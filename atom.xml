<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>前端博客</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2020-04-17T05:54:10.531Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Jumerry</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>VUE框架</title>
    <link href="http://yoursite.com/2020/04/13/VUE%E6%A1%86%E6%9E%B6/"/>
    <id>http://yoursite.com/2020/04/13/VUE%E6%A1%86%E6%9E%B6/</id>
    <published>2020-04-13T07:58:25.000Z</published>
    <updated>2020-04-17T05:54:10.531Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-Vue介绍"><a href="#1-Vue介绍" class="headerlink" title="1 Vue介绍"></a>1 Vue介绍</h1><h2 id="1-1-为什么要学习流行框架"><a href="#1-1-为什么要学习流行框架" class="headerlink" title="1.1 为什么要学习流行框架"></a>1.1 为什么要学习流行框架</h2><ul><li>企业为了提高开发效率：在企业中，时间就是效率，效率就是金钱；</li></ul><ul><li>企业中，使用框架，能够提高开发的效率；</li></ul><ul><li><p>提高开发效率的发展历程：</p><p>原生JS -&gt; Jquery之类的类库 -&gt; 前端模板引擎 -&gt; Angular.js / Vue.js（能够帮助我们减少不必要的DOM操作；提高渲染效率）</p></li></ul><h2 id="1-2-框架和库的区别"><a href="#1-2-框架和库的区别" class="headerlink" title="1.2 框架和库的区别"></a>1.2 框架和库的区别</h2><ul><li><p>框架：是一套完整的解决方案；对项目的侵入性较大，项目如果需要更换框架，则需要重新架构整个项目。</p><p>node 中的 express；</p></li><li><p>库（插件）：提供某一个小功能，对项目的侵入性较小，如果某个库无法完成某些需求，可以很容易切换到其它库实现需求。</p><p>1.从Jquery 切换到 Zepto</p><p>2.从 EJS 切换到 art-template</p></li></ul><h2 id="1-3-什么是Vue-js"><a href="#1-3-什么是Vue-js" class="headerlink" title="1.3 什么是Vue.js"></a>1.3 什么是Vue.js</h2><p><a href="https://cn.vuejs.org/v2/api/" target="_blank" rel="noopener">https://cn.vuejs.org/v2/api/</a></p><ul><li><p>Vue.js是是一套用于构建用户界面的<strong>渐进式框架</strong>，是目前最火的一个前端框架，React是最流行的一个前端框架（React除了开发网站，还可以开发手机App， Vue语法也是可以用于进行手机App开发的，需要借助于Weex）</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">渐进式代表的含义是：没有多做职责之外的事。vue.js只提供了 vue-cli 生态中最核心的 组件系统 和 双向数据绑定。像vuex、vue-router都属于围绕 vue.js开发的库，可以集成也可以不集成。</span><br></pre></td></tr></table></figure><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn4J3Krp/uUnjQtxoKSmXQ5.YSnl4gKOL7ql4zTLdkfaa*MofXsbmscCUBaPTtPY0XYFqokwbHbWXlTNZODq2v0tsVyml*A!!/b&bo=uwPnALsD5wADCSw!&rf=viewer_4"  alt></p></li><li><p>Vue.js 是前端的<strong>主流框架之一</strong>，和Angular.js、React.js 一起，并成为前端三大主流框架！</p></li><li><p>Vue.js 是一套构建用户界面的框架，<strong>只关注视图层</strong>，它不仅易于上手，还便于与第三方库或既有项目整合。（Vue有配套的第三方类库，可以整合起来做大型项目的开发）</p></li></ul><h2 id="1-4-Vue的核心思想"><a href="#1-4-Vue的核心思想" class="headerlink" title="1.4. Vue的核心思想"></a>1.4. Vue的核心思想</h2><blockquote><ul><li>数据驱动，没有dom操作，页面显示由数据驱动</li><li>组件化，一个页面可以划分成很多组件</li><li>状态管理 ，vuex，可用于在多个页面之间进行数据共享</li></ul></blockquote><h2 id="1-5-MVC和MVVM"><a href="#1-5-MVC和MVVM" class="headerlink" title="1.5 MVC和MVVM"></a>1.5 MVC和MVVM</h2><h3 id="a-MVC"><a href="#a-MVC" class="headerlink" title="a) MVC"></a>a) MVC</h3><blockquote><p>M - Model ：数据保存</p><p>V - View : 用户界面</p><p>C - Controller ： 业务逻辑</p></blockquote><p>用户操作–&gt; View (负责接受用户的输入操作)–&gt;Controller（业务逻辑处理）–&gt;Model（数据持久化）–&gt;View（将结果通过View反馈给用户）</p><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn4J3Krp/uUnjQtxoKSmXQ5.YSnl4gDUsvbtG4L1RTP4mGBKtySmryqUo3mH*NbAzuRqTUKk6WiIFBxuolqtQahQbmNddxg!!/b&bo=pgIxAqYCMQIDCSw!&rf=viewer_4"  alt></p><p>MVC有两个很明显的问题：</p><blockquote><p>1.m层和v层直接打交道，导致这两层耦合度高</p><p>2.因为所有逻辑都写在c层，导致c层特别臃肿</p></blockquote><h3 id="b-MVVM"><a href="#b-MVVM" class="headerlink" title="b) MVVM"></a>b) MVVM</h3><p>前端应用的复杂程度已不同往日，暴露出了三个痛点问题：</p><blockquote><p>1.开发者在代码中大量调用相同的DOM API, 处理繁琐，操作冗余，使得代码难以维护。</p><p>2.大量的DOM 操作使页面渲染性能降低，加载速度变慢，影响用户体验。</p><p>3.当 Model 频繁发生变化，开发者需要主动更新到View ；当用户的操作导致Model发生变化，开发者同样需要将变化的数据同步到Model中， 这样的工作不仅繁琐，而且很难维护复杂多变的数据状态。</p></blockquote><p>早期 jQuery 的出现就是为了前端能更简洁的操作DOM 而设计的，但它只解决了第一个问题，另外两个问题始终伴随着前端一直存在。</p><p>MVVM 的出现，完美解决了以上三个问题，MVVM 包含的三部分：</p><blockquote><p>1.Model 层代表数据模型，也可以在Model中定义数据修改和操作的业务逻辑；</p><p>2.View 代表UI 组件，它负责将数据模型转化成UI 展现出来</p><p>3.ViewModel 是一个同步View 和 Model的对象。View 和 Model 之间并没有直接的联系，而是通过ViewModel进行交互。ViewModel 层，它就像是一个中转站（value converter），负责转换 Model 中的数据对象来让数据变得更容易管理和使用，该层向上与视图层进行双向数据绑定，向下与 Model 层通过接口请求进行数据交互，起呈上启下作用。</p></blockquote><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn4J3Krp/uUnjQtxoKSmXQ5.YSnl4gJRDhVvD89N1FFcIy5fSu..TsVI70RHDm.flOWfNkHNyDEuCKh.INuqfHp7v1rNNhw!!/b&bo=nQReAp0EXgIDCSw!&rf=viewer_4"  alt></p><p>MVVM 模式采用双向绑定（data-binding）：View的变动，自动反映在 ViewModel，反之亦然，而View 和 Model 之间的同步工作完全是自动的，无需人为干涉，因此开发者只需关注业务逻辑，不需要手动操作DOM, 不需要关注数据状态的同步问题，复杂的数据状态维护完全由 MVVM 来统一管理。angular 和vue都采用这种模式。</p><h1 id="2-Vue基本语法"><a href="#2-Vue基本语法" class="headerlink" title="2 Vue基本语法"></a>2 Vue基本语法</h1><h2 id="2-1-基本使用"><a href="#2-1-基本使用" class="headerlink" title="2.1 基本使用"></a>2.1 基本使用</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 1. 导入Vue的包 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- id="app" : app指的是将来 new 的Vue实例，会控制这个元素中的所有内容 --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- Vue 实例所控制的这个元素区域，就是我们的 View  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; msg &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 2. 创建一个Vue的实例，就是我们 MVVM中的 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="comment">//  当我们导入包之后，在浏览器的内存中，就多了一个 Vue 构造函数</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">  <span class="comment">// 表示当前我们 new 的这个 Vue 实例，要控制页面上的哪个区域</span></span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,  </span></span><br><span class="line"><span class="actionscript">      <span class="comment">// 这里的 data 就是 MVVM中的 Model，专门用来保存每个页面的数据的</span></span></span><br><span class="line">      data: &#123; </span><br><span class="line"><span class="actionscript"><span class="comment">// data 属性中，存放的是el中要用到的数据</span></span></span><br><span class="line"><span class="actionscript">        msg: <span class="string">'欢迎学习Vue'</span> <span class="comment">// 通过 Vue 提供的指令，很方便的就能把数据渲染到页面上，程序员不再手动操作DOM元素了【前端的Vue之类的框架，不提倡我们去手动操作DOM元素了】</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//mustache 插值表达式的特点：必须是一句话，必须有返回值</span></span><br><span class="line">&#123;&#123;number+<span class="number">1</span>&#125;&#125;</span><br><span class="line">&#123;&#123;ok?<span class="string">"YES"</span>:<span class="string">"NO"</span>&#125;&#125;</span><br><span class="line">&#123;&#123;message.split(<span class="string">""</span>).reverse().join(<span class="string">"-"</span>)&#125;&#125;</span><br></pre></td></tr></table></figure><h2 id="2-2-常用指令"><a href="#2-2-常用指令" class="headerlink" title="2.2 常用指令"></a>2.2 常用指令</h2><ul><li>v-cloak</li><li>v-text</li><li>v-html</li><li>v-bind</li><li>v-on</li></ul><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">    <span class="selector-attr">[v-cloak]</span> &#123;</span></span><br><span class="line">      display: none;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 使用 v-cloak 能够解决 插值表达式闪烁的问题  vue-2.4.0.js的加载需要时间，在vue-2.4.0.js没有成功加载之前，页面会显示&#123; &#123;msg&#125;&#125;文本信息 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-cloak</span>&gt;</span>++++++++ &#123;&#123; msg &#125;&#125; ----------<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h4</span> <span class="attr">v-text</span>=<span class="string">"msg"</span>&gt;</span>==================<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 默认 v-text 是没有闪烁问题的 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- v-text会覆盖元素中原本的内容，但是插值表达式只会替换自己的这个占位符，不会把整个元素的内容清空 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;&#123;msg2&#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-text</span>=<span class="string">"msg2"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!-- v-html会覆盖元素中原本的内容，只不过会将msg2当做html文本进行解析 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-html</span>=<span class="string">"msg2"</span>&gt;</span>1212112<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- v-bind: 是Vue中提供的用于绑定属性的指令，v-bind 中，可以写合法的JS表达式 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"按钮1"</span> <span class="attr">v-bind:title</span>=<span class="string">"mytitle + '123'"</span>&gt;</span> </span><br><span class="line">    <span class="comment">&lt;!-- 注意： v-bind: 指令可以被简写为 :要绑定的属性 --&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"按钮2"</span> <span class="attr">:title</span>=<span class="string">"mytitle + '3455'"</span>&gt;</span> </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Vue 中提供了 v-on: 事件绑定机制</span></span><br><span class="line"><span class="comment">          下面代码错误：因为vue会将alert理解为一个变量，而在Vue中我们并没有定义alert变量，所以找不到--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;input type="button" value="按钮3" :title="mytitle + '888'" v-on:click="alert('hello')"&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--v-on:click可以简写成@click--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"按钮4"</span> @<span class="attr">click</span>=<span class="string">"show"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line"><span class="actionscript">        msg: <span class="string">'123'</span>,</span></span><br><span class="line"><span class="handlebars"><span class="xml">        msg2: '<span class="tag">&lt;<span class="name">h1</span>&gt;</span>哈哈，我是一个大大的H1， 我大，我骄傲<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>',</span></span></span><br><span class="line"><span class="actionscript">        mytitle: <span class="string">'这是一个自己定义的title'</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123; </span><br><span class="line"><span class="actionscript">        <span class="comment">// 这个 methods属性中定义了当前Vue实例所有可用的方法</span></span></span><br><span class="line"><span class="actionscript">        show: <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">          alert(<span class="string">'Hello'</span>)</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    /*</span><br><span class="line"><span class="actionscript"><span class="comment">//在vue中不推荐我们再去使用dom操作的方法</span></span></span><br><span class="line"><span class="javascript"><span class="built_in">document</span>.getElementById(<span class="string">'btn'</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="actionscript">      alert(<span class="string">'Hello'</span>)</span></span><br><span class="line">    &#125; */</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-3-跑马灯效果"><a href="#2-3-跑马灯效果" class="headerlink" title="2.3 跑马灯效果"></a>2.3 跑马灯效果</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 1. 导入Vue包 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 2. 创建一个要控制的区域 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"浪起来"</span> @<span class="attr">click</span>=<span class="string">"lang"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"低调"</span> @<span class="attr">click</span>=<span class="string">"stop"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">h4</span>&gt;</span>&#123;&#123; msg &#125;&#125;<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 注意：在VM实例中，如果想要获取data上的数据，或者想要调用methods中的方法，必须通过this.数据属性名或this.方法名来进行访问，这里的this，就表示我们new出来的VM 实例对象</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line"><span class="actionscript">        msg: <span class="string">'猥琐发育，别浪~~！'</span>,</span></span><br><span class="line"><span class="actionscript">        intervalId: <span class="literal">null</span> <span class="comment">// 在data上定义定时器Id</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line">        lang() &#123;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">          <span class="keyword">if</span> (<span class="keyword">this</span>.intervalId != <span class="literal">null</span>) <span class="keyword">return</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">          <span class="keyword">this</span>.intervalId = setInterval(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">var</span> start = <span class="keyword">this</span>.msg.substring(<span class="number">0</span>, <span class="number">1</span>)</span></span><br><span class="line"><span class="actionscript">            <span class="comment">// 获取到后面的所有字符</span></span></span><br><span class="line"><span class="actionscript">            <span class="keyword">var</span> end = <span class="keyword">this</span>.msg.substring(<span class="number">1</span>)</span></span><br><span class="line"><span class="actionscript">            <span class="comment">// 重新拼接得到新的字符串，并赋值给 this.msg</span></span></span><br><span class="line"><span class="actionscript">            <span class="keyword">this</span>.msg = end + start</span></span><br><span class="line">          &#125;, 400)</span><br><span class="line"></span><br><span class="line"><span class="actionscript">          <span class="comment">// 注意： VM实例，会监听自己身上data中所有数据的改变，只要数据一发生变化，就会自动把最新的数据从data上同步到页面中去；</span></span></span><br><span class="line"><span class="actionscript">  <span class="comment">//【好处：程序员只需要关心数据，不需要考虑如何重新渲染DOM页面】</span></span></span><br><span class="line">        &#125;,</span><br><span class="line">        stop() &#123; </span><br><span class="line"><span class="actionscript">  <span class="comment">//停止定时器</span></span></span><br><span class="line"><span class="actionscript">          clearInterval(<span class="keyword">this</span>.intervalId)</span></span><br><span class="line"><span class="actionscript">          <span class="comment">//每当清除了定时器之后，需要重新把 intervalId 置为 null</span></span></span><br><span class="line"><span class="actionscript">          <span class="keyword">this</span>.intervalId = <span class="literal">null</span>;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-4-事件修饰符"><a href="#2-4-事件修饰符" class="headerlink" title="2.4 事件修饰符"></a>2.4 事件修饰符</h2><ul><li>.stop       阻止冒泡</li><li>.prevent    阻止默认事件</li><li>.capture    添加事件侦听器时使用事件捕获模式</li><li>.self       只当事件在该元素本身（比如不是子元素）触发时触发回调</li><li>.once       事件只触发一次</li></ul><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.inner</span> &#123;</span></span><br><span class="line">      height: 150px;</span><br><span class="line">      background-color: darkcyan;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.outer</span> &#123;</span></span><br><span class="line">      padding: 40px;</span><br><span class="line">      background-color: red;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 使用  .stop  阻止冒泡 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span> @<span class="attr">click</span>=<span class="string">"div1Handler"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"阻止冒泡"</span> @<span class="attr">click.stop</span>=<span class="string">"btnHandler"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 使用 .prevent 阻止默认行为 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://www.baidu.com"</span> @<span class="attr">click.prevent</span>=<span class="string">"linkClick"</span>&gt;</span>阻止默认行为<span class="tag">&lt;/<span class="name">a</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 使用  .capture 实现捕获触发事件的机制 。打印顺序从外向里 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span> @<span class="attr">click.capture</span>=<span class="string">"div1Handler"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"捕获事件"</span> @<span class="attr">click</span>=<span class="string">"btnHandler"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 使用 .self 实现只有点击当前元素时候，才会触发事件处理函数 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span> @<span class="attr">click</span>=<span class="string">"div1Handler.self"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"self"</span> @<span class="attr">click</span>=<span class="string">"btnHandler"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 使用 .once 只触发一次事件处理函数 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">href</span>=<span class="string">"http://www.baidu.com"</span> @<span class="attr">click.once</span>=<span class="string">"spanClick"</span>&gt;</span>只能触发一次<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 演示： .stop 和 .self 的区别 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!--.stop阻止所有的冒泡--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"outer"</span> @<span class="attr">click</span>=<span class="string">"div2Handler"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span> @<span class="attr">click</span>=<span class="string">"div1Handler"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"stop"</span> @<span class="attr">click.stop</span>=<span class="string">"btnHandler"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- .self 只有点击当前元素才会触发点击事件。如果子元素的事件冒泡到自己身上，不会执行该事件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"outer"</span> @<span class="attr">click</span>=<span class="string">"div2Handler"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"inner"</span> @<span class="attr">click.self</span>=<span class="string">"div1Handler"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"self"</span> @<span class="attr">click</span>=<span class="string">"btnHandler"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;&#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line">        div1Handler() &#123;</span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(<span class="string">'这是触发了 inner div 的点击事件'</span>)</span></span><br><span class="line">        &#125;,</span><br><span class="line">        btnHandler() &#123;</span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(<span class="string">'这是触发了 btn 按钮 的点击事件'</span>)</span></span><br><span class="line">        &#125;,</span><br><span class="line">        linkClick() &#123;</span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(<span class="string">'触发了连接的点击事件'</span>)</span></span><br><span class="line">        &#125;,</span><br><span class="line">        div2Handler() &#123;</span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(<span class="string">'这是触发了 outer div 的点击事件'</span>)</span></span><br><span class="line">        &#125;,</span><br><span class="line">        spanClick()&#123;</span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(<span class="string">'spanClick'</span>)</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-5-v-model和双向绑定"><a href="#2-5-v-model和双向绑定" class="headerlink" title="2.5 v-model和双向绑定"></a>2.5 v-model和双向绑定</h2><p>只有v-model指令实现了双向绑定， v-model 只能运用在表单元素中。如： input(radio, text, address, email….)   select    checkbox   textarea</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"app"</span> <span class="attr">action</span>=<span class="string">"#"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">input</span>  <span class="attr">v-model</span>=<span class="string">"email"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">"name"</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"modify"</span>&gt;</span>点我修改数据源<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"show"</span>&gt;</span>改完表单再点我<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">  el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line"><span class="actionscript">        email: <span class="string">'zhangsan@qq.com'</span>,</span></span><br><span class="line"><span class="actionscript">        name: <span class="string">'zhangsan'</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      methods:&#123;</span><br><span class="line"><span class="actionscript">      modify:<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="actionscript">      <span class="keyword">this</span>.email = <span class="string">'lisi@.qq.com'</span>;</span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="actionscript">      show:<span class="function"><span class="keyword">function</span><span class="params">()</span></span>&#123;</span></span><br><span class="line"><span class="actionscript">      alert(<span class="keyword">this</span>.email);</span></span><br><span class="line">      &#125;</span><br><span class="line">      &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-6-双向绑定-计算器案例"><a href="#2-6-双向绑定-计算器案例" class="headerlink" title="2.6 双向绑定-计算器案例"></a>2.6 双向绑定-计算器案例</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"n1"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">v-model</span>=<span class="string">"opt"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"+"</span>&gt;</span>+<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"-"</span>&gt;</span>-<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"*"</span>&gt;</span>*<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">option</span> <span class="attr">value</span>=<span class="string">"/"</span>&gt;</span>/<span class="tag">&lt;/<span class="name">option</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"n2"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"="</span> @<span class="attr">click</span>=<span class="string">"calc"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"result"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line">        n1: 0,</span><br><span class="line">        n2: 0,</span><br><span class="line">        result: 0,</span><br><span class="line"><span class="actionscript">        opt: <span class="string">'+'</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line"><span class="actionscript">        calc() &#123; <span class="comment">// 计算器算数的方法  </span></span></span><br><span class="line"><span class="actionscript">          <span class="comment">// 逻辑：</span></span></span><br><span class="line"><span class="actionscript">          <span class="keyword">switch</span> (<span class="keyword">this</span>.opt) &#123;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">case</span> <span class="string">'+'</span>:</span></span><br><span class="line"><span class="javascript">              <span class="keyword">this</span>.result = <span class="built_in">parseInt</span>(<span class="keyword">this</span>.n1) + <span class="built_in">parseInt</span>(<span class="keyword">this</span>.n2)</span></span><br><span class="line"><span class="actionscript">              <span class="keyword">break</span>;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">case</span> <span class="string">'-'</span>:</span></span><br><span class="line"><span class="javascript">              <span class="keyword">this</span>.result = <span class="built_in">parseInt</span>(<span class="keyword">this</span>.n1) - <span class="built_in">parseInt</span>(<span class="keyword">this</span>.n2)</span></span><br><span class="line"><span class="actionscript">              <span class="keyword">break</span>;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">case</span> <span class="string">'*'</span>:</span></span><br><span class="line"><span class="javascript">              <span class="keyword">this</span>.result = <span class="built_in">parseInt</span>(<span class="keyword">this</span>.n1) * <span class="built_in">parseInt</span>(<span class="keyword">this</span>.n2)</span></span><br><span class="line"><span class="actionscript">              <span class="keyword">break</span>;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">case</span> <span class="string">'/'</span>:</span></span><br><span class="line"><span class="javascript">              <span class="keyword">this</span>.result = <span class="built_in">parseInt</span>(<span class="keyword">this</span>.n1) / <span class="built_in">parseInt</span>(<span class="keyword">this</span>.n2)</span></span><br><span class="line"><span class="actionscript">              <span class="keyword">break</span>;</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-7-双向绑定的原理"><a href="#2-7-双向绑定的原理" class="headerlink" title="2.7 双向绑定的原理"></a>2.7 双向绑定的原理</h2><h3 id="a-页面–-gt-数据"><a href="#a-页面–-gt-数据" class="headerlink" title="a) 页面–&gt;数据"></a>a) 页面–&gt;数据</h3><p>view更新data只需要添加DOM事件监听即可，比如input标签监听 ‘input’ 事件就可以实现</p><h3 id="b-数据–-gt-页面"><a href="#b-数据–-gt-页面" class="headerlink" title="b) 数据–&gt;页面"></a>b) 数据–&gt;页面</h3><p>是通过数据劫持 + 发布者-订阅者模式的方式来实现的</p><h4 id="1-数据劫持"><a href="#1-数据劫持" class="headerlink" title="(1).数据劫持"></a>(1).数据劫持</h4><p>vue是通过Object.defineProperty()来实现数据劫持的。(vue3.0已换成proxy来实现数据劫持)</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> book = &#123;&#125;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(book, <span class="string">'name'</span>, &#123;</span><br><span class="line">    <span class="keyword">set</span>: function (value) &#123;</span><br><span class="line">        name = value;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'你取了一个书名叫做'</span> + value);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">get</span>: function () &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'《'</span> + name + <span class="string">'》'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">book.name = <span class="string">'vue权威指南'</span>;  <span class="comment">// 你取了一个书名叫做vue权威指南</span></span><br><span class="line">book.name = <span class="string">'vue权威指南2'</span>;  <span class="comment">// 你取了一个书名叫做vue权威指南</span></span><br><span class="line"><span class="built_in">console</span>.log(book.name);  <span class="comment">// 《vue权威指南》</span></span><br></pre></td></tr></table></figure><h4 id="2-发布者订阅模式"><a href="#2-发布者订阅模式" class="headerlink" title="(2).发布者订阅模式"></a>(2).发布者订阅模式</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1.消息订阅器，内部维护了所有订阅者的列表</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Dep</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.subs = [];</span><br><span class="line">&#125;</span><br><span class="line">Dep.prototype = &#123;</span><br><span class="line">    addSub: <span class="function"><span class="keyword">function</span>(<span class="params">sub</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.subs.push(sub);</span><br><span class="line">    &#125;,</span><br><span class="line">    notify: <span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.subs.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">sub</span>) </span>&#123;</span><br><span class="line">            sub.update(value);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> dep = <span class="keyword">new</span> Dep();</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.订阅者</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Watcher</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line">Watcher.prototype = &#123;</span><br><span class="line">    update: <span class="function"><span class="keyword">function</span>(<span class="params">value</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"数据源已经变动，新的数据是"</span>+value)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> w1 = <span class="keyword">new</span> Watcher();</span><br><span class="line"><span class="keyword">var</span> w2 = <span class="keyword">new</span> Watcher();</span><br><span class="line">dep.addSub(w1);</span><br><span class="line">dep.addSub(w2);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//3.数据源，通过defineProperty监听数据源的变化</span></span><br><span class="line"><span class="keyword">var</span> book = &#123;&#125;</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(book, <span class="string">'name'</span>, &#123;</span><br><span class="line">    <span class="keyword">set</span>: function (value) &#123;</span><br><span class="line">        name = value;</span><br><span class="line">        <span class="comment">//一旦数据源发生变化了，通知所有的订阅者更新数据</span></span><br><span class="line">        dep.notify(value);</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="keyword">get</span>: function () &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">'《'</span> + name + <span class="string">'》'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">book.name = <span class="string">'vue权威指南'</span>;  <span class="comment">// 你取了一个书名叫做vue权威指南</span></span><br><span class="line">book.name = <span class="string">'vue权威指南2'</span>;  <span class="comment">// 你取了一个书名叫做vue权威指南</span></span><br><span class="line"><span class="built_in">console</span>.log(book.name);  <span class="comment">// 《vue权威指南》</span></span><br></pre></td></tr></table></figure><h4 id="3-数据绑定的实现流程"><a href="#3-数据绑定的实现流程" class="headerlink" title="(3).数据绑定的实现流程"></a>(3).数据绑定的实现流程</h4><p>首先要对数据进行劫持监听，所以我们需要设置一个监听器Observer，用来监听所有属性。如果属性发上变化了，就需要告诉订阅者Watcher看是否需要更新。</p><p>因为订阅者是有很多个，所以我们需要有一个消息订阅器Dep来专门收集这些订阅者，然后在监听器Observer和订阅者Watcher之间进行统一管理的。</p><p>接着，我们还需要有一个指令解析器Compile，对每个节点元素进行扫描和解析，将相关指令对应初始化成一个订阅者Watcher，并替换模板数据或者绑定相应的函数，此时当订阅者Watcher接收到相应属性的变化，就会执行对应的更新函数，从而更新视图。</p><p>因此接下去我们执行以下3个步骤，实现数据的双向绑定：</p><blockquote><p>1.监听器Observer，用来劫持并监听所有属性，如果有变动的，就通知所有订阅者。</p><p>2.订阅者Watcher，可以收到属性的变化通知并执行相应的函数，从而更新视图。</p><p>3.解析器Compile，可以扫描和解析每个节点的相关指令，并根据初始化模板数据以及初始化相应的订阅者</p></blockquote><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn4J3Krp/uUnjQtxoKSmXQ5.YSnl4gBG6a.SdIQeeAOB.hBv4Pz1fwICrQToRPKTr3BtxLrfiOAyzqQ9kstjIHQswgoFMvw!!/b&bo=gwLbAYMC2wEDCSw!&rf=viewer_4"  alt="1547815009579"></p><p>参考链接：<a href="https://www.cnblogs.com/libin-1/p/6893712.html" target="_blank" rel="noopener">https://www.cnblogs.com/libin-1/p/6893712.html</a></p><h2 id="2-8-vue样式操作"><a href="#2-8-vue样式操作" class="headerlink" title="2.8 vue样式操作"></a>2.8 vue样式操作</h2><h3 id="a-class操作"><a href="#a-class操作" class="headerlink" title="a)  class操作"></a>a)  class操作</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.red</span> &#123;</span></span><br><span class="line">      color: red;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.thin</span> &#123;</span></span><br><span class="line">      font-weight: 200;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.italic</span> &#123;</span></span><br><span class="line">      font-style: italic;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.active</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="selector-tag">letter-spacing</span>: 1<span class="selector-class">.5em</span>;</span></span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"red thin"</span>&gt;</span>这是一个很大很大的H1，大到你无法想象！！！<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 第一种使用方式，直接传递一个数组，注意：这里的class需要使用  v-bind 做数据绑定 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">:class</span>=<span class="string">"['thin', 'italic']"</span>&gt;</span>这是一个很大很大的H1，大到你无法想象！！！<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 在数组中使用三元表达式 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">:class</span>=<span class="string">"['thin', 'italic', flag?'active':'']"</span>&gt;</span>这是一个很大很大的H1，大到你无法想象！！！<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 在数组中使用对象来代替三元表达式，提高代码的可读性 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">:class</span>=<span class="string">"['thin', 'italic', &#123;'active':flag&#125; ]"</span>&gt;</span>这是一个很大很大的H1，大到你无法想象！！！<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 在为class使用v-bind绑定对象的时候，对象的属性是类名，属性的值是一个标识符 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">:class</span>=<span class="string">"classObj"</span>&gt;</span>这是一个很大很大的H1，大到你无法想象！！！<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line"><span class="actionscript">        flag: <span class="literal">true</span>,</span></span><br><span class="line"><span class="actionscript">        classObj: &#123; red: <span class="literal">true</span>, thin: <span class="literal">true</span>, italic: <span class="literal">false</span>, active: <span class="literal">false</span> &#125;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="b-style操作"><a href="#b-style操作" class="headerlink" title="b)  style操作"></a>b)  style操作</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 对象就是无序键值对的集合 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">:style</span>=<span class="string">"styleObj1"</span>&gt;</span>标题1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> </span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">:style</span>=<span class="string">"[styleObj1,styleObj2]"</span>&gt;</span>标题2<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line"><span class="actionscript">        styleObj1: &#123; color: <span class="string">'red'</span>, <span class="string">'font-weight'</span>: <span class="number">200</span> &#125;,</span></span><br><span class="line"><span class="actionscript">        styleObj2: &#123; <span class="string">'font-style'</span>: <span class="string">'italic'</span> &#125;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-9-vue循环"><a href="#2-9-vue循环" class="headerlink" title="2.9 vue循环"></a>2.9 vue循环</h2><h3 id="a-循环普通数据"><a href="#a-循环普通数据" class="headerlink" title="a) 循环普通数据"></a>a) 循环普通数据</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;list[0]&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;list[1]&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;list[2]&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;list[3]&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;list[4]&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>--------------------------------------------<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-for</span>=<span class="string">"(item, i) in list"</span>&gt;</span>索引值：&#123;&#123;i&#125;&#125; --- 每一项：&#123;&#123;item&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line">        list: [1, 2, 3, 4, 5, 6]</span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="b-循环对象数组"><a href="#b-循环对象数组" class="headerlink" title="b) 循环对象数组"></a>b) 循环对象数组</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-for</span>=<span class="string">"(user, i) in list"</span>&gt;</span>Id：&#123;&#123; user.id &#125;&#125; --- 名字：&#123;&#123; user.name &#125;&#125; --- 索引：&#123;&#123;i&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"> </span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line">        list: [</span><br><span class="line"><span class="actionscript">          &#123; id: <span class="number">1</span>, name: <span class="string">'zs1'</span> &#125;,</span></span><br><span class="line"><span class="actionscript">          &#123; id: <span class="number">2</span>, name: <span class="string">'zs2'</span> &#125;,</span></span><br><span class="line"><span class="actionscript">          &#123; id: <span class="number">3</span>, name: <span class="string">'zs3'</span> &#125;,</span></span><br><span class="line"><span class="actionscript">          &#123; id: <span class="number">4</span>, name: <span class="string">'zs4'</span> &#125;</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="c-循环对象"><a href="#c-循环对象" class="headerlink" title="c) 循环对象"></a>c) 循环对象</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 注意：在遍历对象身上的键值对的时候， 除了 有  val  key  ,在第三个位置还有 一个 索引  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-for</span>=<span class="string">"(val, key, i) in user"</span>&gt;</span>值是： &#123;&#123; val &#125;&#125; --- 键是： &#123;&#123;key&#125;&#125; -- 索引： &#123;&#123;i&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line">        user: &#123;</span><br><span class="line">          id: 1,</span><br><span class="line"><span class="actionscript">          name: <span class="string">'托尼·屎大颗'</span>,</span></span><br><span class="line"><span class="actionscript">          gender: <span class="string">'男'</span></span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="d-循环数字"><a href="#d-循环数字" class="headerlink" title="d) 循环数字"></a>d) 循环数字</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- in 后面还可以放数字 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 注意：如果使用 v-for 迭代数字的话，前面的 count 值从 1 开始 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-for</span>=<span class="string">"count in 10"</span>&gt;</span>这是第 &#123;&#123; count &#125;&#125; 次循环<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;&#125;,</span><br><span class="line">      methods: &#123;&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="e-循环中key的使用"><a href="#e-循环中key的使用" class="headerlink" title="e) 循环中key的使用"></a>e) 循环中key的使用</h3><p>当 Vue.js 用 v-for 正在更新已渲染过的元素列表时，它默认用 “<strong>就地复用</strong>” 策略。如果数据项的顺序被改变，Vue将<strong>不是移动 DOM 元素来匹配数据项的顺序</strong>， 而是<strong>简单复用此处每个元素</strong>，并且确保它在特定索引下显示已被渲染过的每个元素。</p><p>为了给 Vue 一个提示，<strong>以便它能跟踪每个节点的身份，从而重用和重新排序现有元素</strong>，你需要为每项提供一个唯一 key 属性。</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span>&gt;</span>Id:</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span>&gt;</span>Name:</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"name"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"添加"</span> @<span class="attr">click</span>=<span class="string">"add"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--:key的作用：保证数据和页面的关联，让数据和页面一一对应。这个地方如果不加key，在给某一个input打钩之后再新增数据就会出现问题--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 注意： v-for 循环的时候，key 属性的值只能是number或者string，否则报错 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-for</span>=<span class="string">"item in list"</span> <span class="attr">:key</span>=<span class="string">"item.id"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span>&gt;</span>&#123;&#123;item.id&#125;&#125; --- &#123;&#123;item.name&#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line"><span class="actionscript">        id: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">        name: <span class="string">''</span>,</span></span><br><span class="line">        list: [</span><br><span class="line"><span class="actionscript">          &#123; id: <span class="number">1</span>, name: <span class="string">'李斯'</span> &#125;,</span></span><br><span class="line"><span class="actionscript">          &#123; id: <span class="number">2</span>, name: <span class="string">'嬴政'</span> &#125;,</span></span><br><span class="line"><span class="actionscript">          &#123; id: <span class="number">3</span>, name: <span class="string">'赵高'</span> &#125;,</span></span><br><span class="line"><span class="actionscript">          &#123; id: <span class="number">4</span>, name: <span class="string">'韩非'</span> &#125;,</span></span><br><span class="line"><span class="actionscript">          &#123; id: <span class="number">5</span>, name: <span class="string">'荀子'</span> &#125;</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line"><span class="actionscript">        add() &#123; <span class="comment">// 添加方法</span></span></span><br><span class="line"><span class="actionscript">          <span class="keyword">this</span>.list.unshift(&#123; id: <span class="keyword">this</span>.id, name: <span class="keyword">this</span>.name &#125;)</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-10-v-if和v-show"><a href="#2-10-v-if和v-show" class="headerlink" title="2.10 v-if和v-show"></a>2.10 v-if和v-show</h2><pre><code>一般来说，v-if 有更高的切换消耗而 v-show 有更高的初始渲染消耗。因此，如果需要频繁切换 v-show 较好，如果在运行时条件不大可能改变 v-if 较好。</code></pre><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"toffle1"</span> @<span class="attr">click</span>=<span class="string">"toggle"</span>&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"toggle2"</span> @<span class="attr">click</span>=<span class="string">"flag=!flag"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- v-if 的特点：每次都会重新删除或创建元素,有较高的切换性能消耗 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- v-show 的特点： 每次不会重新进行DOM的删除和创建操作，只是切换了元素的 display:none 样式 --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 如果元素涉及到频繁的切换，最好不要使用 v-if, 而是推荐使用 v-show --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 如果元素可能永远也不会被显示出来被用户看到，则推荐使用 v-if --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span> <span class="attr">v-if</span>=<span class="string">"flag"</span>&gt;</span>这是用v-if控制的元素<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span> <span class="attr">v-show</span>=<span class="string">"flag"</span>&gt;</span>这是用v-show控制的元素<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line"><span class="actionscript">        flag: <span class="literal">false</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line">        toggle() &#123;</span><br><span class="line"><span class="actionscript">          <span class="keyword">this</span>.flag = !<span class="keyword">this</span>.flag</span></span><br><span class="line">        &#125; </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-11-品牌管理案例"><a href="#2-11-品牌管理案例" class="headerlink" title="2.11 品牌管理案例"></a>2.11 品牌管理案例</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"./lib/bootstrap-3.3.7.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel panel-primary"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-heading"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">"panel-title"</span>&gt;</span>添加品牌<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body form-inline"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">          Id:</span><br><span class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">v-model</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">          Name:</span><br><span class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">v-model</span>=<span class="string">"name"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 在Vue中，使用事件绑定机制，为元素指定处理函数的时候，如果加了小括号，就可以给函数传参了 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"添加"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> @<span class="attr">click</span>=<span class="string">"add()"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">          搜索名称关键字：</span><br><span class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">v-model</span>=<span class="string">"keywords"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-bordered table-hover table-striped"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">th</span>&gt;</span>Id<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">th</span>&gt;</span>Name<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">th</span>&gt;</span>Ctime<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">th</span>&gt;</span>Operation<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 之前， v-for中的数据，都是直接从data上的list中直接渲染过来的 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 现在， 我们自定义了一个search方法，调用这个方法获取数据 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 在 search 方法内部，通过执行for循环， 把所有符合搜索关键字的数据，保存到 一个新数组中返回 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span> <span class="attr">v-for</span>=<span class="string">"item in search()"</span> <span class="attr">:key</span>=<span class="string">"item.id"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; item.id &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span> <span class="attr">v-text</span>=<span class="string">"item.name"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; item.ctime &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span> @<span class="attr">click.prevent</span>=<span class="string">"del(item.id)"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line"><span class="actionscript">        id: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">        name: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">        keywords: <span class="string">''</span>, <span class="comment">// 搜索的关键字</span></span></span><br><span class="line">        list: [</span><br><span class="line"><span class="javascript">          &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">'奔驰'</span>, <span class="attr">ctime</span>: <span class="keyword">new</span> <span class="built_in">Date</span>() &#125;,</span></span><br><span class="line"><span class="javascript">          &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">'宝马'</span>, <span class="attr">ctime</span>: <span class="keyword">new</span> <span class="built_in">Date</span>() &#125;</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line"><span class="actionscript">        add() &#123; <span class="comment">// 添加的方法</span></span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> car = &#123; <span class="attr">id</span>: <span class="keyword">this</span>.id, <span class="attr">name</span>: <span class="keyword">this</span>.name, <span class="attr">ctime</span>: <span class="keyword">new</span> <span class="built_in">Date</span>() &#125;</span></span><br><span class="line"><span class="actionscript">          <span class="keyword">this</span>.list.push(car)</span></span><br><span class="line"><span class="actionscript">          <span class="keyword">this</span>.id = <span class="keyword">this</span>.name = <span class="string">''</span></span></span><br><span class="line">        &#125;,</span><br><span class="line"><span class="actionscript">        del(id) &#123; <span class="comment">// 根据Id删除数据</span></span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> index = <span class="keyword">this</span>.list.findIndex(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></span><br><span class="line">            if (item.id == id) &#123;</span><br><span class="line"><span class="actionscript">              <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;)</span><br><span class="line"><span class="actionscript">          <span class="keyword">this</span>.list.splice(index, <span class="number">1</span>)</span></span><br><span class="line">        &#125;,</span><br><span class="line">        search() &#123; </span><br><span class="line"><span class="actionscript">          <span class="comment">// 根据关键字，进行数据的搜索</span></span></span><br><span class="line"><span class="actionscript">          <span class="comment">// 注意：  forEach   some   filter   findIndex   这些都属于数组的新方法，都会对数组中的每一项，进行遍历，执行相关的操作；</span></span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> <span class="keyword">this</span>.list.filter(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="actionscript">            <span class="comment">// if(item.name.indexOf(keywords) != -1)</span></span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">            <span class="comment">// 注意 ： ES6中，为字符串提供了一个新方法，叫做  String.prototype.includes('要包含的字符串')。如果包含，则返回 true ，否则返回 false</span></span></span><br><span class="line"><span class="actionscript">            <span class="keyword">if</span> (item.name.includes(<span class="keyword">this</span>.keywords)) &#123;</span></span><br><span class="line"><span class="actionscript">              <span class="keyword">return</span> item</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-12-Vue-devtools"><a href="#2-12-Vue-devtools" class="headerlink" title="2.12 Vue-devtools"></a>2.12 Vue-devtools</h2><h4 id="a-将vue-devtools拷贝到本地"><a href="#a-将vue-devtools拷贝到本地" class="headerlink" title="a) 将vue-devtools拷贝到本地"></a>a) 将vue-devtools拷贝到本地</h4><p><a href="https://github.com/vuejs/vue-devtools.git" target="_blank" rel="noopener">https://github.com/vuejs/vue-devtools.git</a></p><h4 id="b-在vue-devtools目录下安装依赖包"><a href="#b-在vue-devtools目录下安装依赖包" class="headerlink" title="b) 在vue-devtools目录下安装依赖包"></a>b) 在vue-devtools目录下安装依赖包</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">cd vue-devtools</span><br><span class="line">npm install</span><br></pre></td></tr></table></figure><h4 id="c-编译代码"><a href="#c-编译代码" class="headerlink" title="c) 编译代码"></a>c) 编译代码</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">npm run build</span><br></pre></td></tr></table></figure><h4 id="d-修改manifest-json文件"><a href="#d-修改manifest-json文件" class="headerlink" title="d) 修改manifest.json文件"></a>d) 修改manifest.json文件</h4><p>修改   <code>vue-devtools/shells/chrome/manifest.json</code>文件，将 persistent改成 true</p><h4 id="e-添加谷歌扩展程序"><a href="#e-添加谷歌扩展程序" class="headerlink" title="e) 添加谷歌扩展程序"></a>e) 添加谷歌扩展程序</h4><pre><code>打开开发者模式启用vue-devtools允许访问文件地址</code></pre><h1 id="3-过滤器、按键修饰符、自定义指令"><a href="#3-过滤器、按键修饰符、自定义指令" class="headerlink" title="3 过滤器、按键修饰符、自定义指令"></a>3 过滤器、按键修饰符、自定义指令</h1><h2 id="3-1-过滤器"><a href="#3-1-过滤器" class="headerlink" title="3.1 过滤器"></a>3.1 过滤器</h2><p>概念：Vue.js 允许你自定义过滤器，可被用作一些常见的文本格式化。过滤器可以用在两个地方：mustache 插值和 v-bind 表达式。过滤器应该被添加在 JavaScript 表达式的尾部，由“管道”符指示；</p><h3 id="3-1-1-私有过滤器"><a href="#3-1-1-私有过滤器" class="headerlink" title="3.1.1 私有过滤器"></a>3.1.1 私有过滤器</h3><ol><li>HTML元素：</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;p&gt;&#123;&#123; msg | msgFormat(<span class="string">'疯狂+1'</span>, <span class="string">'123'</span>) | test &#125;&#125;&lt;<span class="regexp">/p&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>私有 <code>filters</code> 定义方式：</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span><br><span class="line">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">      el: <span class="string">'#app'</span>,</span><br><span class="line">      data: &#123;</span><br><span class="line">        msg: <span class="string">'曾经，我也是一个单纯的少年，单纯的我，傻傻的问，谁是世界上最单纯的男人'</span></span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;&#125;,</span><br><span class="line">  filters: &#123; </span><br><span class="line">        <span class="comment">// 过滤器的三个参数：1.要过滤的文本   2.过滤的内容   3.替换的内容</span></span><br><span class="line">        <span class="comment">// 过滤器调用的时候，采用的是就近原则，如果私有过滤器和全局过滤器名称一致了，这时候优先调用私有过滤器</span></span><br><span class="line">        msgFormat: <span class="function"><span class="keyword">function</span> (<span class="params">msg, arg, arg2</span>) </span>&#123;</span><br><span class="line">           <span class="comment">// 字符串的  replace 方法，第一个参数，除了可写一个 字符串之外，还可以定义一个正则</span></span><br><span class="line">   <span class="keyword">return</span> msg.replace(<span class="regexp">/少年/g</span>, arg + arg2)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;);</span><br><span class="line">  &lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>body&gt;</span><br></pre></td></tr></table></figure><h3 id="3-1-2-全局过滤器"><a href="#3-1-2-全局过滤器" class="headerlink" title="3.1.2 全局过滤器"></a>3.1.2 全局过滤器</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">  &lt;div id=<span class="string">"app"</span>&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123; msg | msgFormat(<span class="string">'疯狂+1'</span>, <span class="string">'123'</span>) | test &#125;&#125;&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>div&gt;</span><br><span class="line"></span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    <span class="comment">// 定义一个 Vue 全局的过滤器，名字叫做  msgFormat</span></span><br><span class="line">    Vue.filter(<span class="string">'msgFormat'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">msg, arg, arg2</span>) </span>&#123;</span><br><span class="line">      <span class="comment">// 字符串的  replace 方法，第一个参数，除了可写一个 字符串之外，还可以定义一个正则</span></span><br><span class="line">      <span class="keyword">return</span> msg.replace(<span class="regexp">/单纯/g</span>, arg + arg2)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    Vue.filter(<span class="string">'test'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">msg</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> msg + <span class="string">'========'</span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span><br><span class="line">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">      el: <span class="string">'#app'</span>,</span><br><span class="line">      data: &#123;</span><br><span class="line">        msg: <span class="string">'曾经，我也是一个单纯的少年，单纯的我，傻傻的问，谁是世界上最单纯的男人'</span></span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>body&gt;</span><br></pre></td></tr></table></figure><blockquote><p>注意：当有局部和全局两个名称相同的过滤器时候，会以就近原则进行调用，即：局部过滤器优先于全局过滤器被调用！</p></blockquote><h2 id="3-2-键盘修饰符"><a href="#3-2-键盘修饰符" class="headerlink" title="3.2 键盘修饰符"></a>3.2 键盘修饰符</h2><h3 id="3-2-1-键盘修饰符"><a href="#3-2-1-键盘修饰符" class="headerlink" title="3.2.1  键盘修饰符"></a>3.2.1  键盘修饰符</h3><p><a href="https://cn.vuejs.org/v2/guide/events.html#%E6%8C%89%E9%94%AE%E4%BF%AE%E9%A5%B0%E7%AC%A6" target="_blank" rel="noopener">https://cn.vuejs.org/v2/guide/events.html#%E6%8C%89%E9%94%AE%E4%BF%AE%E9%A5%B0%E7%AC%A6</a></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;input type=<span class="string">"text"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"form-control"</span> v-model=<span class="string">"name"</span> @keyup.enter=<span class="string">"add"</span>&gt;</span><br></pre></td></tr></table></figure><h3 id="3-3-2-自定义键盘修饰符"><a href="#3-3-2-自定义键盘修饰符" class="headerlink" title="3.3.2 自定义键盘修饰符"></a>3.3.2 自定义键盘修饰符</h3><ol><li>通过<code>Vue.config.keyCodes.名称 = 按键值</code>来自定义案件修饰符的别名：</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//约定113对应f2</span></span><br><span class="line">Vue.config.keyCodes.f2 = <span class="number">113</span>;</span><br></pre></td></tr></table></figure><ol start="2"><li>使用自定义的按键修饰符：</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;input type=<span class="string">"text"</span> v-model=<span class="string">"name"</span> @keyup.f2=<span class="string">"add"</span>&gt;</span><br></pre></td></tr></table></figure><h2 id="3-3-自定义指令"><a href="#3-3-自定义指令" class="headerlink" title="3.3 自定义指令"></a>3.3 自定义指令</h2><p><a href="https://cn.vuejs.org/v2/guide/custom-directive.html" target="_blank" rel="noopener">https://cn.vuejs.org/v2/guide/custom-directive.html</a></p><h3 id="3-3-1-自定义全局指令"><a href="#3-3-1-自定义全局指令" class="headerlink" title="3.3.1 自定义全局指令"></a>3.3.1 自定义全局指令</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 自定义全局指令 v-focus，为绑定的元素自动获取焦点：</span></span><br><span class="line"><span class="comment">// 其中：参数1 ： 指令的名称，注意，在定义的时候，指令的名称前面，不需要加 v- 前缀, 但是： 在调用的时候，必须 在指令名称前 加上 v- 前缀来进行调用</span></span><br><span class="line"><span class="comment">//           参数2： 是一个对象，这个对象身上，有一些指令相关的函数，这些函数可以在特定的阶段，执行相关的操作</span></span><br><span class="line">Vue.directive(<span class="string">'focus'</span>, &#123;</span><br><span class="line">    bind: <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123; </span><br><span class="line">        <span class="comment">// 每当指令绑定到元素上的时候，会立即执行这个bind 函数，只执行一次</span></span><br><span class="line">        <span class="comment">// 注意： 在每个函数中，第一个参数永远是el，表示被绑定了指令的那个元素，这个el参数，是一个原生的JS对象</span></span><br><span class="line">        <span class="comment">// 在元素刚绑定了指令的时候还没有插入到DOM中去的时候调用focus方法没有作用。因为，一个元素只有插入DOM之后才能获取焦点</span></span><br><span class="line">        <span class="comment">// el.focus()</span></span><br><span class="line">    &#125;,</span><br><span class="line">    inserted: <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;  </span><br><span class="line">        <span class="comment">// inserted 表示元素 插入到DOM中的时候，会执行 inserted 函数【触发1次】。和JS行为有关的操作，最好在 inserted 中去执行，放置 JS行为不生效</span></span><br><span class="line">        el.focus()</span><br><span class="line">    &#125;,</span><br><span class="line">    updated: <span class="function"><span class="keyword">function</span> (<span class="params">el</span>) </span>&#123;  </span><br><span class="line">        <span class="comment">// 当VNode更新的时候，会执行 updated， 可能会触发多次</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="3-3-2-自定义局部指令"><a href="#3-3-2-自定义局部指令" class="headerlink" title="3.3.2 自定义局部指令"></a>3.3.2 自定义局部指令</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 自定义局部指令 v-color 和 v-font-weight，为绑定的元素设置指定的字体颜色 和 字体粗细：</span></span><br><span class="line">directives: &#123; </span><br><span class="line">    <span class="comment">// 自定义私有指令</span></span><br><span class="line">    <span class="string">'fontweight'</span>: &#123; </span><br><span class="line">        <span class="comment">// 设置字体粗细的</span></span><br><span class="line">        bind: <span class="function"><span class="keyword">function</span> (<span class="params">el, binding</span>) </span>&#123;</span><br><span class="line">            el.style.fontWeight = binding.value</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">   <span class="string">'fontsize'</span>: <span class="function"><span class="keyword">function</span> (<span class="params">el, binding</span>) </span>&#123; </span><br><span class="line">        <span class="comment">// 注意：这个 function 等同于把代码写到了 bind 和 update 中去</span></span><br><span class="line">        el.style.fontSize = <span class="built_in">parseInt</span>(binding.value) + <span class="string">'px'</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-3-3-使用自定义指令"><a href="#3-3-3-使用自定义指令" class="headerlink" title="3.3.3 使用自定义指令"></a>3.3.3 使用自定义指令</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;h3 v-color=<span class="string">"'pink'"</span> v-fontweight=<span class="string">"900"</span> v-fontsize=<span class="string">"50"</span>&gt;这是h3标题&lt;<span class="regexp">/h3&gt;</span></span><br></pre></td></tr></table></figure><h2 id="3-4-品牌管理案例重写"><a href="#3-4-品牌管理案例重写" class="headerlink" title="3.4 品牌管理案例重写"></a>3.4 品牌管理案例重写</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"./lib/bootstrap-3.3.7.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel panel-primary"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-heading"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h3</span> <span class="attr">class</span>=<span class="string">"panel-title"</span>&gt;</span>添加品牌<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"panel-body form-inline"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">          Id:</span><br><span class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">v-model</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">          Name:</span><br><span class="line">   <span class="comment">&lt;!-- 使用自定义键盘修饰符 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">v-model</span>=<span class="string">"name"</span> @<span class="attr">keyup.f2</span>=<span class="string">"add"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 在Vue中，使用事件绑定机制，为元素指定处理函数的时候，如果加了小括号，就可以给函数传参了 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"添加"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> @<span class="attr">click</span>=<span class="string">"add()"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">          搜索名称关键字：</span><br><span class="line">          <span class="comment">&lt;!-- 注意： Vue中所有的指令，在调用的时候，都以 v- 开头</span></span><br><span class="line"><span class="comment">                 v-focus v-color自动获取焦点和设置文本颜色为绿色 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">v-model</span>=<span class="string">"keywords"</span> <span class="attr">id</span>=<span class="string">"search"</span> <span class="attr">v-focus</span> <span class="attr">v-color</span>=<span class="string">"'green'"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">table</span> <span class="attr">class</span>=<span class="string">"table table-bordered table-hover table-striped"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">thead</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">th</span>&gt;</span>Id<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">th</span>&gt;</span>Name<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">th</span>&gt;</span>Ctime<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">th</span>&gt;</span>Operation<span class="tag">&lt;/<span class="name">th</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">thead</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">tbody</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tr</span> <span class="attr">v-for</span>=<span class="string">"item in search(keywords)"</span> <span class="attr">:key</span>=<span class="string">"item.id"</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; item.id &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span> <span class="attr">v-text</span>=<span class="string">"item.name"</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- 过滤器调用时候的格式    &#123;&#123; name | 过滤器的名称 &#125;&#125; --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span>&#123;&#123; item.ctime | dateFormat() &#125;&#125;<span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">td</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span> @<span class="attr">click.prevent</span>=<span class="string">"del(item.id)"</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">td</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">tbody</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app2"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span> <span class="attr">v-color</span>=<span class="string">"'pink'"</span> <span class="attr">v-fontweight</span>=<span class="string">"900"</span> <span class="attr">v-fontsize</span>=<span class="string">"50"</span>&gt;</span>&#123;&#123; dt | dateFormat &#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 全局的过滤器， 进行时间的格式化</span></span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 所谓的全局过滤器，就是所有的VM实例都共享的</span></span></span><br><span class="line"><span class="actionscript">    Vue.filter(<span class="string">'dateFormat'</span>, <span class="function"><span class="keyword">function</span> <span class="params">(dateStr, pattern = <span class="string">""</span>)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">      <span class="comment">// 根据给定的时间字符串，得到特定的时间</span></span></span><br><span class="line"><span class="javascript">      <span class="keyword">var</span> dt = <span class="keyword">new</span> <span class="built_in">Date</span>(dateStr)</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">      <span class="comment">//   yyyy-mm-dd</span></span></span><br><span class="line"><span class="actionscript">      <span class="keyword">var</span> y = dt.getFullYear()</span></span><br><span class="line"><span class="actionscript">      <span class="keyword">var</span> m = dt.getMonth() + <span class="number">1</span></span></span><br><span class="line"><span class="actionscript">      <span class="keyword">var</span> d = dt.getDate()</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">      <span class="keyword">if</span> (pattern.toLowerCase() === <span class="string">'yyyy-mm-dd'</span>) &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;y&#125;</span>-<span class="subst">$&#123;m&#125;</span>-<span class="subst">$&#123;d&#125;</span>`</span></span></span><br><span class="line"><span class="actionscript">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> hh = dt.getHours()</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> mm = dt.getMinutes()</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> ss = dt.getSeconds()</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">        <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;y&#125;</span>-<span class="subst">$&#123;m&#125;</span>-<span class="subst">$&#123;d&#125;</span> <span class="subst">$&#123;hh&#125;</span>:<span class="subst">$&#123;mm&#125;</span>:<span class="subst">$&#123;ss&#125;</span>`</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 自定义全局按键修饰符</span></span></span><br><span class="line">    Vue.config.keyCodes.f2 = 113</span><br><span class="line"><span class="actionscript">    <span class="comment">// 压缩版的vue.js如果要开启Vue的devtools的需要设置下面代码</span></span></span><br><span class="line"><span class="actionscript">Vue.config.devtools = <span class="literal">true</span></span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// Vue.directive()定义全局的指令  v-focus</span></span></span><br><span class="line"><span class="actionscript">    Vue.directive(<span class="string">'focus'</span>, &#123;</span></span><br><span class="line"><span class="actionscript">      bind: <span class="function"><span class="keyword">function</span> <span class="params">(el)</span> </span>&#123; </span></span><br><span class="line">      &#125;,</span><br><span class="line"><span class="actionscript">      inserted: <span class="function"><span class="keyword">function</span> <span class="params">(el)</span> </span>&#123;  </span></span><br><span class="line">        el.focus()</span><br><span class="line">      &#125;,</span><br><span class="line"><span class="actionscript">      updated: <span class="function"><span class="keyword">function</span> <span class="params">(el)</span> </span>&#123;  </span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 自定义一个设置字体颜色的指令</span></span></span><br><span class="line"><span class="actionscript">    Vue.directive(<span class="string">'color'</span>, &#123;</span></span><br><span class="line"><span class="actionscript">      <span class="comment">// 样式:只要通过指令绑定给了元素，不管这个元素有没有被插入到页面中去，这个元素肯定有了一个内联的样式</span></span></span><br><span class="line"><span class="actionscript">      <span class="comment">// 将来元素肯定会显示到页面中，这时候浏览器的渲染引擎必然会解析样式，应用给这个元素</span></span></span><br><span class="line"><span class="actionscript">      bind: <span class="function"><span class="keyword">function</span> <span class="params">(el, binding)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// el.style.color = 'red'</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">// console.log(binding.name)</span></span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="comment">// console.log(binding.value)</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">// console.log(binding.expression)</span></span></span><br><span class="line"></span><br><span class="line"><span class="actionscript"><span class="comment">// 和样式相关的操作，一般都可以在 bind 执行</span></span></span><br><span class="line">        el.style.color = binding.value</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line"><span class="actionscript">        id: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">        name: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">        keywords: <span class="string">''</span>, <span class="comment">// 搜索的关键字</span></span></span><br><span class="line">        list: [</span><br><span class="line"><span class="javascript">          &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">name</span>: <span class="string">'奔驰'</span>, <span class="attr">ctime</span>: <span class="keyword">new</span> <span class="built_in">Date</span>() &#125;,</span></span><br><span class="line"><span class="javascript">          &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">name</span>: <span class="string">'宝马'</span>, <span class="attr">ctime</span>: <span class="keyword">new</span> <span class="built_in">Date</span>() &#125;</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line"><span class="actionscript">        add() &#123; <span class="comment">// 添加的方法</span></span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> car = &#123; <span class="attr">id</span>: <span class="keyword">this</span>.id, <span class="attr">name</span>: <span class="keyword">this</span>.name, <span class="attr">ctime</span>: <span class="keyword">new</span> <span class="built_in">Date</span>() &#125;</span></span><br><span class="line"><span class="actionscript">          <span class="keyword">this</span>.list.push(car)</span></span><br><span class="line"><span class="actionscript">          <span class="keyword">this</span>.id = <span class="keyword">this</span>.name = <span class="string">''</span></span></span><br><span class="line">        &#125;,</span><br><span class="line"><span class="actionscript">        del(id) &#123; <span class="comment">// 根据Id删除数据</span></span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> index = <span class="keyword">this</span>.list.findIndex(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></span><br><span class="line">            if (item.id == id) &#123;</span><br><span class="line"><span class="actionscript">              <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;)</span><br><span class="line"><span class="actionscript">          <span class="keyword">this</span>.list.splice(index, <span class="number">1</span>)</span></span><br><span class="line">        &#125;,</span><br><span class="line"><span class="actionscript">        search(keywords) &#123; <span class="comment">// 根据关键字，进行数据的搜索</span></span></span><br><span class="line"><span class="javascript">          <span class="keyword">return</span> <span class="keyword">this</span>.list.filter(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span></span><br><span class="line">            if (item.name.includes(keywords)) &#123;</span><br><span class="line"><span class="actionscript">              <span class="keyword">return</span> item</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 如何自定义一个私有的过滤器（局部）</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm2 = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app2'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line"><span class="javascript">        dt: <span class="keyword">new</span> <span class="built_in">Date</span>()</span></span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;&#125;,</span><br><span class="line">      filters: &#123; </span><br><span class="line"><span class="actionscript">        <span class="comment">// 过滤器调用的时候，采用的是就近原则，如果私有过滤器和全局过滤器名称一致了，这时候优先调用私有过滤器</span></span></span><br><span class="line"><span class="actionscript">        dateFormat: <span class="function"><span class="keyword">function</span> <span class="params">(dateStr, pattern = <span class="string">''</span>)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">          <span class="comment">// 根据给定的时间字符串，得到特定的时间</span></span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> dt = <span class="keyword">new</span> <span class="built_in">Date</span>(dateStr)</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">          <span class="keyword">var</span> y = dt.getFullYear()</span></span><br><span class="line"><span class="actionscript">          <span class="keyword">var</span> m = (dt.getMonth() + <span class="number">1</span>).toString().padStart(<span class="number">2</span>, <span class="string">'0'</span>)</span></span><br><span class="line"><span class="actionscript">          <span class="keyword">var</span> d = dt.getDate().toString().padStart(<span class="number">2</span>, <span class="string">'0'</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">          <span class="keyword">if</span> (pattern.toLowerCase() === <span class="string">'yyyy-mm-dd'</span>) &#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;y&#125;</span>-<span class="subst">$&#123;m&#125;</span>-<span class="subst">$&#123;d&#125;</span>`</span></span></span><br><span class="line"><span class="actionscript">          &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">var</span> hh = dt.getHours().toString().padStart(<span class="number">2</span>, <span class="string">'0'</span>)</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">var</span> mm = dt.getMinutes().toString().padStart(<span class="number">2</span>, <span class="string">'0'</span>)</span></span><br><span class="line"><span class="actionscript">            <span class="keyword">var</span> ss = dt.getSeconds().toString().padStart(<span class="number">2</span>, <span class="string">'0'</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="javascript">            <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;y&#125;</span>-<span class="subst">$&#123;m&#125;</span>-<span class="subst">$&#123;d&#125;</span> <span class="subst">$&#123;hh&#125;</span>:<span class="subst">$&#123;mm&#125;</span>:<span class="subst">$&#123;ss&#125;</span> ~~~~~~~`</span></span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      directives: &#123; </span><br><span class="line"><span class="actionscript">     <span class="comment">// 自定义私有指令</span></span></span><br><span class="line"><span class="actionscript">        <span class="string">'fontweight'</span>: &#123; </span></span><br><span class="line"><span class="actionscript">  <span class="comment">// 设置字体粗细的</span></span></span><br><span class="line"><span class="actionscript">          bind: <span class="function"><span class="keyword">function</span> <span class="params">(el, binding)</span> </span>&#123;</span></span><br><span class="line">            el.style.fontWeight = binding.value</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line"><span class="actionscript">        <span class="string">'fontsize'</span>: <span class="function"><span class="keyword">function</span> <span class="params">(el, binding)</span> </span>&#123; </span></span><br><span class="line"><span class="actionscript">  <span class="comment">// 注意：这个 function 等同于把代码写到了 bind 和 update 中去</span></span></span><br><span class="line"><span class="javascript">          el.style.fontSize = <span class="built_in">parseInt</span>(binding.value) + <span class="string">'px'</span></span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="4-Vue的生命周期"><a href="#4-Vue的生命周期" class="headerlink" title="4 Vue的生命周期"></a>4 Vue的生命周期</h1><h2 id="4-1-生命周期函数"><a href="#4-1-生命周期函数" class="headerlink" title="4.1 生命周期函数"></a>4.1 生命周期函数</h2><p><a href="https://cn.vuejs.org/v2/guide/instance.html" target="_blank" rel="noopener">https://cn.vuejs.org/v2/guide/instance.html</a></p><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn4J3Krp/uUnjQtxoKSmXQ5.YSnl4gLddGCBvD7vbUKsTdDBghrhST8*VK4q3..ZjHUlA6dc9h3HlCySdT9L8naN0dF5hEg!!/b&bo=9AHyBPQB8gQDCSw!&rf=viewer_4"  alt="lifecycle"></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"ie=edge"</span>&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">    &lt;script src="./</span>lib/vue<span class="number">-2.4</span><span class="number">.0</span>.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">&lt;div id="</span>app<span class="string">"&gt;</span></span><br><span class="line"><span class="string">    &lt;input type="</span>button<span class="string">" value="</span>修改msg<span class="string">" @click="</span>msg=<span class="string">'No'</span><span class="string">"&gt;</span></span><br><span class="line"><span class="string">    &lt;h3 id="</span>h3<span class="string">"&gt;&#123;&#123; msg &#125;&#125;&lt;/h3&gt;</span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;template id="</span>demo1<span class="string">"&gt;</span></span><br><span class="line"><span class="string">    &lt;h2&gt;标签模版&lt;/h2&gt;</span></span><br><span class="line"><span class="string">&lt;/template&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">    // 创建 Vue 实例，得到 ViewModel</span></span><br><span class="line"><span class="string">    var vm = new Vue(&#123;</span></span><br><span class="line"><span class="string">        el: '#app',</span></span><br><span class="line"><span class="string">        //如果没有写template，则会将el的外部html作为模板进行编译</span></span><br><span class="line">        /*template:"#demo1",*/</span><br><span class="line">        data: &#123;</span><br><span class="line">            msg: <span class="string">'ok'</span></span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line">            show() &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">'执行了show方法'</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        beforeCreate() &#123;</span><br><span class="line">            <span class="comment">// 这是我们遇到的第一个生命周期函数，表示实例完全被创建出来之前会执行它</span></span><br><span class="line">            <span class="comment">// console.log(this.msg)</span></span><br><span class="line">            <span class="comment">// this.show()</span></span><br><span class="line">            <span class="comment">// 注意： 在 beforeCreate 生命周期函数执行的时候，data 和 methods 中的数据都还没有没初始化</span></span><br><span class="line">        &#125;,</span><br><span class="line">        created() &#123;</span><br><span class="line">            <span class="comment">// 这是遇到的第二个生命周期函数</span></span><br><span class="line">            <span class="comment">// console.log(this.msg)</span></span><br><span class="line">            <span class="comment">// this.show()</span></span><br><span class="line">            <span class="comment">//  在 created 中，data 和 methods 都已经被初始化好了！</span></span><br><span class="line">            <span class="comment">// 如果要调用 methods 中的方法，或者操作 data 中的数据，最早只能在 created 中操作</span></span><br><span class="line">        &#125;,</span><br><span class="line">        beforeMount() &#123;</span><br><span class="line">            <span class="comment">// 这是遇到的第3个生命周期函数，表示模板已经在内存中编辑完成了，但是尚未把模板渲染到页面中</span></span><br><span class="line">            <span class="comment">// console.log(document.getElementById('h3').innerText)</span></span><br><span class="line">            <span class="comment">// 在 beforeMount 执行的时候，页面中的元素还没有被真正替换过来，只是之前写的一些模板字符串</span></span><br><span class="line">        &#125;,</span><br><span class="line">        mounted() &#123;</span><br><span class="line">            <span class="comment">// 这是遇到的第4个生命周期函数，表示内存中的模板已经真实的挂载到了页面中，用户已经可以看到渲染好的页面了</span></span><br><span class="line">            <span class="comment">// console.log(document.getElementById('h3').innerText)</span></span><br><span class="line">            <span class="comment">// 注意： mounted是实例创建期间的最后一个生命周期函数，当执行完mounted就表示Vue实例已经被完全创建好了，此时如果没有其它操作的话，这个实例就静静的躺在我们的内存中一动不动</span></span><br><span class="line">        &#125;,</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 接下来的是运行中的两个事件</span></span><br><span class="line">        beforeUpdate() &#123;</span><br><span class="line">            <span class="comment">// 这时候表示数据更新了但是界面还没有被更新</span></span><br><span class="line">            <span class="comment">/* console.log('界面上元素的内容：' + document.getElementById('h3').innerText)</span></span><br><span class="line"><span class="comment">             console.log('data 中的 msg 数据是：' + this.msg) */</span></span><br><span class="line">            <span class="comment">// 得出结论： 当执行 beforeUpdate 的时候，页面中的显示的数据还是旧的，此时 data 数据是最新的，页面尚未和最新的数据保持同步</span></span><br><span class="line">        &#125;,</span><br><span class="line">        updated() &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'界面上元素的内容：'</span> + <span class="built_in">document</span>.getElementById(<span class="string">'h3'</span>).innerText)</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'data 中的 msg 数据是：'</span> + <span class="keyword">this</span>.msg)</span><br><span class="line">            <span class="comment">// updated 事件执行的时候，页面和 data 数据已经保持同步了，都是最新的</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//如果在创建vm实例的时候没有挂载el，可以通过代码手动挂载</span></span><br><span class="line">    vm.$mount(<span class="string">"#app"</span>);</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>body&gt;</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/html&gt;</span></span><br></pre></td></tr></table></figure><h2 id="4-2-Vue-nextTick"><a href="#4-2-Vue-nextTick" class="headerlink" title="4.2 Vue.nextTick()"></a>4.2 Vue.nextTick()</h2><h3 id="4-2-1-nextTick介绍"><a href="#4-2-1-nextTick介绍" class="headerlink" title="4.2.1 nextTick介绍"></a>4.2.1 nextTick介绍</h3><p>该方法会在下次 DOM 更新循环结束之后执行延迟回调。在修改数据之后立即使用这个方法，获取更新后的 DOM。</p><p>应用场景：</p><blockquote><ul><li>在Vue生命周期的<code>created()</code>钩子函数进行的DOM操作一定要放在<code>Vue.nextTick()</code>的回调函数中</li><li>在数据变化后要执行的某个操作，而这个操作需要使用随数据改变而改变的DOM结构的时候，这个操作都应该放进<code>Vue.nextTick()</code>的回调函数中。</li></ul></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">created() &#123;</span><br><span class="line">     <span class="comment">//改变数据</span></span><br><span class="line">    vm.message = <span class="string">'changed'</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//想要立即使用更新后的DOM。这样不行，因为设置message后DOM还没有更新</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">document</span>.getElementById(<span class="string">'testCount'</span>).innerHTML) <span class="comment">// 并不会得到'changed'</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//这样可以，nextTick里面的代码会在DOM更新后执行</span></span><br><span class="line">    Vue.nextTick(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">document</span>.getElementById(<span class="string">'testCount'</span>).innerHTML) <span class="comment">//可以得到'changed'</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h3 id="4-2-2-nextTick-原理"><a href="#4-2-2-nextTick-原理" class="headerlink" title="4.2.2 nextTick()原理"></a>4.2.2 nextTick()原理</h3><h4 id="a-异步说明"><a href="#a-异步说明" class="headerlink" title="a) 异步说明"></a>a) 异步说明</h4><blockquote><p>Vue 实现响应式并<strong>不是数据发生变化之后 DOM 立即变化</strong>，而是按一定的策略进行 DOM 的更新。</p></blockquote><p>在 Vue 的<a href="https://cn.vuejs.org/v2/guide/reactivity.html#%E5%BC%82%E6%AD%A5%E6%9B%B4%E6%96%B0%E9%98%9F%E5%88%97" target="_blank" rel="noopener">文档</a>中，说明 Vue 是异步执行 DOM 更新的。关于异步的解析，可以查看阮一峰老师的<a href="http://www.ruanyifeng.com/blog/2014/10/event-loop.html" target="_blank" rel="noopener">这篇文章，</a>截取关键部分如下：</p><p>具体来说，异步执行的运行机制如下。</p><blockquote><p>（1）所有同步任务都在主线程上执行，形成一个执行栈（execution context stack）。<br>（2）主线程之外，还存在一个”任务队列”（task queue）。只要异步任务有了运行结果，就在”任务队列”之中放置一个事件。<br>（3）一旦”执行栈”中的所有同步任务执行完毕，系统就会读取”任务队列”，看看里面有哪些事件。那些对应的异步任务，于是结束等待状态，进入执行栈，开始执行。<br>（4）主线程不断重复上面的第三步。</p></blockquote><p>下图就是主线程和任务队列的示意图。</p><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn4J3Krp/uUnjQtxoKSmXQ5.YSnl4gMS4uttU9GjyPyaQjh1n6V1um92*hCEP*0wAyGhXWQ4D*RVabNWTueL.KrUUlG4ieg!!/b&bo=RQKkAUUCpAEDCSw!&rf=viewer_4"  alt="clipboard.png"></p><h4 id="b-事件循环说明"><a href="#b-事件循环说明" class="headerlink" title="b) 事件循环说明"></a>b) 事件循环说明</h4><p>简单来说，Vue 在修改数据后，视图不会立刻更新，而是等同一事件循环中的所有数据变化完成之后，再统一进行视图更新。图解：</p><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn4J3Krp/43eWRH6lLSncPe1pJhVzbRx4gJnuJfC.TYgDWevUKXjuHUabbBafX0wvdfIy.3ian26pmWpaCLnS8fKdY5fhJF58O2CD.ta899mLKtJg0.k!/b&bo=pwEAAqcBAAIDGTw!&rf=viewer_4"  alt="clipboard.png"></p><h2 id="4-3-nextTick-案例"><a href="#4-3-nextTick-案例" class="headerlink" title="4.3 nextTick()案例"></a>4.3 nextTick()案例</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//点击按钮显示文本输入框，同时让其获取焦点</span></span><br><span class="line">methods:&#123;</span><br><span class="line">   showsou()&#123;</span><br><span class="line">      <span class="keyword">this</span>.showit = <span class="literal">true</span></span><br><span class="line">      <span class="keyword">this</span>.$nextTick(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// DOM 更新了</span></span><br><span class="line">        <span class="built_in">document</span>.getElementById(<span class="string">"keywords"</span>).focus()</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="5-axios使用"><a href="#5-axios使用" class="headerlink" title="5 axios使用"></a>5 axios使用</h1><p>在vue中，我们可以使用vue-resource去发送请求，也可以使用axios来发送请求<br>Axios 是一个基于 promise 的 HTTP 库，可以用在浏览器和 node.js 中。<br>Axios的特点：<br>•    从浏览器中创建XMLHttpRequests<br>•    从 node.js 创建http请求<br>•    支持PromiseAPI<br>•    拦截请求和响应<br>•    转换请求数据和响应数据<br>•    取消请求<br>•    自动转换 JSON 数据</p><h2 id="5-1-GER-POST"><a href="#5-1-GER-POST" class="headerlink" title="5.1 GER/POST"></a>5.1 GER/POST</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"># 这边测试服务器使用品牌列表的服务器</span><br><span class="line"></span><br><span class="line"><span class="comment">//全局配置axios</span></span><br><span class="line">axios.defaults.baseURL = <span class="string">'http://localhost:3000/'</span>;</span><br><span class="line">axios.defaults.headers.post[<span class="string">'Content-Type'</span>] = <span class="string">'application/x-www-form-urlencoded'</span>;</span><br><span class="line">axios.defaults.withCredentials = <span class="literal">true</span>; </span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el:<span class="string">"#app"</span>,</span><br><span class="line">    data:&#123;</span><br><span class="line"></span><br><span class="line">    &#125;,</span><br><span class="line">    methods:&#123;</span><br><span class="line">        testGet()&#123;</span><br><span class="line">            axios.get(<span class="string">'api/getnewslist'</span>,&#123;</span><br><span class="line">                params:&#123;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">                .then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(response.data);</span><br><span class="line">            &#125;)</span><br><span class="line">                .catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(error);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;,</span><br><span class="line">        testPost()&#123;</span><br><span class="line">            axios.post(<span class="string">'api/news/new'</span>, &#123;</span><br><span class="line">                name: <span class="string">'李宁'</span>,</span><br><span class="line">                id: <span class="string">'1001'</span></span><br><span class="line">            &#125;)</span><br><span class="line">                .then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(response.data);</span><br><span class="line">            &#125;)</span><br><span class="line">                .catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(error);</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="5-2-品牌列表案例重写"><a href="#5-2-品牌列表案例重写" class="headerlink" title="5.2 品牌列表案例重写"></a>5.2 品牌列表案例重写</h2><p>服务器代码参照资料中code—&gt;brand-list—&gt;server</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"ie=edge"</span>&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    &lt;link rel="stylesheet" href="./</span>bootstrap<span class="number">-3.3</span><span class="number">.7</span>.css<span class="string">"&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &lt;script src="</span>./axios.min.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">    &lt;script src="</span>./vue<span class="number">-2.4</span><span class="number">.0</span>.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">    &lt;div id="</span>app<span class="string">"&gt;</span></span><br><span class="line"><span class="string">        &lt;div class="</span>panel panel-primary<span class="string">"&gt;</span></span><br><span class="line"><span class="string">            &lt;div class="</span>panel-heading<span class="string">"&gt;</span></span><br><span class="line"><span class="string">                &lt;h3 class="</span>panel-title<span class="string">"&gt;添加品牌&lt;/h3&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">            &lt;div class="</span>panel-body form-inline<span class="string">"&gt;</span></span><br><span class="line"><span class="string">                &lt;label&gt;</span></span><br><span class="line"><span class="string">                    &lt;!-- ref属性作用：在vue中可以根据this.$refs.ref_value 来获取页面元素 --&gt;</span></span><br><span class="line"><span class="string">                    Id:&lt;input type="</span>text<span class="string">" class="</span>form-control<span class="string">" v-model="</span>id<span class="string">" v-focus ref="</span>idInput<span class="string">"&gt;</span></span><br><span class="line"><span class="string">                &lt;/label&gt;</span></span><br><span class="line"><span class="string">            </span></span><br><span class="line"><span class="string">                &lt;label&gt;</span></span><br><span class="line"><span class="string">                    Name:&lt;input type="</span>text<span class="string">" class="</span>form-control<span class="string">" v-model="</span>name<span class="string">" @keydown.enter="</span>add<span class="string">"&gt;</span></span><br><span class="line"><span class="string">                &lt;/label&gt;</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">                &lt;label&gt;</span></span><br><span class="line"><span class="string">                    搜索名称关键字：&lt;input type="</span>text<span class="string">" class="</span>form-control<span class="string">" v-font_size="</span><span class="number">30</span><span class="string">" v-model="</span>keywords<span class="string">"&gt;</span></span><br><span class="line"><span class="string">                &lt;/label&gt;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        &lt;table class="</span>table table-bordered table-hover table-striped<span class="string">"&gt;</span></span><br><span class="line"><span class="string">            &lt;thead&gt;</span></span><br><span class="line"><span class="string">                &lt;tr&gt;</span></span><br><span class="line"><span class="string">                    &lt;th&gt;Id&lt;/th&gt;</span></span><br><span class="line"><span class="string">                    &lt;th&gt;Name&lt;/th&gt;</span></span><br><span class="line"><span class="string">                    &lt;th&gt;Ctime&lt;/th&gt;</span></span><br><span class="line"><span class="string">                    &lt;th&gt;Operation&lt;/th&gt;</span></span><br><span class="line"><span class="string">                &lt;/tr&gt;</span></span><br><span class="line"><span class="string">            &lt;/thead&gt;</span></span><br><span class="line"><span class="string">            &lt;tbody&gt;</span></span><br><span class="line"><span class="string">                &lt;!-- search()是根据keywords搜索内容来过滤数据源的  --&gt;</span></span><br><span class="line"><span class="string">                &lt;tr v-for="</span>item <span class="keyword">in</span> search()<span class="string">" :key="</span>item.id<span class="string">"&gt;</span></span><br><span class="line"><span class="string">                    &lt;td&gt;&#123;&#123;item.id&#125;&#125;&lt;/td&gt;</span></span><br><span class="line"><span class="string">                    &lt;td&gt;&#123;&#123;item.name&#125;&#125;&lt;/td&gt;</span></span><br><span class="line"><span class="string">                    &lt;td&gt;&#123;&#123;item.ctime|dateFormatter('yyyy-MM-dd')&#125;&#125;&lt;/td&gt;</span></span><br><span class="line"><span class="string">                    &lt;td&gt;&lt;input type="</span>button<span class="string">" value="</span>删除<span class="string">" @click="</span>del(item.id)<span class="string">"&gt;&lt;/td&gt;</span></span><br><span class="line"><span class="string">                &lt;/tr&gt;</span></span><br><span class="line"><span class="string">            &lt;/tbody&gt;</span></span><br><span class="line"><span class="string">        &lt;/table&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt; </span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">    axios.defaults.baseURL = 'http://localhost:3000/';</span></span><br><span class="line"><span class="string">    axios.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded';</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    var vm = new Vue(&#123;</span></span><br><span class="line">        el:"#app",</span><br><span class="line">        data:&#123;</span><br><span class="line">            id:<span class="string">""</span>,</span><br><span class="line">            name:<span class="string">""</span>,</span><br><span class="line">            keywords:<span class="string">""</span>,</span><br><span class="line">            list:[</span><br><span class="line">                &#123;<span class="attr">id</span>:<span class="number">1</span>,<span class="attr">name</span>:<span class="string">"张三"</span>,<span class="attr">ctime</span>:<span class="keyword">new</span> <span class="built_in">Date</span>()&#125;,</span><br><span class="line">                &#123;<span class="attr">id</span>:<span class="number">2</span>,<span class="attr">name</span>:<span class="string">"李四"</span>,<span class="attr">ctime</span>:<span class="keyword">new</span> <span class="built_in">Date</span>()&#125;,</span><br><span class="line">                &#123;<span class="attr">id</span>:<span class="number">3</span>,<span class="attr">name</span>:<span class="string">"王五"</span>,<span class="attr">ctime</span>:<span class="keyword">new</span> <span class="built_in">Date</span>()&#125;,</span><br><span class="line">                &#123;<span class="attr">id</span>:<span class="number">4</span>,<span class="attr">name</span>:<span class="string">"赵六"</span>,<span class="attr">ctime</span>:<span class="keyword">new</span> <span class="built_in">Date</span>()&#125;,</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//在vue实例创建完毕之后发送请求获取数据</span></span><br><span class="line">        created()&#123;</span><br><span class="line">            <span class="keyword">this</span>.getBrandList();</span><br><span class="line">        &#125;,</span><br><span class="line">        methods:&#123;</span><br><span class="line">            <span class="comment">//获取品牌列表的</span></span><br><span class="line">            getBrandList()&#123;</span><br><span class="line">                axios.get(<span class="string">"api/getnewslist"</span>)</span><br><span class="line">                .then(<span class="function">(<span class="params">&#123;data&#125;</span>)=&gt;</span>&#123;</span><br><span class="line">                    <span class="keyword">if</span>(data.status == <span class="number">0</span>)&#123;</span><br><span class="line">                        <span class="keyword">this</span>.list = data.message;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="keyword">this</span>.list = [];</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">                .catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(error);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">            ,</span><br><span class="line">            add()&#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="keyword">this</span>.id &amp;&amp; <span class="keyword">this</span>.name)&#123;</span><br><span class="line">                    axios.post(<span class="string">'api/news/new'</span>, &#123;</span><br><span class="line">                        name: <span class="keyword">this</span>.name</span><br><span class="line">                    &#125;)</span><br><span class="line">                    .then(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">                        <span class="comment">//当添加用户成功之后重新去请求服务器</span></span><br><span class="line">                        <span class="keyword">this</span>.getBrandList();</span><br><span class="line">                    &#125;)</span><br><span class="line">                    .catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">                        <span class="built_in">console</span>.log(error);</span><br><span class="line">                    &#125;);</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// //当添加数据完毕之后清空用户输入的内容</span></span><br><span class="line">                    <span class="keyword">this</span>.id = <span class="string">""</span>;</span><br><span class="line">                    <span class="keyword">this</span>.name = <span class="string">""</span>;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// //让id文本框获取焦点</span></span><br><span class="line">                    <span class="keyword">this</span>.$refs.idInput.focus();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            del(id)&#123;</span><br><span class="line">                axios.get(<span class="string">"api/news/del/"</span>+id)</span><br><span class="line">                .then(<span class="function">(<span class="params">&#123;data&#125;</span>)=&gt;</span>&#123;</span><br><span class="line">                    <span class="keyword">this</span>.getBrandList();</span><br><span class="line">                &#125;)</span><br><span class="line">                .catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">                    <span class="built_in">console</span>.log(error);</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;,</span><br><span class="line">            search()&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>.list.filter(<span class="function">(<span class="params">item</span>)=&gt;</span>&#123;</span><br><span class="line">                    <span class="keyword">if</span>(item.name.includes(<span class="keyword">this</span>.keywords))&#123;</span><br><span class="line">                        <span class="keyword">return</span> item;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        filters:&#123;</span><br><span class="line">            <span class="comment">//默认值参数</span></span><br><span class="line">            dateFormatter:<span class="function"><span class="keyword">function</span>(<span class="params">msg,pattern=<span class="string">''</span></span>)</span>&#123;</span><br><span class="line">                <span class="comment">//1.将msg时间字符串转换为时间对象</span></span><br><span class="line">                <span class="keyword">var</span> dt = <span class="keyword">new</span> <span class="built_in">Date</span>(msg)</span><br><span class="line">                <span class="comment">//2.获取到年月日时分秒的信息</span></span><br><span class="line">                <span class="keyword">var</span> year = dt.getFullYear();</span><br><span class="line">                <span class="keyword">var</span> month = (dt.getMonth()+<span class="number">1</span>).toString().padStart(<span class="number">2</span>,<span class="string">'0'</span>);</span><br><span class="line">                <span class="keyword">var</span> day = dt.getDate().toString().padStart(<span class="number">2</span>,<span class="string">'0'</span>);</span><br><span class="line">                <span class="keyword">var</span> hour = dt.getHours().toString().padStart(<span class="number">2</span>,<span class="string">'0'</span>);</span><br><span class="line">                <span class="keyword">var</span> minute = dt.getMinutes().toString().padStart(<span class="number">2</span>,<span class="string">'0'</span>);</span><br><span class="line">                <span class="keyword">var</span> second = dt.getSeconds().toString().padStart(<span class="number">2</span>,<span class="string">'0'</span>);</span><br><span class="line">                <span class="comment">//console.log(year,month,day,hour,minute,second)</span></span><br><span class="line">                <span class="comment">//3.根据pattern返回数据</span></span><br><span class="line">                <span class="keyword">if</span>(pattern == <span class="string">'yyyy-MM-dd'</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;year&#125;</span>-<span class="subst">$&#123;month&#125;</span>-<span class="subst">$&#123;day&#125;</span>`</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="string">`<span class="subst">$&#123;year&#125;</span>-<span class="subst">$&#123;month&#125;</span>-<span class="subst">$&#123;day&#125;</span> <span class="subst">$&#123;hour&#125;</span>:<span class="subst">$&#123;minute&#125;</span>:<span class="subst">$&#123;second&#125;</span>`</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//自定义私有指令</span></span><br><span class="line">        directives:&#123;</span><br><span class="line">            focus:&#123;</span><br><span class="line">                inserted(el)&#123;</span><br><span class="line">                    el.focus();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            font_size:&#123;</span><br><span class="line">                inserted(el,binding)&#123;</span><br><span class="line">                    el.style.fontSize = binding.value+<span class="string">"px"</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;/</span>html&gt;</span><br></pre></td></tr></table></figure><h1 id="6-Vue中的动画"><a href="#6-Vue中的动画" class="headerlink" title="6 Vue中的动画"></a>6 Vue中的动画</h1><p><a href="https://cn.vuejs.org/v2/guide/transitions.html" target="_blank" rel="noopener">https://cn.vuejs.org/v2/guide/transitions.html</a></p><p>Vue 在插入、更新或者移除 DOM 时，提供下面的多种不同方式的应用过渡效果。</p><blockquote><ul><li>在 CSS 过渡和动画中自动应用 class —过渡类名</li><li>可以配合使用第三方 CSS 动画库，如 Animate.css</li><li>在过渡钩子函数中使用 JavaScript 直接操作 DOM  </li><li>可以配合使用第三方 JavaScript 动画库，如 Velocity.js</li></ul></blockquote><h2 id="6-1-不使用动画"><a href="#6-1-不使用动画" class="headerlink" title="6.1 不使用动画"></a>6.1 不使用动画</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"toggle"</span> @<span class="attr">click</span>=<span class="string">"flag=!flag"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 需求： 点击按钮，让 h3 显示，再点击，让 h3 隐藏 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span> <span class="attr">v-if</span>=<span class="string">"flag"</span>&gt;</span>这是一个H3<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line"><span class="actionscript">        flag: <span class="literal">false</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="6-2-使用过渡类名"><a href="#6-2-使用过渡类名" class="headerlink" title="6.2 使用过渡类名"></a>6.2 使用过渡类名</h2><p>Vue 提供了内置的过渡封装组件(transition)，该组件用于包裹要实现过渡效果的组件。</p><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn4J3Krp/43eWRH6lLSncPe1pJhVzbd.A1uhyOUn6UQ.bYpWTivJeR*m4*8GJe6fx5en06iL39Bmo9RyJp0qbeJ6nk6JtZxPDyUceubzIgK9eRzLdN*0!/b&bo=WALzAFgC8wADGTw!&rf=viewer_4"  alt="1544748438460"></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">  &lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br><span class="line">  &lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"ie=edge"</span>&gt;</span><br><span class="line">  &lt;title&gt;Document&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">  &lt;script src="./</span>lib/vue<span class="number">-2.4</span><span class="number">.0</span>.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">  &lt;!-- 2. 自定义两组样式，来控制 transition 内部的元素实现动画 --&gt;</span></span><br><span class="line"><span class="string">  &lt;style&gt;</span></span><br><span class="line"><span class="string">h3&#123;</span></span><br><span class="line"><span class="string">background-color:red;</span></span><br><span class="line"><span class="string">width:100px;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">    /*全场动画：使用过渡类名*/</span></span><br><span class="line"><span class="string">    /* v-enter 【这是一个时间点】 是进入之前，元素的起始状态，此时还没有开始进入 */</span></span><br><span class="line"><span class="string">    /* v-leave-to 【这是一个时间点】 是动画离开之后，离开的终止状态，此时元素动画已经结束了 */</span></span><br><span class="line"><span class="string">    .v-enter,</span></span><br><span class="line"><span class="string">    .v-leave-to &#123;</span></span><br><span class="line"><span class="string">      opacity: 0;</span></span><br><span class="line"><span class="string">      transform: translateX(150px);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    /* v-enter-active 【入场动画的时间段】 */</span></span><br><span class="line"><span class="string">    /* v-leave-active 【离场动画的时间段】 */</span></span><br><span class="line"><span class="string">    .v-enter-active&#123;</span></span><br><span class="line"><span class="string">transition: all 1.8s ease;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">    .v-leave-active&#123;</span></span><br><span class="line"><span class="string">      transition: all 0.8s ease;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &lt;/style&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">  &lt;div id="</span>app<span class="string">"&gt;</span></span><br><span class="line"><span class="string">    &lt;input type="</span>button<span class="string">" value="</span>toggle<span class="string">" @click="</span>flag=!flag<span class="string">"&gt;</span></span><br><span class="line"><span class="string">    &lt;!-- 需求： 点击按钮，让 h3 显示，再点击，让 h3 隐藏 --&gt;</span></span><br><span class="line"><span class="string">    &lt;!-- 1. 使用 transition 元素，把 需要被动画控制的元素，包裹起来 --&gt;</span></span><br><span class="line"><span class="string">    &lt;transition&gt;</span></span><br><span class="line"><span class="string">      &lt;h3 v-if="</span>flag<span class="string">"&gt;这是一个H3&lt;/h3&gt;</span></span><br><span class="line"><span class="string">    &lt;/transition&gt;</span></span><br><span class="line"><span class="string">  &lt;/div&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  &lt;script&gt;</span></span><br><span class="line"><span class="string">    // 创建 Vue 实例，得到 ViewModel</span></span><br><span class="line"><span class="string">    var vm = new Vue(&#123;</span></span><br><span class="line"><span class="string">      el: '#app',</span></span><br><span class="line"><span class="string">      data: &#123;</span></span><br><span class="line"><span class="string">        flag: false</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      methods: &#123;&#125;</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">  &lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure><h2 id="6-3-修改动画前缀"><a href="#6-3-修改动画前缀" class="headerlink" title="6.3 修改动画前缀"></a>6.3 修改动画前缀</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 2. 自定义两组样式，来控制 transition 内部的元素实现动画 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.my-enter</span>,</span></span><br><span class="line"><span class="css">    <span class="selector-class">.my-leave-to</span> &#123;</span></span><br><span class="line">      opacity: 0;</span><br><span class="line">      transform: translateY(70px);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.my-enter-active</span>,</span></span><br><span class="line"><span class="css">    <span class="selector-class">.my-leave-active</span>&#123;</span></span><br><span class="line"><span class="css">      <span class="selector-tag">transition</span>: <span class="selector-tag">all</span> 0<span class="selector-class">.8s</span> <span class="selector-tag">ease</span>;</span></span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"toggle2"</span> @<span class="attr">click</span>=<span class="string">"flag2=!flag2"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">"my"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h6</span> <span class="attr">v-if</span>=<span class="string">"flag2"</span>&gt;</span>这是一个H6<span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line"><span class="actionscript">        flag: <span class="literal">false</span>,</span></span><br><span class="line"><span class="actionscript">        flag2: <span class="literal">false</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="6-4-AnimateCSS"><a href="#6-4-AnimateCSS" class="headerlink" title="6.4 AnimateCSS"></a>6.4 AnimateCSS</h2><p>animate.css是一个使用CSS3的animation制作的动画效果的CSS集合，里面预设了很多种常用的动画，且使用非常简单。</p><p><a href="https://daneden.github.io/animate.css/" target="_blank" rel="noopener">https://daneden.github.io/animate.css/</a></p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"./lib/animate.css"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 入场 bounceIn    离场 bounceOut --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"toggle"</span> @<span class="attr">click</span>=<span class="string">"flag=!flag"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 需求： 点击按钮，让 h3 显示，再点击，让 h3 隐藏 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">transition</span> <span class="attr">enter-active-class</span>=<span class="string">"animated bounceIn"</span> <span class="attr">leave-active-class</span>=<span class="string">"animated bounceOut"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h3</span> <span class="attr">v-if</span>=<span class="string">"flag"</span>&gt;</span>这是一个H3<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 使用 :duration="毫秒值" 来统一设置 入场 和 离场 时候的动画时长 </span></span><br><span class="line"><span class="comment">            注意：这边duration时间设置过长无效--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">transition</span> <span class="attr">enter-active-class</span>=<span class="string">"bounceIn"</span> <span class="attr">leave-active-class</span>=<span class="string">"bounceOut"</span> <span class="attr">:duration</span>=<span class="string">"200"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h3</span> <span class="attr">v-if</span>=<span class="string">"flag"</span> <span class="attr">class</span>=<span class="string">"animated"</span>&gt;</span>这是一个H3<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 使用  :duration="&#123; enter: 200, leave: 400 &#125;"  来分别设置 入场的时长 和 离场的时长  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">transition</span> <span class="attr">enter-active-class</span>=<span class="string">"bounceIn"</span> <span class="attr">leave-active-class</span>=<span class="string">"bounceOut"</span> <span class="attr">:duration</span>=<span class="string">"&#123; enter: 200, leave: 400 &#125;"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h3</span> <span class="attr">v-if</span>=<span class="string">"flag"</span> <span class="attr">class</span>=<span class="string">"animated"</span>&gt;</span>这是一个H3<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">transition</span>&gt;</span> </span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line"><span class="actionscript">        flag: <span class="literal">false</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="6-5-动画的钩子函数"><a href="#6-5-动画的钩子函数" class="headerlink" title="6.5 动画的钩子函数"></a>6.5 动画的钩子函数</h2><p>Vue2实现动画的方式可以是css也可以js钩子，大部分情况下css3即可满足，但若是需要在实现动画过程中进行位置计算，那就需要使用js钩子函数来进行</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">        <span class="selector-class">.ball</span> &#123;</span></span><br><span class="line">            width: 15px;</span><br><span class="line">            height: 15px;</span><br><span class="line">            border-radius: 50%;</span><br><span class="line">            background-color: red;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"快到碗里来"</span> @<span class="attr">click</span>=<span class="string">"flag=!flag"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 1. 使用 transition 元素把 小球包裹起来 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">transition</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">before-enter</span>=<span class="string">"beforeEnter"</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">enter</span>=<span class="string">"enter"</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">after-enter</span>=<span class="string">"afterEnter"</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">before-leave</span>=<span class="string">"beforeLeave"</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">leave</span>=<span class="string">"leave"</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">after-leave</span>=<span class="string">"afterLeave"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"ball"</span> <span class="attr">v-show</span>=<span class="string">"flag"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line">        data: &#123;</span><br><span class="line"><span class="actionscript">            flag: <span class="literal">false</span></span></span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line"><span class="actionscript">            <span class="comment">//el，表示 要执行动画的那个DOM元素，是个原生的 JS DOM对象</span></span></span><br><span class="line">            beforeEnter(el)&#123;</span><br><span class="line"><span class="actionscript">                <span class="comment">// beforeEnter 表示动画入场之前，此时，动画尚未开始，可以 在 beforeEnter 中，设置元素开始动画之前的起始样式</span></span></span><br><span class="line"><span class="actionscript">                el.style.transform = <span class="string">"translate(0px, 0px)"</span></span></span><br><span class="line">                el.style.opacity = 0.0</span><br><span class="line">            &#125;,</span><br><span class="line"><span class="actionscript">            <span class="comment">//当只有javascript过渡的时候，在enter和leave中必须使用done进行回调。done的作用其实是调用afterEnter和afterLeave方法</span></span></span><br><span class="line">            enter(el,done)&#123;</span><br><span class="line"><span class="actionscript">                <span class="comment">//el.offsetWidth 会强制动画刷新</span></span></span><br><span class="line">                el.offsetWidth</span><br><span class="line"><span class="actionscript">                <span class="comment">// enter 表示动画 开始之后的样式，在这里可以设置小球完成动画之后的结束状态</span></span></span><br><span class="line"><span class="actionscript">                el.style.transform = <span class="string">"translate(150px, 450px)"</span></span></span><br><span class="line"><span class="actionscript">                el.style.transition = <span class="string">'all 1s ease'</span></span></span><br><span class="line">                el.style.opacity = 1.0</span><br><span class="line"><span class="actionscript">                <span class="comment">//过渡动画结束后调用afterEnter方法</span></span></span><br><span class="line"><span class="actionscript">                el.addEventListener(<span class="string">'transitionend'</span>, done);</span></span><br><span class="line">            &#125;,</span><br><span class="line">            afterEnter(el)&#123;</span><br><span class="line"><span class="actionscript">                <span class="comment">// 动画完成之后，会调用 afterEnter</span></span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="string">'ok111'</span>)</span></span><br><span class="line">            &#125;,</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            beforeLeave(el)&#123;</span><br><span class="line"><span class="actionscript">                <span class="comment">//el.style.opacity = 1.0</span></span></span><br><span class="line"><span class="actionscript">                el.style.transform = <span class="string">"translate(150px, 450px)"</span></span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="string">"beforeLeave"</span>)</span></span><br><span class="line">            &#125;,</span><br><span class="line">            leave(el,done)&#123;</span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="string">"leave"</span>)</span></span><br><span class="line">                el.offsetWidth</span><br><span class="line"><span class="actionscript">                <span class="comment">// leave 表示动画 离开 之后的样式，在这里可以设置小球完成动画之后的结束状态</span></span></span><br><span class="line"><span class="actionscript">                el.style.transition = <span class="string">'all 1s ease'</span></span></span><br><span class="line"></span><br><span class="line">                el.style.opacity = 0</span><br><span class="line"><span class="actionscript">                el.style.transform = <span class="string">"translate(0px,0px)"</span></span></span><br><span class="line"><span class="actionscript">                el.addEventListener(<span class="string">'transitionend'</span>, done);</span></span><br><span class="line">            &#125;,</span><br><span class="line">            afterLeave(el)&#123;</span><br><span class="line"><span class="actionscript">                <span class="comment">// 动画完成之后，会调用 afterEnter</span></span></span><br><span class="line"><span class="javascript">                <span class="built_in">console</span>.log(<span class="string">'ok222'</span>)</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="6-6-实现添加购物车的动画效果"><a href="#6-6-实现添加购物车的动画效果" class="headerlink" title="6.6 实现添加购物车的动画效果"></a>6.6 实现添加购物车的动画效果</h2><p>需求：在添加购物车动画执行完毕之后就立马隐藏小球</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"ie=edge"</span>&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">    &lt;script src="./</span>lib/vue<span class="number">-2.4</span><span class="number">.0</span>.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">    &lt;style&gt;</span></span><br><span class="line"><span class="string">        .ball &#123;</span></span><br><span class="line"><span class="string">            width: 15px;</span></span><br><span class="line"><span class="string">            height: 15px;</span></span><br><span class="line"><span class="string">            border-radius: 50%;</span></span><br><span class="line"><span class="string">            background-color: red;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &lt;/style&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">&lt;div id="</span>app<span class="string">"&gt;</span></span><br><span class="line"><span class="string">    &lt;input type="</span>button<span class="string">" value="</span>快到碗里来<span class="string">" @click="</span>flag=!flag<span class="string">"&gt;</span></span><br><span class="line"><span class="string">    &lt;!-- 1. 使用 transition 元素把 小球包裹起来 --&gt;</span></span><br><span class="line"><span class="string">    &lt;transition</span></span><br><span class="line"><span class="string">            @before-enter="</span>beforeEnter<span class="string">"</span></span><br><span class="line"><span class="string">            @enter="</span>enter<span class="string">"</span></span><br><span class="line"><span class="string">            @after-enter="</span>afterEnter<span class="string">"&gt;</span></span><br><span class="line"><span class="string">        &lt;div class="</span>ball<span class="string">" v-show="</span>flag<span class="string">"&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">    &lt;/transition&gt;</span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    // 创建 Vue 实例，得到 ViewModel</span></span><br><span class="line"><span class="string">    var vm = new Vue(&#123;</span></span><br><span class="line"><span class="string">        el: '#app',</span></span><br><span class="line"><span class="string">        data: &#123;</span></span><br><span class="line"><span class="string">            flag: false</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        methods: &#123;</span></span><br><span class="line"><span class="string">            //el，表示 要执行动画的那个DOM元素，是个原生的 JS DOM对象</span></span><br><span class="line"><span class="string">            beforeEnter(el)&#123;</span></span><br><span class="line"><span class="string">                // beforeEnter 表示动画入场之前，此时，动画尚未开始，可以 在 beforeEnter 中，设置元素开始动画之前的起始样式</span></span><br><span class="line"><span class="string">                el.style.transform = "</span>translate(<span class="number">0</span>px, <span class="number">0</span>px)<span class="string">"</span></span><br><span class="line"><span class="string">            &#125;,</span></span><br><span class="line"><span class="string">            enter(el,done)&#123;</span></span><br><span class="line"><span class="string">                //el.offsetWidth 会强制动画刷新</span></span><br><span class="line"><span class="string">                el.offsetWidth</span></span><br><span class="line"><span class="string">                // enter 表示动画 开始之后的样式，在这里可以设置小球完成动画之后的结束状态</span></span><br><span class="line"><span class="string">                el.style.transform = "</span>translate(<span class="number">150</span>px, <span class="number">450</span>px)<span class="string">"</span></span><br><span class="line"><span class="string">                el.style.transition = 'all 1s ease'</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">                el.addEventListener('transitionend', done);</span></span><br><span class="line"><span class="string">            &#125;,</span></span><br><span class="line"><span class="string">            afterEnter(el)&#123;</span></span><br><span class="line"><span class="string">                //上面使用done之后会在动画执行完了就立马隐藏小球</span></span><br><span class="line"><span class="string">                console.log('ok')</span></span><br><span class="line"><span class="string">                //解决afterEnter被触发后要过一段时间才能隐藏的问题</span></span><br><span class="line"><span class="string">                el.style.display = 'none'</span></span><br><span class="line"><span class="string">                //动画分为上半场和下半场，上半场指的是 flag :  false ---&gt; true</span></span><br><span class="line"><span class="string">                //                                        下半场指的是 flag ： true ---&gt;false</span></span><br><span class="line"><span class="string">                //这里让this.flag = !this.flag是执行下半场的动画(虽然我们没有定义过下半场动画)。如果没有这个代码，那我们点击一下按钮进行动画，再点击一下按钮进行动画就会有问题。</span></span><br><span class="line"><span class="string">                this.flag = !this.flag</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure><h2 id="6-7-列表动画"><a href="#6-7-列表动画" class="headerlink" title="6.7 列表动画"></a>6.7 列表动画</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    li &#123;</span><br><span class="line"><span class="css">      <span class="selector-tag">border</span>: 1<span class="selector-tag">px</span> <span class="selector-tag">dashed</span> <span class="selector-id">#999</span>;</span></span><br><span class="line">      margin: 5px;</span><br><span class="line">      line-height: 35px;</span><br><span class="line">      padding-left: 5px;</span><br><span class="line">      font-size: 12px;</span><br><span class="line">      width: 100%;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-tag">li</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line">      background-color: hotpink;</span><br><span class="line"><span class="css">      <span class="selector-tag">transition</span>: <span class="selector-tag">all</span> 0<span class="selector-class">.8s</span> <span class="selector-tag">ease</span>;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="css"><span class="comment">/*整个列表进入动画*/</span></span></span><br><span class="line"><span class="css">    <span class="selector-class">.v-enter</span>,</span></span><br><span class="line"><span class="css">    <span class="selector-class">.v-leave-to</span> &#123;</span></span><br><span class="line">      opacity: 0;</span><br><span class="line">      transform: translateY(80px);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.v-enter-active</span>,</span></span><br><span class="line"><span class="css">    <span class="selector-class">.v-leave-active</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="selector-tag">transition</span>: <span class="selector-tag">all</span> 0<span class="selector-class">.6s</span> <span class="selector-tag">ease</span>;</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line"><span class="css"><span class="comment">/*transition-group 不仅可以进入和离开动画，还可以改变定位。要使用这个新功能只需了解新增的 v-move 特性，它会在元素的改变定位的过程中应用*/</span></span></span><br><span class="line"><span class="css"><span class="comment">/* 下面的 .v-move 和 .v-leave-active 配合使用，能够实现列表后续的元素，渐渐地漂上来的效果 。其原理是点击要删除的li的时候动态添加absulute样式，让其脱标，下面元素就可以顶上来了 */</span></span></span><br><span class="line"><span class="css">    <span class="selector-class">.v-move</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="comment">/*列表排序过滤*/</span></span></span><br><span class="line"><span class="css">      <span class="selector-tag">transition</span>: <span class="selector-tag">all</span> 10<span class="selector-class">.6s</span> <span class="selector-tag">ease</span>;</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.v-leave-active</span>&#123;</span></span><br><span class="line">      position: absolute;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">        Id:</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"id"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span>&gt;</span></span><br><span class="line">        Name:</span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"name"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"添加"</span> @<span class="attr">click</span>=<span class="string">"add"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- &lt;ul&gt; --&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 在实现列表过渡的时候，如果需要过渡的元素，是通过 v-for 循环渲染出来的，不能使用 transition 包裹，需要使用 transitionGroup --&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 如果要为 v-for 循环创建的元素设置动画，必须为每一个元素设置 :key 属性 --&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 给 transition-group 添加 appear 属性，实现页面刚展示出来时候，入场时候的效果 --&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 通过 为 transition-group 元素，设置 tag 属性，指定 transition-group 渲染为指定的元素，如果不指定 tag 属性，默认，渲染为 span 标签 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">transition-group</span> <span class="attr">appear</span> <span class="attr">tag</span>=<span class="string">"ul"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">"(item, i) in list"</span> <span class="attr">:key</span>=<span class="string">"item.id"</span> @<span class="attr">click</span>=<span class="string">"del(i)"</span>&gt;</span></span><br><span class="line">          &#123;&#123;item.id&#125;&#125; --- &#123;&#123;item.name&#125;&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">transition-group</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;/ul&gt; --&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line"><span class="actionscript">        id: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">        name: <span class="string">''</span>,</span></span><br><span class="line">        list: [</span><br><span class="line"><span class="actionscript">          &#123; id: <span class="number">1</span>, name: <span class="string">'赵高'</span> &#125;,</span></span><br><span class="line"><span class="actionscript">          &#123; id: <span class="number">2</span>, name: <span class="string">'秦桧'</span> &#125;,</span></span><br><span class="line"><span class="actionscript">          &#123; id: <span class="number">3</span>, name: <span class="string">'严嵩'</span> &#125;,</span></span><br><span class="line"><span class="actionscript">          &#123; id: <span class="number">4</span>, name: <span class="string">'魏忠贤'</span> &#125;</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line">        add() &#123;</span><br><span class="line"><span class="actionscript">          <span class="comment">//this.list.push(&#123; id: this.id, name: this.name &#125;)</span></span></span><br><span class="line"><span class="actionscript">  <span class="keyword">this</span>.list.splice(<span class="number">1</span>,<span class="number">0</span>,&#123; id: <span class="keyword">this</span>.id, name: <span class="keyword">this</span>.name &#125;)</span></span><br><span class="line"><span class="actionscript">          <span class="keyword">this</span>.id = <span class="keyword">this</span>.name = <span class="string">''</span></span></span><br><span class="line">        &#125;,</span><br><span class="line">        del(i) &#123;</span><br><span class="line"><span class="actionscript">          <span class="keyword">this</span>.list.splice(i, <span class="number">1</span>)</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="6-8-相关文章"><a href="#6-8-相关文章" class="headerlink" title="6.8 相关文章"></a>6.8 相关文章</h2><ol><li><a href="https://v1-cn.vuejs.org/" target="_blank" rel="noopener">vue.js 1.x 文档</a></li><li><a href="https://cn.vuejs.org/" target="_blank" rel="noopener">vue.js 2.x 文档</a></li><li><a href="http://www.css88.com/archives/7715" target="_blank" rel="noopener">String.prototype.padStart(maxLength, fillString)</a></li><li><a href="http://www.cnblogs.com/wuhua1/p/6686237.html" target="_blank" rel="noopener">js 里面的键盘事件对应的键码</a></li><li><a href="http://www.cnblogs.com/kidney/p/6052935.html" target="_blank" rel="noopener">Vue.js双向绑定的实现原理</a></li><li><a href="https://github.com/pagekit/vue-resource" target="_blank" rel="noopener">pagekit/vue-resource</a></li><li><a href="https://jingyan.baidu.com/article/a65957f4976aad24e67f9b9b.html" target="_blank" rel="noopener">navicat如何导入sql文件和导出sql文件</a></li><li><a href="http://cubic-bezier.com/#.4,-0.3,1,.33" target="_blank" rel="noopener">贝塞尔在线生成器</a></li></ol><h1 id="7-Vue组件"><a href="#7-Vue组件" class="headerlink" title="7 Vue组件"></a>7 Vue组件</h1><p>什么是组件： 组件的出现，就是为了拆分Vue实例的代码量的，能够让我们以不同的组件，来划分不同的功能模块，将来我们需要什么样的功能，就可以去调用对应的组件即可；</p><p>组件化和模块化的不同：</p><ul><li>模块化： 是从代码逻辑的角度进行划分的；方便代码分层开发，保证每个功能模块的职能单一；</li><li>组件化： 是从UI界面的角度进行划分的；前端的组件化，方便UI组件的重用；</li></ul><h2 id="7-1-定义Vue组件"><a href="#7-1-定义Vue组件" class="headerlink" title="7.1 定义Vue组件"></a>7.1 定义Vue组件</h2><h3 id="7-1-2-全局组件的定义"><a href="#7-1-2-全局组件的定义" class="headerlink" title="7.1.2 全局组件的定义"></a>7.1.2 全局组件的定义</h3><h4 id="a-使用Vue-component-方法："><a href="#a-使用Vue-component-方法：" class="headerlink" title="a) 使用Vue.component 方法："></a>a) 使用Vue.component 方法：</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">  &lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br><span class="line">  &lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"ie=edge"</span>&gt;</span><br><span class="line">  &lt;title&gt;Document&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">  &lt;script src="./</span>lib/vue<span class="number">-2.4</span><span class="number">.0</span>.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">  &lt;div id="</span>app<span class="string">"&gt;</span></span><br><span class="line"><span class="string">    &lt;!-- 如果要使用组件，直接，把组件的名称，以 HTML 标签的形式，引入到页面中，即可 --&gt;</span></span><br><span class="line"><span class="string">    &lt;my-component&gt;&lt;/my-component&gt;</span></span><br><span class="line"><span class="string">  &lt;/div&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  &lt;script&gt;</span></span><br><span class="line"><span class="string">    Vue.component('myComponent', &#123;</span></span><br><span class="line"><span class="string">      template: '&lt;h3&gt;这是使用 Vue.extend 创建的组件3&lt;/h3&gt;'</span></span><br><span class="line"><span class="string">    &#125;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    // 创建 Vue 实例，得到 ViewModel</span></span><br><span class="line"><span class="string">    var vm = new Vue(&#123;</span></span><br><span class="line"><span class="string">      el: '#app',</span></span><br><span class="line"><span class="string">      data: &#123;&#125;,</span></span><br><span class="line"><span class="string">      methods: &#123;&#125;</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">  &lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 注意：一个组件只可以有唯一的根元素</span></span><br></pre></td></tr></table></figure><h4 id="b-模板字符串定义组件"><a href="#b-模板字符串定义组件" class="headerlink" title="b) 模板字符串定义组件"></a>b) 模板字符串定义组件</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mycom3</span>&gt;</span><span class="tag">&lt;/<span class="name">mycom3</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 在 被控制的 #app 外面,使用 template 元素,定义组件的HTML模板结构  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">"tmpl"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是通过 template 元素,在外部定义的组件结构,这个方式,有代码的只能提示和高亮<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h4</span>&gt;</span>好用,不错!<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    Vue.component(<span class="string">'mycom3'</span>, &#123;</span></span><br><span class="line"><span class="actionscript">      template: <span class="string">'#tmpl'</span></span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;&#125;,</span><br><span class="line">      methods: &#123;&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>注意： 组件中的DOM结构，有且只能有唯一的根元素（Root Element）来进行包裹！</p></blockquote><h3 id="7-1-2-私有组建的定义"><a href="#7-1-2-私有组建的定义" class="headerlink" title="7.1.2 私有组建的定义"></a>7.1.2 私有组建的定义</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mycom3</span>&gt;</span><span class="tag">&lt;/<span class="name">mycom3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">login</span>&gt;</span><span class="tag">&lt;/<span class="name">login</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">"tmpl"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是私有的 login 组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm2 = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;&#125;,</span><br><span class="line">      methods: &#123;&#125;,</span><br><span class="line">      filters: &#123;&#125;,</span><br><span class="line">      directives: &#123;&#125;,</span><br><span class="line"><span class="actionscript">      <span class="comment">// 定义实例内部私有组件的</span></span></span><br><span class="line">      components: &#123; </span><br><span class="line">        login: &#123;</span><br><span class="line"><span class="actionscript">          template: <span class="string">'#tmpl'</span></span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="7-1-3-组件中数据和事件"><a href="#7-1-3-组件中数据和事件" class="headerlink" title="7.1.3 组件中数据和事件"></a>7.1.3 组件中数据和事件</h3><h4 id="a-基本使用"><a href="#a-基本使用" class="headerlink" title="a) 基本使用"></a>a) 基本使用</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">counter</span>&gt;</span><span class="tag">&lt;/<span class="name">counter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">counter</span>&gt;</span><span class="tag">&lt;/<span class="name">counter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">counter</span>&gt;</span><span class="tag">&lt;/<span class="name">counter</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">"tmpl"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"+1"</span> @<span class="attr">click</span>=<span class="string">"increment"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;&#123;count&#125;&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> dataObj = &#123; count: <span class="number">0</span> &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 这是一个计数器的组件, 身上有个按钮,每当点击按钮,让 data 中的 count 值 +1</span></span></span><br><span class="line"><span class="actionscript">    Vue.component(<span class="string">'counter'</span>, &#123;</span></span><br><span class="line"><span class="actionscript">      template: <span class="string">'#tmpl'</span>,</span></span><br><span class="line"><span class="actionscript">      data: <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// 在组件中最好return一个独立的对象，每当创建一个新的组件实例，每一个组件实例之间是完全独立的</span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> &#123; count: <span class="number">0</span> &#125;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line">        increment() &#123;</span><br><span class="line"><span class="actionscript">          <span class="keyword">this</span>.count++</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;&#125;,</span><br><span class="line">      methods: &#123;&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="b-为什么-组件中-data-必须是函数"><a href="#b-为什么-组件中-data-必须是函数" class="headerlink" title="b) 为什么 组件中 data 必须是函数"></a>b) 为什么 组件中 data 必须是函数</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//伪代码</span></span><br><span class="line"><span class="keyword">var</span> Component = functionComponent() &#123;&#125;;</span><br><span class="line">Component.prototype.data = &#123;</span><br><span class="line">    demo: <span class="number">123</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> component1 = <span class="keyword">new</span> Component();</span><br><span class="line"><span class="keyword">var</span> component2 = <span class="keyword">new</span> Component();</span><br><span class="line">component1.data.demo = <span class="number">456</span>;</span><br><span class="line"><span class="built_in">console</span>.log(component2.data.demo); <span class="comment">// 456</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//1.从上面可以看出，两个实例都引用同一个对象，其中一个改变的时候，另一个也发生改变。</span></span><br><span class="line"><span class="comment">//2.每一个vue组件都是一个vue实例，通过new Vue()实例化，引用同一个对象，如果data直接是一个对象的话，那么一旦修改其中一个组件的数据，其他组件相同数据就会被改变。</span></span><br><span class="line"><span class="comment">//3.而data是函数，并且在函数中return一个独立对象的时候，每个vue组件的data都因为函数有了自己的作用域，互不干扰。</span></span><br></pre></td></tr></table></figure><h2 id="7-2-切换组件"><a href="#7-2-切换组件" class="headerlink" title="7.2 切换组件"></a>7.2 切换组件</h2><h3 id="7-2-1-使用flag标识符结合v-if和v-else切换组件"><a href="#7-2-1-使用flag标识符结合v-if和v-else切换组件" class="headerlink" title="7.2.1 使用flag标识符结合v-if和v-else切换组件"></a>7.2.1 使用flag标识符结合v-if和v-else切换组件</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">  &lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br><span class="line">  &lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"ie=edge"</span>&gt;</span><br><span class="line">  &lt;title&gt;Document&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">  &lt;script src="./</span>lib/vue<span class="number">-2.4</span><span class="number">.0</span>.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">  &lt;div id="</span>app<span class="string">"&gt;</span></span><br><span class="line"><span class="string">    &lt;a href="</span><span class="string">" @click.prevent="</span>flag=<span class="literal">true</span><span class="string">"&gt;登录&lt;/a&gt;</span></span><br><span class="line"><span class="string">    &lt;a href="</span><span class="string">" @click.prevent="</span>flag=<span class="literal">false</span><span class="string">"&gt;注册&lt;/a&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &lt;login v-if="</span>flag<span class="string">"&gt;&lt;/login&gt;</span></span><br><span class="line"><span class="string">    &lt;register v-else&gt;&lt;/register&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  &lt;/div&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  &lt;script&gt;</span></span><br><span class="line"><span class="string">    Vue.component('login', &#123;</span></span><br><span class="line"><span class="string">      template: '&lt;h3&gt;登录组件&lt;/h3&gt;'</span></span><br><span class="line"><span class="string">    &#125;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Vue.component('register', &#123;</span></span><br><span class="line"><span class="string">      template: '&lt;h3&gt;注册组件&lt;/h3&gt;'</span></span><br><span class="line"><span class="string">    &#125;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    // 创建 Vue 实例，得到 ViewModel</span></span><br><span class="line"><span class="string">    var vm = new Vue(&#123;</span></span><br><span class="line"><span class="string">      el: '#app',</span></span><br><span class="line"><span class="string">      data: &#123;</span></span><br><span class="line"><span class="string">        flag: false</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      methods: &#123;&#125;</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">  &lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 缺点：只能切换两个组件</span></span><br></pre></td></tr></table></figure><h3 id="7-2-2-使用component来切换不同的子组件"><a href="#7-2-2-使用component来切换不同的子组件" class="headerlink" title="7.2.2 使用component来切换不同的子组件"></a>7.2.2 使用component来切换不同的子组件</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span> @<span class="attr">click.prevent</span>=<span class="string">"comName='login'"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span> @<span class="attr">click.prevent</span>=<span class="string">"comName='register'"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- Vue提供了 component ,来展示对应名称的组件 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- component 是一个占位符, :is 属性,可以用来指定要展示的组件的名称 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">"comName"</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 组件名称是 字符串</span></span></span><br><span class="line"><span class="actionscript">    Vue.component(<span class="string">'login'</span>, &#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">      template: '<span class="tag">&lt;<span class="name">h3</span>&gt;</span>登录组件<span class="tag">&lt;/<span class="name">h3</span>&gt;</span>'</span></span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    Vue.component(<span class="string">'register'</span>, &#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">      template: '<span class="tag">&lt;<span class="name">h3</span>&gt;</span>注册组件<span class="tag">&lt;/<span class="name">h3</span>&gt;</span>'</span></span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line"><span class="actionscript">        comName: <span class="string">'login'</span> <span class="comment">// 当前 component 中的 :is 绑定的组件的名称</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="7-2-3-keep-alive组件"><a href="#7-2-3-keep-alive组件" class="headerlink" title="7.2.3 keep-alive组件"></a>7.2.3 keep-alive组件</h3><p><keep-alive>是Vue的内置组件，能在组件切换过程中将状态保留在内存中，而不是销毁他们，防止重复渲染DOM。</keep-alive></p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span> @<span class="attr">click.prevent</span>=<span class="string">"comName='login'"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span> @<span class="attr">click.prevent</span>=<span class="string">"comName='register'"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--keep-alive 将组件缓存--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;keep-alive&gt;</span></span><br><span class="line"><span class="comment">        &lt;component :is="comName"&gt;&lt;/component&gt;</span></span><br><span class="line"><span class="comment">    &lt;/keep-alive&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--仅缓存login登陆组件 include后面是组件名 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;keep-alive  include="login"&gt;</span></span><br><span class="line"><span class="comment">        &lt;component :is="comName"&gt;&lt;/component&gt;</span></span><br><span class="line"><span class="comment">    &lt;/keep-alive&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--使用正则表达式，需要使用v-bind的方式，缓存login和register组件--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;keep-alive  :include="/login|register/"&gt;</span></span><br><span class="line"><span class="comment">        &lt;component :is="comName"&gt;&lt;/component&gt;</span></span><br><span class="line"><span class="comment">    &lt;/keep-alive&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">keep-alive</span>  <span class="attr">:include</span>=<span class="string">"['login','register']"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">"comName"</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">keep-alive</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--&lt;keep-alive  exclude="login"&gt;</span></span><br><span class="line"><span class="comment">        &lt;component :is="comName"&gt;&lt;/component&gt;</span></span><br><span class="line"><span class="comment">    &lt;/keep-alive&gt;--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 组件名称是 字符串</span></span></span><br><span class="line"><span class="actionscript">    Vue.component(<span class="string">'login'</span>, &#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">        template: '<span class="tag">&lt;<span class="name">h3</span>&gt;</span>登录组件<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span><span class="tag">&lt;/<span class="name">h3</span>&gt;</span>'</span></span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    Vue.component(<span class="string">'register'</span>, &#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">        template: '<span class="tag">&lt;<span class="name">h3</span>&gt;</span>注册组件<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span>&gt;</span><span class="tag">&lt;/<span class="name">h3</span>&gt;</span>'</span></span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line">        data: &#123;</span><br><span class="line"><span class="actionscript">            comName: <span class="string">'login'</span> <span class="comment">// 当前 component 中的 :is 绑定的组件的名称</span></span></span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;&#125;</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="7-2-4-组件切换动画"><a href="#7-2-4-组件切换动画" class="headerlink" title="7.2.4 组件切换动画"></a>7.2.4 组件切换动画</h3><p><a href="https://cn.vuejs.org/v2/guide/transitions.html#%E5%A4%9A%E4%B8%AA%E7%BB%84%E4%BB%B6%E7%9A%84%E8%BF%87%E6%B8%A1" target="_blank" rel="noopener">https://cn.vuejs.org/v2/guide/transitions.html#%E5%A4%9A%E4%B8%AA%E7%BB%84%E4%BB%B6%E7%9A%84%E8%BF%87%E6%B8%A1</a></p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.v-enter</span>,</span></span><br><span class="line"><span class="css">    <span class="selector-class">.v-leave-to</span> &#123;</span></span><br><span class="line">      opacity: 0;</span><br><span class="line">      transform: translateX(150px);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.v-enter-active</span>,</span></span><br><span class="line"><span class="css">    <span class="selector-class">.v-leave-active</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="selector-tag">transition</span>: <span class="selector-tag">all</span> 0<span class="selector-class">.5s</span> <span class="selector-tag">ease</span>;</span></span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span> @<span class="attr">click.prevent</span>=<span class="string">"comName='login'"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">""</span> @<span class="attr">click.prevent</span>=<span class="string">"comName='register'"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 通过 mode 属性,设置组件切换时候的模式,out-in 表示原先的组件先出去，后来的组件再进来 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">transition</span> <span class="attr">mode</span>=<span class="string">"out-in"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">"comName"</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 组件名称是 字符串</span></span></span><br><span class="line"><span class="actionscript">    Vue.component(<span class="string">'login'</span>, &#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">      template: '<span class="tag">&lt;<span class="name">h3</span>&gt;</span>登录组件<span class="tag">&lt;/<span class="name">h3</span>&gt;</span>'</span></span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    Vue.component(<span class="string">'register'</span>, &#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">      template: '<span class="tag">&lt;<span class="name">h3</span>&gt;</span>注册组件<span class="tag">&lt;/<span class="name">h3</span>&gt;</span>'</span></span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line"><span class="actionscript">        comName: <span class="string">'login'</span> <span class="comment">// 当前 component 中的 :is 绑定的组件的名称</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="7-3-父子组件之间的通信"><a href="#7-3-父子组件之间的通信" class="headerlink" title="7.3 父子组件之间的通信"></a>7.3 父子组件之间的通信</h2><h3 id="7-3-1-父组件向子组件传值"><a href="#7-3-1-父组件向子组件传值" class="headerlink" title="7.3.1 父组件向子组件传值"></a>7.3.1 父组件向子组件传值</h3><p>使用步骤：</p><blockquote><p>1.父组件给子组件绑定数据<br><com1 v-bind:parentmsg="msg"></com1></p><p>2.子组件中提前声明绑定的key<br>props: [‘parentmsg’], </p><p>3.子组件使用props中声明的绑定的key<br>template: ‘&lt;h1 @click=”change”&gt;这是子组件 — ‘</p></blockquote><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 父组件，可以在引用子组件的时候， 通过属性绑定（v-bind:） 的形式, 把需要传递给子组件的数据以属性绑定的形式传递到子组件内部，供子组件使用 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">com1</span> <span class="attr">v-bind:parentmsg</span>=<span class="string">"msg"</span>&gt;</span><span class="tag">&lt;/<span class="name">com1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">"tmpl"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> @<span class="attr">click</span>=<span class="string">"change"</span>&gt;</span>这是子组件 --- &#123;&#123; parentmsg &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> com1 = &#123;</span></span><br><span class="line">        data() &#123;</span><br><span class="line"><span class="actionscript">            <span class="comment">//子组件中的 data 数据，并不是通过父组件传递过来的，而是子组件自身私有的。data 上的数据，都是可读可写的</span></span></span><br><span class="line"><span class="actionscript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="actionscript">                title: <span class="string">'123'</span>,</span></span><br><span class="line"><span class="actionscript">                content: <span class="string">'qqq'</span></span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line"><span class="actionscript">        <span class="comment">//子组件默认情况下无法直接访问父组件的数据</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">//可以通过父组件向子组件传值的方式来实现访问</span></span></span><br><span class="line"><span class="actionscript">        template: <span class="string">'#tmpl'</span>,</span></span><br><span class="line"><span class="actionscript">        <span class="comment">// 注意： 组件中的所有 props 中的数据，都是通过父组件传递给子组件的。props中的数据都是只读的，无法重新赋值</span></span></span><br><span class="line"><span class="actionscript">        props: [<span class="string">'parentmsg'</span>],</span></span><br><span class="line">        methods: &#123;</span><br><span class="line">            change() &#123;</span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.parentmsg = <span class="string">'被修改了'</span></span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line">        data: &#123;</span><br><span class="line"><span class="actionscript">            msg: <span class="string">'123 啊-父组件中的数据'</span></span></span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;&#125;,</span><br><span class="line">        components: &#123;</span><br><span class="line">            com1:com1</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>注意：子组件props中的数据只是从父组件传递过来，不可以在子组件中进行修改</strong></p><h3 id="7-3-2-子组件向父组件传值"><a href="#7-3-2-子组件向父组件传值" class="headerlink" title="7.3.2 子组件向父组件传值"></a>7.3.2 子组件向父组件传值</h3><p>原理：父组件将方法的引用，传递到子组件内部，子组件在内部调用父组件传递过来的方法，同时把要发送给父组件的数据，在调用方法的时候当作参数传递进去；</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 父组件向子组件传递方法，使用的是事件绑定机制--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">com2</span> @<span class="attr">func</span>=<span class="string">"show"</span>&gt;</span><span class="tag">&lt;/<span class="name">com2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">"tmpl"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是子组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"这是子组件中的按钮 - 点击它，触发父组件传递过来的 func 方法"</span> @<span class="attr">click</span>=<span class="string">"myclick"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 定义了一个字面量类型的组件模板对象</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> com2 = &#123;</span></span><br><span class="line"><span class="actionscript">      template: <span class="string">'#tmpl'</span>,</span></span><br><span class="line">      data() &#123;</span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="actionscript">          sonmsg: &#123; name: <span class="string">'小头儿子'</span>, age: <span class="number">6</span> &#125;</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line">        myclick() &#123;</span><br><span class="line"><span class="actionscript">          <span class="comment">// 当点击子组件的按钮的时候，通过emit触发父组件传递过来的方法。emit 英文原意： 是触发，调用、发射的意思</span></span></span><br><span class="line"><span class="actionscript">          <span class="comment">// 这边的func为父组件中绑定事件的key</span></span></span><br><span class="line"><span class="actionscript">          <span class="keyword">this</span>.$emit(<span class="string">'func'</span>, <span class="keyword">this</span>.sonmsg)</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line"><span class="actionscript">        datamsgFormSon: <span class="literal">null</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line">        show(data) &#123;</span><br><span class="line"><span class="actionscript">          <span class="keyword">this</span>.datamsgFormSon = data</span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.datamsgFormSon);</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line"></span><br><span class="line">      components: &#123;</span><br><span class="line">        com2: com2</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#上面代码也可以简写</span><br><span class="line">#1.子组件</span><br><span class="line">&lt;input type=<span class="string">"button"</span> value=<span class="string">"这是子组件中的按钮 - 点击它，触发父组件传递过来的 func 方法"</span> @click=<span class="string">"$emit('func', this.sonmsg)"</span>&gt;</span><br><span class="line"></span><br><span class="line">#2.父组件</span><br><span class="line">&lt;com2 @func=<span class="string">"show"</span>&gt;&lt;<span class="regexp">/com2&gt;</span></span><br><span class="line"><span class="regexp">show(data) &#123;</span></span><br><span class="line"><span class="regexp">    console.log(data);</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="7-3-3-this-refs-获取元素和组件"><a href="#7-3-3-this-refs-获取元素和组件" class="headerlink" title="7.3.3  this.$refs 获取元素和组件"></a>7.3.3  this.$refs 获取元素和组件</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"获取元素"</span> @<span class="attr">click</span>=<span class="string">"getElement"</span> <span class="attr">ref</span>=<span class="string">"mybtn"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h3</span> <span class="attr">id</span>=<span class="string">"myh3"</span> <span class="attr">ref</span>=<span class="string">"myh3"</span>&gt;</span>哈哈哈， 今天天气太好了！！！<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">login</span> <span class="attr">ref</span>=<span class="string">"mylogin"</span>&gt;</span><span class="tag">&lt;/<span class="name">login</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> login = &#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">      template: '<span class="tag">&lt;<span class="name">h1</span>&gt;</span>登录组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>',</span></span></span><br><span class="line">      data() &#123;</span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="actionscript">          msg: <span class="string">'son msg'</span></span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line">        show() &#123;</span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(<span class="string">'调用了子组件的方法'</span>)</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;&#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line">        getElement() &#123;</span><br><span class="line"><span class="actionscript">  <span class="comment">// 在vue中不再推荐使用dom操作获取元素了，我们可以使用ref来替换</span></span></span><br><span class="line"><span class="actionscript">          <span class="comment">// console.log(document.getElementById('myh3').innerText)</span></span></span><br><span class="line">          </span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(<span class="keyword">this</span>.$refs.myh3.innerText)</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(<span class="keyword">this</span>.$refs.mylogin.msg)</span></span><br><span class="line"><span class="actionscript">          <span class="keyword">this</span>.$refs.mylogin.show()</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      components: &#123;</span><br><span class="line">        login</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="7-3-4-评论列表案例"><a href="#7-3-4-评论列表案例" class="headerlink" title="7.3.4 评论列表案例"></a>7.3.4 评论列表案例</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"./lib/bootstrap-3.3.7.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line"> <span class="comment">&lt;!--使用自定义组件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">cmt-box</span> @<span class="attr">func</span>=<span class="string">"loadComments"</span>&gt;</span><span class="tag">&lt;/<span class="name">cmt-box</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"list-group"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"list-group-item"</span> <span class="attr">v-for</span>=<span class="string">"item in list"</span> <span class="attr">:key</span>=<span class="string">"item.id"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"badge"</span>&gt;</span>评论人： &#123;&#123; item.user &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        &#123;&#123; item.content &#125;&#125;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--定义字符串模板--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">"tmpl"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span>评论人：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">v-model</span>=<span class="string">"user"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span>评论内容：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">textarea</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">v-model</span>=<span class="string">"content"</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"发表评论"</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> @<span class="attr">click</span>=<span class="string">"postComment"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  </span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">//自定义组件</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> commentBox = &#123;</span></span><br><span class="line">      data() &#123;</span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="actionscript">          user: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">          content: <span class="string">''</span></span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line"><span class="actionscript">      template: <span class="string">'#tmpl'</span>,</span></span><br><span class="line">      methods: &#123;</span><br><span class="line"><span class="actionscript">    <span class="comment">// 发表评论的方法</span></span></span><br><span class="line">        postComment() &#123; </span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> comment = &#123; <span class="attr">id</span>: <span class="built_in">Date</span>.now(), <span class="attr">user</span>: <span class="keyword">this</span>.user, <span class="attr">content</span>: <span class="keyword">this</span>.content &#125;</span></span><br><span class="line"><span class="actionscript">          <span class="comment">// 从 localStorage 中获取所有的评论</span></span></span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> list = <span class="built_in">JSON</span>.parse(localStorage.getItem(<span class="string">'cmts'</span>) || <span class="string">'[]'</span>)</span></span><br><span class="line"><span class="actionscript">  <span class="comment">// 添加评论</span></span></span><br><span class="line">          list.unshift(comment)</span><br><span class="line"><span class="actionscript">          <span class="comment">// 重新保存最新的评论数据</span></span></span><br><span class="line"><span class="javascript">          localStorage.setItem(<span class="string">'cmts'</span>, <span class="built_in">JSON</span>.stringify(list))</span></span><br><span class="line"><span class="actionscript">          <span class="keyword">this</span>.user = <span class="keyword">this</span>.content = <span class="string">''</span></span></span><br><span class="line"><span class="actionscript">          <span class="comment">// 触发父组件传递过来的方法</span></span></span><br><span class="line"><span class="actionscript">          <span class="keyword">this</span>.$emit(<span class="string">'func'</span>)</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line">        list: [</span><br><span class="line"><span class="javascript">          &#123; <span class="attr">id</span>: <span class="built_in">Date</span>.now(), <span class="attr">user</span>: <span class="string">'李白'</span>, <span class="attr">content</span>: <span class="string">'天生我材必有用'</span> &#125;,</span></span><br><span class="line"><span class="javascript">          &#123; <span class="attr">id</span>: <span class="built_in">Date</span>.now(), <span class="attr">user</span>: <span class="string">'江小白'</span>, <span class="attr">content</span>: <span class="string">'劝君更尽一杯酒'</span> &#125;,</span></span><br><span class="line"><span class="javascript">          &#123; <span class="attr">id</span>: <span class="built_in">Date</span>.now(), <span class="attr">user</span>: <span class="string">'小马'</span>, <span class="attr">content</span>: <span class="string">'我姓马， 风吹草低见牛羊的马'</span> &#125;</span></span><br><span class="line">        ]</span><br><span class="line">      &#125;,</span><br><span class="line">      beforeCreate()&#123; </span><br><span class="line"></span><br><span class="line">      &#125;,</span><br><span class="line">      created()&#123;</span><br><span class="line"><span class="actionscript"><span class="comment">//调用loadComments方法初始化</span></span></span><br><span class="line"><span class="actionscript">        <span class="keyword">this</span>.loadComments()</span></span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line"><span class="actionscript">    <span class="comment">//加载评论的方法</span></span></span><br><span class="line">        loadComments() &#123; </span><br><span class="line"><span class="javascript">          <span class="keyword">var</span> list = <span class="built_in">JSON</span>.parse(localStorage.getItem(<span class="string">'cmts'</span>) || <span class="string">'[]'</span>)</span></span><br><span class="line"><span class="actionscript">          <span class="keyword">this</span>.list = list</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line"><span class="actionscript">  <span class="comment">//自定义组件</span></span></span><br><span class="line">      components: &#123;</span><br><span class="line"><span class="actionscript">        <span class="string">'cmt-box'</span>: commentBox</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="7-4-中央事件总线的使用"><a href="#7-4-中央事件总线的使用" class="headerlink" title="7.4 中央事件总线的使用"></a>7.4 中央事件总线的使用</h2><p><strong>中央事件总线</strong> - 就是一个名字可以叫做<strong>Bus的vue空实例</strong>,里边没有任何内容。</p><p>它就像一个公交车一样，来回输送人，将组件A输送到组件B，再将组件B输送到组件A；</p><p>这里A，B组件可以是父、子组件，也可以是兄、弟组件，或者两个没有任何关系的组件；</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1.创建中央事件总线</span></span><br><span class="line"><span class="keyword">var</span> bus = <span class="keyword">new</span> Vue();</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.使用Bus中央事件总线在A组件中发送信息</span></span><br><span class="line">Bus.$emit(<span class="string">'自定义事件名'</span>，<span class="string">'$on发送过来的数据'</span>)；</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.使用Bus中央事件总线在B组件中接收信息</span></span><br><span class="line">Bus.$on(<span class="string">'自定义事件名'</span>，<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">     <span class="comment">//然后执行什么你自己懂的。。。</span></span><br><span class="line">&#125;)；</span><br></pre></td></tr></table></figure><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn4J3Krp/uUnjQtxoKSmXQ5.YSnl4gBhMINC2LXbiYK1fMNoo.bFZ1ov3MhaM99GiGmzs7HDGM5LIF1Ox*mmWG4xcZAWmuQ!!/b&bo=TgEdAU4BHQEDCSw!&rf=viewer_4"  alt="aa"></p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">com1</span>&gt;</span><span class="tag">&lt;/<span class="name">com1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">com2</span>&gt;</span><span class="tag">&lt;/<span class="name">com2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">"tmpl1"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是子组件1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">"sendMessage"</span>&gt;</span>向组件2发送数据<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">"tmpl2"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是子组件2<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123; fromComponentAMsg &#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">//创建中央事件总线</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> Bus = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">        name: <span class="string">'bus'</span>,</span></span><br><span class="line">        data () &#123;</span><br><span class="line"><span class="actionscript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="actionscript">                <span class="comment">// code</span></span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 定义了一个字面量类型的组件模板对象</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> com1 = &#123;</span></span><br><span class="line"><span class="actionscript">        template: <span class="string">'#tmpl1'</span>,</span></span><br><span class="line">        data() &#123;</span><br><span class="line"><span class="actionscript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line">            sendMessage() &#123;</span><br><span class="line"><span class="actionscript">                Bus.$emit(<span class="string">'inceptMessage'</span>, <span class="string">"组件B，你好"</span>)</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 定义了一个字面量类型的组件模板对象</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> com2 = &#123;</span></span><br><span class="line"><span class="actionscript">        template: <span class="string">'#tmpl2'</span>,</span></span><br><span class="line">        data() &#123;</span><br><span class="line"><span class="actionscript">            <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="actionscript">                fromComponentAMsg:<span class="string">''</span></span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line">        &#125;,</span><br><span class="line">        created () &#123;</span><br><span class="line"><span class="actionscript">            Bus.$on(<span class="string">'inceptMessage'</span>,(msg) =&gt; &#123;</span></span><br><span class="line"><span class="actionscript">                <span class="keyword">this</span>.fromComponentAMsg = msg</span></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">        el: <span class="string">'#app'</span>,</span></span><br><span class="line">        data: &#123;</span><br><span class="line"></span><br><span class="line">        &#125;,</span><br><span class="line">        methods: &#123;</span><br><span class="line"></span><br><span class="line">        &#125;,</span><br><span class="line">        components: &#123;</span><br><span class="line">            com1:com1,</span><br><span class="line">            com2: com2</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="7-5-插槽-slot"><a href="#7-5-插槽-slot" class="headerlink" title="7.5 插槽 slot"></a>7.5 插槽 slot</h2><p>插槽使用场景是：子组件需要显示的内容并非来自本身而是父组件动态传递进来的，插槽的内容具体是什么是由父视图在调用的时候决定的 </p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">  &lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br><span class="line">  &lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"ie=edge"</span>&gt;</span><br><span class="line">  &lt;title&gt;Document&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">  &lt;script src="./</span>lib/vue<span class="number">-2.4</span><span class="number">.0</span>.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">  &lt;div id="</span>app<span class="string">"&gt;</span></span><br><span class="line"><span class="string">    &lt;com2&gt;</span></span><br><span class="line"><span class="string">            &lt;!--使用插槽--&gt;</span></span><br><span class="line"><span class="string">            &lt;h1 slot="</span>header<span class="string">"&gt;顶部&lt;/h1&gt;</span></span><br><span class="line"><span class="string">      &lt;h1 slot="</span>footer<span class="string">"&gt;底部&lt;/h1&gt;</span></span><br><span class="line"><span class="string">      &lt;/com2&gt;</span></span><br><span class="line"><span class="string">  &lt;/div&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  &lt;template id="</span>tmpl<span class="string">"&gt;</span></span><br><span class="line"><span class="string">    &lt;div&gt;</span></span><br><span class="line"><span class="string">      &lt;h1&gt;这是子组件&lt;/h1&gt;</span></span><br><span class="line"><span class="string">      &lt;!--声明插槽--&gt;</span></span><br><span class="line"><span class="string">      &lt;header&gt;</span></span><br><span class="line"><span class="string">      &lt;slot name="</span>header<span class="string">"&gt;&lt;/slot&gt;</span></span><br><span class="line"><span class="string">    &lt;/header&gt;</span></span><br><span class="line"><span class="string">      &lt;footer&gt;</span></span><br><span class="line"><span class="string">      &lt;slot name="</span>footer<span class="string">"&gt;&lt;/slot&gt;</span></span><br><span class="line"><span class="string">      &lt;/footer&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">  &lt;/template&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">  &lt;script&gt;</span></span><br><span class="line"><span class="string">    // 定义了一个字面量类型的组件模板对象</span></span><br><span class="line"><span class="string">    var com2 = &#123;</span></span><br><span class="line"><span class="string">      template: '#tmpl',</span></span><br><span class="line"><span class="string">      data() &#123;</span></span><br><span class="line"><span class="string">        return &#123;</span></span><br><span class="line"><span class="string">          </span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      methods: &#123;</span></span><br><span class="line"><span class="string">       </span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    // 创建 Vue 实例，得到 ViewModel</span></span><br><span class="line"><span class="string">    var vm = new Vue(&#123;</span></span><br><span class="line"><span class="string">      el: '#app',</span></span><br><span class="line"><span class="string">      data: &#123;</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      methods: &#123;</span></span><br><span class="line"><span class="string">      &#125;,</span></span><br><span class="line"><span class="string">      components: &#123;</span></span><br><span class="line"><span class="string">        com2: com2</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">  &lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure><h2 id="7-6-Render方法渲染组件"><a href="#7-6-Render方法渲染组件" class="headerlink" title="7.6 Render方法渲染组件"></a>7.6 Render方法渲染组件</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">  &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">  &lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br><span class="line">  &lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"ie=edge"</span>&gt;</span><br><span class="line">  &lt;title&gt;Document&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">  &lt;script src="./</span>lib/vue<span class="number">-2.4</span><span class="number">.0</span>.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">  &lt;div id="</span>app<span class="string">"&gt;</span></span><br><span class="line"><span class="string">    &lt;p&gt;444444&lt;/p&gt;</span></span><br><span class="line"><span class="string">  &lt;/div&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">  &lt;script&gt;</span></span><br><span class="line"><span class="string">    var login = &#123;</span></span><br><span class="line"><span class="string">      template: '&lt;h1&gt;这是登录组件&lt;/h1&gt;'</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    // 创建 Vue 实例，得到 ViewModel</span></span><br><span class="line"><span class="string">    var vm = new Vue(&#123;</span></span><br><span class="line"><span class="string">      el: '#app',</span></span><br><span class="line"><span class="string">      data: &#123;&#125;,</span></span><br><span class="line"><span class="string">      methods: &#123;&#125;,</span></span><br><span class="line"><span class="string">      // createElements 是一个方法，调用它能够把指定的组件模板渲染为html结构</span></span><br><span class="line"><span class="string">      render: function (createElements) &#123; </span></span><br><span class="line"><span class="string">        return createElements(login);</span></span><br><span class="line"><span class="string">        // 注意：这里 return 的结果，会替换页面中el指定的那个容器</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">  &lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 在一个el中，render只能渲染一个组件，这个组件会完全替换整个el</span></span><br></pre></td></tr></table></figure><h1 id="8-Vue路由"><a href="#8-Vue路由" class="headerlink" title="8.Vue路由"></a>8.Vue路由</h1><h2 id="8-1-什么是路由"><a href="#8-1-什么是路由" class="headerlink" title="8.1 什么是路由"></a>8.1 什么是路由</h2><ol><li><p>对于普通的网站，所有的超链接都是URL地址，所有的URL地址都对应服务器上对应的资源；</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">A : http:<span class="comment">//127.0.0.1:5500/12.路由的使用.html/register</span></span><br><span class="line">B : http:<span class="comment">//127.0.0.1:5500/12.路由的使用.html/login</span></span><br><span class="line"></span><br><span class="line">app.get(<span class="string">"/login"</span>,(req,res)=&gt;&#123;&#125;)</span><br><span class="line">app.get(<span class="string">"/register"</span>,(req,res)=&gt;&#123;&#125;)</span><br><span class="line"></span><br><span class="line">当我们的网址由A到B的时候，此时会向服务器发送请求(也就是此时服务器要处理login请求)</span><br></pre></td></tr></table></figure></li><li><p>对于单页面应用程序来说，主要通过URL中的hash(#号)来实现不同页面之间的切换，同时hash有一个特点，<strong>HTTP请求中不会包含hash相关的内容</strong>；</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line">A : http:<span class="comment">//127.0.0.1:5500/12.路由的使用.html#/register</span></span><br><span class="line">B : http:<span class="comment">//127.0.0.1:5500/12.路由的使用.html#/login</span></span><br><span class="line"></span><br><span class="line">当我们的网址由A到B的时候，此时网址中变化是#后面的内容，此时不会向服务器发送请求。这种方式我们称为前端路由。</span><br><span class="line">当我们由#/register切换到#/login变化的是：当前的路由地址所对应的组件信息</span><br></pre></td></tr></table></figure></li><li><p>在单页面应用程序中，这种通过hash改变来切换页面的方式，称作前端路由（区别于后端路由）；</p></li></ol><h2 id="8-2-前端路由案例"><a href="#8-2-前端路由案例" class="headerlink" title="8.2  前端路由案例"></a>8.2  前端路由案例</h2><h3 id="8-2-1-路由使用步骤"><a href="#8-2-1-路由使用步骤" class="headerlink" title="8.2.1 路由使用步骤"></a>8.2.1 路由使用步骤</h3><p><a href="https://router.vuejs.org/zh/installation.html" target="_blank" rel="noopener">https://router.vuejs.org/zh/installation.html</a></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#1.导入 vue-router 组件类库：</span><br><span class="line">&lt;script src=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;script src="./</span>lib/vue-router<span class="number">-3.0</span><span class="number">.1</span>.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#2.使用 router-link 组件来导航</span></span><br><span class="line"><span class="string">&lt;router-link to="</span>/login<span class="string">"&gt;登录&lt;/router-link&gt;</span></span><br><span class="line"><span class="string">&lt;router-link to="</span>/register<span class="string">"&gt;注册&lt;/router-link&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#3.使用 router-view 组件来显示匹配到的组件</span></span><br><span class="line"><span class="string">&lt;router-view&gt;&lt;/router-view&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#4.创建使用Vue.extend创建组件</span></span><br><span class="line"><span class="string">var login = Vue.extend(&#123;</span></span><br><span class="line"><span class="string">    template: '&lt;h1&gt;登录组件&lt;/h1&gt;'</span></span><br><span class="line"><span class="string">&#125;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">var register = Vue.extend(&#123;</span></span><br><span class="line"><span class="string">    template: '&lt;h1&gt;注册组件&lt;/h1&gt;'</span></span><br><span class="line"><span class="string">&#125;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#5. 创建一个路由 router 实例，通过 routers 属性来定义路由匹配规则</span></span><br><span class="line"><span class="string">var router = new VueRouter(&#123;</span></span><br><span class="line"><span class="string">    routes: [</span></span><br><span class="line"><span class="string">        &#123; path: '/login', component: login &#125;,</span></span><br><span class="line"><span class="string">        &#123; path: '/register', component: register &#125;</span></span><br><span class="line"><span class="string">    ]</span></span><br><span class="line"><span class="string">&#125;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#6.挂载路由</span></span><br><span class="line"><span class="string">var vm = new Vue(&#123;</span></span><br><span class="line"><span class="string">    el: '#app',</span></span><br><span class="line"><span class="string">    router: router // 使用 router 属性来使用路由规则</span></span><br><span class="line"><span class="string">&#125;);</span></span><br></pre></td></tr></table></figure><h3 id="8-2-2-路由案例"><a href="#8-2-2-路由案例" class="headerlink" title="8.2.2 路由案例"></a>8.2.2 路由案例</h3><p>当切换登陆和注册的时候，可以发现url后面#/login和#/register在切换</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 1. 安装 vue-router 路由模块 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-router-3.0.1.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="css">    <span class="selector-class">.router-link-active</span>,</span></span><br><span class="line"><span class="css">    <span class="selector-class">.myactive</span> &#123;</span></span><br><span class="line">      color: red;</span><br><span class="line">      font-weight: 800;</span><br><span class="line">      font-style: italic;</span><br><span class="line">      font-size: 80px;</span><br><span class="line">      text-decoration: underline;</span><br><span class="line">      background-color: green;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.v-enter</span>,</span></span><br><span class="line"><span class="css">    <span class="selector-class">.v-leave-to</span> &#123;</span></span><br><span class="line">      opacity: 0;</span><br><span class="line">      transform: translateX(140px);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.v-enter-active</span>,</span></span><br><span class="line"><span class="css">    <span class="selector-class">.v-leave-active</span> &#123;</span></span><br><span class="line"><span class="css">      <span class="selector-tag">transition</span>: <span class="selector-tag">all</span> 0<span class="selector-class">.5s</span> <span class="selector-tag">ease</span>;</span></span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- &lt;a href="#/login"&gt;登录&lt;/a&gt; --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;a href="#/register"&gt;注册&lt;/a&gt; --&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- router-link 默认渲染为一个a 标签 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/login"</span> <span class="attr">tag</span>=<span class="string">"span"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/register"</span> <span class="attr">tag</span>=<span class="string">"a"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 这是 vue-router 提供的元素专门用来当作占位符的，将来路由规则匹配到的组件，就会展示到这个 router-view 中去 --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 所以： 我们可以把 router-view 认为是一个占位符 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">transition</span> <span class="attr">mode</span>=<span class="string">"out-in"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 组件的模板对象</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> login = &#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">      template: '<span class="tag">&lt;<span class="name">h1</span>&gt;</span>登录组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>'</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> register = &#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">      template: '<span class="tag">&lt;<span class="name">h1</span>&gt;</span>注册组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>'</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">   <span class="comment">// 2. 创建一个路由对象，当导入vue-router包之后，在window全局对象中就有了一个路由的构造函数叫做VueRouter</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> routerObj = <span class="keyword">new</span> VueRouter(&#123;</span></span><br><span class="line"><span class="actionscript">      <span class="comment">// 路由匹配规则</span></span></span><br><span class="line">      routes: [  </span><br><span class="line"><span class="actionscript">        <span class="comment">//  每个路由规则都是一个对象，这个规则对象有两个必须的属性：</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">//  属性1 是 path，表示监听哪个路由链接地址</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">//  属性2 是 component，表示如果路由是前面匹配到的 path，则展示component对应的那个组件</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">//  注意： component的属性值，必须是一个组件的模板对象，不能是组件的引用名称       </span></span></span><br><span class="line"><span class="actionscript">        &#123; path: <span class="string">'/login'</span>, component: login &#125;,</span></span><br><span class="line"><span class="actionscript">        &#123; path: <span class="string">'/register'</span>, component: register &#125;,</span></span><br><span class="line"><span class="actionscript">        &#123; path: <span class="string">'/'</span>, redirect: <span class="string">'/register'</span> &#125;   <span class="comment">//当访问根路径的时候重定向到/register路径</span></span></span><br><span class="line">      ],</span><br><span class="line"><span class="actionscript">      <span class="comment">//https://router.vuejs.org/zh/api/#tag</span></span></span><br><span class="line"><span class="actionscript">      <span class="comment">//设定路由激活的选项的样式</span></span></span><br><span class="line"><span class="actionscript">      linkActiveClass: <span class="string">'myactive'</span></span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;&#125;,</span><br><span class="line">      methods: &#123;&#125;,</span><br><span class="line"><span class="actionscript">      router: routerObj <span class="comment">// 将路由规则对象，注册到 vm 实例上，用来监听URL地址的变化，然后展示对应的组件</span></span></span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="8-3-路由导航模式"><a href="#8-3-路由导航模式" class="headerlink" title="8.3 路由导航模式"></a>8.3 路由导航模式</h2><p>在vue-router中有mode这样一个参数，这个参数的可选值有”hash”、 “history”、”abstract”，主要使用hash和history两种。vue中默认是hash模式。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> routerObj = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">    mode: <span class="string">'hash'</span>,</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="8-3-1-hash模式"><a href="#8-3-1-hash模式" class="headerlink" title="8.3.1 hash模式"></a>8.3.1 hash模式</h3><p>mode:”hash”        <a href="http://127.0.0.1:5500/06.路由模式.html#/login" target="_blank" rel="noopener">http://127.0.0.1:5500/06.路由模式.html#/login</a></p><p>在vue-router.js的2.8版本之前，在路由的hash部分发生了任何变化，都会执行window.onhashchange方法，在这个方法内部我们可以根据当前匹配到的hash去加载对应的组件</p><p>在vue-router.js的2.8版本之后，内部使用window.history.pushState来完成相应的功能</p><p>hash模式的特点：在切换路由的时候，不会向服务器发送请求，但是刷新网页的时候，此时会向服务器发送请求，在向服务器发送请求的时候，hash部分的信息是不会发送到服务器的，所以此时刷新网页没有问题</p><p>更关键的一点是，因为hash发生变化的url都会被浏览器记录下来，从而你会发现浏览器的前进后退都可以用了。这样一来，尽管浏览器没有请求服务器，但是页面状态和url一一关联起来，后来人们给它起了一个霸气的名字叫前端路由，成为了单页应用标配。</p><h3 id="8-3-2-history模式"><a href="#8-3-2-history模式" class="headerlink" title="8.3.2 history模式"></a>8.3.2 history模式</h3><p>mode:”history”     <a href="http://127.0.0.1:5500/login" target="_blank" rel="noopener">http://127.0.0.1:5500/login</a><br>内部使用window.history.pushState来处理url的变化，切换对应的组件</p><p>history模式的特点：在切换路由的时候，不会向服务器发送请求，但是当刷新网页的时候，此时会向服务器发送请求，如果后端没有对应的接口与此匹配，此时会报资源找不到的错误<br>history模式一般情况下不能刷新网页</p><h2 id="8-4-路由元数据-meta-的使用"><a href="#8-4-路由元数据-meta-的使用" class="headerlink" title="8.4 路由元数据(meta)的使用"></a>8.4 路由元数据(meta)的使用</h2><p>meta字段（元数据），直接在路由配置的时候，给每个路由添加一个自定义的meta对象，在meta对象中可以设置一些状态，供页面组件或者路由钩子函数中使用。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">"viewport"</span> content=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">"X-UA-Compatible"</span> content=<span class="string">"ie=edge"</span>&gt;</span><br><span class="line">    &lt;title&gt;Document&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">    &lt;script src="./</span>lib/vue<span class="number">-2.4</span><span class="number">.0</span>.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">    &lt;script src="</span>./lib/vue-router<span class="number">-3.0</span><span class="number">.1</span>.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">&lt;div id="</span>app<span class="string">"&gt;</span></span><br><span class="line"><span class="string">    &lt;div&gt;</span></span><br><span class="line"><span class="string">        &lt;router-link to="</span>/login<span class="string">"&gt;登录&lt;/router-link&gt;</span></span><br><span class="line"><span class="string">        &lt;router-link to="</span>/register<span class="string">"&gt;注册&lt;/router-link&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        &lt;keep-alive&gt;</span></span><br><span class="line"><span class="string">            &lt;router-view v-if="</span>$route.meta.cache<span class="string">"&gt;&lt;/router-view&gt;</span></span><br><span class="line"><span class="string">        &lt;/keep-alive&gt;</span></span><br><span class="line"><span class="string">        &lt;!-- 不缓存 --&gt;</span></span><br><span class="line"><span class="string">        &lt;router-view v-if="</span>!$route.meta.cache<span class="string">"&gt;&lt;/router-view&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">    var login = &#123;</span></span><br><span class="line"><span class="string">        template: '&lt;h3&gt;登录&lt;input type="</span>text<span class="string">"&gt;&lt;/h3&gt;'</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    var register = &#123;</span></span><br><span class="line"><span class="string">        template: '&lt;h3&gt;注册&lt;input type="</span>text<span class="string">"&gt;&lt;/h3&gt;'</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    var router = new VueRouter(&#123;</span></span><br><span class="line"><span class="string">        routes: [</span></span><br><span class="line"><span class="string">            &#123;   path: '/login',</span></span><br><span class="line"><span class="string">                component: login ,</span></span><br><span class="line"><span class="string">                meta: &#123;</span></span><br><span class="line"><span class="string">                    cache: false</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">            &#125;,</span></span><br><span class="line"><span class="string">            &#123;   path: '/register',</span></span><br><span class="line"><span class="string">                component: register,</span></span><br><span class="line"><span class="string">                meta: &#123;</span></span><br><span class="line"><span class="string">                    cache: true</span></span><br><span class="line"><span class="string">                &#125;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">        ]</span></span><br><span class="line"><span class="string">    &#125;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    // 创建Vue实例得到ViewModel</span></span><br><span class="line"><span class="string">    var vm = new Vue(&#123;</span></span><br><span class="line"><span class="string">        el: '#app',</span></span><br><span class="line"><span class="string">        data: &#123;&#125;,</span></span><br><span class="line"><span class="string">        methods: &#123;&#125;,</span></span><br><span class="line"><span class="string">        router</span></span><br><span class="line"><span class="string">    &#125;);</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br></pre></td></tr></table></figure><h2 id="8-5-路由参数的传递"><a href="#8-5-路由参数的传递" class="headerlink" title="8.5 路由参数的传递"></a>8.5 路由参数的传递</h2><h3 id="8-5-1-URL传参"><a href="#8-5-1-URL传参" class="headerlink" title="8.5.1 URL传参"></a>8.5.1 URL传参</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-router-3.0.1.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 如果在路由中，使用查询字符串给路由传递参数，则不需要修改路由规则的path属性 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/login?id=10&amp;name=zs"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 也可以这样使用，注意to前面的冒号 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">:to</span>=<span class="string">"&#123;path:'login',query:&#123;name:'zs',id:20&#125;&#125;"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/register"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> login = &#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">      template: '<span class="tag">&lt;<span class="name">h1</span>&gt;</span>登录 --- </span><span class="template-variable">&#123;&#123; $route.query.id &#125;&#125;</span><span class="xml"> --- </span><span class="template-variable">&#123;&#123; $route.query.name &#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span>',</span></span></span><br><span class="line">      data()&#123;</span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="actionscript">          msg: <span class="string">'123'</span></span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      created()&#123; </span><br><span class="line"><span class="actionscript"><span class="comment">// created()中就可以获取url中的参数信息了</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">// console.log(this.$route)</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">// console.log(this.$route.query.id)</span></span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> register = &#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">      template: '<span class="tag">&lt;<span class="name">h1</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>'</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> router = <span class="keyword">new</span> VueRouter(&#123;</span></span><br><span class="line">      routes: [</span><br><span class="line"><span class="actionscript">        &#123; path: <span class="string">'/login'</span>, component: login &#125;,</span></span><br><span class="line"><span class="actionscript">        &#123; path: <span class="string">'/register'</span>, component: register &#125;</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建Vue实例，得到ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;&#125;,</span><br><span class="line">      methods: &#123;&#125;,</span><br><span class="line">      router</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="8-5-2-Params方式传参"><a href="#8-5-2-Params方式传参" class="headerlink" title="8.5.2 Params方式传参"></a>8.5.2 Params方式传参</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-router-3.0.1.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/login/12/ls"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/register"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> login = &#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">      template: '<span class="tag">&lt;<span class="name">h1</span>&gt;</span>登录 --- </span><span class="template-variable">&#123;&#123; $route.params.id &#125;&#125;</span><span class="xml"> --- </span><span class="template-variable">&#123;&#123; $route.params.name &#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">h1</span>&gt;</span>',</span></span></span><br><span class="line">      data()&#123;</span><br><span class="line"><span class="actionscript">        <span class="keyword">return</span> &#123;</span></span><br><span class="line"><span class="actionscript">          msg: <span class="string">'123'</span></span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      created()&#123; </span><br><span class="line"><span class="actionscript">    <span class="comment">// 组件的生命周期钩子函数</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.$route.params.id)</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> register = &#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">      template: '<span class="tag">&lt;<span class="name">h1</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>'</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> router = <span class="keyword">new</span> VueRouter(&#123;</span></span><br><span class="line">      routes: [</span><br><span class="line"><span class="actionscript">        &#123; path: <span class="string">'/login/:id/:name'</span>, component: login &#125;,</span></span><br><span class="line"><span class="actionscript">        &#123; path: <span class="string">'/register'</span>, component: register &#125;</span></span><br><span class="line">      ]</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建Vue实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;&#125;,</span><br><span class="line">      methods: &#123;&#125;,</span><br><span class="line">      router: router</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="8-6-路由的导航钩子函数"><a href="#8-6-路由的导航钩子函数" class="headerlink" title="8.6 路由的导航钩子函数"></a>8.6 路由的导航钩子函数</h2><p>路由钩子函数：在路由切换的不同阶段调用不同的节点函数，路由钩子函数主要用来拦截导航，让它完成跳转或取消。</p><p>有三种方式设置路由的导航钩子函数</p><blockquote><ol><li>全局的</li><li>单个路由独享的</li><li>组件级的</li></ol></blockquote><h3 id="8-6-1-组件级钩子函数"><a href="#8-6-1-组件级钩子函数" class="headerlink" title="8.6.1 组件级钩子函数"></a>8.6.1 组件级钩子函数</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//路由组件 复用  '路由参数传递'  中的代码</span></span><br><span class="line"><span class="keyword">var</span> login = &#123;</span><br><span class="line">    template: <span class="string">'&lt;h1&gt;登录 --- &#123;&#123; $route.params.id &#125;&#125; --- &#123;&#123; $route.params.name &#125;&#125;&lt;/h1&gt;'</span>,</span><br><span class="line">    data()&#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            msg: <span class="string">'123'</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    created()&#123;</span><br><span class="line">        <span class="comment">// 组件的生命周期钩子函数</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.$route.params.id)</span><br><span class="line">    &#125;,</span><br><span class="line">    beforeRouteEnter (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">        <span class="comment">// 在渲染该组件的对应路由被 confirm 前调用</span></span><br><span class="line">        <span class="comment">// 不能获取组件实例 `this`, 因为当钩子执行前，组件实例还没被创建</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"login路由进入之前"</span>)</span><br><span class="line">        next()</span><br><span class="line">    &#125;,</span><br><span class="line">    beforeRouteUpdate (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">        <span class="comment">// 在当前路由改变，但是该组件被复用时调用</span></span><br><span class="line">        <span class="comment">// 举例来说，对于一个带有动态参数的路径 /foo/:id，在 /foo/1 和 /foo/2 之间跳转的时候，</span></span><br><span class="line">        <span class="comment">// 由于会渲染同样的 Foo 组件，因此组件实例会被复用。而这个钩子就会在这个情况下被调用。</span></span><br><span class="line">        <span class="comment">// 可以访问组件实例 `this`</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"login组件被复用"</span>)</span><br><span class="line">        next()</span><br><span class="line">    &#125;,</span><br><span class="line">    beforeRouteLeave (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">        <span class="comment">// 导航离开该组件的对应路由时调用</span></span><br><span class="line">        <span class="comment">// 可以访问组件实例 `this`</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"login组件离开之前"</span>)</span><br><span class="line">        next()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">next()：进入管道中的下一个钩子，如果全部的钩子执行完了，则导航的状态就是 confirmed（确认的）</span></span><br><span class="line"><span class="comment">next(false)：这代表中断掉当前的导航，即 to 代表的路由对象不会进入，被中断，此时该表 URL 地址会被重置到 from 路由对应的地址</span></span><br><span class="line"><span class="comment">next(‘/’) 和 next(&#123;path: ‘/’&#125;)：在中断掉当前导航的同时，跳转到一个不同的地址</span></span><br><span class="line"><span class="comment">next(error)：如果传入参数是一个 Error 实例，那么导航被终止的同时会将错误传递给 router.onError() 注册过的回调</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">    </span><br><span class="line">&lt;div id=<span class="string">"app"</span>&gt;</span><br><span class="line">    &lt;router-link to=<span class="string">"/login/12/ls"</span>&gt;登录&lt;<span class="regexp">/router-link&gt;</span></span><br><span class="line"><span class="regexp">    &lt;router-link to="/</span>login/<span class="number">12</span>/ls2<span class="string">"&gt;登录2&lt;/router-link&gt;</span></span><br><span class="line"><span class="string">    &lt;router-link to="</span>/register<span class="string">"&gt;注册&lt;/router-link&gt;</span></span><br><span class="line"><span class="string">    &lt;router-view&gt;&lt;/router-view&gt;</span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br></pre></td></tr></table></figure><h3 id="8-6-2-全局路由钩子函数"><a href="#8-6-2-全局路由钩子函数" class="headerlink" title="8.6.2 全局路由钩子函数"></a>8.6.2 全局路由钩子函数</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//你可以使用 router.beforeEach 注册一个全局前置守卫(进来之前的守卫)：</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123; ... &#125;)</span><br><span class="line">router.beforeEach(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">    </span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//同样可以注册一个全局的 after 钩子(后置守卫)，不过它不像 before 钩子那样，after 钩子没有 next 方法，不能改变导航</span></span><br><span class="line">router.afterEach(<span class="function">(<span class="params">to, <span class="keyword">from</span></span>) =&gt;</span> &#123;</span><br><span class="line">  </span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="8-6-3-某个路由独享的钩子"><a href="#8-6-3-某个路由独享的钩子" class="headerlink" title="8.6.3 某个路由独享的钩子"></a>8.6.3 某个路由独享的钩子</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">    routes: [</span><br><span class="line">        &#123;   <span class="attr">path</span>: <span class="string">'/login/:id/:name'</span>,</span><br><span class="line">         component: login ,</span><br><span class="line">         beforeEnter: <span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</span><br><span class="line">             <span class="built_in">console</span>.log(<span class="string">"login的beforeEnter"</span>)</span><br><span class="line">             next()</span><br><span class="line">         &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123; <span class="attr">path</span>: <span class="string">'/register'</span>, <span class="attr">component</span>: register &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h3 id="8-6-4-路由钩子的应用场景"><a href="#8-6-4-路由钩子的应用场景" class="headerlink" title="8.6.4 路由钩子的应用场景"></a>8.6.4 路由钩子的应用场景</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1.清除当前组件中的定时器</span></span><br><span class="line">beforeRouteLeave (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">    <span class="built_in">window</span>.clearInterval(<span class="keyword">this</span>.timer) <span class="comment">//清除定时器</span></span><br><span class="line">    next()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.当页面中有未关闭的窗口, 或未保存的内容时, 阻止页面跳转</span></span><br><span class="line">beforeRouteLeave (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">    <span class="comment">//判断是否弹出框的状态和保存信息与否</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.dialogVisibility === <span class="literal">true</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.dialogVisibility = <span class="literal">false</span> <span class="comment">//关闭弹出框</span></span><br><span class="line">        next(<span class="literal">false</span>) <span class="comment">//回到当前页面, 阻止页面跳转</span></span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">this</span>.saveMessage === <span class="literal">false</span>) &#123;</span><br><span class="line">        <span class="comment">//弹出警告</span></span><br><span class="line">        next(<span class="literal">false</span>) <span class="comment">//回到当前页面, 阻止页面跳转</span></span><br><span class="line">    &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">        next() <span class="comment">//否则允许跳转</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.保存相关内容到Vuex中或Session中</span></span><br><span class="line">beforeRouteLeave (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">    localStorage.setItem(name, content); <span class="comment">//保存到localStorage中</span></span><br><span class="line">    next()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="8-6-5-路由导航的解析流程"><a href="#8-6-5-路由导航的解析流程" class="headerlink" title="8.6.5 路由导航的解析流程"></a>8.6.5 路由导航的解析流程</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">当由A路由 --&gt; B路由的时候：</span><br><span class="line">1、在A组件里调用离开守卫。          A组件中的  beforeRouteLeave </span><br><span class="line">2、调用全局的 beforeEach 守卫。    router.beforeEach</span><br><span class="line">3、再执行B路由配置里调用 beforeEnter。</span><br><span class="line">      routes: [</span><br><span class="line">        &#123;</span><br><span class="line">          path: &#39;&#x2F;b&#39;,</span><br><span class="line">          component: B,</span><br><span class="line">          beforeEnter: (to, from, next) &#x3D;&gt; &#123;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">4、再执行B组件的进入守卫。          B组件中 beforeRouteEnter。</span><br><span class="line">5、调用全局的 beforeResole 守卫 (2.5+)。    router.beforeResolve</span><br><span class="line">6、导航被确认。</span><br><span class="line">7、调用全局的 afterEach 钩子。              router.afterEach</span><br><span class="line">8、触发 DOM 更新。</span><br></pre></td></tr></table></figure><h2 id="8-7-子路由"><a href="#8-7-子路由" class="headerlink" title="8.7 子路由"></a>8.7 子路由</h2><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-router-3.0.1.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/account"</span>&gt;</span>Account<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">id</span>=<span class="string">"tmpl"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是 Account 组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/account/login"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/account/register"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 组件的模板对象</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> account = &#123;</span></span><br><span class="line"><span class="actionscript">      template: <span class="string">'#tmpl'</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> login = &#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">      template: '<span class="tag">&lt;<span class="name">h3</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">h3</span>&gt;</span>'</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> register = &#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">      template: '<span class="tag">&lt;<span class="name">h3</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">h3</span>&gt;</span>'</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> router = <span class="keyword">new</span> VueRouter(&#123;</span></span><br><span class="line">      routes: [</span><br><span class="line">        &#123;</span><br><span class="line"><span class="actionscript">          path: <span class="string">'/account'</span>,</span></span><br><span class="line">          component: account,</span><br><span class="line"><span class="actionscript">          <span class="comment">// 使用children属性实现子路由，同时路由的path前面不要带 / ，否则永远以根路径开始请求，这样不方便我们用户去理解URL地址</span></span></span><br><span class="line">          children: [</span><br><span class="line"><span class="actionscript">            &#123; path: <span class="string">'login'</span>, component: login &#125;,</span></span><br><span class="line"><span class="actionscript">            &#123; path: <span class="string">'register'</span>, component: register &#125;</span></span><br><span class="line">          ]</span><br><span class="line">        &#125;,</span><br><span class="line"><span class="actionscript"><span class="comment">//不能在这里写子路由，当前路由和/account路由是平级关系，当url改掉之后，当前路由会完全占据之前的router-view的坑</span></span></span><br><span class="line"><span class="actionscript"><span class="comment">//&#123; path: '/account/login', component: login &#125;,</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">//&#123; path: '/account/register', component: register &#125;</span></span></span><br><span class="line">      ]</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建Vue实例得到ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;&#125;,</span><br><span class="line">      methods: &#123;&#125;,</span><br><span class="line">      router</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="8-8-命名视图"><a href="#8-8-命名视图" class="headerlink" title="8.8 命名视图"></a>8.8 命名视图</h2><p>有时候想同时 (同级) 展示多个视图，而不是嵌套展示，例如创建一个布局，有 <code>sidebar</code> (侧导航) 和 <code>main</code> (主内容) 两个视图，这个时候命名视图就派上用场了。你可以在界面中拥有多个单独命名的视图，而不是只有一个单独的出口。如果 <code>router-view</code> 没有设置名字，那么默认为 <code>default</code>。</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-router-3.0.1.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html,</span><br><span class="line">    body &#123;</span><br><span class="line">      margin: 0;</span><br><span class="line">      padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.header</span> &#123;</span></span><br><span class="line">      background-color: orange;</span><br><span class="line">      height: 80px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    h1 &#123;</span><br><span class="line">      margin: 0;</span><br><span class="line">      padding: 0;</span><br><span class="line">      font-size: 16px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.container</span> &#123;</span></span><br><span class="line">      display: flex;</span><br><span class="line">      height: 600px;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.left</span> &#123;</span></span><br><span class="line">      background-color: lightgreen;</span><br><span class="line">      flex: 2;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="css">    <span class="selector-class">.main</span> &#123;</span></span><br><span class="line">      background-color: lightpink;</span><br><span class="line">      flex: 8;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--没有指定router-view的name,默认就放default组件--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--指定了router-view的name为left,呈现left组件--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">router-view</span> <span class="attr">name</span>=<span class="string">"left"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--指定了router-view的name为main,呈现main组件--&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">router-view</span> <span class="attr">name</span>=<span class="string">"main"</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> header = &#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">      template: '<span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"header"</span>&gt;</span>Header头部区域<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>'</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> leftBox = &#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">      template: '<span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"left"</span>&gt;</span>Left侧边栏区域<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>'</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> mainBox = &#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">      template: '<span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">"main"</span>&gt;</span>mainBox主体区域<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>'</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建路由对象</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> router = <span class="keyword">new</span> VueRouter(&#123;</span></span><br><span class="line">      routes: [</span><br><span class="line"><span class="actionscript"><span class="comment">//要实现上面header、左边left、右边main，下面方式做不了，只能做到三选一，在某一路径下，要么header呈现，要么left呈现，要么main呈现</span></span></span><br><span class="line">        /* &#123; path: '/', component: header &#125;,</span><br><span class="line"><span class="actionscript">        &#123; path: <span class="string">'/'</span>, component: leftBox &#125;,</span></span><br><span class="line"><span class="actionscript">        &#123; path: <span class="string">'/'</span>, component: mainBox &#125; */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#123;</span><br><span class="line"><span class="actionscript">          path: <span class="string">'/'</span>, components: &#123;</span></span><br><span class="line"><span class="actionscript"><span class="comment">//默认情况下显示的组件</span></span></span><br><span class="line"><span class="actionscript">            <span class="string">'default'</span>: header,</span></span><br><span class="line"><span class="actionscript"><span class="comment">//left情况下显示的组件</span></span></span><br><span class="line"><span class="actionscript">            <span class="string">'left'</span>: leftBox,</span></span><br><span class="line"><span class="actionscript"><span class="comment">//main情况下显示的组件</span></span></span><br><span class="line"><span class="actionscript">            <span class="string">'main'</span>: mainBox</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;&#125;,</span><br><span class="line">      methods: &#123;&#125;,</span><br><span class="line">      router</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="9-watch-computed-methods"><a href="#9-watch-computed-methods" class="headerlink" title="9.watch\computed\methods"></a>9.watch\computed\methods</h1><h2 id="9-1-watch属性的使用"><a href="#9-1-watch属性的使用" class="headerlink" title="9.1 watch属性的使用"></a>9.1 watch属性的使用</h2><p>考虑一个问题：想要实现 第一个文本框 和 第二个文本框 两个文本框的内容改变，则全名的文本框中的值也跟着改变，如何实现？</p><h3 id="9-1-1-使用keyup事件"><a href="#9-1-1-使用keyup事件" class="headerlink" title="9.1.1 使用keyup事件"></a>9.1.1 使用keyup事件</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"firstname"</span> @<span class="attr">keyup</span>=<span class="string">"getFullname"</span>&gt;</span> +</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"lastname"</span> @<span class="attr">keyup</span>=<span class="string">"getFullname"</span>&gt;</span> =</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"fullname"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line"><span class="actionscript">        firstname: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">        lastname: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">        fullname: <span class="string">''</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;</span><br><span class="line">        getFullname() &#123;</span><br><span class="line"><span class="actionscript">          <span class="keyword">this</span>.fullname = <span class="keyword">this</span>.firstname + <span class="string">'-'</span> + <span class="keyword">this</span>.lastname</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="9-9-2-使用watch监听文本框变化"><a href="#9-9-2-使用watch监听文本框变化" class="headerlink" title="9.9.2 使用watch监听文本框变化"></a>9.9.2 使用watch监听文本框变化</h3><p>watch的作用：主要用来监听data属性值的变化</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"firstname"</span>&gt;</span> +</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"lastname"</span>&gt;</span> =</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"fullname"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建Vue实例得到ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line"><span class="actionscript">        firstname: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">        lastname: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">        fullname: <span class="string">''</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;&#125;,</span><br><span class="line"><span class="actionscript">  <span class="comment">// 使用watch属性可以监视data中指定数据的变化，然后触发watch中对应的function处理函数</span></span></span><br><span class="line">      watch: &#123; </span><br><span class="line"><span class="actionscript">        <span class="string">'firstname'</span>: <span class="function"><span class="keyword">function</span> <span class="params">(newVal, oldVal)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">          <span class="comment">// console.log('监视到了 firstname 的变化')</span></span></span><br><span class="line"><span class="actionscript">          <span class="comment">// this.fullname = this.firstname + '-' + this.lastname</span></span></span><br><span class="line"><span class="actionscript">          <span class="comment">// console.log(newVal + ' --- ' + oldVal)</span></span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">          <span class="keyword">this</span>.fullname = newVal + <span class="string">'-'</span> + <span class="keyword">this</span>.lastname</span></span><br><span class="line">        &#125;,</span><br><span class="line"><span class="actionscript">        <span class="string">'lastname'</span>: <span class="function"><span class="keyword">function</span> <span class="params">(newVal)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">          <span class="keyword">this</span>.fullname = <span class="keyword">this</span>.firstname + <span class="string">'-'</span> + newVal</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="9-9-3-使用watch监听路由地址的变化"><a href="#9-9-3-使用watch监听路由地址的变化" class="headerlink" title="9.9.3 使用watch监听路由地址的变化"></a>9.9.3 使用watch监听路由地址的变化</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 1. 导入包 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-router-3.0.1.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/login"</span>&gt;</span>登录<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"/register"</span>&gt;</span>注册<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 容器 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 2. 创建子组件</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> login = &#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">      template: '<span class="tag">&lt;<span class="name">h3</span>&gt;</span>这是登录子组件，这个组件是 奔波霸 开发的。<span class="tag">&lt;/<span class="name">h3</span>&gt;</span>'</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> register = &#123;</span></span><br><span class="line"><span class="handlebars"><span class="xml">      template: '<span class="tag">&lt;<span class="name">h3</span>&gt;</span>这是注册子组件，这个组件是 霸波奔 开发的。<span class="tag">&lt;/<span class="name">h3</span>&gt;</span>'</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 3. 创建一个路由对象</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> router = <span class="keyword">new</span> VueRouter(&#123;</span></span><br><span class="line">      routes: [ </span><br><span class="line"><span class="actionscript">     <span class="comment">// 路由规则数组</span></span></span><br><span class="line"><span class="actionscript">        &#123; path: <span class="string">'/'</span>, redirect: <span class="string">'/login'</span> &#125;,</span></span><br><span class="line"><span class="actionscript">        &#123; path: <span class="string">'/login'</span>, component: login &#125;,</span></span><br><span class="line"><span class="actionscript">        &#123; path: <span class="string">'/register'</span>, component: register &#125;</span></span><br><span class="line">      ],</span><br><span class="line"><span class="actionscript">      linkActiveClass: <span class="string">'myactive'</span> </span></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;&#125;,</span><br><span class="line">      methods: &#123;&#125;,</span><br><span class="line">      router,</span><br><span class="line">      watch: &#123;</span><br><span class="line"><span class="actionscript">        <span class="comment">//  this.$route.path</span></span></span><br><span class="line"><span class="actionscript">        <span class="string">'$route.path'</span>: <span class="function"><span class="keyword">function</span> <span class="params">(newVal, oldVal)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">          <span class="keyword">if</span> (newVal === <span class="string">'/login'</span>) &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'欢迎进入登录页面'</span>)</span></span><br><span class="line"><span class="actionscript">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (newVal === <span class="string">'/register'</span>) &#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(<span class="string">'欢迎进入注册页面'</span>)</span></span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="9-2-computer属性的使用"><a href="#9-2-computer属性的使用" class="headerlink" title="9.2 computer属性的使用"></a>9.2 computer属性的使用</h2><p>computer属性的作用：当前的属性值是由data中的其他若干属性值推导出来的</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"viewport"</span> <span class="attr">content</span>=<span class="string">"width=device-width, initial-scale=1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"ie=edge"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/vue-2.4.0.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"firstname"</span>&gt;</span> +</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"middlename"</span>&gt;</span> +</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"lastname"</span>&gt;</span> =</span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">v-model</span>=<span class="string">"fullname"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; fullname &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; fullname &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; fullname &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 创建 Vue 实例，得到 ViewModel</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span></span><br><span class="line"><span class="actionscript">      el: <span class="string">'#app'</span>,</span></span><br><span class="line">      data: &#123;</span><br><span class="line"><span class="actionscript">        firstname: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">        lastname: <span class="string">''</span>,</span></span><br><span class="line"><span class="actionscript">        middlename: <span class="string">''</span></span></span><br><span class="line">      &#125;,</span><br><span class="line">      methods: &#123;&#125;,</span><br><span class="line">      computed: &#123; </span><br><span class="line"><span class="actionscript">    <span class="comment">// 在computed中可以定义一些属性，这些属性叫做【计算属性】，计算属性的本质就是一个方法，只不过我们在使用这些计算属性的时候是把它们的名称直接当作属性来使用的，并不会把计算属性当作方法去调用</span></span></span><br><span class="line"></span><br><span class="line"><span class="actionscript">        <span class="comment">// 注意1： 计算属性在引用的时候，一定不要加()去调用，直接把它当作普通属性去使用就好了；</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">// 注意2： 在计算属性的function中所用到的任何data中的数据发送了变化，就会立即重新计算这个计算属性的值</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">// 注意3： 计算属性的求值结果会被缓存起来，方便下次直接使用。</span></span></span><br><span class="line"><span class="actionscript">        <span class="string">'fullname'</span>: <span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">          <span class="built_in">console</span>.log(<span class="string">'ok'</span>)</span></span><br><span class="line"><span class="actionscript">          <span class="keyword">return</span> <span class="keyword">this</span>.firstname + <span class="string">'-'</span> + <span class="keyword">this</span>.middlename + <span class="string">'-'</span> + <span class="keyword">this</span>.lastname</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="9-3-watch、computed和methods之间的对比"><a href="#9-3-watch、computed和methods之间的对比" class="headerlink" title="9.3 watch、computed和methods之间的对比"></a>9.3 watch、computed和methods之间的对比</h2><ol><li><code>computed</code>当前属性的值是依赖于其他属性的值求出来的，计算属性的结果会被缓存，除非依赖的属性变化才会重新计算，主要当作属性来使用；</li><li><code>methods</code>方法表示一个具体的操作，主要书写业务逻辑；</li><li><code>watch</code>一个对象，键是需要观察的表达式，值是对应回调函数。主要用来监听某些特定数据的变化，从而进行某些具体的业务逻辑操作;</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;1-Vue介绍&quot;&gt;&lt;a href=&quot;#1-Vue介绍&quot; class=&quot;headerlink&quot; title=&quot;1 Vue介绍&quot;&gt;&lt;/a&gt;1 Vue介绍&lt;/h1&gt;&lt;h2 id=&quot;1-1-为什么要学习流行框架&quot;&gt;&lt;a href=&quot;#1-1-为什么要学习流行框架&quot; cla
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>create-react-app的使用</title>
    <link href="http://yoursite.com/2020/04/10/create-react-app%E7%9A%84%E4%BD%BF%E7%94%A8/"/>
    <id>http://yoursite.com/2020/04/10/create-react-app%E7%9A%84%E4%BD%BF%E7%94%A8/</id>
    <published>2020-04-10T10:59:50.000Z</published>
    <updated>2020-04-17T06:06:32.246Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-creat-react-app使用"><a href="#1-creat-react-app使用" class="headerlink" title="1.creat-react-app使用"></a>1.creat-react-app使用</h1><p><a href="https://www.html.cn/create-react-app/docs/getting-started/" target="_blank" rel="noopener">https://www.html.cn/create-react-app/docs/getting-started/</a></p><p><code>Create React App</code>是FaceBook的React团队官方出的一个构建<code>React</code>单页面应用的脚手架工具。它本身集成了<code>Webpack</code>，并配置了一系列内置的<code>loader</code>和默认的npm的脚本，可以很轻松的实现零配置就可以快速开发React的应用。</p><h2 id="1-1-创建应用"><a href="#1-1-创建应用" class="headerlink" title="1.1 创建应用"></a>1.1 创建应用</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"># 全局安装</span><br><span class="line">npm install -g create-react-app</span><br><span class="line"># 构建一个my-app的项目</span><br><span class="line">npx create-react-app my-app</span><br><span class="line">cd my-app</span><br><span class="line"></span><br><span class="line"># 启动编译当前的React项目，并自动打开 http://localhost:3000/</span><br><span class="line">npm start</span><br><span class="line"></span><br><span class="line"># 如果你不能确保最新版本，可以先尝试卸载： npm uninstall -g create-react-app,然后再全局安装</span><br><span class="line"></span><br><span class="line"># 解压默认的webpack配置到配置文件中</span><br><span class="line"># react-scripts 是 create-react-app 的一个核心包，一些脚本和工具的默认配置都集成在里面，而 yarn eject 命令执行后会将封装在 create-react-app 中的配置全部反编译到当前项目，这样用户就能完全取得 webpack 文件的控制权。所以，eject 命令存在的意义就是更改 webpack 配置存在的啊！</span><br><span class="line">npm run eject</span><br><span class="line">npm install   <span class="comment">//需要再次运行install命令安装</span></span><br><span class="line">npm run start <span class="comment">//然后才可以启动</span></span><br></pre></td></tr></table></figure><pre><code>应用的目录结构：</code></pre><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">├── package.json</span><br><span class="line">├── public                  # 这个是webpack的配置的静态目录</span><br><span class="line">│   ├── favicon.ico</span><br><span class="line">│   ├── index.html          # 默认是单页面应用，这个是最终的html的基础模板</span><br><span class="line">│   └── manifest.json</span><br><span class="line">├── src</span><br><span class="line">│   ├── App.css             # App根组件的css</span><br><span class="line">│   ├── App.js              # App组件代码</span><br><span class="line">│   ├── App.test.js</span><br><span class="line">│   ├── index.css           # 启动文件样式</span><br><span class="line">│   ├── index.js            # 启动的文件（开始执行的入口）！！！！</span><br><span class="line">│   ├── logo.svg</span><br><span class="line">│   └── serviceWorker.js</span><br><span class="line">└── yarn.lock</span><br></pre></td></tr></table></figure><h2 id="1-2-启用sass"><a href="#1-2-启用sass" class="headerlink" title="1.2 启用sass"></a>1.2 启用sass</h2><p><a href="mailto:react-scripts@2.0.0">react-scripts@2.0.0</a> 以上版本才适用。</p><p>react-scripts主要设计原理是将配置好的如 <code>Webpack，Babel，ESLint</code> ，合并到 <code>react-scripts</code> 这npm包中，用户就可以开箱即用。很多开发者都在这基础上进行改造开发。注意 <code>react-scripts</code> 就是create-react-app脚手架的核心配置代码。</p><h3 id="1-2-1-安装依赖"><a href="#1-2-1-安装依赖" class="headerlink" title="1.2.1 安装依赖"></a>1.2.1 安装依赖</h3><p>要使用Sass必须首先安装   <code>node-sass</code></p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">// yarn config <span class="built_in">set</span> sass_binary_site http://cdn.npm.taobao.org/dist/node-sass -g</span><br><span class="line"></span><br><span class="line">$ npm install node-sass --save</span><br><span class="line">$ <span class="comment"># or</span></span><br><span class="line">$ yarn add node-sass</span><br></pre></td></tr></table></figure><p>安装完之后，我们就可以直接把原来的CSS文件后缀直接改为 <code>.scss</code> 或者<code>.sass</code>,然后组件中导入的文件不再是 css文件而给我scss文件即可。</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'./Store/Index'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;AddNumCreator, MinusNumCreator&#125; <span class="keyword">from</span> <span class="string">'./Store/ActionCreaters'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./App.scss'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div className=<span class="string">"App"</span>&gt;</span><br><span class="line">        &lt;header className=<span class="string">"App-header"</span>&gt;</span><br><span class="line">          &lt;h1&gt;潇洒&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>header&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br></pre></td></tr></table></figure><h3 id="1-2-2-在sass文件中引入其他sass文件"><a href="#1-2-2-在sass文件中引入其他sass文件" class="headerlink" title="1.2.2 在sass文件中引入其他sass文件"></a>1.2.2 在sass文件中引入其他sass文件</h3><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">@<span class="keyword">import</span> <span class="string">'styles/colors.scss'</span>;   <span class="comment">//这边路径以当前文件路径为参照</span></span><br></pre></td></tr></table></figure><h2 id="1-3-CSS-Modules支持"><a href="#1-3-CSS-Modules支持" class="headerlink" title="1.3 CSS Modules支持"></a>1.3 CSS Modules支持</h2><p>导入CSS文件或者Sass文件的时候，可以用一个变量接收一下返回值。那么就可以直接通过它来访问CSS或者Sass中的内部样式类了。比如：</p><ul><li>button.module.css</li></ul><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.error</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>Button.js</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> styles <span class="keyword">from</span> <span class="string">'./button.module.css'</span>;     <span class="comment">// Import css modules stylesheet as styles</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Button</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="comment">// reference as a js object</span></span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">&#123;styles.error&#125;</span>&gt;</span>Error Button<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- This button has red background --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"Button_error_ax7yz"</span>&gt;</span>Error Button<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="1-4-环境变量"><a href="#1-4-环境变量" class="headerlink" title="1.4 环境变量"></a>1.4 环境变量</h2><p>巧妙的使用环境变量可以帮我们在项目中区分开生产环境还是编译环境，从而执行不同的代码。</p><h3 id="1-4-1-添加自定义环境变量文件-env"><a href="#1-4-1-添加自定义环境变量文件-env" class="headerlink" title="1.4.1 添加自定义环境变量文件.env"></a>1.4.1 添加自定义环境变量文件<code>.env</code></h3><p>项目根目录下创建<code>.env</code>文件，文件内部添加 <code>key=value</code>的配置可以直接应用于项目的编译中。</p><figure class="highlight sh"><table><tr><td class="code"><pre><span class="line">REACT_APP_WEBSITE_NAME=myapp</span><br><span class="line">REACT_APP_PUBLIC_URL=localhost:3000</span><br></pre></td></tr></table></figure><blockquote><p>Note: 如果创建自定义的环境变量必须以<code>REACT_APP_</code>开头.</p></blockquote><h3 id="1-4-2-在项目中使用环境变量"><a href="#1-4-2-在项目中使用环境变量" class="headerlink" title="1.4.2 在项目中使用环境变量"></a>1.4.2 在项目中使用环境变量</h3><p>在项目中可以直接用<code>process.env.XXX</code>访问我们的自定义的环境变量。比如：</p><ul><li>js中使用</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;small&gt;You are running <span class="keyword">this</span> application <span class="keyword">in</span> &lt;b&gt;&#123;process.env.NODE_ENV&#125;&lt;<span class="regexp">/b&gt; mode.&lt;/</span>small&gt;</span><br><span class="line">      &lt;form&gt;</span><br><span class="line">        &lt;input type=<span class="string">"text"</span> defaultValue=&#123;process.env.REACT_APP_WEBSITE_NAME&#125; /&gt;</span><br><span class="line">        &lt;img src=&#123;process.env.REACT_APP_PUBLIC_URL + <span class="string">'/img/logo.png'</span>&#125; /&gt;;</span><br><span class="line">      &lt;<span class="regexp">/form&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//再比如：判断是否是生产环境</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (process.env.NODE_ENV !== <span class="string">'production'</span>) &#123;</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">"development"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>HTML中使用</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;title&gt;%REACT_APP_WEBSITE_NAME%&lt;&#x2F;title&gt;</span><br></pre></td></tr></table></figure><h2 id="1-5-添加图片，字体和文件"><a href="#1-5-添加图片，字体和文件" class="headerlink" title="1.5 添加图片，字体和文件"></a>1.5 添加图片，字体和文件</h2><p>使用 Webpack，添加图片和字体等静态资源的工作方式与 CSS 类似。</p><p>你可以 <strong>直接在 JavaScript 模块中 import 文件</strong>。 这会告诉 Webpack 将该文件包含在 bundle(包) 中。 与 CSS 导入不同，导入文件会为你提供字符串值。 此值是你可以在代码中引用的最终路径，例如 image 的 <code>src</code> 属性或链接到 PDF 的 <code>href</code> 属性。</p><p>要减少对服务器的请求数，导入小于 10,000 字节的图片将返回 <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URIs" target="_blank" rel="noopener">data URI</a> 而不是路径。 这适用于以下文件扩展名：<code>bmp</code> ，<code>gif</code> ，<code>jpg</code> ，<code>jpeg</code> 和 <code>png</code> 。</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//例如：</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">'./logo.png'</span>; <span class="comment">// 告诉 Webpack 这个 JS 文件使用了这个图片</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(logo); <span class="comment">// /logo.84287d09.png</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Header</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 导入结果是图片的 URL </span></span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&#123;logo&#125;</span> <span class="attr">alt</span>=<span class="string">"Logo"</span> /&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Header;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//这也适用于 CSS ：</span></span><br><span class="line">.Logo &#123;</span><br><span class="line">  background-image: url(./logo.png);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//字体图标的使用</span></span><br><span class="line"><span class="comment">//yarn add font-awesome</span></span><br><span class="line"><span class="comment">//引入样式</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'font-awesome/css/font-awesome.css'</span></span><br><span class="line"><span class="comment">//使用样式</span></span><br><span class="line">&lt;i <span class="class"><span class="keyword">class</span></span>=<span class="string">"fa fa-address-book"</span> aria-hidden=<span class="string">"true"</span>&gt;&lt;<span class="regexp">/i&gt; </span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/具体使用参照官网：http:/</span><span class="regexp">/www.fontawesome.com.cn/</span>faicons/</span><br></pre></td></tr></table></figure><h2 id="1-6-使用Boostrap"><a href="#1-6-使用Boostrap" class="headerlink" title="1.6 使用Boostrap"></a>1.6 使用Boostrap</h2><p>从 npm 安装 reactstrap 和 Bootstrap 。 reactstrap 不包括 Bootstrap CSS 所以这也需要安装：</p><pre><code>yarn add reactstrap bootstrap@4.0.0  </code></pre><p>在 <code>src/index.js</code> 文件的开头导入 Bootstrap CSS 和可选的 Bootstrap 主题 CSS ：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">'bootstrap/dist/css/bootstrap.css'</span>;</span><br><span class="line"><span class="comment">// 在下面放置任何其他导入，</span></span><br><span class="line"><span class="comment">// 以便组件中的CSS优先于默认样式。</span></span><br></pre></td></tr></table></figure><p>在 <code>src/App.js</code> 文件或自定义组件文件中导入所需的 reactstrap 组件：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Button &#125; <span class="keyword">from</span> <span class="string">'reactstrap'</span>;</span><br></pre></td></tr></table></figure><h2 id="1-7-启用less、取别名"><a href="#1-7-启用less、取别名" class="headerlink" title="1.7 启用less、取别名"></a>1.7 启用less、取别名</h2><p>由于 create-react-app 脚手架中并没有配置关于 less 文件的解析，正常情况下我们也不会通过yarn reject暴露配置文件然后修改配置文件，我们可以在项目根目录下新建一个config-overrides.js配置文件，覆盖默认的配置</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span>yarn add react-app-rewired customize-cra</span><br><span class="line"><span class="number">2.</span>在项目根目录下创建一个config-overrides.js</span><br><span class="line"><span class="number">3.</span>  yarn add less less-loader</span><br><span class="line"><span class="number">4.</span>  修改package.json</span><br><span class="line">    <span class="string">"scripts"</span>: &#123;</span><br><span class="line">        - <span class="string">"start"</span>: <span class="string">"react-scripts start"</span>,</span><br><span class="line">        + <span class="string">"start"</span>: <span class="string">"react-app-rewired start"</span>,</span><br><span class="line">        - <span class="string">"build"</span>: <span class="string">"react-scripts build"</span>,</span><br><span class="line">        + <span class="string">"build"</span>: <span class="string">"react-app-rewired build"</span>,</span><br><span class="line">        - <span class="string">"test"</span>: <span class="string">"react-scripts test"</span>,</span><br><span class="line">        + <span class="string">"test"</span>: <span class="string">"react-app-rewired test"</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//  修改config-overrides.js文件</span></span><br><span class="line"><span class="comment">//  http://npm.taobao.org/package/customize-cra</span></span><br><span class="line"><span class="comment">//  https://blog.csdn.net/weixin_33850890/article/details/91372527</span></span><br><span class="line"></span><br><span class="line">        </span><br><span class="line"><span class="comment">// 配置less和@符号</span></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">"path"</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;</span><br><span class="line">    override,</span><br><span class="line">    addWebpackAlias,</span><br><span class="line">    addLessLoader</span><br><span class="line">&#125; = <span class="built_in">require</span>(<span class="string">"customize-cra"</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = override(</span><br><span class="line">    addLessLoader(),</span><br><span class="line">    addWebpackAlias(&#123;</span><br><span class="line">        [<span class="string">"@"</span>]: path.resolve(__dirname, <span class="string">"src"</span>)</span><br><span class="line">    &#125;),</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h2 id="1-8-其他react的默认配置"><a href="#1-8-其他react的默认配置" class="headerlink" title="1.8 其他react的默认配置"></a>1.8 其他react的默认配置</h2><ul><li>直接可以使用sass（安装node-sass模块后）</li><li>直接可以使用css（import）</li><li>直接可以导入 图片、svg、字体文件等，已经配置好相应的loader</li><li>ES67代码直接可以用 <ul><li>class</li><li>箭头函数</li><li>私用变量</li><li>静态属性</li><li>继承</li><li>装饰器（XXX不能用）</li></ul></li></ul><h1 id="2-AntDesgin使用"><a href="#2-AntDesgin使用" class="headerlink" title="2.AntDesgin使用"></a>2.AntDesgin使用</h1><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$ yarn add babel-plugin-<span class="keyword">import</span></span><br><span class="line">$ yarn add antd</span><br><span class="line"></span><br><span class="line"><span class="comment">//修改config-overrides.js</span></span><br><span class="line">+ <span class="keyword">const</span> &#123; override, fixBabelImports &#125; = <span class="built_in">require</span>(<span class="string">'customize-cra'</span>);</span><br><span class="line">+ <span class="built_in">module</span>.exports = override(</span><br><span class="line">+   fixBabelImports(<span class="string">'import'</span>, &#123;</span><br><span class="line">+     libraryName: <span class="string">'antd'</span>,</span><br><span class="line">+     libraryDirectory: <span class="string">'es'</span>,</span><br><span class="line">+     style: <span class="string">'css'</span>,</span><br><span class="line">+   &#125;),</span><br><span class="line">+ );</span><br></pre></td></tr></table></figure><p>然后移除前面在 <code>src/App.css</code> 里全量添加的 <code>@import &#39;~antd/dist/antd.css&#39;;</code> 样式代码，并且按下面的格式引入模块。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">  <span class="comment">// src/App.js</span></span><br><span class="line">  <span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line">- <span class="keyword">import</span> Button <span class="keyword">from</span> <span class="string">'antd/es/button'</span>;</span><br><span class="line">+ <span class="keyword">import</span> &#123; Button &#125; <span class="keyword">from</span> <span class="string">'antd'</span>;</span><br><span class="line">  <span class="keyword">import</span> <span class="string">'./App.css'</span>;</span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        &lt;div className=<span class="string">"App"</span>&gt;</span><br><span class="line">          &lt;Button type=<span class="string">"primary"</span>&gt;Button&lt;<span class="regexp">/Button&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>div&gt;</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span> App;</span><br></pre></td></tr></table></figure><p>最后重启 <code>yarn start</code> 访问页面，antd 组件的 js 和 css 代码都会按需加载</p><h1 id="3-Flux和Redux"><a href="#3-Flux和Redux" class="headerlink" title="3.Flux和Redux"></a>3.Flux和Redux</h1><h2 id="3-1-常用软件架构思想"><a href="#3-1-常用软件架构思想" class="headerlink" title="3.1 常用软件架构思想"></a>3.1 常用软件架构思想</h2><h3 id="a-MVC"><a href="#a-MVC" class="headerlink" title="a) MVC"></a>a) MVC</h3><p><strong>Model</strong></p><blockquote><p>Model负责保存应用数组，和后端交互同步应用数据，或校验数据。Model主要与业务数据相关，与应用内交互状态无关</p></blockquote><p><strong>View</strong></p><blockquote><p>View是Model的可视化，表示当前状态的视图。前端View负责构建和维护DOM元素。更新Model的实际任务是在Controller上。用户可以与View交互，包括读取和编辑Model，在Model中获取或设置属性值。<em>一个view通常对应一个model，所以在世实际开发过程中，会面临多个view对应多个model的状况</em></p></blockquote><p><strong>Controller</strong></p><blockquote><p>Controller负责连接view和model，model的任何变化会应用到view中，view的操作会痛殴controller应用到model中。</p></blockquote><p>MVC有两个很明显的问题：</p><pre><code>1.m层和v层直接打交道，导致这两层耦合度高2.因为所有逻辑都写在c层，导致c层特别臃肿</code></pre><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn1XyhLI/uUnjQtxoKSmXQ5.YSnl4gEgb4NQimyPKWp19A*AGOxTuyjada5SFEAg0L*v7r2gi1FHAlr63hxDhiDOaQEBJ2w!!/b&bo=iAJ0AYgCdAEDCSw!&rf=viewer_4"  alt="1553222527572"></p><h3 id="b-MVVM"><a href="#b-MVVM" class="headerlink" title="b) MVVM"></a>b) MVVM</h3><p>近年来前端一个明显的开发趋势就是架构从传统的 MVC 模式向 MVVM 模式迁移。在传统的 MVC 下，当前前端和后端发生数据交互后会刷新整个页面，从而导致比较差的用户体验。因此我们通过 Ajax 的方式和网关 REST API 作通讯，异步的刷新页面的某个区块，来优化和提升体验。</p><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn1XyhLI/43eWRH6lLSncPe1pJhVzbc4UUbPGnQsIbB43D8pCUIB2MS27beZ7mb1xQb4rGIXtgNiiXEWPzuo3VRCggo8E1NhRwETHKcv5zI0p7uSriWY!/b&bo=qgIAAaoCAAEDGTw!&rf=viewer_4"  alt="1553222636183"></p><p>在 MVVM 框架中，View(视图) 和 Model(数据) 是不可以直接通讯的，在它们之间存在着 ViewModel 这个中间介充当着观察者的角色。当用户操作 View(视图)，ViewModel 感知到变化，然后通知 Model 发生相应改变；反之当 Model(数据) 发生改变，ViewModel 也能感知到变化，使 View 作出相应更新。这个一来一回的过程就是我们所熟知的双向绑定。</p><h3 id="c-Flux"><a href="#c-Flux" class="headerlink" title="c) Flux"></a>c) Flux</h3><p>Flux 是一种架构思想，专门解决软件的结构问题。它跟<a href="http://www.ruanyifeng.com/blog/2007/11/mvc.html" target="_blank" rel="noopener">MVC 架构</a>是同一类东西，但是更加<a href="http://www.infoq.com/news/2014/05/facebook-mvc-flux" target="_blank" rel="noopener">简单和清晰</a>。</p><p>首先，Flux将一个应用分成四个部分。</p><blockquote><ul><li><strong>View</strong>： 视图层</li><li><strong>Action</strong>（动作）：视图层发出的消息（比如mouseClick）。然后在mouseClick中将出现数据从应用程序发送到store的有效信息负载。可以将其理解为用户的某个操作而做出的反应，是改变store数据的唯一方法</li><li><strong>Dispatcher</strong>（派发器）：用来接收Actions、执行回调函数</li><li><strong>Store</strong>（数据层）：用来存放应用的状态，一旦发生变动，就提醒Views要更新页面</li></ul></blockquote><p><strong>Flux 的最大特点，就是数据的”单向流动”。</strong></p><blockquote><ol><li>用户访问 View</li><li>View 发出用户的 Action</li><li>Dispatcher 收到 Action，要求 Store 进行相应的更新</li><li>Store 更新后，发出一个”change”事件</li><li>View 收到”change”事件后，更新页面</li></ol></blockquote><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn1XyhLI/43eWRH6lLSncPe1pJhVzbc05dt7kYMr.PS.Uegs5R8C*vKLOxhBwxGRHH5k2bJB79TXR0g.zVVSK*q*kwdEGe8XKX6XMN3XOPTQcJO.nAsk!/b&bo=WAK2AFgCtgADGTw!&rf=viewer_4"  alt="1553222968163"></p><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn1XyhLI/43eWRH6lLSncPe1pJhVzbfqolJ8OdQvDiFJTQzt65TlKcmvBI8saygf*srVUZSzI7vRlQEUiw00vVG1nJRa6hJFpvjVcc4koKoDnM8fRNyQ!/b&bo=3AKFAdwChQEDKQw!&rf=viewer_4"  alt="1553223019430"></p><h2 id="3-2-Redux"><a href="#3-2-Redux" class="headerlink" title="3.2 Redux"></a>3.2 Redux</h2><p><a href="http://cn.redux.js.org/" target="_blank" rel="noopener">http://cn.redux.js.org/</a></p><h3 id="a-Redux介绍"><a href="#a-Redux介绍" class="headerlink" title="a) Redux介绍"></a>a) Redux介绍</h3><p>我们把Flux看做一个框架的理念的话，Redux是Flux的一种实现。Redux是SPA单页面应用程序中多个组件之间共享数据的一种方式。</p><p>Flux的基本原则是“单向数据流”，Redux在此基础上强调三个基本原则：<br>1.唯一数据源 ：唯一数据源指的是应用的状态数据应该只存储在唯一的一个Store上。<br>2.保持状态只读 ： 保持状态只读，就是说不能去直接修改状态，要修改Store的状态，必须要通过派发一个action对象完成。<br>3.数据改变只能通过纯函数完成 ：这里所说的纯函数就是把Reducer，Reducer描述了state状态如何修改。Redux这个名字的前三个字母Red代表的就是Reducer，其实Redux名字的含义就是Reducer+Flux。</p><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn1XyhLI/43eWRH6lLSncPe1pJhVzbdOf.Nk*em2bEeH32K58x4JVzccPBx6nveptqCSV86kK0crvJcsiee9hJ0H50rSZTZMpAI8g237*roNjpcwYY5k!/b&bo=*QLYAf0C2AEDGTw!&rf=viewer_4"  alt="1553225378607"></p><h3 id="b-Redux的基本使用"><a href="#b-Redux的基本使用" class="headerlink" title="b) Redux的基本使用"></a>b) Redux的基本使用</h3><p>React和Redux事实上是两个独立的产品，一个应用可以使用React而不使用Redux，也可以使用Redux而不使用React，但是如果两者结合使用，没有理由不使用一个名为react-dedux的库，这个库能大大简化代码的书写。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install redux --save</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#1.main.js</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>                        <span class="comment">// 创建组件、虚拟DOM元素，生命周期</span></span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>      <span class="comment">// 把创建好的 组件 和 虚拟DOM 放到页面上展示的</span></span><br><span class="line"><span class="keyword">import</span> &#123; createStore &#125; <span class="keyword">from</span> <span class="string">'redux'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">"./app.jsx"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 1.创建reducer</span></span><br><span class="line"><span class="comment">    这是一个 reducer，形式为 (state, action) =&gt; state 的纯函数.。描述了 action 如何把 state 转变成下一个 state。</span></span><br><span class="line"><span class="comment">    state 的形式取决于你，可以是基本类型、数组、对象、甚至是 Immutable.js 生成的数据结构。惟一的要点是当 state 变化时需要返回全新的对象，而不是修改传入的参数。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">counter</span>(<span class="params">state = <span class="number">0</span>, action</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'ADD'</span>:</span><br><span class="line">            <span class="keyword">return</span> state + <span class="number">1</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">'MINUS'</span>:</span><br><span class="line">            <span class="keyword">return</span> state - <span class="number">1</span></span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> state</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.声明 actions</span></span><br><span class="line"><span class="comment">//action 是改变 state 的唯一途径，是一个普通的 javascript 对象，它描述了一个行为且是改变 state 的唯一途径。从用户UI操作事件、网络请求回调和 WebSocket 等其他地方获得的数据，最终都会通过 dispatch 函数调用一个 action，从而改变对应的数据。action 必须带有 type 指明具体的行为名称，且能附带上额外的信息。</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addFn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">type</span>:<span class="string">'ADD'</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">minusFn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">type</span>:<span class="string">'MINUS'</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.创建 Redux store 来存放应用的状态。store对象的API 有 &#123; subscribe, dispatch, getState &#125;。</span></span><br><span class="line"><span class="keyword">let</span> store = createStore(counter)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 4.订阅更新，监听state的变化</span></span><br><span class="line">store.subscribe(<span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(store.getState()))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5.触发action</span></span><br><span class="line">store.dispatch(addFn())  <span class="comment">// 1</span></span><br><span class="line">store.dispatch(addFn())  <span class="comment">// 2</span></span><br><span class="line">store.dispatch(minusFn())  <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 6.渲染页面</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">App</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span> <span class="attr">addFn</span>=<span class="string">&#123;addFn&#125;</span> <span class="attr">minusFn</span>=<span class="string">&#123;minusFn&#125;/</span>&gt;</span></span>, <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>));</span><br><span class="line">&#125;</span><br><span class="line">render()</span><br><span class="line"><span class="comment">// 每当state状态发生变化的时候，重新渲染页面</span></span><br><span class="line">store.subscribe(render)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">#2.app.jsx</span><br><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> store=<span class="keyword">this</span>.props.store</span><br><span class="line">        <span class="keyword">const</span> addFn=<span class="keyword">this</span>.props.addFn</span><br><span class="line">        <span class="keyword">const</span> minusFn=<span class="keyword">this</span>.props.minusFn</span><br><span class="line">        <span class="keyword">const</span> init=store.getState()</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div className=<span class="string">"App"</span>&gt;</span><br><span class="line">                &lt;h1&gt;你好吗？&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">                &#123;&lt;p&gt;现在的总数是：&#123;store.getState()&#125;&lt;/</span>p&gt;&#125;</span><br><span class="line">                &#123;&lt;button onClick=&#123; ()=&gt;store.dispatch( addFn() ) &#125;&gt;加<span class="number">1</span>&lt;<span class="regexp">/button&gt;&#125;</span></span><br><span class="line"><span class="regexp">                &#123;&lt;button onClick=&#123; ()=&gt;store.dispatch( minusFn() ) &#125;&gt;减1&lt;/</span>button&gt;&#125;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        );</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">export default App;</span></span><br></pre></td></tr></table></figure><h3 id="c-redux异步处理"><a href="#c-redux异步处理" class="headerlink" title="c) redux异步处理"></a>c) redux异步处理</h3><p> redux默认情况下只处理同步，想要处理异步，需要上面安装的redux-thunk插件</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">npm install redux-thunk -S</span><br><span class="line"></span><br><span class="line">#1.修改main.js 代码 </span><br><span class="line"><span class="keyword">import</span> &#123; createStore ,applyMiddleware &#125; <span class="keyword">from</span> <span class="string">'redux'</span>;</span><br><span class="line"><span class="keyword">import</span> thunk <span class="keyword">from</span> <span class="string">'redux-thunk'</span></span><br><span class="line"><span class="comment">//使用applyMiddleware在创建store的时候开启中间件</span></span><br><span class="line"><span class="keyword">const</span> store=createStore(couter ,applyMiddleware(thunk))</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addFn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">type</span>:<span class="string">'ADD'</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">minusFn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">type</span>:<span class="string">'MINUS'</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">addAsynFn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">dispatch</span>=&gt;</span>&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">            dispatch(addFn())</span><br><span class="line">        &#125;,<span class="number">2000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">App</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span> <span class="attr">addFn</span>=<span class="string">&#123;addFn&#125;</span> <span class="attr">minusFn</span>=<span class="string">&#123;minusFn&#125;</span> <span class="attr">addAsyncFn</span>=<span class="string">&#123;addAsynFn&#125;/</span>&gt;</span></span>, <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>));</span><br><span class="line">&#125;</span><br><span class="line">                    </span><br><span class="line">#2.修改app.jsx代码</span><br><span class="line">render() &#123;</span><br><span class="line">        <span class="keyword">const</span> store=<span class="keyword">this</span>.props.store</span><br><span class="line">        <span class="keyword">const</span> addFn=<span class="keyword">this</span>.props.addFn</span><br><span class="line">        <span class="keyword">const</span> minusFn=<span class="keyword">this</span>.props.minusFn</span><br><span class="line">        <span class="keyword">const</span> addAsynFn=<span class="keyword">this</span>.props.addAsyncFn</span><br><span class="line">        <span class="built_in">console</span>.log(addAsynFn)</span><br><span class="line">        <span class="keyword">const</span> init=store.getState()</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div className=<span class="string">"App"</span>&gt;</span><br><span class="line">                &lt;h1&gt;你好吗？&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">                &#123;&lt;p&gt;现在的总数是：&#123;store.getState()&#125;&lt;/</span>p&gt;&#125;</span><br><span class="line">                &#123;&lt;button onClick=&#123; ()=&gt;store.dispatch( addFn() ) &#125;&gt;加<span class="number">1</span>&lt;<span class="regexp">/button&gt;&#125;</span></span><br><span class="line"><span class="regexp">                &#123;&lt;button onClick=&#123; ()=&gt;store.dispatch( minusFn() ) &#125;&gt;减1&lt;/</span>button&gt;&#125;</span><br><span class="line">                &#123;&lt;button onClick=&#123; ()=&gt;store.dispatch( addAsynFn() ) &#125;&gt;异步加<span class="number">1</span>&lt;<span class="regexp">/button&gt;&#125;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h3 id="d-抽离main-js中的reducer和actions到单独模块"><a href="#d-抽离main-js中的reducer和actions到单独模块" class="headerlink" title="d) 抽离main.js中的reducer和actions到单独模块"></a>d) 抽离main.js中的reducer和actions到单独模块</h3><figure class="highlight"><table><tr><td class="code"><pre><span class="line">#1.reducers/index.js</span><br><span class="line"><span class="comment">//1.创建reducer,描述了如何根据action将state修改为下一个state</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">counter</span>(<span class="params">state = <span class="number">0</span>, action</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'ADD'</span>:</span><br><span class="line">            <span class="keyword">return</span> state + <span class="number">1</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">'MINUS'</span>:</span><br><span class="line">            <span class="keyword">return</span> state - <span class="number">1</span></span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> state</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#2.actions/action.js</span><br><span class="line"><span class="comment">//2.声明 actions</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">addFn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">type</span>:<span class="string">'ADD'</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">minusFn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">type</span>:<span class="string">'MINUS'</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">addAsynFn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">dispatch</span>=&gt;</span>&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">            dispatch(addFn())</span><br><span class="line">        &#125;,<span class="number">2000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#3.main.js</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>                        <span class="comment">// 创建组件、虚拟DOM元素，生命周期</span></span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>      <span class="comment">// 把创建好的 组件 和 虚拟DOM 放到页面上展示的</span></span><br><span class="line"><span class="keyword">import</span> &#123; createStore,applyMiddleware  &#125; <span class="keyword">from</span> <span class="string">'redux'</span></span><br><span class="line"><span class="keyword">import</span> thunk <span class="keyword">from</span> <span class="string">'redux-thunk'</span></span><br><span class="line"><span class="keyword">import</span> &#123; counter &#125; <span class="keyword">from</span> <span class="string">'./reducers/index'</span></span><br><span class="line"><span class="keyword">import</span> &#123;addFn,minusFn,addAsynFn&#125; <span class="keyword">from</span> <span class="string">'./actions/action'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">"./app.jsx"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.创建 Redux store 来存放应用的状态。store对象的API 有 &#123; subscribe, dispatch, getState &#125;。</span></span><br><span class="line"><span class="keyword">let</span> store = createStore(counter,applyMiddleware(thunk))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 4.订阅更新，监听state的变化</span></span><br><span class="line">store.subscribe(<span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(store.getState()))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 5.触发action</span></span><br><span class="line">store.dispatch(addFn())  <span class="comment">// 1</span></span><br><span class="line">store.dispatch(addFn())  <span class="comment">// 2</span></span><br><span class="line">store.dispatch(minusFn())  <span class="comment">// 1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 6.渲染页面</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">App</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span> <span class="attr">addFn</span>=<span class="string">&#123;addFn&#125;</span> <span class="attr">minusFn</span>=<span class="string">&#123;minusFn&#125;</span> <span class="attr">addAsyncFn</span>=<span class="string">&#123;addAsynFn&#125;/</span>&gt;</span></span>, <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>));</span><br><span class="line">&#125;</span><br><span class="line">render()</span><br><span class="line"><span class="comment">// 每当state状态发生变化的时候，重新渲染页面</span></span><br><span class="line">store.subscribe(render)</span><br><span class="line">    </span><br><span class="line">#4. app.jsx 没有变化</span><br></pre></td></tr></table></figure><h3 id="e-react和redux的结合使用"><a href="#e-react和redux的结合使用" class="headerlink" title="e) react和redux的结合使用"></a>e) react和redux的结合使用</h3><p>1.插件：react-redux</p><p>2.不适用subscribe发布事件</p><p>3.提供provider和connect两个接口</p><pre><code>provider作用：如果我们手动将state对象一层一层的传入容器组件应用。小还好说，大应用深层的组件简直累死了，绝对让你传到怀疑人生。react-redux提供了Provider组件让我们省了不少功夫，用法就是在我们根组件外部嵌套一层Provider，传入store （使用全局的store有风险）这样所以的子组件都可以开心地拿到state了 。Provider接受store作为其props，并声明为context的属性之一 。子组件在声明了contextTypes之后可以通过this.context.store访问到store。connect用于连接 React 组件与 Redux store。连接操作不会改变原来的组件类。反而返回一个新的已与 Redux store 连接的组件类。不过现在我们仅仅是通过展示组件生成了一个容器组件并且将它们连接了起来，但是容器组件中并没有数据和逻辑，只是一具空壳毫无意义，所以我们还需要向这个connect函数中传入两个参数。mapStateToProps负责将state的数据映射到展示组件的this.props。mapDispatchToProps负责定义发送action的函数映射到展示组件的this.props。</code></pre><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">npm install react-redux --save</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#1.main.js</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>                        <span class="comment">// 创建组件、虚拟DOM元素，生命周期</span></span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>      <span class="comment">// 把创建好的 组件 和 虚拟DOM 放到页面上展示的</span></span><br><span class="line"><span class="keyword">import</span> &#123; createStore,applyMiddleware &#125; <span class="keyword">from</span> <span class="string">'redux'</span></span><br><span class="line"><span class="keyword">import</span> thunk <span class="keyword">from</span> <span class="string">'redux-thunk'</span></span><br><span class="line"><span class="keyword">import</span> &#123; counter &#125; <span class="keyword">from</span> <span class="string">'./reducers/index'</span></span><br><span class="line"><span class="keyword">import</span> &#123; Provider &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">"./app.jsx"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3.创建 Redux store 来存放应用的状态。store对象的API 有 &#123; subscribe, dispatch, getState &#125;。</span></span><br><span class="line"><span class="keyword">let</span> store = createStore(counter,applyMiddleware(thunk))</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4.订阅更新，监听state的变化</span></span><br><span class="line">store.subscribe(<span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(store.getState()))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">    &lt;Provider store=&#123;store&#125;&gt;</span><br><span class="line">        &lt; App /&gt;</span><br><span class="line">    &lt;<span class="regexp">/Provider&gt;</span></span><br><span class="line"><span class="regexp">    , document.getElementById('app'));</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">#2.app.jsx</span></span><br><span class="line"><span class="regexp">import React, &#123; Component &#125; from 'react';</span></span><br><span class="line"><span class="regexp">import &#123; connect &#125; from 'react-redux'</span></span><br><span class="line"><span class="regexp">import &#123;addFn,minusFn,addAsynFn&#125; from './</span>actions/action<span class="string">'</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">class App extends Component &#123;</span></span><br><span class="line"><span class="string">    constructor(props)&#123;</span></span><br><span class="line"><span class="string">        super(props)</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    render() &#123;</span></span><br><span class="line"><span class="string">        const num=this.props.num</span></span><br><span class="line"><span class="string">        const addFn=this.props.addFn</span></span><br><span class="line"><span class="string">        const minusFn=this.props.minusFn</span></span><br><span class="line"><span class="string">        const addAsynFn=this.props.addAsynFn</span></span><br><span class="line"><span class="string">        console.log(addAsynFn)</span></span><br><span class="line"><span class="string">        return (</span></span><br><span class="line"><span class="string">            &lt;div className="App"&gt;</span></span><br><span class="line"><span class="string">                &lt;h1&gt;你好吗？&lt;/h1&gt;</span></span><br><span class="line"><span class="string">                &#123;&lt;p&gt;现在的总数是：&#123;num&#125;&lt;/p&gt;&#125;</span></span><br><span class="line"><span class="string">                &#123;&lt;button onClick=&#123; addFn &#125;&gt;加1&lt;/button&gt;&#125;</span></span><br><span class="line"><span class="string">                &#123;&lt;button onClick=&#123; minusFn &#125;&gt;减1&lt;/button&gt;&#125;</span></span><br><span class="line"><span class="string">                &#123;&lt;button onClick=&#123; addAsynFn &#125;&gt;异步加1&lt;/button&gt;&#125;</span></span><br><span class="line"><span class="string">            &lt;/div&gt;</span></span><br><span class="line"><span class="string">        );</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">//将state状态映射到属性里面,之后可以通过props获取</span></span><br><span class="line"><span class="string">const mapStatetoProps=(state)=&gt;&#123;</span></span><br><span class="line"><span class="string">    return &#123;num:state&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">//addFn 自动有了dispatch的功能 onClick=&#123;addFn&#125; ; addFn  minusFn  minusFn会被映射到props里面</span></span><br><span class="line"><span class="string">const mapDispatchToProps=&#123;addFn,minusFn,addAsynFn&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">//为App组件提供数据和逻辑。mapStateToProps负责将state的数据映射到展示组件的this.props。mapDispatchToProps负责定义发送action的函数映射到展示组件的this.props</span></span><br><span class="line"><span class="string">App=connect(mapStatetoProps,mapDispatchToProps)(App)</span></span><br><span class="line"><span class="string">export default App;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#3.其他 reducers/index.js 和 actions/action.js 无变化</span></span><br></pre></td></tr></table></figure><h3 id="f-多个reducer之间的合并问题"><a href="#f-多个reducer之间的合并问题" class="headerlink" title="f) 多个reducer之间的合并问题"></a>f) 多个reducer之间的合并问题</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#1. reducers/counter.js</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">counter</span>(<span class="params">state = <span class="number">0</span>, action</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'ADD'</span>:</span><br><span class="line">            <span class="keyword">return</span> state + <span class="number">1</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">'MINUS'</span>:</span><br><span class="line">            <span class="keyword">return</span> state - <span class="number">1</span></span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> state</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#2. reducers/city.js</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">location</span>(<span class="params">state = <span class="string">'无锡'</span>, action</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'CHOOSECITY'</span>:</span><br><span class="line">            <span class="keyword">return</span> action.city</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> state</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#3. reducers/index.js</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123;combineReducers&#125; <span class="keyword">from</span> <span class="string">'redux'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//redux提供的用于多个reducer合并的方法</span></span><br><span class="line"><span class="comment">// 里面是个对象。罗列需要合并的reducer</span></span><br><span class="line"><span class="keyword">import</span> counter <span class="keyword">from</span> <span class="string">'./counter'</span>;  <span class="comment">//项目中需要的reducer</span></span><br><span class="line"><span class="keyword">import</span> city <span class="keyword">from</span> <span class="string">'./city'</span>;   <span class="comment">//项目中需要的reducer</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(combineReducers)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> combineReducers(&#123;counter,city&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#4.actions/action.js</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">addFn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">type</span>:<span class="string">'ADD'</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">minusFn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">type</span>:<span class="string">'MINUS'</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*该action接收参数，在dispatch当前action的时候可以传递参数*/</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">changeCityFn</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">type</span>:<span class="string">'CHOOSECITY'</span>,<span class="attr">city</span>:name &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">addAsynFn</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">dispatch</span>=&gt;</span>&#123;</span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">            dispatch(addFn())</span><br><span class="line">        &#125;,<span class="number">2000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#5. main.js</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>                        <span class="comment">// 创建组件、虚拟DOM元素，生命周期</span></span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>      <span class="comment">// 把创建好的 组件 和 虚拟DOM 放到页面上展示的</span></span><br><span class="line"><span class="keyword">import</span> &#123; createStore,applyMiddleware &#125; <span class="keyword">from</span> <span class="string">'redux'</span></span><br><span class="line"><span class="keyword">import</span> thunk <span class="keyword">from</span> <span class="string">'redux-thunk'</span></span><br><span class="line"><span class="keyword">import</span> reducer <span class="keyword">from</span> <span class="string">'./reducers/index'</span></span><br><span class="line"><span class="keyword">import</span> &#123; Provider &#125; <span class="keyword">from</span> <span class="string">'react-redux'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">"./app.jsx"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> store = createStore(reducer,applyMiddleware(thunk))</span><br><span class="line"></span><br><span class="line">store.subscribe(<span class="function"><span class="params">()</span> =&gt;</span> <span class="built_in">console</span>.log(store.getState()))</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">    (<span class="xml"><span class="tag">&lt;<span class="name">Provider</span> <span class="attr">store</span>=<span class="string">&#123;store&#125;</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt; <span class="attr">App</span> /&gt;</span></span></span><br><span class="line">    &lt;<span class="regexp">/Provider&gt;)</span></span><br><span class="line"><span class="regexp">    , document.getElementById('app'));</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">#4. app.jsx </span></span><br><span class="line"><span class="regexp">import React from 'react'</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">import &#123; connect &#125; from 'react-redux'</span></span><br><span class="line"><span class="regexp">import &#123;addFn,minusFn,addAsynFn,changeCityFn&#125; from '../</span>actions/action<span class="string">'</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">class App extends React.Component &#123;</span></span><br><span class="line"><span class="string">    constructor(props, context) &#123;</span></span><br><span class="line"><span class="string">        super(props,context)</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    render() &#123;</span></span><br><span class="line"><span class="string">        const num=this.props.num</span></span><br><span class="line"><span class="string">        const city = this.props.city</span></span><br><span class="line"><span class="string">        const addFn=this.props.addFn</span></span><br><span class="line"><span class="string">        const minusFn=this.props.minusFn</span></span><br><span class="line"><span class="string">        const addAsynFn=this.props.addAsynFn</span></span><br><span class="line"><span class="string">        const changeCityFn=this.props.changeCityFn</span></span><br><span class="line"><span class="string">        return &lt;div&gt;</span></span><br><span class="line"><span class="string">            &lt;h1&gt;你好吗？&lt;/h1&gt;</span></span><br><span class="line"><span class="string">            &lt;h1&gt;&#123;city&#125;&lt;/h1&gt;</span></span><br><span class="line"><span class="string">            &#123;&lt;p&gt;现在的总数是：&#123;num&#125;&lt;/p&gt;&#125;</span></span><br><span class="line"><span class="string">            &#123;&lt;button onClick=&#123; addFn &#125;&gt;加1&lt;/button&gt;&#125;</span></span><br><span class="line"><span class="string">            &#123;&lt;button onClick=&#123; minusFn &#125;&gt;减1&lt;/button&gt;&#125;</span></span><br><span class="line"><span class="string">            &#123;&lt;button onClick=&#123; addAsynFn &#125;&gt;异步加1&lt;/button&gt;&#125;</span></span><br><span class="line"><span class="string">            &#123;/* 这里通过箭头函数dispatch对应的方法，并传递参数 */&#125;</span></span><br><span class="line"><span class="string">            &#123;&lt;button onClick=&#123; ()=&gt;&#123;</span></span><br><span class="line"><span class="string">                changeCityFn("苏州")</span></span><br><span class="line"><span class="string">            &#125; &#125;&gt;改变城市&lt;/button&gt;&#125;</span></span><br><span class="line"><span class="string">            这是home</span></span><br><span class="line"><span class="string">        &lt;/div&gt;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">//将state状态映射到属性里面,之后可以通过props获取</span></span><br><span class="line"><span class="string">const mapStatetoProps=(state)=&gt;&#123;</span></span><br><span class="line"><span class="string">    return &#123;num:state.counter,city:state.city&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">//addFn 自动有了dispatch的功能 onClick=&#123;addFn&#125; ; addFn  minusFn  minusFn会被映射到props里面</span></span><br><span class="line"><span class="string">const mapDispatchToProps=&#123;addFn,minusFn,addAsynFn,changeCityFn&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">//为App组件提供数据和逻辑。mapStateToProps负责将state的数据映射到展示组件的this.props。mapDispatchToProps负责定义发送action的函数映射到展示组件的this.props</span></span><br><span class="line"><span class="string">App=connect(mapStatetoProps,mapDispatchToProps)(App)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">export default App</span></span><br></pre></td></tr></table></figure><h2 id="3-3-redux不可变数据"><a href="#3-3-redux不可变数据" class="headerlink" title="3.3 redux不可变数据"></a>3.3 redux不可变数据</h2><p><strong>1.在ReactJS中的数据对象</strong></p><p>在ReactJS 中主要是props 和state：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#x2F;&#x2F;1.props是不可变的</span><br><span class="line">props在子组件构造时由父组件传人子组件或自定义初始值，在子组件中不能改变props的值，只能读取：采用this.props.name。</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;2.state是可变的</span><br><span class="line">state是在组件内部运用的，在组件内部均可改变。但是我们永远不要直接改变state，而是要通过setState()方法来改变，因此请把 this.state 看作是不可变的，事实上有时候有人会搭配使用 Immutable来设置state，直接把state看成不可变的。</span><br></pre></td></tr></table></figure><p><strong>2.如何在Reactjs中减少render</strong></p><p>那么如何在reactjs中减少render提高性能呢，主要还是从props和state入手。在Reactjs中只要state变化或者props变化,都会重新render，这里的变化并非值真变了，即使是相同的值，因为重新输入了，也会导致render。因此reactjs提供了shouldComponentUpdate和PureComponent来阻止。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//方式一：使用shouldComponentUpdate方法</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">shouldComponentUpdate</span> (<span class="params">nextProps, nextState</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//我们需要在state和props有新值的时候进行判断，是否需要render，如果不需要，则返回false。</span></span><br><span class="line">    <span class="keyword">return</span> nextProps.id !== <span class="keyword">this</span>.props.id;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//方式二：使用PureComponent类 </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListOfWords</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">PureComponent</span> </span>&#123;</span><br><span class="line"> render() &#123;</span><br><span class="line">     <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;this.props.words.join(',')&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WordAdder</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line"> <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">     <span class="keyword">super</span>(props);</span><br><span class="line">     <span class="keyword">this</span>.state = &#123;</span><br><span class="line">         words: [<span class="string">'marklar'</span>]</span><br><span class="line">     &#125;;</span><br><span class="line">     <span class="keyword">this</span>.handleClick = <span class="keyword">this</span>.handleClick.bind(<span class="keyword">this</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> handleClick() &#123;</span><br><span class="line">     <span class="comment">// This section is bad style and causes a bug</span></span><br><span class="line">     <span class="keyword">const</span> words = <span class="keyword">this</span>.state.words;</span><br><span class="line">     words.push(<span class="string">'marklar'</span>);</span><br><span class="line">     <span class="keyword">this</span>.setState(&#123;<span class="attr">words</span>: words&#125;);</span><br><span class="line">  </span><br><span class="line"> &#125;</span><br><span class="line"> render() &#123;</span><br><span class="line">     <span class="keyword">return</span> (</span><br><span class="line">         &lt;div&gt;</span><br><span class="line">             &lt;button onClick=&#123;<span class="keyword">this</span>.handleClick&#125;&gt;click&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">             &lt;ListOfWords words=&#123;this.state.words&#125; /</span>&gt;</span><br><span class="line">         &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">     );</span></span><br><span class="line"><span class="regexp"> &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">/</span>*</span><br><span class="line"><span class="number">1.</span>继承PureComponent时，不能再重写shouldComponentUpdate</span><br><span class="line"><span class="number">2.</span>继承PureComponent时，进行的是浅比较，也就是说，如果是引用类型的数据，只会比较是不是同一个地址，而不会比较具体这个地址存的数据是否完全一致</span><br><span class="line"><span class="number">3.</span>上面代码中，无论你怎么点击按钮，ListOfWords渲染的结果始终没变化，原因就是WordAdder的word的引用地址始终是同一个。</span><br><span class="line"><span class="number">4.</span>我们可以这样修改state，此时页面会发生变化，因为给words赋值了一个新对象</span><br><span class="line">   <span class="keyword">this</span>.setState(&#123;<span class="attr">words</span>:[...words]&#125;);</span><br><span class="line">*<span class="regexp">/</span></span><br></pre></td></tr></table></figure><p><strong>3.如何简单快捷的判断是否需要render</strong></p><p>从上面我们可以看出reactjs提供了阻止render的方法，但是如何快速判断是否需要render依然是个问题，因为判断一个复杂的数据对象是否跟之前的值是否相同并不容易。</p><p>Redux将这个问题极简化了，整个应用共用一个state。但也带来了更复杂的问题，就是state的结构可能非常复杂，如果判断是否更新呢？Redux又一次极简了，那就是采用不可变数据。</p><p>我们在判断数据是否相同时，并不需要深入判断数据对象的值是否相同，只需要浅比较即可，也就是判断是否为同一个数据对象地址，因为不可变数据对象在数据变化时均会重新创建一个新的数据对象，数据对象的地址不会相同。这也就是为什么在Reactjs，Redux中才有不可变数据对象。</p><h1 id="4-react-hook"><a href="#4-react-hook" class="headerlink" title="4.react hook"></a>4.react hook</h1><p><em>Hook</em> 是 React 16.8 的新增特性。它可以让你在不编写 class 的情况下使用 state 以及其他的 React 特性。</p><p>Hook 是一些可以让你在函数组件里“钩入” React state 及生命周期等特性的函数。Hook 不能在 class 组件中使用 —— 这使得你不使用 class 也能使用 React。</p><h2 id="4-1-State-Hook"><a href="#4-1-State-Hook" class="headerlink" title="4.1 State Hook"></a>4.1 State Hook</h2><p><code>useState</code> 就是一个 <em>Hook</em> （等下我们会讲到这是什么意思）。通过在函数组件里调用它来给组件添加一些内部 state。React 会在重复渲染时保留这个 state。</p><p><code>useState</code> 会返回一对值：<strong>当前</strong>状态和一个让你更新它的函数，你可以在事件处理函数中或其他一些地方调用这个函数。它类似 class 组件的 <code>this.setState</code>，但是它不会把新的 state 和旧的 state 进行合并。</p><blockquote><ol><li>一般来说，一个函数组件，在函数退出后变量就会”消失”，但是 state 中的变量会被 React 保留。</li><li>当我们点击按钮，调用setCount函数时，React会重新渲染这个组件，并把更新的count值传给这个组件</li><li>useState()接受一个参数为默认值，该方法返回一个数组，第一个值为定义data的值，第二个为更新data的方法，他们总是成对出现的，</li></ol></blockquote><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Demo1</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//count代表state的变量</span></span><br><span class="line">    <span class="comment">//setCount是一个function，如果我们要修改count变量，需要通过setCount来修改</span></span><br><span class="line">    <span class="keyword">let</span> [count, setCount] = useState(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">let</span> [count2, setCount2] = useState(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">let</span> [count3, setCount3] = useState(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        &#123;count&#125;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123; setCount(++count) &#125;&#125;&gt;点我修改count<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span></span><br><span class="line"><span class="xml">        &#123;count2&#125;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123; setCount2(++count2) &#125;&#125;&gt;点我修改count2<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span></span><br><span class="line"><span class="xml">        &#123;count3&#125;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123; setCount3(++count3) &#125;&#125;&gt;点我修改count3<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Demo1;</span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">//注意点：不要在循环，条件或嵌套函数中调用 Hook， 确保总是在你的 React 函数的最顶层调用他们。遵守这条规则，你就能确保 Hook 在每一次渲染中都按照同样的顺序被调用。这让 React 能够在多次的 useState 和 useEffect 调用之间保持 hook 状态的正确</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Form</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> [name1, setName1] = useState(<span class="string">'111'</span>);</span><br><span class="line">    <span class="keyword">if</span>(name1!==<span class="string">''</span>)&#123;</span><br><span class="line">        <span class="keyword">const</span> [name2, setName2] = useState(<span class="string">'222'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> [name3, setName3] = useState(<span class="string">'333'</span>);</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-2-Effect-Hook"><a href="#4-2-Effect-Hook" class="headerlink" title="4.2 Effect Hook"></a>4.2 Effect Hook</h2><p><code>useEffect</code> 就是一个 Effect Hook，给函数组件增加了操作副作用的能力。它跟 class 组件中的 <code>componentDidMount</code>、<code>componentDidUpdate</code> 和 <code>componentWillUnmount</code> 具有相同的用途，只不过被合并成了一个 API。</p><p>在调用这个hook时，就是告诉React在完成对DOM的更改后运行这个hook,在这里你可以访问到state和props。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">- 纯函数：如果函数的调用参数相同，则永远返回相同的结果。它不依赖于程序执行期间函数外部任何状态或数据的变化，必须只依赖于其输入参数。</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">priceAfterTax</span>(<span class="params">productPrice</span>) </span>&#123; <span class="keyword">return</span> (productPrice * <span class="number">0.20</span>) + productPrice;&#125;</span><br><span class="line"></span><br><span class="line">- 副作用：一个可以被观察的副作用是在函数内部与其外部的任意交互。这可能是在函数内修改外部的变量，或者在函数里调用另外一个函数等。</span><br><span class="line">    <span class="keyword">var</span> tax = <span class="number">20</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">calculateTax</span>(<span class="params">productPrice</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (productPrice * (tax/<span class="number">100</span>)) + productPrice;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState,useEffect  &#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> Child <span class="keyword">from</span> <span class="string">'./Child.jsx'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Demo2</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//count代表state的变量</span></span><br><span class="line">    <span class="comment">//setCount是一个function，如果我们要修改count变量，需要通过setCount来修改</span></span><br><span class="line">    <span class="keyword">let</span> [count, setCount] = useState(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">let</span> [count2, setCount2] = useState(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//useEffect函数可以来模拟class组件的中指定生命周期的钩子函数 componentDidMount，componentDidUpdate，componentWillUnmount</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//相当于componentDidMount 、componentDidUpdate</span></span><br><span class="line">    useEffect(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"xxxxxxxxxxx"</span>,count)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="comment">//相当于componentDidMount</span></span><br><span class="line">    useEffect(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"yyyyyyyyy"</span>)</span><br><span class="line">    &#125;,[])</span><br><span class="line"></span><br><span class="line">    <span class="comment">//当count2的值被改变之后执行当前的useEffect，其他值改变不会执行这个useEffect</span></span><br><span class="line">    useEffect(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"zzzzzzzzzzzzz"</span>)</span><br><span class="line">    &#125;,[count2])</span><br><span class="line"></span><br><span class="line">    <span class="comment">//useEffect函数中return的function会在组件重新渲染的时候以及组件卸载的时候执行</span></span><br><span class="line">    useEffect(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">'hello Hook'</span>)    </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        &#123;count&#125;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123; setCount(++count) &#125;&#125;&gt;点我修改count<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> &#123; setCount2(++count2) &#125;&#125;&gt;点我修改count2<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">Child</span>&gt;</span><span class="tag">&lt;/<span class="name">Child</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> Demo2;</span><br></pre></td></tr></table></figure><h2 id="4-3-Ref-Hook"><a href="#4-3-Ref-Hook" class="headerlink" title="4.3 Ref Hook"></a>4.3 Ref Hook</h2><blockquote><p>“ref”对象是一个通用容器，其current属性是可变的</p></blockquote><h3 id="a-保存dom"><a href="#a-保存dom" class="headerlink" title="a) 保存dom"></a>a) 保存dom</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> t = useRef(<span class="literal">null</span>);</span><br><span class="line"> </span><br><span class="line">  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(t.current); <span class="comment">// div</span></span><br><span class="line">  &#125;);</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div ref=&#123;t&#125;&gt; ... &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="b-保存事件程序"><a href="#b-保存事件程序" class="headerlink" title="b) 保存事件程序"></a>b) 保存事件程序</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> t = useRef(<span class="literal">null</span>);</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">handleClick</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    t.current = setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> l(<span class="number">1</span>), <span class="number">2000</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">handleClear</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    clearTimeout(t.current);</span><br><span class="line">  &#125;</span><br><span class="line"> </span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;button onClick=&#123;handleClick&#125;&gt;start&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;button onClick=&#123;handleClear&#125;&gt;clear&lt;/</span>button&gt;</span><br><span class="line">    &lt;<span class="regexp">/&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="c-存储以前的值"><a href="#c-存储以前的值" class="headerlink" title="c) 存储以前的值"></a>c) 存储以前的值</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> t = useRef(<span class="literal">null</span>);</span><br><span class="line">  <span class="keyword">const</span> [name, setName] = useState(<span class="string">"ajanuw"</span>);</span><br><span class="line">  useEffect(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    t.current = name;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="keyword">const</span> prevName = t.current;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;input value=&#123;name&#125; onChange=&#123;e =&gt; setName(e.target.value)&#125; /&gt;</span><br><span class="line">      &lt;h2&gt;&#123;name&#125;&lt;<span class="regexp">/h2&gt;</span></span><br><span class="line"><span class="regexp">      &lt;p&gt;&#123;prevName&#125;&lt;/</span>p&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="4-4-memo-useMemo-useCallback"><a href="#4-4-memo-useMemo-useCallback" class="headerlink" title="4.4 memo\useMemo\useCallback"></a>4.4 memo\useMemo\useCallback</h2><p>在介绍一下这两个hooks的作用之前，我们先来回顾一下react中的性能优化。在hooks诞生之前，如果组件包含内部state，我们都是基于class的形式来创建组件。当时我们也知道，react中，性能的优化点在于：</p><blockquote><ol><li>调用setState，就会触发组件的重新渲染，无论前后的state是否不同</li><li>父组件更新，子组件也会自动的更新</li></ol></blockquote><p>基于上面的两点，我们通常的解决方案是：</p><blockquote><ol><li>使用immutable进行比较，在不相等的时候调用setState；</li><li>在shouldComponentUpdate中判断前后的props和state，如果没有变化，则返回false来阻止更新。</li></ol></blockquote><p>在hooks出来之后，我们能够使用function的形式来创建包含内部state的组件。但是，使用function的形式，失去了上面的shouldComponentUpdate，我们无法通过判断前后状态来决定是否更新。而且，在函数组件中，react不再区分mount和update两个状态，这意味着函数组件的每一次调用都会执行其内部的所有逻辑，那么会带来较大的性能损耗。因此useMemo 和useCallback就是解决性能问题的杀手锏。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState, memo &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">'./logo.svg'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./App.css'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Child = <span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">  <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &#123;date.toLocaleString()&#125;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const Parent = ()=&gt;&#123;</span></span><br><span class="line"><span class="regexp">  const [count,setCount] = useState(0);</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;div&gt;</span></span><br><span class="line"><span class="regexp">      &lt;div&gt;数量为:&#123;count&#125;&lt;/</span>div&gt;</span><br><span class="line">      &lt;button onClick=&#123;()=&gt;&#123;setCount(count+<span class="number">1</span>)&#125;&#125;&gt;点我加<span class="number">1</span>&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Child&gt;&lt;/</span>Child&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function App() &#123;</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;div className="App"&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Parent&gt;&lt;/</span>Parent&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/案例存在的问题：每点击一次按钮，会重新渲染一次时间，说明父组件更新的时候，子组件也重新渲染了</span></span><br></pre></td></tr></table></figure><h3 id="4-4-1-使用memo组件"><a href="#4-4-1-使用memo组件" class="headerlink" title="4.4.1 使用memo组件"></a>4.4.1 使用memo组件</h3><p><code>React.memo()</code>是一个高阶函数，它与 <a href="https://reactjs.org/docs/react-api.html#reactpurecomponent" target="_blank" rel="noopener"><code>React.PureComponent</code></a>类似，但是一个函数组件而非一个类。</p><p>React.memo()可接受2个参数，第一个参数为纯函数的组件，第二个参数用于对比props控制是否刷新，与<a href="https://reactjs.org/docs/react-component.html#shouldcomponentupdate" target="_blank" rel="noopener"><code>shouldComponentUpdate()</code></a>功能类似</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//修改Child组件</span></span><br><span class="line"><span class="keyword">const</span> Child = memo(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &#123;date.toLocaleString()&#125;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;, (prev,next) =&gt; &#123; console.log(prev.count,next.count); return prev.count==next.count &#125;)  /</span><span class="regexp">/这边只要父亲传递给孩子的props发生了变化就应该刷新子组件(如果父亲没有给子组件传递props或者父亲给子组件传递的props没有改变，则子组件不应该刷新)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const Parent = () =&gt; &#123;</span></span><br><span class="line"><span class="regexp">  const [count, setCount] = useState(0);</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;div&gt;</span></span><br><span class="line"><span class="regexp">      &lt;div&gt;数量为:&#123;count&#125;&lt;/</span>div&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; &#123; setCount(count + <span class="number">1</span>) &#125;&#125;&gt;点我加<span class="number">1</span>&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Child count=&#123;count&#125;&gt;&lt;/</span>Child&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="4-4-2-useMemo"><a href="#4-4-2-useMemo" class="headerlink" title="4.4.2 useMemo"></a>4.4.2 useMemo</h3><h4 id="a-没有使用useMemo存在的问题"><a href="#a-没有使用useMemo存在的问题" class="headerlink" title="a) 没有使用useMemo存在的问题"></a>a) 没有使用useMemo存在的问题</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState, memo &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">'./logo.svg'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./App.css'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Child = memo(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &#123;date.toLocaleString()&#125;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;, (prev,next) =&gt; &#123; console.log(prev.obj,next.obj); return prev.obj==next.obj &#125;)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const Parent = () =&gt; &#123;</span></span><br><span class="line"><span class="regexp">  const [count, setCount] = useState(0);</span></span><br><span class="line"><span class="regexp">  const obj = &#123;</span></span><br><span class="line"><span class="regexp">    name:"zhangsan"</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;div&gt;</span></span><br><span class="line"><span class="regexp">      &lt;div&gt;数量为:&#123;count&#125;&lt;/</span>div&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; &#123; setCount(count + <span class="number">1</span>) &#125;&#125;&gt;点我加<span class="number">1</span>&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Child obj=&#123;obj&#125;&gt;&lt;/</span>Child&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function App() &#123;</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;div className="App"&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Parent&gt;&lt;/</span>Parent&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/案例存在的问题：每点击一次按钮，会重新渲染一次时间，但是每一次点击按钮的时候，父组件给子组件传递的都是相同的obj对象，为什么子组件还是会刷新呢?</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/原因是每一次点击按钮的时候，会重新刷新父组件，父组件中的obj会重新被实例化，所以新实例化的obj和上一次实例化的obj不是同一个对象</span></span><br></pre></td></tr></table></figure><h4 id="b-useMemo-hook"><a href="#b-useMemo-hook" class="headerlink" title="b) useMemo hook"></a>b) useMemo hook</h4><p>useMemo可以用来缓存一些变量，并指定哪些条件变化后重新计算缓存的变量。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> memoizedValue = useMemo(<span class="function"><span class="params">()</span> =&gt;</span> computeExpensiveValue(a, b), [a, b]);</span><br></pre></td></tr></table></figure><blockquote><p>useMemo第一个参数是一个 factory 函数，该函数的返回结果会通过useMemo缓存下来</p><p>​                  第二个参数是factory函数的依赖(deps)，当依赖(deps)改变时才重新执行 factory 函数，memoizedValue 才会被重新计算</p></blockquote><p>也就是在依赖未改变时（或空数组无依赖时），memoizedValue 总是返回通过useMemo缓存的值。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState, memo,useMemo &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">'./logo.svg'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./App.css'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Child = memo(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &#123;date.toLocaleString()&#125;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;, (prev,next) =&gt; &#123; console.log(prev.obj===next.obj); return prev.obj===next.obj &#125;)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const Parent = () =&gt; &#123;</span></span><br><span class="line"><span class="regexp">  const [count, setCount] = useState(0);</span></span><br><span class="line"><span class="regexp">  /</span><span class="regexp">/使用useMemo将函数返回的结果返回</span></span><br><span class="line"><span class="regexp">  const obj = useMemo(()=&gt;&#123;</span></span><br><span class="line"><span class="regexp">    return &#123;</span></span><br><span class="line"><span class="regexp">      name:"zhangsan"</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  &#125;,[])</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;div&gt;</span></span><br><span class="line"><span class="regexp">      &lt;div&gt;数量为:&#123;count&#125;&lt;/</span>div&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; &#123; setCount(count + <span class="number">1</span>) &#125;&#125;&gt;点我加<span class="number">1</span>&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Child obj=&#123;obj&#125;&gt;&lt;/</span>Child&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function App() &#123;</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;div className="App"&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Parent&gt;&lt;/</span>Parent&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br></pre></td></tr></table></figure><h3 id="4-4-3-useCallback"><a href="#4-4-3-useCallback" class="headerlink" title="4.4.3 useCallback"></a>4.4.3 useCallback</h3><h4 id="a-没有使用useCallback的问题"><a href="#a-没有使用useCallback的问题" class="headerlink" title="a) 没有使用useCallback的问题"></a>a) 没有使用useCallback的问题</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState, memo,useMemo &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">'./logo.svg'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./App.css'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Child = memo(<span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &#123;date.toLocaleString()&#125;</span><br><span class="line">      &lt;input type=<span class="string">"text"</span> onChange=&#123;props.onChange&#125;&gt;&lt;<span class="regexp">/input&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Parent = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [text,setText] = useState(<span class="string">""</span>)</span><br><span class="line">  <span class="keyword">const</span> changeHandler = <span class="function">(<span class="params">event</span>)=&gt;</span>&#123;</span><br><span class="line">    setText(event.target.value)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;div&gt;text文本为:&#123;text&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Child onChange=&#123;changeHandler&#125;&gt;&lt;/</span>Child&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function App() &#123;</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;div className="App"&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Parent&gt;&lt;/</span>Parent&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/上面代码中，我们在子组件中修改文本框的值，会触发子组件的onChange，从而触发父组件的changeHandler方法，在父组件中的changeHandler方法中修改了text文本，所以页面上的text值发生了改变。 </span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/但是除了我们发现页面上text文本改变之外，子组件中的时间也发生了改变 (说明每一次子组件输入内容的时候都会触发子组件的重新渲染)</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/原因是每一次子组件输入内容，父组件的text文本发生变化，造成父组件被重新渲染，从而造成父组件传递给子组件的changeHandler方法(props)发生了变化，从而造成子组件的重新渲染</span></span><br></pre></td></tr></table></figure><h4 id="b-useCallback-hook"><a href="#b-useCallback-hook" class="headerlink" title="b) useCallback   hook"></a>b) useCallback   hook</h4><p>useMemo缓存的是值</p><p>useCallback缓存的是函数。有两个参数，第一个参数是需要缓存的函数，第二个参数是依赖项。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useState, memo,useMemo,useCallback &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">'./logo.svg'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./App.css'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Child = memo(<span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> date = <span class="keyword">new</span> <span class="built_in">Date</span>();</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &#123;date.toLocaleString()&#125;</span><br><span class="line">      &lt;input type=<span class="string">"text"</span> onChange=&#123;props.onChange&#125;&gt;&lt;<span class="regexp">/input&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Parent = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> [text,setText] = useState(<span class="string">""</span>)</span><br><span class="line">  <span class="comment">//使用useCallback来缓存函数</span></span><br><span class="line">  <span class="keyword">const</span> changeHandler = useCallback(<span class="function">(<span class="params">event</span>)=&gt;</span>&#123;</span><br><span class="line">    setText(event.target.value)</span><br><span class="line">  &#125;,[])</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;div&gt;text文本为:&#123;text&#125;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Child onChange=&#123;changeHandler&#125;&gt;&lt;/</span>Child&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function App() &#123;</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;div className="App"&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Parent&gt;&lt;/</span>Parent&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br></pre></td></tr></table></figure><h2 id="4-5-useReducer"><a href="#4-5-useReducer" class="headerlink" title="4.5 useReducer"></a>4.5 useReducer</h2><p>useReducer提供类似 Redux 的功能。他接收两个参数，第一个参数是一个recuder(纯函数)，第二个参数是state的初始值。</p><p>他返回一个状态 state和 dispath，state是返回状态中的值，而 dispatch 是一个可以发布事件来更新 state 的。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useReducer &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">'./logo.svg'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./App.css'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//声明一个reducer(纯函数，将action转换为state)</span></span><br><span class="line"><span class="keyword">const</span> reducer = <span class="function">(<span class="params">state=<span class="number">0</span>,action</span>)=&gt;</span>&#123;</span><br><span class="line">  <span class="keyword">switch</span>(action.type)&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'ADD'</span>:</span><br><span class="line">      <span class="keyword">return</span> state+<span class="number">1</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'SUB'</span>:</span><br><span class="line">      <span class="keyword">return</span> state<span class="number">-1</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Child = <span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//使用useReducer提供状态</span></span><br><span class="line">  <span class="keyword">const</span> [count,dispatcher] = useReducer(reducer,<span class="number">10</span>);</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      子组件</span><br><span class="line">      数量:&#123;count&#125;&lt;br/&gt;</span><br><span class="line">      &lt;button onClick=&#123;()=&gt;&#123;dispatcher(&#123;<span class="attr">type</span>:<span class="string">"ADD"</span>&#125;)&#125;&#125;&gt;加<span class="number">1</span>&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;button onClick=&#123;()=&gt;&#123;dispatcher(&#123;type:"SUB"&#125;)&#125;&#125;&gt;减1&lt;/</span>button&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const Parent = () =&gt; &#123;</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;div&gt;</span></span><br><span class="line"><span class="regexp">      &lt;div&gt;父组件&lt;/</span>div&gt;</span><br><span class="line">      &lt;Child&gt;&lt;<span class="regexp">/Child&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=<span class="string">"App"</span>&gt;</span><br><span class="line">      &lt;Parent&gt;&lt;<span class="regexp">/Parent&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App;</span><br></pre></td></tr></table></figure><h2 id="4-6-useContext"><a href="#4-6-useContext" class="headerlink" title="4.6 useContext"></a>4.6 useContext</h2><p>接收一个 context 对象（<code>React.createContext</code> 的返回值）并返回该 context 的当前值。当前的 context 值由上层组件中距离当前组件最近的 <code>&lt;MyContext.Provider&gt;</code> 的 <code>value</code> prop 决定。</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">#1.App.jsx</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> Demo3 <span class="keyword">from</span> <span class="string">'@/components/Demo3'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> MyContext <span class="keyword">from</span> <span class="string">'./context.js'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">MyContext.Provider</span> <span class="attr">value</span>=<span class="string">&#123;&#123;name:</span>"<span class="attr">zhangsan</span>"&#125;&#125;&gt;</span></span></span><br><span class="line"><span class="xml">        App</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">Demo3</span>&gt;</span><span class="tag">&lt;/<span class="name">Demo3</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">MyContext.Provider</span>&gt;</span></span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#2/context.js</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">const</span> MyContext = React.createContext(<span class="literal">null</span>);</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> MyContext;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#3.Child.jsx</span><br><span class="line"><span class="keyword">import</span> React,&#123;useContext&#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> MyContext <span class="keyword">from</span> <span class="string">'@/context.js'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params">props</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//在子组件中获取父组件发布的数据</span></span><br><span class="line">    <span class="keyword">const</span> contextValue = useContext(MyContext);</span><br><span class="line">    <span class="built_in">console</span>.log(contextValue)</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>xx<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-7-useReducer和useContext提供全局状态管理"><a href="#4-7-useReducer和useContext提供全局状态管理" class="headerlink" title="4.7 useReducer和useContext提供全局状态管理"></a>4.7 useReducer和useContext提供全局状态管理</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; useReducer,useContext &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">'./logo.svg'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./App.css'</span>;</span><br><span class="line"><span class="keyword">import</span> MyContext <span class="keyword">from</span> <span class="string">'./context.js'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//声明一个reducer(纯函数，将action转换为state)</span></span><br><span class="line"><span class="keyword">const</span> reducer = <span class="function">(<span class="params">state = <span class="number">0</span>, action</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> (action.type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'ADD'</span>:</span><br><span class="line">      <span class="keyword">return</span> state + <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">'SUB'</span>:</span><br><span class="line">      <span class="keyword">return</span> state - <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      <span class="keyword">return</span> state;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Child = <span class="function">(<span class="params">props</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">//使用useReducer提供状态</span></span><br><span class="line">  </span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> [count,dispatcher] = useContext(MyContext);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      子组件</span><br><span class="line">      数量:&#123;count&#125;&lt;br /&gt;</span><br><span class="line">      &lt;button onClick=&#123;() =&gt; &#123; dispatcher(&#123; <span class="attr">type</span>: <span class="string">"ADD"</span> &#125;) &#125;&#125;&gt;加<span class="number">1</span>&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">      &lt;button onClick=&#123;() =&gt; &#123; dispatcher(&#123; type: "SUB" &#125;) &#125;&#125;&gt;减1&lt;/</span>button&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  )</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const Parent = () =&gt; &#123;</span></span><br><span class="line"><span class="regexp">  const [count,dispatcher] = useContext(MyContext);</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;div&gt;</span></span><br><span class="line"><span class="regexp">      父组件：&#123;count&#125;</span></span><br><span class="line"><span class="regexp">      &lt;div&gt;父组件&lt;/</span>div&gt;</span><br><span class="line">      &lt;Child&gt;&lt;<span class="regexp">/Child&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> [count, dispatcher] = useReducer(reducer, <span class="number">10</span>);</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;MyContext.Provider value=&#123;[count,dispatcher]&#125;&gt;</span><br><span class="line">      &lt;div className=<span class="string">"App"</span>&gt;</span><br><span class="line">        &lt;Parent&gt;&lt;<span class="regexp">/Parent&gt;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>div&gt;</span><br><span class="line">    &lt;<span class="regexp">/MyContext.Provider&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br></pre></td></tr></table></figure><p>useReducer和useContext的出现并不是为了取代redux，redux是独立于任何第三方库，redux有优秀的中间件(异步数据流、debug)。当状态比较简单的时候，我们可以使用useReducer和useContext来实现组件之间的数据共享，但是当状态变得特别复杂的时候，建议使用redux。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;1-creat-react-app使用&quot;&gt;&lt;a href=&quot;#1-creat-react-app使用&quot; class=&quot;headerlink&quot; title=&quot;1.creat-react-app使用&quot;&gt;&lt;/a&gt;1.creat-react-app使用&lt;/h1&gt;&lt;p&gt;&lt;a
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>WebPack</title>
    <link href="http://yoursite.com/2020/04/07/WebPack/"/>
    <id>http://yoursite.com/2020/04/07/WebPack/</id>
    <published>2020-04-07T10:53:54.000Z</published>
    <updated>2020-04-17T05:56:01.741Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-Webpack"><a href="#1-Webpack" class="headerlink" title="1.Webpack"></a>1.Webpack</h1><h2 id="1-1-引入"><a href="#1-1-引入" class="headerlink" title="1.1 引入"></a>1.1 引入</h2><h3 id="1-1-1-网页中常见的静态资源"><a href="#1-1-1-网页中常见的静态资源" class="headerlink" title="1.1.1 网页中常见的静态资源"></a>1.1.1 网页中常见的静态资源</h3><blockquote><ul><li>JS ： .js  .jsx  .coffee  .ts（TypeScript  类 C# 语言）</li></ul><ul><li>CSS ： .css  .less   .sass  .scss</li></ul><ul><li>Images ：  .jpg   .png   .gif   .bmp   .svg</li></ul><ul><li>字体文件（Fonts）： .svg   .ttf   .eot   .woff   .woff2</li></ul><ul><li>模板文件 ： .ejs   .jade  .vue【这是在webpack中定义组件的方式，推荐这么用】</li></ul></blockquote><h3 id="1-1-2-静态资源带来的问题"><a href="#1-1-2-静态资源带来的问题" class="headerlink" title="1.1.2 静态资源带来的问题"></a>1.1.2 静态资源带来的问题</h3><ol><li>网页加载速度慢， 因为我们要发起很多的二次请求；</li><li>要处理错综复杂的依赖关系</li></ol><h3 id="1-1-3-如何解决上述两个问题"><a href="#1-1-3-如何解决上述两个问题" class="headerlink" title="1.1.3 如何解决上述两个问题"></a>1.1.3 如何解决上述两个问题</h3><ol><li>合并、压缩、精灵图、图片的Base64编码</li><li>可以使用之前学过的requireJS、也可以使用webpack可以解决各个包之间的复杂依赖关系；</li></ol><h3 id="1-1-4-完美实现上述问题的2种解决方案"><a href="#1-1-4-完美实现上述问题的2种解决方案" class="headerlink" title="1.1.4 完美实现上述问题的2种解决方案"></a>1.1.4 完美实现上述问题的2种解决方案</h3><ol><li>使用Gulp， 是基于 task 任务的，是前端构建工具；</li><li>使用browserify/Webpack， 是预编译的模块化方案；</li></ol><h3 id="1-1-5-gulp"><a href="#1-1-5-gulp" class="headerlink" title="1.1.5 gulp"></a>1.1.5 gulp</h3><pre><code>gulp是基于Node.js的前端自动化构建**工具**，能自动化地完成 JavaScript/sass/html/image/css 等文件的的测试、检查、合并、压缩混淆、格式化、浏览器自动刷新、部署文件生成等操作，同时可以对文件进行监听，如果文件有改动，可以自动处理生成新的文件。所以gulp解决了开发效率(修改代码后自动更新页面)、资源整合(代码的压缩合并)、代码质量(代码的检查 自动化测试)、代码转换(es6--&gt;es5)等问题[官网](http://www.gulpjs.com)[中文网](http://www.gulpjs.com.cn)</code></pre><h4 id="a-gulp的核心方法"><a href="#a-gulp的核心方法" class="headerlink" title="a) gulp的核心方法"></a>a) gulp的核心方法</h4><ul><li>gulp.task(‘任务名’,function(){})     // 创建任务。</li><li>gulp.src(‘./*.css’)                            // 指定想要处理的文件</li><li>gulp.dest()                                      // 指定最终处理后的文件的存放路径</li><li>gulp.watch()                                   // 自动的监视文件的变化，然后执行相应任务。</li><li>gulp.run(‘任务名’)                          // 直接执行相应的任务。</li></ul><h4 id="b-安装gulp使用"><a href="#b-安装gulp使用" class="headerlink" title="b) 安装gulp使用"></a>b) 安装gulp使用</h4><ul><li>1.通过npm安装:<code>npm install gulp-cli -g</code>    安装全局的命令行，可以在终端中使用gulp相关命令</li></ul><ul><li>2.在当前项目中也要安装gulp: <code>npm install gulp --save</code></li><li>3.还需要在当前项目中新建一个文件: gulpfile.js</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp =  <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建任务</span></span><br><span class="line"><span class="comment">// 第一个参数: 任务名</span></span><br><span class="line"><span class="comment">// 第二个参数: 回调函数,当我们执行任务时就会执行这个函数</span></span><br><span class="line">gulp.task(<span class="string">'test'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">123</span>)</span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'src/js2/*.js'</span>);</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//执行任务: gulp 任务名</span></span><br><span class="line">gulp test</span><br></pre></td></tr></table></figure><h4 id="c-对js进行压缩混淆和合并"><a href="#c-对js进行压缩混淆和合并" class="headerlink" title="c) 对js进行压缩混淆和合并"></a>c) 对js进行压缩混淆和合并</h4><ul><li><code>npm install gulp-uglify --save</code>     压缩混淆</li></ul><ul><li><code>npm install gulp-concat --save</code>   合并</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</span><br><span class="line"><span class="keyword">var</span> uglify = <span class="built_in">require</span>(<span class="string">'gulp-uglify'</span>);</span><br><span class="line"><span class="keyword">var</span> concat = <span class="built_in">require</span>(<span class="string">'gulp-concat'</span>);</span><br><span class="line">gulp.task(<span class="string">'script'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// 1.要匹配到要处理的文件</span></span><br><span class="line">    <span class="comment">// 指定指定的文件:参数是匹配的规则</span></span><br><span class="line">    <span class="comment">// 参数也可以是数组，数组中的元素就是匹配的规则</span></span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'src/js2/*.js'</span>)</span><br><span class="line">    <span class="comment">// concat 的参数是合并之后的文件名字</span></span><br><span class="line">        .pipe(concat(<span class="string">'index.js'</span>))</span><br><span class="line">    <span class="comment">// 压缩混淆</span></span><br><span class="line">        .pipe(uglify())</span><br><span class="line">    <span class="comment">// dest方法参数，指定输出文件的路径</span></span><br><span class="line">        .pipe(gulp.dest(<span class="string">'dist/js2'</span>))</span><br><span class="line">&#125;)</span><br><span class="line">gulp.run(<span class="string">'script'</span>)</span><br></pre></td></tr></table></figure><h4 id="d-对css进行压缩操作"><a href="#d-对css进行压缩操作" class="headerlink" title="d) 对css进行压缩操作"></a>d) 对css进行压缩操作</h4><ul><li><code>npm install gulp-cssnano --save</code></li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> concat = <span class="built_in">require</span>(<span class="string">'gulp-concat'</span>);</span><br><span class="line"><span class="keyword">var</span> cssnano = <span class="built_in">require</span>(<span class="string">'gulp-cssnano'</span>);</span><br><span class="line"><span class="comment">// 新建一个任务，对css进行处理</span></span><br><span class="line">gulp.task(<span class="string">'style'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// 对项目中的2个css文件进行合并，压缩操作</span></span><br><span class="line">    <span class="comment">// 1.匹配到要处理的文件</span></span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'src/css/*.css'</span>)</span><br><span class="line">    <span class="comment">// 2.合并文件</span></span><br><span class="line">        .pipe(concat(<span class="string">'index.css'</span>))</span><br><span class="line">    <span class="comment">// 3.压缩操作</span></span><br><span class="line">        .pipe(cssnano())</span><br><span class="line">    <span class="comment">// 4.输出到指定目录</span></span><br><span class="line">        .pipe(gulp.dest(<span class="string">'dist/css'</span>))</span><br><span class="line">&#125;)</span><br><span class="line">gulp.run(<span class="string">'style'</span>)</span><br></pre></td></tr></table></figure><h4 id="e-对html进行压缩"><a href="#e-对html进行压缩" class="headerlink" title="e) 对html进行压缩"></a>e) 对html进行压缩</h4><ul><li><code>npm install gulp-htmlmin --save</code></li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> htmlmin = <span class="built_in">require</span>(<span class="string">'gulp-htmlmin'</span>);</span><br><span class="line"><span class="comment">// 新建一个任务，对html进行压缩</span></span><br><span class="line">gulp.task(<span class="string">'html'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// 1.匹配到要处理的文件</span></span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'src/index.html'</span>)</span><br><span class="line">    <span class="comment">// 2.压缩操作</span></span><br><span class="line">        .pipe(htmlmin(&#123;<span class="attr">collapseWhitespace</span>:<span class="literal">true</span>&#125;))</span><br><span class="line">    <span class="comment">// 3.指定输出目录</span></span><br><span class="line">        .pipe(gulp.dest(<span class="string">'dist'</span>))</span><br><span class="line">&#125;)</span><br><span class="line">gulp.run(<span class="string">'html'</span>)</span><br></pre></td></tr></table></figure><h4 id="f-gulp对图片压缩"><a href="#f-gulp对图片压缩" class="headerlink" title="f) gulp对图片压缩"></a>f) gulp对图片压缩</h4><ul><li><code>npm install gulp-imagemin</code></li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">gulp.task(<span class="string">'image'</span>,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'./images/*.*'</span>)</span><br><span class="line">        .pipe(imageMin(&#123;<span class="attr">progressive</span>: <span class="literal">true</span>&#125;))</span><br><span class="line">        .pipe(gulp.dest(<span class="string">'./dist/images'</span>))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="g-gulp-watch"><a href="#g-gulp-watch" class="headerlink" title="g) gulp.watch"></a>g) gulp.watch</h4><ul><li>监视文件的变化，然后执行相应的任务</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// gulp.watch 监视文件变化，执行相应任务</span></span><br><span class="line">gulp.task(<span class="string">'mywatch'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// 1.监视js文件的变化，然后执行script任务</span></span><br><span class="line">    <span class="comment">// 第一个参数：要监视的文件的规则</span></span><br><span class="line">    <span class="comment">// 第二个参数：是要执行的任务</span></span><br><span class="line">    gulp.watch(<span class="string">"src/js2/*.js"</span>,gulp.series(<span class="string">"script"</span>))</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//然后使用gulp mywatch启动监听，然后一旦源文件修改了，会立刻同步编译新的目标文件</span></span><br></pre></td></tr></table></figure><h4 id="h-gulp解决浏览器缓存问题"><a href="#h-gulp解决浏览器缓存问题" class="headerlink" title="h) gulp解决浏览器缓存问题"></a>h) gulp解决浏览器缓存问题</h4><ul><li><code>npm install gulp-rev  gulp-rev-rewrite</code> </li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> rev = <span class="built_in">require</span>(<span class="string">'gulp-rev'</span>);</span><br><span class="line"><span class="keyword">var</span> revRewrite = <span class="built_in">require</span>(<span class="string">'gulp-rev-rewrite'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//给js文件重命名 并且输出到dist目录下</span></span><br><span class="line">gulp.task(<span class="string">'js'</span>, () =&gt;</span><br><span class="line">    gulp.src([<span class="string">'./js/c.js'</span>])</span><br><span class="line">        .pipe(gulp.dest(<span class="string">'dist'</span>)) <span class="comment">// 将源文件拷贝到打包目录</span></span><br><span class="line">        .pipe(rev())  </span><br><span class="line">        .pipe(gulp.dest(<span class="string">'dist'</span>)) <span class="comment">// 将生成的hash文件添加到打包目录</span></span><br><span class="line">        .pipe(rev.manifest(<span class="string">'js-rev.json'</span>))</span><br><span class="line">        .pipe(gulp.dest(<span class="string">'dist'</span>)) <span class="comment">// 将map映射文件添加到打包目录</span></span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">//将html中的js文件用重名后的名字替换</span></span><br><span class="line">gulp.task(<span class="string">'html2'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> jsManifest = gulp.src(<span class="string">'dist/js-rev.json'</span>); <span class="comment">//获取js映射文件</span></span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="string">'./html/a.html'</span>)</span><br><span class="line">      .pipe(revRewrite(&#123;<span class="attr">manifest</span>: jsManifest&#125;)) <span class="comment">// 把引用的js替换成有版本号的名字</span></span><br><span class="line">      .pipe(gulp.dest(<span class="string">'dist'</span>))</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//当c.js文件发生变化之后，会重新执行js和html2的任务</span></span><br><span class="line">gulp.task(<span class="string">'mywatch'</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">// 1.监视js文件的变化，然后执行script任务</span></span><br><span class="line">    <span class="comment">// 第一个参数：要监视的文件的规则</span></span><br><span class="line">    <span class="comment">// 第二个参数：是要执行的任务</span></span><br><span class="line">    <span class="keyword">return</span> gulp.watch(<span class="string">"./js/c.js"</span>,gulp.series([<span class="string">'js'</span>,<span class="string">'html2'</span>]))</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h4 id="i-gulp对requirejs的打包和压缩"><a href="#i-gulp对requirejs的打包和压缩" class="headerlink" title="i) gulp对requirejs的打包和压缩"></a>i) gulp对requirejs的打包和压缩</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#1.初始化项目，安装gulp</span><br><span class="line">npm init -y</span><br><span class="line">npm install gulp</span><br><span class="line">npm install gulp-requirejs-optimize    <span class="comment">//gulp对于requireJS依赖处理</span></span><br></pre></td></tr></table></figure><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn4J3Krp/uUnjQtxoKSmXQ5.YSnl4gABR0aI1ZMyeCd2hU5y4LngiQHBJUoPiaNAtLDo9BSxCutsRt1BKdZIFWHTE..rqaw!!/b&bo=NwE4ATcBOAEDCSw!&rf=viewer_4"  alt="1547520269520"></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#1.index.html</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;title&gt;requirejs-gulp&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h2&gt;demo&lt;<span class="regexp">/h2&gt;</span></span><br><span class="line"><span class="regexp">    &lt;div&gt;相加的值：&lt;span class="math"&gt;&lt;/</span>span&gt;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    &lt;!--data-main指定js文件的入口--&gt;</span></span><br><span class="line"><span class="regexp">    &lt;script src="./</span><span class="built_in">require</span>.js<span class="string">" data-main="</span>./js/entry.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#2.math.js</span></span><br><span class="line"><span class="string">//定义math模块，该模块依赖于jquery模块，入参$</span></span><br><span class="line"><span class="string">define(['jquery'], function($)&#123;</span></span><br><span class="line"><span class="string">    var math = &#123;</span></span><br><span class="line"><span class="string">        add: function(i,j)&#123;</span></span><br><span class="line"><span class="string">            $('.math').text(i+j)</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">    //requireJS模块需要返回一个对象</span></span><br><span class="line"><span class="string">    return math;</span></span><br><span class="line"><span class="string">&#125;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#3.entry.js</span></span><br><span class="line"><span class="string">//require配置</span></span><br><span class="line"><span class="string">require.config(&#123;</span></span><br><span class="line"><span class="string">    paths: &#123;</span></span><br><span class="line"><span class="string">        "</span>jquery<span class="string">": "</span>./jquery<span class="string">",</span></span><br><span class="line"><span class="string">        "</span>math<span class="string">": "</span>./math<span class="string">",</span></span><br><span class="line"><span class="string">    &#125;,</span></span><br><span class="line"><span class="string">    //requireJS加载非AMD规范的模块，需要用shim(AMD规范是用define和require定义和引入规范)</span></span><br><span class="line"><span class="string">    shim: &#123;</span></span><br><span class="line"><span class="string">        "</span>jquery<span class="string">": &#123;</span></span><br><span class="line"><span class="string">            //exports的值要与文件中暴露出全局变量名称一致</span></span><br><span class="line"><span class="string">            exports: '$'</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">//入口文件引入math模块，function中的入参需要是模块名</span></span><br><span class="line"><span class="string">require(['math'], function(math)&#123;</span></span><br><span class="line"><span class="string">    math.add(3,5);</span></span><br><span class="line"><span class="string">&#125;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#4.项目中引入require.js，然后使用浏览器运行index.html</span></span><br><span class="line"><span class="string">打开network，查看index.html的请求资源数</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#5.使用gulp进行打包构建，在项目根目录下创建gulpfile.js</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">var gulp = require('gulp');</span></span><br><span class="line"><span class="string">var requirejsOptimize = require('gulp-requirejs-optimize');</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">//要进行的任务</span></span><br><span class="line"><span class="string">gulp.task('rjs', function()&#123;</span></span><br><span class="line"><span class="string">    //源文件</span></span><br><span class="line"><span class="string">    return gulp.src('src/js/*.js')</span></span><br><span class="line"><span class="string">    .pipe(</span></span><br><span class="line"><span class="string">        requirejsOptimize(&#123;</span></span><br><span class="line"><span class="string">            optimize: 'none', /*optimize: 'uglify',*/  /*uglify 压缩所有文件*/</span></span><br><span class="line"><span class="string">            paths:&#123;</span></span><br><span class="line"><span class="string">                //.的含义是task任务所在的js文件路径，即生成模块的路径，所以.代表src/js目录，这里要用..</span></span><br><span class="line"><span class="string">                "</span>jquery<span class="string">": '../js/jquery',</span></span><br><span class="line"><span class="string">                'entry': '../js/entry',</span></span><br><span class="line"><span class="string">                'math': '../js/math',</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">        &#125;))</span></span><br><span class="line"><span class="string">        //配置详解：https://blog.csdn.net/xuelang532777032/article/details/55096057</span></span><br><span class="line"><span class="string">    .pipe(gulp.dest('dist/js/'));</span></span><br><span class="line"><span class="string">&#125;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#6.修改index.html中的请求资源路径，再查看浏览器中network中的请求资源数</span></span><br><span class="line"><span class="string">    &lt;script src="</span>./<span class="built_in">require</span>.js<span class="string">" data-main="</span>../dist/js/entry.js<span class="string">"&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><h3 id="1-1-6-webpack"><a href="#1-1-6-webpack" class="headerlink" title="1.1.6 webpack"></a>1.1.6 webpack</h3><blockquote><p>webpack 是前端的一个项目构建工具，它是基于 Node.js 开发出来的一个前端工具；</p></blockquote><ul><li>借助于webpack这个前端自动化构建工具，可以完美实现资源的合并、打包、压缩、混淆等诸多功能。</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"># 在没有使用webpack之前：</span><br><span class="line">举个例子：index.html里面有一大堆的css和js文件，如a.js   b.js   c.js  d.js等等</span><br><span class="line">（<span class="number">1</span>）a.js要用到b.js里面的一个函数，则a.js要放在b.js后面</span><br><span class="line">（<span class="number">2</span>）c.js要用到a.js里面的一个函数，则c.js要放在a.js后面</span><br><span class="line">（<span class="number">3</span>）b.js又要用到d.js文件里面的函数，则b.js就要放在d.js后面</span><br><span class="line">如果有N多个js文件，需要手动处理他们的关系，即容易出错。</span><br><span class="line"></span><br><span class="line"># 使用webpack：</span><br><span class="line">webpack的理念就是一切皆模块化，把一堆的css文件和js文件放在一个总的入口文件，通过<span class="built_in">require</span>引入，剩下的事情webpack会处理，包括所有模块的前后依赖关系，打包、压缩、合并成一个js文件，公共代码抽离成一个js文件、某些自己指定的js单独打包，模块可以是css/js/images/font等等。</span><br></pre></td></tr></table></figure><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn4J3Krp/43eWRH6lLSncPe1pJhVzbb*s7PIQ7gHDU8rcrixpu*Rtad.K2DtV3udjhLxISPEvqkxIZx0RKdH9bvlxiJNX112RWNaO0apdDEp.BE9WFE4!/b&bo=GASDARgEgwEDGTw!&rf=viewer_4"  alt="1547006043567"></p><h3 id="1-1-7-Gulp和webpack对比"><a href="#1-1-7-Gulp和webpack对比" class="headerlink" title="1.1.7 Gulp和webpack对比"></a>1.1.7 Gulp和webpack对比</h3><pre><code>gulp、grunt、webpack都是前端自动化构建工具。</code></pre><h4 id="a-gulp"><a href="#a-gulp" class="headerlink" title="a) gulp"></a>a) gulp</h4><blockquote><p>gulp 和 grunt 非常类似，gulp强调的是前端开发的工作流程，核心都是基于一个个的任务(task)进行项目构建，我们可以通过配置一系列的task，定义task处理的事务（例如文件压缩合并、雪碧图、启动server、版本控制等），然后定义执行顺序，来让gulp执行这些task，从而构建项目的整个前端开发流程。</p><p>只是grunt 会频繁进行 IO 操作，而 gulp 则不需要(<strong>基于管道流</strong>)，可以更高效的完成操作。</p><p>PS：简单说就一个Task Runner</p></blockquote><h4 id="b-webpack"><a href="#b-webpack" class="headerlink" title="b) webpack"></a>b) webpack</h4><blockquote><p>Webpack与Gulp、Grunt没有什么可比性，它把项目看成一个整体，是一个前端模块化方案，更侧重模块打包，我们可以把开发中的所有资源（图片、js文件、css文件等）都看成模块，通过loader（加载器）和plugins（插件）对资源进行处理，打包成符合生产环境部署的前端资源。</p><p>PS：webpack is a module bundle</p></blockquote><h2 id="1-2-webpack的安装"><a href="#1-2-webpack的安装" class="headerlink" title="1.2 webpack的安装"></a>1.2 webpack的安装</h2><pre><code>[WebPack官网](http://webpack.github.io/)</code></pre><ol><li><p>运行<code>npm i webpack@4.27.1 -g</code>全局安装webpack，这样就能在全局使用webpack的命令</p><p><code>npm i webpack-cli@3.1.2 –g</code> 全局安装webpack命令行工具</p></li></ol><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">配置环境变量</span><br></pre></td></tr></table></figure><ol start="2"><li>在项目根目录中运行<code>npm i webpack@4.27.1 --save-dev</code>安装到项目依赖中</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">npm info webpack <span class="comment">//查看npm上的webpack的信息</span></span><br><span class="line"></span><br><span class="line">webpack -v   <span class="comment">//查看当前安装的webpack的版本信息</span></span><br></pre></td></tr></table></figure><h2 id="1-3-webpack打包构建"><a href="#1-3-webpack打包构建" class="headerlink" title="1.3 webpack打包构建"></a>1.3 webpack打包构建</h2><p><a href="https://webpack.docschina.org/guides/getting-started" target="_blank" rel="noopener">https://webpack.docschina.org/guides/getting-started</a></p><h3 id="1-3-1-webpack-列表隔行变色案例"><a href="#1-3-1-webpack-列表隔行变色案例" class="headerlink" title="1.3.1 webpack 列表隔行变色案例"></a>1.3.1 webpack 列表隔行变色案例</h3><ol><li><p>运行<code>npm init -y</code>初始化项目，使用npm管理项目中的依赖包</p></li><li><p>创建项目基本的目录结构</p><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn4J3Krp/43eWRH6lLSncPe1pJhVzbR8.YT6VpZTHtFhmi3L6FN8*.VpnJ4YS4FpDpAhjIMyF.z9yJpCYEnI97ZnMHtGab.eBpWO8BDlvwaiNzToDg*k!/b&bo=6wDcAOsA3AADGTw!&rf=viewer_4"  alt="1545011845124"></p></li><li><p>使用<code>npm i jquery --save</code>安装jquery类库</p></li><li><p>index.html</p></li></ol><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span><span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--不推荐这样用，这样使用会导致当前文件依赖于其他文件--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--&lt;script type="text/javascript" src="../node_modules/jquery/jquery.js"&gt;&lt;/script&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--所以我们把主要的逻辑代码写到main.js中，只要引入一个main.js就可以了--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--&lt;script type="text/javascript" src="main.js"&gt;&lt;/script&gt;--&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!--使用打包后的路径--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"../dist/bundle.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--使用jquery实现隔行渐变--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>A<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>B<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>C<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>D<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>E<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span>F<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="5"><li>创建<code>main.js</code>并书写各行变色的代码逻辑：</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1. 导入 Jquery</span></span><br><span class="line"><span class="comment">// import *** from *** 是ES6中导入模块的方式</span></span><br><span class="line"><span class="comment">// 由于 ES6的代码，太高级了，浏览器解析不了，所以，这一行执行会报错</span></span><br><span class="line"><span class="keyword">import</span> $ <span class="keyword">from</span> <span class="string">'jquery'</span></span><br><span class="line"><span class="comment">//const $ = require('jquery')   express导包的语法，vue中使用es6导包的语法，import .. from ..</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置偶数行背景色，索引从0开始，0是偶数</span></span><br><span class="line">$(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  $(<span class="string">'li:odd'</span>).css(<span class="string">'backgroundColor'</span>, <span class="string">'yellow'</span>)</span><br><span class="line">  $(<span class="string">'li:even'</span>).css(<span class="string">'backgroundColor'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">'#'</span> + <span class="string">'D97634'</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><ol start="6"><li>注意点</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span> 直接在页面上引用main.js会报错，因为浏览器不认识<span class="keyword">import</span>这种高级的JS语法，需要使用webpack进行处理，webpack默认会把这种高级的语法转换为低级的浏览器能识别的语法；</span><br><span class="line"><span class="number">2.</span> 运行webpack 入口文件路径 输出文件路径对main.js进行处理：</span><br><span class="line">    webpack ./src/main.js -o ./dist/bundle.js</span><br><span class="line"><span class="number">3.</span>webpack使用的是CommonJS模块化规范，即<span class="built_in">require</span>引入模块，<span class="built_in">module</span>.exports导出模块</span><br><span class="line">   Vue中使用的是ES6的模块化规范，即<span class="keyword">import</span> ** <span class="keyword">from</span> **引入模块，<span class="keyword">export</span> /<span class="keyword">export</span> <span class="keyword">default</span>导出模块</span><br></pre></td></tr></table></figure><ol start="7"><li>webstorm中的cmd</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">点击左下角的Terminal</span><br><span class="line">如果要运行package.json中的指令，可以选择tools--&gt;run gulp/grunt/npm task</span><br></pre></td></tr></table></figure><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn4J3Krp/43eWRH6lLSncPe1pJhVzbWuNT4MYGUWdwu7EC9*fWaRPGA9yRXQJ*FfUQrAW1DkjKJRFqF6nMgw4yZPQ5eUkf2Mc9GCyOz3Hlib*M94ssRY!/b&bo=EwIbARMCGwEDGTw!&rf=viewer_4"  alt="1545021824702"></p><h3 id="1-3-2-webpack配置文件使用"><a href="#1-3-2-webpack配置文件使用" class="headerlink" title="1.3.2 webpack配置文件使用"></a>1.3.2 webpack配置文件使用</h3><ol><li>在项目根目录中创建<code>webpack.config.js</code></li><li>由于运行webpack命令的时候，webpack需要指定入口文件和输出文件的路径，所以，我们需要在<code>webpack.config.js</code>中配置这两个路径：</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 导入处理路径的模块</span></span><br><span class="line"><span class="keyword">var</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 导出一个配置对象，将来webpack在启动的时候，会默认来查找webpack.config.js，并读取这个文件中导出的配置对象，来进行打包处理</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: path.resolve(__dirname, <span class="string">'src/main.js'</span>), <span class="comment">// 项目入口文件</span></span><br><span class="line">    output: &#123; <span class="comment">// 配置输出选项</span></span><br><span class="line">        path: path.resolve(__dirname, <span class="string">'dist'</span>), <span class="comment">// 配置输出的路径</span></span><br><span class="line">        filename: <span class="string">'bundle.js'</span> <span class="comment">// 配置输出的文件名</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>使用命令打包构建</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"># 使用webpack命令即可打包项目、</span><br><span class="line">webpack   <span class="comment">//没有指定webpack打包的配置文件，默认使用项目根路径下的webpack.config.js文件</span></span><br><span class="line">webpack --config webpack.config.js  <span class="comment">//指定webpack打包的时候使用的配置文件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 当我们在控制台，直接输入 webpack 命令执行的时候，webpack 做了以下几步：</span></span><br><span class="line"><span class="comment">//  1. 首先webpack 发现我们并没有通过命令的形式给它指定入口和出口</span></span><br><span class="line"><span class="comment">//  2. webpack 就会去项目的根目录中查找一个叫做 `webpack.config.js` 的配置文件</span></span><br><span class="line"><span class="comment">//  3. 当找到配置文件后，webpack会去解析执行这个配置文件，当解析执行完配置文件后，就得到了 配置文件中，导出的配置对象</span></span><br><span class="line"><span class="comment">//  4. 当 webpack拿到配置对象后，就拿到了配置对象中指定的入口和出口，然后进行打包构建；</span></span><br></pre></td></tr></table></figure><h3 id="1-3-3-webpack实时打包构建"><a href="#1-3-3-webpack实时打包构建" class="headerlink" title="1.3.3 webpack实时打包构建"></a>1.3.3 webpack实时打包构建</h3><ol><li><p>由于每次重新修改代码之后，都需要手动运行webpack打包的命令，比较麻烦，所以使用<code>webpack-dev-server</code>来实现代码实时打包编译，当修改代码之后，会自动进行打包构建。</p></li><li><p>安装webpack-dev-server</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">npm i webpack-dev-server@<span class="number">3.1</span><span class="number">.9</span> --save-dev</span><br><span class="line">npm i webpack@<span class="number">4.27</span><span class="number">.1</span> --save-dev     <span class="comment">//项目中安装webpack</span></span><br><span class="line">npm i webpack-cli@<span class="number">3.1</span><span class="number">.2</span></span><br></pre></td></tr></table></figure></li><li><p>安装完成之后，在命令行直接运行<code>webpack-dev-server</code>来进行打包，发现报错，因为它不是全局命令，不可以直接使用。</p></li><li><p>我们借助于<code>package.json</code>文件中的指令来进行运行<code>webpack-dev-server</code>命令，在<code>scripts</code>节点下新增<code>&quot;dev&quot;: &quot;webpack-dev-server&quot;</code>指令，发现可以进行实时打包</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">  <span class="string">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>,</span><br><span class="line">  <span class="string">"dev"</span>: <span class="string">"webpack-dev-server"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>运行项目</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure><p>但是dist目录下并没有生成<code>bundle.js</code>文件，这是因为<code>webpack-dev-server</code>将打包好的文件放在了内存中。把bundle.js放在内存中的好处是：由于需要实时打包编译，所以放在内存中速度会非常快</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Project is running at  [1m [34mhttp:&#x2F;&#x2F;localhost:8084&#x2F; [39m[22m</span><br><span class="line">webpack output is served from &#x2F;</span><br></pre></td></tr></table></figure><pre><code>此时我们可以通过http://localhost:8083/bundle.js 文件，因为webpack-dev-server默认是将bundle.js文件打包到根路径，所以要能做到修改main.js之后页面也要同步变化，需要修改页面的script标签：</code></pre></li></ol>   <figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&lt;script type&#x3D;&quot;text&#x2F;javascript&quot; src&#x3D;&quot;..&#x2F;bundle.js&quot;&gt;&lt;&#x2F;script&gt;</span><br></pre></td></tr></table></figure><p>   6.指定启动参数：</p><pre><code>为了能在访问http://localhost:8080/的时候直接访问到index首页，可以使用--contentBase src指令来修改dev指令，指定启动的根目录：</code></pre><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">   <span class="string">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>,</span><br><span class="line">   <span class="string">"dev"</span>: <span class="string">"webpack-dev-server --open --port 3001 --contentBase src --hot"</span></span><br><span class="line"> &#125;,</span><br><span class="line"> </span><br><span class="line"> <span class="comment">//  --open含义：构建完成自动打开浏览器</span></span><br><span class="line"> <span class="comment">//  --port 3001 : 指定运行的端口</span></span><br><span class="line"> <span class="comment">//  --contentBase src   :  指定运行的根目录是src，即认为src就是项目根目录</span></span><br><span class="line"> <span class="comment">//  --hot : 以补丁的方式修改文件，而不是修改全部文件</span></span><br></pre></td></tr></table></figure><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn4J3Krp/43eWRH6lLSncPe1pJhVzbQMHtNdJffaeDy7gGwmET1DyxWN0NPN1jdOWbQYV8B.yNnlVgiDn9115mhM5VOeFSEIn5skOR4Go2aOviqNuCT0!/b&bo=TgJTAE4CUwADGTw!&rf=viewer_4"  alt="1545024701179"></p><pre><code>7.解决webpack4.0之后打包大小警告和热更新慢的问题https://cloud.tencent.com/developer/section/1477466</code></pre><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#main.js </span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="comment">//1.设置为开发模式，不然热更新会比较缓慢</span></span><br><span class="line">    mode:<span class="string">"development"</span>,</span><br><span class="line">    entry: path.resolve(__dirname, <span class="string">'src/main.js'</span>),</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.resolve(__dirname, <span class="string">'dist'</span>),</span><br><span class="line">        filename: <span class="string">'bundle.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//2.打包文件大小警告和错误的问题</span></span><br><span class="line">    performance: &#123;</span><br><span class="line">        hints:<span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1-3-3-使用配置文件生成参数-了解"><a href="#1-3-3-使用配置文件生成参数-了解" class="headerlink" title="1.3.3 使用配置文件生成参数(了解)"></a>1.3.3 使用配置文件生成参数(了解)</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="comment">// 启用热更新的 第2步</span></span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">  entry: path.join(__dirname, <span class="string">'./src/main.js'</span>),</span><br><span class="line">  output: &#123; </span><br><span class="line">    path: path.join(__dirname, <span class="string">'./dist'</span>), </span><br><span class="line">    filename: <span class="string">'bundle.js'</span></span><br><span class="line">  &#125;,</span><br><span class="line">  devServer: &#123; </span><br><span class="line">    <span class="comment">// 这是配置 dev-server 命令参数的第二种形式，相对来说，这种方式麻烦一些</span></span><br><span class="line">    <span class="comment">//  --open --port 3000 --contentBase src --hot</span></span><br><span class="line">    open: <span class="literal">true</span>, <span class="comment">// 自动打开浏览器</span></span><br><span class="line">    port: <span class="number">3000</span>, <span class="comment">// 设置启动时候的运行端口</span></span><br><span class="line">    contentBase: <span class="string">'src'</span>, <span class="comment">// 指定托管的根目录</span></span><br><span class="line">    hot: <span class="literal">true</span> <span class="comment">// 启用热更新 的 第1步</span></span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [ <span class="comment">// 配置插件的节点</span></span><br><span class="line">    <span class="keyword">new</span> webpack.HotModuleReplacementPlugin(), <span class="comment">// new 一个热更新的 模块对象， 这是 启用热更新的第 3 步</span></span><br><span class="line">  ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1-3-4-html-webpack-plugin插件配置启动页面"><a href="#1-3-4-html-webpack-plugin插件配置启动页面" class="headerlink" title="1.3.4 html-webpack-plugin插件配置启动页面"></a>1.3.4 html-webpack-plugin插件配置启动页面</h3><pre><code>https://www.npmjs.com/package/html-webpack-pluginhtml-webpack-plugin插件可以**将指定页面配置生成到内存中**，并且可以**将打包的bundle.js配置到内存中生成的html页面中**，使用步骤如下：</code></pre><ol><li>运行<code>npm i html-webpack-plugin@3.2.0 --save-dev</code>安装到开发依赖</li><li>修改<code>webpack.config.js</code>配置文件如下：</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="comment">// 导入自动生成HTMl文件的插件</span></span><br><span class="line"><span class="keyword">var</span> htmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: path.join(__dirname, <span class="string">'./src/main.js'</span>),</span><br><span class="line">    output: &#123; </span><br><span class="line">        path: path.join(__dirname, <span class="string">'./dist'</span>), </span><br><span class="line">        filename: <span class="string">'bundle.js'</span> </span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [ </span><br><span class="line">        <span class="comment">// 添加plugins节点配置插件</span></span><br><span class="line">        <span class="keyword">new</span> htmlWebpackPlugin(&#123;</span><br><span class="line">            template:path.resolve(__dirname, <span class="string">'src/index.html'</span>),<span class="comment">//模板路径</span></span><br><span class="line">            filename:<span class="string">'index.html'</span><span class="comment">//自动生成的HTML文件的名称</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>修改<code>package.json</code>中<code>script</code>节点中的dev指令如下：</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>,</span><br><span class="line">    <span class="string">"dev"</span>: <span class="string">"webpack-dev-server --open --port 3001 --contentBase src --hot"</span></span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><ol start="4"><li>将index.html中script标签注释掉，因为<code>html-webpack-plugin</code>插件会自动把bundle.js注入到index.html页面中！</li></ol><h3 id="1-3-5-使用webpack打包css文件"><a href="#1-3-5-使用webpack打包css文件" class="headerlink" title="1.3.5 使用webpack打包css文件"></a>1.3.5 使用webpack打包css文件</h3><pre><code>一般情况下，我们并不推荐在html页面中直接引入其他css文件，这样会导致过多的请求。对应的，我们可以使用webpack来构建。使用步骤如下：</code></pre><ol><li>运行 <code>npm i style-loader css-loader --save-dev</code></li><li>main.js中引入index.css</li></ol><figure class="highlight"><table><tr><td class="code"><pre><span class="line">import "./css/index.css"</span><br></pre></td></tr></table></figure><ol start="3"><li>修改<code>webpack.config.js</code>这个配置文件：</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 用来配置第三方loader模块的</span></span><br><span class="line"><span class="built_in">module</span>: &#123; </span><br><span class="line">    rules: [ </span><br><span class="line">        <span class="comment">// 匹配以.css结尾的文件</span></span><br><span class="line">        &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>] &#125;<span class="comment">//处理css文件的规则</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>webpack 处理第三方文件类型的过程</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span> 发现这个要处理的文件不是JS文件，然后就去配置文件中，查找有没有对应的第三方 loader 规则</span><br><span class="line"><span class="number">2.</span> 如果能找到对应的规则， 就会调用对应的loader处理这种文件类型；</span><br><span class="line"><span class="number">3.</span> 在调用loader的时候，use中相关loader模块的调用顺序是从后向前调用的；</span><br><span class="line"><span class="number">4.</span> 当最后的一个loader调用完毕，会把处理的结果直接交给 webpack 进行打包合并，最终输出到  bundle.js 中去</span><br></pre></td></tr></table></figure><h3 id="1-3-6-使用webpack打包less文件"><a href="#1-3-6-使用webpack打包less文件" class="headerlink" title="1.3.6 使用webpack打包less文件"></a>1.3.6 使用webpack打包less文件</h3><ol><li>运行<code>npm i less-loader less</code>，需要同时安装less-loader和less</li><li>main.js中引入index.less</li></ol><figure class="highlight"><table><tr><td class="code"><pre><span class="line">import "./css/index.less"</span><br></pre></td></tr></table></figure><ol start="3"><li>修改<code>webpack.config.js</code>这个配置文件：</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123; <span class="comment">// 用来配置第三方loader模块的</span></span><br><span class="line">    rules: [ <span class="comment">// 文件的匹配规则</span></span><br><span class="line">        &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>] &#125;,<span class="comment">//处理css文件的规则</span></span><br><span class="line">        &#123; <span class="attr">test</span>: <span class="regexp">/\.less$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'less-loader'</span>] &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1-3-7-使用webpack打包sass文件"><a href="#1-3-7-使用webpack打包sass文件" class="headerlink" title="1.3.7 使用webpack打包sass文件"></a>1.3.7 使用webpack打包sass文件</h3><ol><li>运行<code>npm i sass-loader@7.3.1 node-sass --save-dev</code></li><li>main.js中引入index.scss   </li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//注意：文件名是scss结尾</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"./css/index.scss"</span></span><br></pre></td></tr></table></figure><ol start="3"><li>在<code>webpack.config.js</code>中添加处理scss文件的loader模块：</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123; <span class="comment">// 用来配置第三方loader模块的</span></span><br><span class="line">    rules: [ <span class="comment">// 文件的匹配规则</span></span><br><span class="line">        &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>] &#125;,<span class="comment">//处理css文件的规则</span></span><br><span class="line">        &#123; <span class="attr">test</span>: <span class="regexp">/\.less$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'less-loader'</span>] &#125;,</span><br><span class="line">        &#123; <span class="attr">test</span>: <span class="regexp">/\.scss$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'sass-loader'</span>] &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1-3-8-使用webpack处理css中的路径"><a href="#1-3-8-使用webpack处理css中的路径" class="headerlink" title="1.3.8 使用webpack处理css中的路径"></a>1.3.8 使用webpack处理css中的路径</h3><ol><li>运行<code>npm i url-loader file-loader --save-dev</code></li><li>在<code>webpack.config.js</code>中添加处理url路径的loader模块：</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123; <span class="comment">// 用来配置第三方loader模块的</span></span><br><span class="line">    rules: [ <span class="comment">// 文件的匹配规则</span></span><br><span class="line">        &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>] &#125;,<span class="comment">//处理css文件的规则</span></span><br><span class="line">        &#123; <span class="attr">test</span>: <span class="regexp">/\.less$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'less-loader'</span>] &#125;,</span><br><span class="line">        &#123; <span class="attr">test</span>: <span class="regexp">/\.scss$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'sass-loader'</span>] &#125;,</span><br><span class="line">        &#123; <span class="attr">test</span>: <span class="regexp">/\.(png|jpg|gif|bmp|jpeg)$/</span>, <span class="attr">use</span>: <span class="string">'url-loader'</span> &#125;</span><br><span class="line">    ]</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><ol start="3"><li>index.css</li></ol><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">div</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">600px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">450px</span>;</span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(../images/<span class="number">1</span>.jpg);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><pre><code>注意点：url-loader默认情况下会将图片转换为base64编码的图片，好处是可以减少图片的二次请求。但是这种方式一般情况下适用于小图，如果是大图，我们可以像下面这样去使用：</code></pre><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123; <span class="comment">// 用来配置第三方loader模块的</span></span><br><span class="line">    rules: [ <span class="comment">// 文件的匹配规则</span></span><br><span class="line">        &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>] &#125;,<span class="comment">//处理css文件的规则</span></span><br><span class="line">        &#123; <span class="attr">test</span>: <span class="regexp">/\.less$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'less-loader'</span>] &#125;,</span><br><span class="line">        &#123; <span class="attr">test</span>: <span class="regexp">/\.scss$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'sass-loader'</span>] &#125;,</span><br><span class="line">        &#123; <span class="attr">test</span>: <span class="regexp">/\.(png|jpg|gif|bmp|jpeg)$/</span>,</span><br><span class="line">         use: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: <span class="string">'url-loader'</span>,</span><br><span class="line">                        options: &#123;</span><br><span class="line">                            limit: <span class="number">8192</span>,</span><br><span class="line">                            name:<span class="string">'[hash:8]-[name].[ext]'</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//limit ： 当图片大小小于等于指定的值时会进行base64编码</span></span><br><span class="line"><span class="comment">//name =[name].[ext]： 不给图片重命名，还是使用原图名。如果没有这个属性，则默认会使用hashcode的方式来给图片重命名。</span></span><br><span class="line"><span class="comment">//给图片重命名的好处是：如果在多个不同的目录下有两张同名的图片(内容不同)，不会产生冲突。(默认情况下webpack会将图片也打包到根路径下)</span></span><br><span class="line"><span class="comment">//如果既想多个文件夹下的同名的图片被打包后不冲突，又想保留原来的图片名字，可以这样使用：name=[hash:8]-[name].[ext]  ，  [hash:8]表示保留8位hash值，然后再去追加原来的[name]</span></span><br></pre></td></tr></table></figure><h3 id="1-3-9-使用webpack处理字体图标"><a href="#1-3-9-使用webpack处理字体图标" class="headerlink" title="1.3.9 使用webpack处理字体图标"></a>1.3.9 使用webpack处理字体图标</h3><p>1.运行<code>npm i bootstrap@3.3.5</code>安装boostrap</p><p>2.main.js引入bootstrap</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//注意：这边import的时候不需要加上 node_modules目录，import前面没有路径的时候会自动从node_modules目录下去查找</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">"bootstrap/dist/css/bootstrap.css"</span></span><br></pre></td></tr></table></figure><p>3.index.html</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"glyphicon glyphicon-heart-empty"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br></pre></td></tr></table></figure><p>4.webpack.config.js修改匹配规则。因为boostrap的字体文件中也使用了url，所以字体文件的路径一样要处理</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123; <span class="comment">// 用来配置第三方loader模块的</span></span><br><span class="line">    rules: [ <span class="comment">// 文件的匹配规则</span></span><br><span class="line">        &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>] &#125;,<span class="comment">//处理css文件的规则</span></span><br><span class="line">        &#123; <span class="attr">test</span>: <span class="regexp">/\.less$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'less-loader'</span>] &#125;,</span><br><span class="line">        &#123; <span class="attr">test</span>: <span class="regexp">/\.scss$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'sass-loader'</span>] &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">                test: <span class="regexp">/\.(png|jpg|gif|bmp|jpeg)$/</span>,</span><br><span class="line">                use: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: <span class="string">'url-loader'</span>,</span><br><span class="line">                        options: &#123;</span><br><span class="line">                            limit: <span class="number">8192</span>,</span><br><span class="line">                            name:<span class="string">'[hash:8]-[name].[ext]'</span></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;   <span class="attr">test</span>: <span class="regexp">/\.(ttf|eot|svg|woff|woff2)$/</span>,</span><br><span class="line">                use: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader:<span class="string">'url-loader'</span></span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;, <span class="comment">// 处理 字体文件的 loader</span></span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1-3-10-webpack中babel的配置"><a href="#1-3-10-webpack中babel的配置" class="headerlink" title="1.3.10 webpack中babel的配置"></a>1.3.10 webpack中babel的配置</h3><pre><code>在 webpack 中，默认只能处理一部分 ES6 的新语法；这时候就需要借助于第三方的 loader，来帮助webpack 处理这些高级的语法，当第三方loader可以把高级语法转为低级的语法，然后再把结果交给 webpack 去打包到 bundle.js 中</code></pre><ol><li>运行<code>npm i babel-core@6.26.3 babel-loader@7.1.5 babel-plugin-transform-runtime --save-dev</code>安装babel的相关loader包 (babel的转换工具)</li><li>运行<code>npm i babel-preset-env babel-preset-stage-0 --save-dev</code>安装babel转换的语法 (es6的语法和es5的语法的对应关系)</li><li>在<code>webpack.config.js</code>中添加相关loader模块，其中需要注意的是，一定要把<code>node_modules</code>文件夹添加到排除项：</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123; <span class="comment">// 用来配置第三方loader模块的</span></span><br><span class="line">    rules: [ <span class="comment">// 文件的匹配规则</span></span><br><span class="line">        &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>] &#125;,<span class="comment">//处理css文件的规则</span></span><br><span class="line">        &#123; <span class="attr">test</span>: <span class="regexp">/\.less$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'less-loader'</span>] &#125;,</span><br><span class="line">        &#123; <span class="attr">test</span>: <span class="regexp">/\.scss$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'sass-loader'</span>] &#125;,</span><br><span class="line">        &#123; <span class="attr">test</span>: <span class="regexp">/\.(png|jpg|gif|bmp|jpeg)$/</span>, <span class="attr">use</span>: <span class="string">'url-loader?limit=1024&amp;name=[hash:8]-[name].[ext]'</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">test</span>: <span class="regexp">/\.(ttf|eot|svg|woff|woff2)$/</span>, <span class="attr">use</span>: <span class="string">'url-loader'</span> &#125;, <span class="comment">// 处理 字体文件的 loader</span></span><br><span class="line">        <span class="comment">//配置 babel 的 loader规则的时候，必须 把 node_modules 目录，通过 exclude 选项排除掉</span></span><br><span class="line">        &#123; <span class="attr">test</span>: <span class="regexp">/\.js$/</span>, <span class="attr">use</span>: <span class="string">'babel-loader'</span>, <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span> &#125;,</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="4"><li>在项目根目录中添加<code>.babelrc</code>文件，并修改这个配置文件如下(这个文件必须符合json的语法，不能有注释。字符串必须使用双引号)：</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">"presets"</span>: [<span class="string">"env"</span>, <span class="string">"stage-0"</span>],</span><br><span class="line">  <span class="string">"plugins"</span>: [<span class="string">"transform-runtime"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>注意：之前用的比较多的语法插件<code>babel-preset-es2015</code>更新为<code>babel-preset-env</code>，它包含了所有的ES相关的语法；</strong></p><h3 id="1-3-11-所有配置总结"><a href="#1-3-11-所有配置总结" class="headerlink" title="1.3.11 所有配置总结"></a>1.3.11 所有配置总结</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"># 1.安装</span><br><span class="line">npm i webpack@<span class="number">4.20</span><span class="number">.1</span> --save-dev                   <span class="comment">//安装webpack</span></span><br><span class="line">npm init -y                                                       <span class="comment">//项目初始化</span></span><br><span class="line">npm i webpack-dev-server@<span class="number">3.1</span><span class="number">.9</span> --save-dev      <span class="comment">//实时打包构建</span></span><br><span class="line">npm i webpack-cli@<span class="number">3.1</span><span class="number">.2</span>      </span><br><span class="line">npm i html-webpack-plugin@<span class="number">3.2</span><span class="number">.0</span> --save-dev      <span class="comment">//配置内存页面</span></span><br><span class="line">npm i style-loader css-loader --save-dev               <span class="comment">//css加载器</span></span><br><span class="line">npm i less-loader less                                             <span class="comment">//less加载器</span></span><br><span class="line">npm i sass-loader@<span class="number">7.3</span><span class="number">.1</span> node-sass --save-dev               <span class="comment">//sass加载器</span></span><br><span class="line">npm i url-loader file-loader --save-dev                 <span class="comment">//url加载器</span></span><br><span class="line">npm i babel-core@<span class="number">6.26</span><span class="number">.3</span> babel-loader@<span class="number">7.1</span><span class="number">.5</span> babel-plugin-transform-runtime --save-dev    <span class="comment">//babel转换工具</span></span><br><span class="line">npm i babel-preset-env babel-preset-stage<span class="number">-0</span> --save-dev           <span class="comment">//babel转换的语法</span></span><br><span class="line"></span><br><span class="line">#2.webpack.config.js</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>)</span><br><span class="line"><span class="comment">// 导入自动生成HTMl文件的插件</span></span><br><span class="line"><span class="keyword">var</span> htmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: path.join(__dirname, <span class="string">'./src/main.js'</span>),</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.join(__dirname, <span class="string">'./dist'</span>),</span><br><span class="line">        filename: <span class="string">'bundle.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="comment">// 添加plugins节点配置插件</span></span><br><span class="line">        <span class="keyword">new</span> htmlWebpackPlugin(&#123;</span><br><span class="line">            template:path.resolve(__dirname, <span class="string">'src/index.html'</span>),<span class="comment">//模板路径</span></span><br><span class="line">            filename:<span class="string">'index.html'</span><span class="comment">//自动生成的HTML文件的名称</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">    <span class="built_in">module</span>: &#123; <span class="comment">// 用来配置第三方loader模块的</span></span><br><span class="line">        rules: [ <span class="comment">// 文件的匹配规则</span></span><br><span class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>] &#125;,<span class="comment">//处理css文件的规则</span></span><br><span class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.less$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'less-loader'</span>] &#125;,</span><br><span class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.scss$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>, <span class="string">'sass-loader'</span>] &#125;,</span><br><span class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.(png|jpg|gif|bmp|jpeg)$/</span>, <span class="attr">use</span>: <span class="string">'url-loader?limit=1024&amp;name=[hash:8]-[name].[ext]'</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.(ttf|eot|svg|woff|woff2)$/</span>, <span class="attr">use</span>: <span class="string">'url-loader'</span> &#125;, <span class="comment">// 处理 字体文件的 loader</span></span><br><span class="line">            <span class="comment">//配置 babel 的 loader规则的时候，必须 把 node_modules 目录，通过 exclude 选项排除掉</span></span><br><span class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.js$/</span>, <span class="attr">use</span>: <span class="string">'babel-loader'</span>, <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span> &#125;,</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#3.项目入口文件</span><br><span class="line"><span class="keyword">import</span> <span class="string">"./css/index.css"</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"ok"</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(name,age)&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">    showInfo()&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Person(<span class="string">"xiaoming"</span>,<span class="number">18</span>);</span><br><span class="line"><span class="built_in">console</span>.log(p.name);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#4.package.json</span><br><span class="line"> <span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>,</span><br><span class="line">    <span class="string">"dev"</span>: <span class="string">"webpack-dev-server --open --port 3000 --contentBase src --hot"</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">#5.项目根目录 .babelrc</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"presets"</span>: [<span class="string">"env"</span>, <span class="string">"stage-0"</span>],</span><br><span class="line">  <span class="string">"plugins"</span>: [<span class="string">"transform-runtime"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="1-4-相关文章"><a href="#1-4-相关文章" class="headerlink" title="1.4 相关文章"></a>1.4 相关文章</h2><p><a href="https://segmentfault.com/p/1210000008466178" target="_blank" rel="noopener">babel-preset-env：你需要的唯一Babel插件</a><br><a href="https://segmentfault.com/a/1190000009065987" target="_blank" rel="noopener">Runtime transform 运行时编译es6</a></p><h1 id="2-Vue结合webpack的使用"><a href="#2-Vue结合webpack的使用" class="headerlink" title="2.Vue结合webpack的使用"></a>2.Vue结合webpack的使用</h1><h3 id="2-1-基本使用"><a href="#2-1-基本使用" class="headerlink" title="2.1 基本使用"></a>2.1 基本使用</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#1.安装vue</span><br><span class="line">   运行npm i vue@<span class="number">2.3</span><span class="number">.4</span>将vue安装为运行依赖</span><br><span class="line">   </span><br><span class="line">#2.main.js</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> 注意：在webpack中使用 import Vue from 'vue'导入的Vue构造函数功能不完整，只提供了runtime-only的方式，并没有提供像网页中那样的使用方式；</span></span><br><span class="line"><span class="comment"> import Vue from 'vue' 导入包的规则：</span></span><br><span class="line"><span class="comment">   1. 找项目根目录中有没有 node_modules 的文件夹</span></span><br><span class="line"><span class="comment">   2. 在node_modules中根据包名，找对应的vue文件夹</span></span><br><span class="line"><span class="comment">   3. 在vue文件夹中，找一个叫做 package.json 的包配置文件</span></span><br><span class="line"><span class="comment">   4. 在package.json文件中，查找一个 main 属性【main属性指定了这个包在被加载时候的入口文件】，这里我们发现入口文件为vue.runtime.common.js，并不是vue.js文件</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> 解决方案有两种：</span></span><br><span class="line"><span class="comment">   1.在webpack.config.js下新增配置：</span></span><br><span class="line"><span class="comment">       resolve: &#123;</span></span><br><span class="line"><span class="comment">            alias: &#123;</span></span><br><span class="line"><span class="comment">                'vue$': 'vue/dist/vue.js'</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        </span></span><br><span class="line"><span class="comment">        然后使用 import Vue from 'vue'  就可以了</span></span><br><span class="line"><span class="comment">        </span></span><br><span class="line"><span class="comment">   2.手动修改导包的路径为：import Vue from 'vue/dist/vue''，此时无需修改配置文件</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> login = &#123;</span><br><span class="line">   template: <span class="string">'&lt;h1&gt;这是login组件，是使用网页中形式创建出来的组件&lt;/h1&gt;'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">        msg: <span class="string">'123'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    components:&#123;</span><br><span class="line">        login</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">#3.index.html</span><br><span class="line">&lt;div id=<span class="string">"app"</span>&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123;msg&#125;&#125;&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">&lt;login&gt;&lt;/</span>login&gt;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">#4.webpack.config.js</span></span><br><span class="line"><span class="regexp">resolve: &#123;</span></span><br><span class="line"><span class="regexp">    alias: &#123;</span></span><br><span class="line"><span class="regexp">        'vue$': 'vue/</span>dist/vue.js<span class="string">'</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#5.package.json、.babelrc还有webpack的所需要安装的内容和之前一致</span></span><br></pre></td></tr></table></figure><h3 id="2-2-使用-vue文件的方式生成组件"><a href="#2-2-使用-vue文件的方式生成组件" class="headerlink" title="2.2 使用.vue文件的方式生成组件"></a>2.2 使用.vue文件的方式生成组件</h3><pre><code>vscode中安装vetur插件，可以格式化html、标准css（有分号 、大括号的那种）、标准js（有分号 、双引号的那种）、vue文件webstorm中支持vue文件的提示，需要安装插件</code></pre><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#1. 新建login.vue文件</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h1&gt;这是登录组件，使用 .vue 文件定义出来的 &lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">  &lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">#2.main.js引入.vue文件，并使用</span></span><br><span class="line"><span class="regexp">import Vue from 'vue'</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">import login from './</span>login.vue<span class="string">'</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">var vm = new Vue(&#123;</span></span><br><span class="line">    el: '#app',</span><br><span class="line">    data: &#123;</span><br><span class="line">        msg: <span class="string">'123'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    components:&#123;</span><br><span class="line">        login</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">#3. index.html</span><br><span class="line">&lt;div id=<span class="string">"app"</span>&gt;</span><br><span class="line">    &lt;p&gt;&#123;&#123;msg&#125;&#125;&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">    &lt;login&gt;&lt;/</span>login&gt;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">#4.安装vue-loader和 vue-template-compiler(默认情况下不支持import方式引入.vue文件，需要安装下面两个文件)</span></span><br><span class="line"><span class="regexp">npm i vue-loader@15.4.2 vue-template-compiler@2.3.4</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/注意：这里vue-template-compiler版本需要和当前使用的vue版本一致</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">#5.webpack.config.js</span></span><br><span class="line"><span class="regexp">const path = require('path')</span></span><br><span class="line"><span class="regexp">var htmlWebpackPlugin = require('html-webpack-plugin');</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/1.引入VueLoaderPlugin插件(在vue-loader15版本以后需要配置这个)</span></span><br><span class="line"><span class="regexp">const VueLoaderPlugin = require('vue-loader/</span>lib/plugin<span class="string">');</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">module.exports = &#123;</span></span><br><span class="line"><span class="string">    entry: path.join(__dirname, '</span>./src/main.js<span class="string">'),</span></span><br><span class="line"><span class="string">    output: &#123;</span></span><br><span class="line"><span class="string">        path: path.join(__dirname, '</span>./dist<span class="string">'),</span></span><br><span class="line"><span class="string">        filename: '</span>bundle.js<span class="string">'</span></span><br><span class="line"><span class="string">    &#125;,</span></span><br><span class="line"><span class="string">    plugins: [</span></span><br><span class="line"><span class="string">        new htmlWebpackPlugin(&#123;</span></span><br><span class="line"><span class="string">            template:path.resolve(__dirname, '</span>src/index.html<span class="string">'),//模板路径</span></span><br><span class="line"><span class="string">            filename:'</span>index.html<span class="string">'//自动生成的HTML文件的名称</span></span><br><span class="line"><span class="string">        &#125;),</span></span><br><span class="line"><span class="string">        // 2.配置VueLoaderPlugin插件</span></span><br><span class="line"><span class="string">        new VueLoaderPlugin()</span></span><br><span class="line"><span class="string">    ],</span></span><br><span class="line"><span class="string">    module: &#123; </span></span><br><span class="line"><span class="string">        rules: [ </span></span><br><span class="line"><span class="string">            &#123; test: /\.css$/, use: ['</span>style-loader<span class="string">', '</span>css-loader<span class="string">'] &#125;,</span></span><br><span class="line"><span class="string">            &#123; test: /\.less$/, use: ['</span>style-loader<span class="string">', '</span>css-loader<span class="string">', '</span>less-loader<span class="string">'] &#125;,</span></span><br><span class="line"><span class="string">            &#123; test: /\.scss$/, use: ['</span>style-loader<span class="string">', '</span>css-loader<span class="string">', '</span>sass-loader<span class="string">'] &#125;,</span></span><br><span class="line"><span class="string">            &#123; test: /\.(png|jpg|gif|bmp|jpeg)$/, use: '</span>url-loader?limit=<span class="number">1024</span>&amp;name=[hash:<span class="number">8</span>]-[name].[ext]<span class="string">' &#125;,</span></span><br><span class="line"><span class="string">            &#123; test: /\.(ttf|eot|svg|woff|woff2)$/, use: '</span>url-loader<span class="string">' &#125;, </span></span><br><span class="line"><span class="string">            &#123; test: /\.js$/, use: '</span>babel-loader<span class="string">', exclude: /node_modules/ &#125;,</span></span><br><span class="line"><span class="string">            //3.处理 .vue 文件的 loader</span></span><br><span class="line"><span class="string">            &#123; test: /\.vue$/, use: '</span>vue-loader<span class="string">' &#125; </span></span><br><span class="line"><span class="string">        ]</span></span><br><span class="line"><span class="string">    &#125;,</span></span><br><span class="line"><span class="string">    resolve: &#123;</span></span><br><span class="line"><span class="string">        alias: &#123;</span></span><br><span class="line"><span class="string">           '</span>vue$<span class="string">': '</span>vue/dist/vue.js<span class="string">'</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="2-3-render渲染组件"><a href="#2-3-render渲染组件" class="headerlink" title="2.3 render渲染组件"></a>2.3 render渲染组件</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#main.js</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> login <span class="keyword">from</span> <span class="string">'./login.vue'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">        msg: <span class="string">'123'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    render: <span class="function"><span class="params">c</span> =&gt;</span> c(login)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">//注意：此种方式会替换页面内容</span></span><br></pre></td></tr></table></figure><h3 id="2-4-vue组件中的数据"><a href="#2-4-vue组件中的数据" class="headerlink" title="2.4 .vue组件中的数据"></a>2.4 .vue组件中的数据</h3><h4 id="2-4-1-模块的导出"><a href="#2-4-1-模块的导出" class="headerlink" title="2.4.1 模块的导出"></a>2.4.1 模块的导出</h4><p>   ES6语法：</p><blockquote><ol><li>在ES6中使用 export default 和 export 导出模块中的成员;</li></ol><p>(Node中使用 module.exports 和 export导出成员)</p><ol start="2"><li>使用 import ** from ** 和 import ‘路径’ 还有 import {a, b} from ‘模块标识’ 导入其他模块</li></ol></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#1. 新建test.js</span><br><span class="line"><span class="comment">// 在 ES6 中，使用 export default 和 export 向外暴露成员：</span></span><br><span class="line"><span class="keyword">var</span> info = &#123;</span><br><span class="line">  name: <span class="string">'zs'</span>,</span><br><span class="line">  age: <span class="number">20</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> info</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 注意：</span></span><br><span class="line"><span class="comment">   export default 向外暴露的成员，可以使用任意的变量来接收</span></span><br><span class="line"><span class="comment">   在一个模块中，export default 只允许向外暴露1次</span></span><br><span class="line"><span class="comment">   在一个模块中，可以同时使用 export default 和 export 向外暴露成员</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">var</span> title = <span class="string">'小星星'</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">var</span> content = <span class="string">'哈哈哈'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*注意：</span></span><br><span class="line"><span class="comment">     使用 export 向外暴露的成员，只能使用 &#123; &#125; 的形式来接收，这种形式叫做 【按需导出】</span></span><br><span class="line"><span class="comment">     export 可以向外暴露多个成员， 同时如果某些成员在我们import 的时候不需要，则可以不在 &#123;&#125;  中定义</span></span><br><span class="line"><span class="comment">     使用 export 导出的成员，必须严格按照导出时候的名称来使用  &#123;&#125;  按需接收；</span></span><br><span class="line"><span class="comment">     使用 export 导出的成员，如果想换个名称来接收，可以使用 as 来起别名；</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">#2. main.js</span><br><span class="line"><span class="keyword">import</span> minfo3, &#123; title <span class="keyword">as</span> title123, content &#125; <span class="keyword">from</span> <span class="string">'./test.js'</span></span><br><span class="line"><span class="built_in">console</span>.log(minfo3)    <span class="comment">//这里的minfo3就是test.js中所暴露出来的default info</span></span><br><span class="line"><span class="built_in">console</span>.log(title123 + <span class="string">' --- '</span> + content)</span><br></pre></td></tr></table></figure><h4 id="2-4-2-vue中的数据导出"><a href="#2-4-2-vue中的数据导出" class="headerlink" title="2.4.2 .vue中的数据导出"></a>2.4.2 .vue中的数据导出</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#login.vue</span><br><span class="line"></span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h1&gt;这是登录组件，使用 .vue 文件定义出来的 --- &#123;&#123;msg&#125;&#125;&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">    &lt;button @click="show"&gt;点我&lt;/</span>button&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    data() &#123;</span><br><span class="line">      <span class="comment">// 注意：组件中的 data 必须是 function</span></span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        msg: <span class="string">"123321"</span></span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      show() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"调用了 login.vue 中的 show 方法"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-5-vue-router使用"><a href="#2-5-vue-router使用" class="headerlink" title="2.5 vue-router使用"></a>2.5 vue-router使用</h3><pre><code>[vue-router官网](https://router.vuejs.org/)</code></pre><h4 id="2-5-1-基本使用"><a href="#2-5-1-基本使用" class="headerlink" title="2.5.1 基本使用"></a>2.5.1 基本使用</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#1. 安装路由模块</span><br><span class="line">npm install vue-router --save</span><br><span class="line"></span><br><span class="line">#2.login.vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &lt;h1&gt;这是登录组件，使用 .vue 文件定义出来的 --- &#123;&#123;msg&#125;&#125;&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">    &lt;button @click="show"&gt;点我&lt;/</span>button&gt;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">  <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    data() &#123;</span><br><span class="line">      <span class="comment">// 注意：组件中的 data 必须是 function</span></span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        msg: <span class="string">"123321"</span></span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">    methods: &#123;</span><br><span class="line">      show() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"调用了 login.vue 中的 show 方法"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;style&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>style&gt;</span><br><span class="line"></span><br><span class="line">#3.register.vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;这是注册组件&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">#4.main.js</span></span><br><span class="line"><span class="regexp">import Vue from 'vue'</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/1.导入VueRouter并且安装</span></span><br><span class="line"><span class="regexp">import VueRouter from 'vue-router'</span></span><br><span class="line"><span class="regexp">Vue.use(VueRouter)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/2.导入组件</span></span><br><span class="line"><span class="regexp">import login from './</span>login.vue<span class="string">'</span></span><br><span class="line"><span class="string">import register from '</span>./register.vue<span class="string">'</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">//3.创建路由对象</span></span><br><span class="line"><span class="string">var router = new VueRouter(&#123;</span></span><br><span class="line"><span class="string">    routes: [</span></span><br><span class="line"><span class="string">        &#123; path: '</span>/<span class="string">', redirect: '</span>/login<span class="string">' &#125;,</span></span><br><span class="line"><span class="string">        &#123; path: '</span>/login<span class="string">', component: login &#125;,</span></span><br><span class="line"><span class="string">        &#123; path: '</span>/register<span class="string">', component: register &#125;</span></span><br><span class="line"><span class="string">    ]</span></span><br><span class="line"><span class="string">&#125;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">var vm = new Vue(&#123;</span></span><br><span class="line">    el: '#app',</span><br><span class="line">    data: &#123;</span><br><span class="line">        msg: <span class="string">'123'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//4.挂载路由</span></span><br><span class="line">    router:router</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">#5.index.html</span><br><span class="line">&lt;div id=<span class="string">"app"</span>&gt;</span><br><span class="line">    &lt;router-link to=<span class="string">"/login"</span>&gt;登陆&lt;<span class="regexp">/router-link&gt;</span></span><br><span class="line"><span class="regexp">    &lt;router-link to="/</span>register<span class="string">"&gt;注册&lt;/router-link&gt;</span></span><br><span class="line"><span class="string">    &lt;router-view&gt;&lt;/router-view&gt;</span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#6.webpack.config.js参照之前的配置</span></span><br></pre></td></tr></table></figure><h4 id="2-5-2-vue-router和render结合使用"><a href="#2-5-2-vue-router和render结合使用" class="headerlink" title="2.5.2 vue-router和render结合使用"></a>2.5.2 vue-router和render结合使用</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"># 在上面案例的基础上</span><br><span class="line">#1.新增account.vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;账户组件&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">&lt;!--组件中的路由--&gt;</span></span><br><span class="line"><span class="regexp">        &lt;router-link to="/</span>login<span class="string">"&gt;登陆&lt;/router-link&gt;</span></span><br><span class="line"><span class="string">        &lt;router-link to="</span>/register<span class="string">"&gt;注册&lt;/router-link&gt;</span></span><br><span class="line"><span class="string">        &lt;router-view&gt;&lt;/router-view&gt;</span></span><br><span class="line"><span class="string">    &lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/template&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#2.main.js</span></span><br><span class="line"><span class="string">import account from './account.vue'</span></span><br><span class="line"><span class="string">var vm = new Vue(&#123;</span></span><br><span class="line"><span class="string">    el: '#app',</span></span><br><span class="line"><span class="string">    data: &#123;</span></span><br><span class="line"><span class="string">        msg: '123'</span></span><br><span class="line"><span class="string">    &#125;,</span></span><br><span class="line"><span class="string">    //渲染组件替换el</span></span><br><span class="line"><span class="string">    render:e=&gt;e(account),</span></span><br><span class="line"><span class="string">    router:router</span></span><br><span class="line"><span class="string">&#125;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#3.index.html</span></span><br><span class="line"><span class="string">&lt;div id="</span>app<span class="string">"&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br></pre></td></tr></table></figure><h4 id="2-5-3-路由嵌套"><a href="#2-5-3-路由嵌套" class="headerlink" title="2.5.3 路由嵌套"></a>2.5.3 路由嵌套</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"># 在上面案例的基础上</span><br><span class="line">#1. 新建subcom/findpwd.vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;找回密码&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">#2. 新建subcom/</span>thirdpartlogin.vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;微信登陆&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">#3.修改login.vue</span></span><br><span class="line"><span class="regexp">&lt;template&gt;</span></span><br><span class="line"><span class="regexp">  &lt;div&gt;</span></span><br><span class="line"><span class="regexp">    &lt;h1&gt;这是登录组件，使用 .vue 文件定义出来的 --- &#123;&#123;msg&#125;&#125;&lt;/</span>h1&gt;</span><br><span class="line">    &lt;button @click=<span class="string">"show"</span>&gt;点我&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    &lt;router-link to="/</span>login/findpwd<span class="string">"&gt;找回密码&lt;/router-link&gt;</span></span><br><span class="line"><span class="string">    &lt;router-link to="</span>/login/thirdpartlogin<span class="string">"&gt;第三方登陆&lt;/router-link&gt;</span></span><br><span class="line"><span class="string">    &lt;router-view&gt;&lt;/router-view&gt;</span></span><br><span class="line"><span class="string">  &lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/template&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">  export default &#123;</span></span><br><span class="line"><span class="string">    data() &#123;</span></span><br><span class="line"><span class="string">      // 注意：组件中的 data 必须是 function</span></span><br><span class="line"><span class="string">      return &#123;</span></span><br><span class="line"><span class="string">        msg: "</span><span class="number">123321</span><span class="string">"</span></span><br><span class="line"><span class="string">      &#125;;</span></span><br><span class="line"><span class="string">    &#125;,</span></span><br><span class="line"><span class="string">    methods: &#123;</span></span><br><span class="line"><span class="string">      show() &#123;</span></span><br><span class="line"><span class="string">        console.log("</span>调用了 login.vue 中的 show 方法<span class="string">");</span></span><br><span class="line"><span class="string">      &#125;</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;;</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#4.在main.js中配置子路由</span></span><br><span class="line"><span class="string">var router = new VueRouter(&#123;</span></span><br><span class="line"><span class="string">    routes: [</span></span><br><span class="line"><span class="string">        &#123; path: '/', redirect: '/login' &#125;,</span></span><br><span class="line"><span class="string">        &#123; path: '/login',</span></span><br><span class="line"><span class="string">          component: login,</span></span><br><span class="line"><span class="string">          children:[</span></span><br><span class="line"><span class="string">              &#123;path:'findpwd',component:findpwd&#125;,</span></span><br><span class="line"><span class="string">              &#123;path:'thirdpartlogin',component:thirdpartlogin&#125;</span></span><br><span class="line"><span class="string">          ]</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        &#123; path: '/register', component: register &#125;</span></span><br><span class="line"><span class="string">    ]</span></span><br><span class="line"><span class="string">&#125;);</span></span><br></pre></td></tr></table></figure><h3 id="2-6-组件样式"><a href="#2-6-组件样式" class="headerlink" title="2.6 组件样式"></a>2.6 组件样式</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"># 在上面代码的基础上</span><br><span class="line">#login.vue新增样式</span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line">  <span class="comment">/*scoped作用域，如果不加scoped，则h1的样式会默认使用为全局而非当前组件*/</span></span><br><span class="line">  h1&#123;</span><br><span class="line">    color: red;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;<span class="regexp">/style&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">#account.vue新增样式</span></span><br><span class="line"><span class="regexp">&lt;style lang="scss" scoped&gt;</span></span><br><span class="line"><span class="regexp">    /</span>*要编译sass只需要lang=<span class="string">"scss"</span>就可以</span><br><span class="line">      scoped 推荐使用*<span class="regexp">/</span></span><br><span class="line"><span class="regexp">    body&#123;</span></span><br><span class="line"><span class="regexp">        h1&#123;</span></span><br><span class="line"><span class="regexp">            background-color: blue;</span></span><br><span class="line"><span class="regexp">        &#125;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>style&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//scoped的原理：scoped实际上是给当前组件的所有元素加上data-v-f626523的属性来实现的样式隔离</span></span><br></pre></td></tr></table></figure><h3 id="2-7-抽离路由为单独的模块"><a href="#2-7-抽离路由为单独的模块" class="headerlink" title="2.7 抽离路由为单独的模块"></a>2.7 抽离路由为单独的模块</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#1.main.js</span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="comment">//导入VueRouter并且安装</span></span><br><span class="line"><span class="keyword">import</span> VueRouter <span class="keyword">from</span> <span class="string">'vue-router'</span></span><br><span class="line">Vue.use(VueRouter)</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> account <span class="keyword">from</span> <span class="string">'./account.vue'</span></span><br><span class="line"><span class="comment">//导入路由模块</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">'./router.js'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">        msg: <span class="string">'123'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    render:<span class="function"><span class="params">e</span>=&gt;</span>e(account),</span><br><span class="line">    <span class="comment">//挂载路由</span></span><br><span class="line">    router:router</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#2.router.js</span><br><span class="line"><span class="keyword">import</span> VueRouter <span class="keyword">from</span> <span class="string">'vue-router'</span></span><br><span class="line"><span class="comment">//导入组件</span></span><br><span class="line"><span class="keyword">import</span> login <span class="keyword">from</span> <span class="string">'./login.vue'</span></span><br><span class="line"><span class="keyword">import</span> register <span class="keyword">from</span> <span class="string">'./register.vue'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> findpwd <span class="keyword">from</span> <span class="string">'./subcom/findpwd.vue'</span></span><br><span class="line"><span class="keyword">import</span> thirdpartlogin <span class="keyword">from</span> <span class="string">'./subcom/thirdpartlogin.vue'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//创建路由对象</span></span><br><span class="line"><span class="keyword">var</span> router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">    routes: [</span><br><span class="line">        &#123; <span class="attr">path</span>: <span class="string">'/'</span>, <span class="attr">redirect</span>: <span class="string">'/login'</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">path</span>: <span class="string">'/login'</span>,</span><br><span class="line">          component: login,</span><br><span class="line">          children:[</span><br><span class="line">              &#123;<span class="attr">path</span>:<span class="string">'findpwd'</span>,<span class="attr">component</span>:findpwd&#125;,</span><br><span class="line">              &#123;<span class="attr">path</span>:<span class="string">'thirdpartlogin'</span>,<span class="attr">component</span>:thirdpartlogin&#125;</span><br><span class="line">          ]</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123; <span class="attr">path</span>: <span class="string">'/register'</span>, <span class="attr">component</span>: register &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//导出路由对象</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router;</span><br></pre></td></tr></table></figure><h1 id="3-vuex介绍"><a href="#3-vuex介绍" class="headerlink" title="3.vuex介绍"></a>3.vuex介绍</h1><h2 id="3-1-vuex概念"><a href="#3-1-vuex概念" class="headerlink" title="3.1 vuex概念"></a>3.1 vuex概念</h2><pre><code>https://vuex.vuejs.org/zh/installation.htmlvuex 是 Vue 配套的 公共数据管理工具，它可以把一些共享的数据保存到 vuex 中，方便 整个程序中的任何组件直接获取或修改我们的公共数据；</code></pre><h2 id="3-2-vuex的基本使用"><a href="#3-2-vuex的基本使用" class="headerlink" title="3.2 vuex的基本使用"></a>3.2 vuex的基本使用</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#1.拷贝原项目中除了node_modules之外的其他信息，运行npm install安装模块 </span><br><span class="line"></span><br><span class="line">#2.安装vuex</span><br><span class="line"> npm i vuex -S</span><br><span class="line"></span><br><span class="line">#3.main.js</span><br><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">'vuex'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 注册vuex到vue中</span></span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"></span><br><span class="line"><span class="comment">// new Vuex.Store()实例，得到一个数据仓储对象</span></span><br><span class="line"><span class="comment">// 可以在组件中通过this.$store.state.xx 来访问store中的数据</span></span><br><span class="line"><span class="keyword">var</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">    <span class="comment">//state相当于组件中的data</span></span><br><span class="line">    state: &#123;</span><br><span class="line">        count: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">//如果要修改store中state的值，需要调用 mutations提供的方法，可以通过this.$store.commit('方法名')来调用</span></span><br><span class="line">    mutations: &#123;</span><br><span class="line">        increment(state) &#123;</span><br><span class="line">            state.count++</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">//mutations函数参数列表中最多支持两个参数，其中参数1是state； 参数2是通过commit提交过来的参数；</span></span><br><span class="line">        subtract(state, obj) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(obj)</span><br><span class="line">            state.count -= obj.step;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    getters: &#123;</span><br><span class="line">        <span class="comment">//这里的getters只负责对外提供数据，不负责修改数据，如果想要修改 state 中的数据需要在mutations中修改</span></span><br><span class="line">        optCount: <span class="function"><span class="keyword">function</span> (<span class="params">state</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'当前最新的count值是：'</span> + state.count</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 总结：</span></span><br><span class="line"><span class="comment">// 1. state中的数据，不能直接修改，如果想要修改，必须通过 mutations</span></span><br><span class="line"><span class="comment">// 2. 如果组件想要直接 从 state 上获取数据： 需要 this.$store.state.***</span></span><br><span class="line"><span class="comment">// 3. 如果组件想要修改数据，必须使用 mutations 提供的方法，需要通过 this.$store.commit('方法的名称'， 唯一的一个参数)</span></span><br><span class="line"><span class="comment">// 4. store中state上的数据在对外提供的时候建议做一层包装，推荐使用 getters。调用的时候则用this.$store.getters.***</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App.vue'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    render: <span class="function"><span class="params">c</span> =&gt;</span> c(App),</span><br><span class="line">    <span class="comment">//将vuex创建的store挂载到VM实例上，只要挂载到了 vm 上，任何组件都能使用store来存取数据</span></span><br><span class="line">    store</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">#4.index.html</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=<span class="string">"app"</span>&gt;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>body&gt;</span><br><span class="line"></span><br><span class="line">#5.App.vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;这是 App 组件&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">        &lt;hr&gt;</span></span><br><span class="line"><span class="regexp">        &lt;counter&gt;&lt;/</span>counter&gt;</span><br><span class="line">        &lt;hr&gt;</span><br><span class="line">        &lt;amount&gt;&lt;<span class="regexp">/amount&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">&lt;<span class="regexp">/template&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">    import counter from "./</span>components/counter.vue<span class="string">";</span></span><br><span class="line"><span class="string">    import amount from "</span>./components/amount.vue<span class="string">";</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    export default &#123;</span></span><br><span class="line"><span class="string">        data() &#123;</span></span><br><span class="line"><span class="string">            return &#123;&#125;;</span></span><br><span class="line"><span class="string">        &#125;,</span></span><br><span class="line"><span class="string">        components: &#123;</span></span><br><span class="line"><span class="string">            counter,</span></span><br><span class="line"><span class="string">            amount</span></span><br><span class="line"><span class="string">        &#125;</span></span><br><span class="line"><span class="string">    &#125;;</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#6.components/amount.vue</span></span><br><span class="line"><span class="string">&lt;template&gt;</span></span><br><span class="line"><span class="string">  &lt;div&gt;</span></span><br><span class="line"><span class="string">    &lt;h3&gt;&#123;&#123; $store.getters.optCount &#125;&#125;&lt;/h3&gt;</span></span><br><span class="line"><span class="string">  &lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/template&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">#7.components/counter.vue</span></span><br><span class="line"><span class="string">&lt;template&gt;</span></span><br><span class="line"><span class="string">  &lt;div&gt;</span></span><br><span class="line"><span class="string">    &lt;input type="</span>button<span class="string">" value="</span>绑定事件-减少<span class="string">" @click="</span>sub<span class="string">"&gt;</span></span><br><span class="line"><span class="string">    &lt;input type="</span>button<span class="string">" value="</span>绑定事件-增加<span class="string">" @click="</span>add<span class="string">"&gt;</span></span><br><span class="line"><span class="string">    &lt;br&gt;</span></span><br><span class="line"><span class="string">    &lt;input type="</span>text<span class="string">" v-model="</span>$store.state.count<span class="string">"&gt;</span></span><br><span class="line"><span class="string">  &lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/template&gt;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;script&gt;</span></span><br><span class="line"><span class="string">export default &#123;</span></span><br><span class="line"><span class="string">  data() &#123;</span></span><br><span class="line"><span class="string">    return &#123;</span></span><br><span class="line"><span class="string">    &#125;;</span></span><br><span class="line"><span class="string">  &#125;,</span></span><br><span class="line"><span class="string">  methods: &#123;</span></span><br><span class="line"><span class="string">    add() &#123;</span></span><br><span class="line"><span class="string">       this.$store.commit("</span>increment<span class="string">");</span></span><br><span class="line"><span class="string">    &#125;,</span></span><br><span class="line"><span class="string">    sub() &#123;</span></span><br><span class="line"><span class="string">      this.$store.commit("</span>subtract<span class="string">",&#123; step:3&#125;);</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;;</span></span><br><span class="line"><span class="string">&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><h2 id="3-3-vuex异步修改状态"><a href="#3-3-vuex异步修改状态" class="headerlink" title="3.3 vuex异步修改状态"></a>3.3 vuex异步修改状态</h2><pre><code>mutation的使用局限：mutation必须是同步函数，如果有异步操作，可以在actions完成</code></pre><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#main.js中给store添加actions的方法</span><br><span class="line"><span class="keyword">var</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">    <span class="comment">// state相当于组件中的data</span></span><br><span class="line">    state: &#123;</span><br><span class="line">        count: <span class="number">0</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// 如果要修改store中state的值，需要调用 mutations提供的方法，可以通过this.$store.commit('方法名')来调用</span></span><br><span class="line">    mutations: &#123;</span><br><span class="line">        increment (state) &#123;</span><br><span class="line">            state.count++</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// mutations函数参数列表中最多支持两个参数，其中参数1是state； 参数2是通过commit提交过来的参数；</span></span><br><span class="line">        subtract (state, obj) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(obj)</span><br><span class="line">            state.count -= obj.step</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    getters: &#123;</span><br><span class="line">        <span class="comment">// 这里的getters只负责对外提供数据，不负责修改数据，如果想要修改 state 中的数据需要在mutations中修改</span></span><br><span class="line">        optCount: <span class="function"><span class="keyword">function</span> (<span class="params">state</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">'当前最新的count值是：'</span> + state.count</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    actions: &#123;</span><br><span class="line">        <span class="comment">// action中的方法允许异步事件</span></span><br><span class="line">        increment (&#123; commit &#125;) &#123;</span><br><span class="line">            setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="comment">// 提交mutations中的increment方法</span></span><br><span class="line">                commit(<span class="string">'increment'</span>)</span><br><span class="line">            &#125;, <span class="number">1000</span>)</span><br><span class="line">        &#125;,</span><br><span class="line">        subtract (&#123; commit &#125;, obj) &#123;</span><br><span class="line">            <span class="comment">// 返回一个Promise，以便做回调</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">                setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                    commit(<span class="string">'subtract'</span>, obj)</span><br><span class="line">                    resolve()</span><br><span class="line">                &#125;, <span class="number">1000</span>)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">#components/counter.vue</span><br><span class="line">methods: &#123;</span><br><span class="line">    add () &#123;</span><br><span class="line">        <span class="comment">// dispatch 触发指定的action</span></span><br><span class="line">        <span class="keyword">this</span>.$store.dispatch(<span class="string">"increment"</span>)</span><br><span class="line">    &#125;,</span><br><span class="line">        sub () &#123;</span><br><span class="line">            <span class="keyword">this</span>.$store.dispatch(<span class="string">"subtract"</span>, &#123; <span class="attr">step</span>: <span class="number">3</span> &#125;)</span><br><span class="line">                .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"减少操作完成"</span>)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-4-vuex的模块"><a href="#3-4-vuex的模块" class="headerlink" title="3.4 vuex的模块"></a>3.4 vuex的模块</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#1.使用Vuex.Store中的modules声明多个模块</span><br><span class="line"><span class="keyword">const</span> moduleA = &#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    count: <span class="number">1</span></span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> moduleB = &#123;</span><br><span class="line">  state: &#123;</span><br><span class="line">    count: <span class="number">11</span></span><br><span class="line">  &#125;,</span><br><span class="line">  mutations: &#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</span><br><span class="line">  modules: &#123;</span><br><span class="line">    a: moduleA,</span><br><span class="line">    b: moduleB</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">#2.使用不同模块中的数据</span><br><span class="line">&lt;div&gt;</span><br><span class="line">    &lt;h3&gt;&#123;&#123; $store.state.a.count &#125;&#125;&lt;<span class="regexp">/h3&gt;</span></span><br><span class="line"><span class="regexp">    &lt;h3&gt;&#123;&#123; $store.state.b.count &#125;&#125;&lt;/</span>h3&gt;</span><br><span class="line">&lt;<span class="regexp">/div&gt;</span></span><br></pre></td></tr></table></figure><h2 id="3-5-刷新网页时vuex缓存"><a href="#3-5-刷新网页时vuex缓存" class="headerlink" title="3.5 刷新网页时vuex缓存"></a>3.5 刷新网页时vuex缓存</h2><p><a href="https://blog.csdn.net/weixin_42233917/article/details/82217596" target="_blank" rel="noopener">https://blog.csdn.net/weixin_42233917/article/details/82217596</a></p><h1 id="4-vue中UI框架"><a href="#4-vue中UI框架" class="headerlink" title="4.vue中UI框架"></a>4.vue中UI框架</h1><h2 id="4-1-常用框架介绍"><a href="#4-1-常用框架介绍" class="headerlink" title="4.1 常用框架介绍"></a>4.1 常用框架介绍</h2><p>PC桌面端UI框架：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span> iview          （用户评分高功能多炫酷，解决和避免了其他UI框架出现的一些小问题）</span><br><span class="line"><span class="number">2.</span> bootstrap  （使用用户最多）</span><br><span class="line"><span class="number">3.</span> ElementUI  （饿了么团队研发，使用较多不过里还有些小bug）</span><br></pre></td></tr></table></figure><p>手机端UI框架：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span>BUI       </span><br><span class="line">   http:<span class="comment">//www.easybui.com/docs/  很不错官网有视频介绍。视频里有介绍非常非常实用的工具，建议去看官网视频。</span></span><br><span class="line">这个框架有现成的模板只需要一个创建模板的命令就可以创建一个大致的具有交互功能的页面。</span><br><span class="line"><span class="number">2.</span>vux  </span><br><span class="line">  vux 基于WeUI和Vue(<span class="number">2.</span>x)开发的移动端UI组件库</span><br><span class="line">  基于webpack+vue-loader+vux可以快速开发移动端页面，配合vux-loader方便你在WeUI的基础上定制需要的样式。</span><br><span class="line"><span class="number">3.</span>Mint UI</span><br><span class="line">  Mint UI 由饿了么前端团队推出的，Mint UI 是一个基于 Vue.js 封装的移动端组件库</span><br></pre></td></tr></table></figure><h2 id="4-2-MintUI-框架介绍"><a href="#4-2-MintUI-框架介绍" class="headerlink" title="4.2 MintUI 框架介绍"></a>4.2 MintUI 框架介绍</h2><p><a href="https://github.com/ElemeFE/mint-ui" target="_blank" rel="noopener">Github 仓储地址</a></p><p><a href="http://mint-ui.github.io/#!/zh-cn" target="_blank" rel="noopener">Mint-UI官方文档</a></p><h3 id="4-2-1-css组件使用"><a href="#4-2-1-css组件使用" class="headerlink" title="4.2.1 css组件使用"></a>4.2.1 css组件使用</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span>安装MintUI</span><br><span class="line">   npm install mint-ui -S</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>main.js 导入MintUI，并注册到Vue</span><br><span class="line">  <span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line">  <span class="keyword">import</span> Mint <span class="keyword">from</span> <span class="string">'mint-ui'</span>;</span><br><span class="line">  <span class="keyword">import</span> app <span class="keyword">from</span> <span class="string">"./app.vue"</span></span><br><span class="line"></span><br><span class="line">  Vue.use(Mint);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">        msg: <span class="string">'123'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    render:<span class="function"><span class="params">e</span>=&gt;</span>e(app)</span><br><span class="line">  &#125;)</span><br><span class="line">  </span><br><span class="line"><span class="number">3.</span>main.js 导入MintUI的样式</span><br><span class="line">  <span class="keyword">import</span> <span class="string">'mint-ui/lib/style.css'</span></span><br><span class="line">  </span><br><span class="line"><span class="number">4.</span>app.vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;app组件&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">        &lt;mt-button type="primary" size="large" plain&gt;primary&lt;/m</span>t-button&gt;</span><br><span class="line">        &lt;mt-button type=<span class="string">"danger"</span> size=<span class="string">"small"</span> disabled&gt;danger&lt;<span class="regexp">/mt-button&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">        &lt;mt-button type="danger" icon="more" @click="show"&gt;more&lt;/m</span>t-button&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br></pre></td></tr></table></figure><h3 id="4-2-2-js组件使用-toast"><a href="#4-2-2-js组件使用-toast" class="headerlink" title="4.2.2 js组件使用-toast"></a>4.2.2 js组件使用-toast</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#在上面代码的基础上</span><br><span class="line">#app.vue</span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;app组件&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">        &lt;mt-button type="primary" size="large" plain&gt;primary&lt;/m</span>t-button&gt;</span><br><span class="line">        &lt;mt-button type=<span class="string">"danger"</span> size=<span class="string">"small"</span> disabled&gt;danger&lt;<span class="regexp">/mt-button&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">        &lt;mt-button type="danger" icon="more" @click="show"&gt;more&lt;/m</span>t-button&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="comment">// 按需导入 Toast 组件</span></span><br><span class="line">    <span class="keyword">import</span> &#123; Toast &#125; <span class="keyword">from</span> <span class="string">"mint-ui"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">        data() &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                toastInstanse: <span class="literal">null</span></span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;,</span><br><span class="line">        created() &#123;</span><br><span class="line">        &#125;,</span><br><span class="line">       methods:&#123;</span><br><span class="line">            show()&#123;</span><br><span class="line">                <span class="keyword">if</span>(<span class="keyword">this</span>.toastInstanse)&#123;</span><br><span class="line">                    <span class="keyword">return</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">this</span>.toastInstanse = Toast(&#123;</span><br><span class="line">                    message: <span class="string">"这是消息"</span>,</span><br><span class="line">                    duration: <span class="number">-1</span>, <span class="comment">// 如果是 -1 则弹出之后不消失</span></span><br><span class="line">                    position: <span class="string">"top"</span>,</span><br><span class="line">                    iconClass: <span class="string">"glyphicon glyphicon-heart"</span>, <span class="comment">// 设置 图标的类</span></span><br><span class="line">                    className: <span class="string">"mytoast"</span> <span class="comment">// 自定义Toast的样式，需要自己提供一个类名</span></span><br><span class="line">                &#125;);</span><br><span class="line">                setTimeout(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">                    <span class="keyword">this</span>.toastInstanse.close();</span><br><span class="line">                    <span class="keyword">this</span>.toastInstanse = <span class="literal">null</span>;</span><br><span class="line">                &#125;,<span class="number">1000</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;!--注意：这边style不需要加scoped，scoped样式只能作用于当前组件，不能作用于当前组件的子组件--&gt;</span></span><br><span class="line"><span class="regexp">&lt;style&gt;</span></span><br><span class="line"><span class="regexp">    .mytoast&#123;</span></span><br><span class="line"><span class="regexp">        color: red!important;</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&lt;/</span>style&gt;</span><br><span class="line"></span><br><span class="line">#注意：toast中不自带字体图标，所以我们使用bootstrap中的字体图标</span><br><span class="line"><span class="comment">//1.安装</span></span><br><span class="line">   npm install bootstrap@<span class="number">3.3</span><span class="number">.5</span></span><br><span class="line"><span class="comment">//2.main.js中引入boostrap样式</span></span><br><span class="line">   <span class="keyword">import</span> <span class="string">'bootstrap/dist/css/bootstrap.css'</span></span><br></pre></td></tr></table></figure><h3 id="4-2-3-按需导入组件"><a href="#4-2-3-按需导入组件" class="headerlink" title="4.2.3 按需导入组件"></a>4.2.3 按需导入组件</h3><pre><code>如果完全导入Maint UI，打包后的bundle.js有将近1.5M，为了减少打包后的体积，我们可以进行按需导入。</code></pre><p><a href="http://mint-ui.github.io/docs/#/zh-cn2/quickstart" target="_blank" rel="noopener">http://mint-ui.github.io/docs/#/zh-cn2/quickstart</a></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1.安装babel-plugin-component插件</span></span><br><span class="line">npm install babel-plugin-component -D</span><br><span class="line"><span class="comment">//2.修改babel的配置文件</span></span><br><span class="line">&#123;</span><br><span class="line">      <span class="string">"presets"</span>: [<span class="string">"env"</span>, <span class="string">"stage-0"</span>],</span><br><span class="line">      <span class="string">"plugins"</span>: [<span class="string">"transform-runtime"</span>,</span><br><span class="line">        [<span class="string">"component"</span>, [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="string">"libraryName"</span>: <span class="string">"mint-ui"</span>,</span><br><span class="line">            <span class="string">"style"</span>: <span class="literal">true</span></span><br><span class="line">          &#125;</span><br><span class="line">        ]]]</span><br><span class="line">    &#125;</span><br><span class="line"> <span class="comment">//3.修改main.js</span></span><br><span class="line"> <span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></span><br><span class="line"> <span class="comment">//按需导入button</span></span><br><span class="line"> <span class="keyword">import</span> &#123; Button&#125; <span class="keyword">from</span> <span class="string">'mint-ui'</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">import</span> <span class="string">'mint-ui/lib/style.css'</span></span><br><span class="line"> <span class="keyword">import</span> <span class="string">'bootstrap/dist/css/bootstrap.css'</span></span><br><span class="line"> <span class="keyword">import</span> app <span class="keyword">from</span> <span class="string">"./app.vue"</span></span><br><span class="line"> <span class="comment">//注册button</span></span><br><span class="line"> Vue.component(Button.name, Button)</span><br><span class="line"></span><br><span class="line"> <span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    el: <span class="string">'#app'</span>,</span><br><span class="line">    data: &#123;</span><br><span class="line">        msg: <span class="string">'123'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    render:<span class="function"><span class="params">e</span>=&gt;</span>e(app)</span><br><span class="line"> &#125;)</span><br></pre></td></tr></table></figure><h2 id="4-3-使用-MUI-组件"><a href="#4-3-使用-MUI-组件" class="headerlink" title="4.3 使用 MUI 组件"></a>4.3 使用 MUI 组件</h2><p><a href="http://dev.dcloud.net.cn/mui/" target="_blank" rel="noopener">官网首页</a></p><p><a href="http://dev.dcloud.net.cn/mui/ui/" target="_blank" rel="noopener">文档地址</a></p><h3 id="4-3-1-MUI和Mint-UI区别"><a href="#4-3-1-MUI和Mint-UI区别" class="headerlink" title="4.3.1 MUI和Mint-UI区别"></a>4.3.1 MUI和Mint-UI区别</h3><pre><code>MUI不同于Mint-UI，MUI只是一套开发出来的代码片段，配套了样式和html代码，类似于bootstrap。而Mint-UI是真正的vue组件，可以无缝的和vue项目集成开发。因此从体验上，Mint-UI体验更好，因为这是已经封装好的vue组件。理论上，任何项目都可以使用bootstrap和MUI，而Mint-UI只适用于vue</code></pre><h3 id="4-3-2-MUI的使用"><a href="#4-3-2-MUI的使用" class="headerlink" title="4.3.2 MUI的使用"></a>4.3.2 MUI的使用</h3><pre><code>MUI不能使用npm进行下载，需要手动下载然后导入到项目。    由于MUI不是vue组件，因此不需要导入组件库然后注册组件，只需要导入样式之后就可以在页面使用了。</code></pre><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#1. 将MUI下的fonts\css\js文件放入到项目的lib目录下</span><br><span class="line">#2.main.js引入MUI的样式</span><br><span class="line"><span class="keyword">import</span> <span class="string">"../lib/mui/css/mui.css"</span></span><br><span class="line">#3.app.vue中使用MUI的组件</span><br><span class="line">&lt;template&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;app组件&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">        &lt;mt-button type="primary" size="large" plain&gt;primary&lt;/m</span>t-button&gt;</span><br><span class="line">        &lt;mt-button type=<span class="string">"danger"</span> size=<span class="string">"small"</span> disabled&gt;danger&lt;<span class="regexp">/mt-button&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">        &lt;mt-button type="danger" icon="more" @click="show"&gt;more&lt;/m</span>t-button&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!--引入MUI组件--&gt;</span><br><span class="line">        &lt;form <span class="class"><span class="keyword">class</span></span>=<span class="string">"mui-input-group"</span>&gt;</span><br><span class="line">            &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"mui-input-row"</span>&gt;</span><br><span class="line">                &lt;label&gt;用户名&lt;<span class="regexp">/label&gt;</span></span><br><span class="line"><span class="regexp">                &lt;input type="text" class="mui-input-clear" placeholder="请输入用户名"&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">            &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"mui-input-row"</span>&gt;</span><br><span class="line">                &lt;label&gt;密码&lt;<span class="regexp">/label&gt;</span></span><br><span class="line"><span class="regexp">                &lt;input type="password" class="mui-input-password" placeholder="请输入密码"&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">            &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"mui-button-row"</span>&gt;</span><br><span class="line">                &lt;button type=<span class="string">"button"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"mui-btn mui-btn-primary"</span> &gt;确认&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">                &lt;button type="button" class="mui-btn mui-btn-danger" &gt;取消&lt;/</span>button&gt;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>form&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>template&gt;</span><br><span class="line"></span><br><span class="line">#注意点：MUI中有字体图标，所以需要在webpack.config.js中添加下面的url加载规则</span><br><span class="line">&#123; <span class="attr">test</span>: <span class="regexp">/\.(png|jpg|gif|ttf)$/</span>, <span class="attr">use</span>: <span class="string">'url-loader'</span> &#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;1-Webpack&quot;&gt;&lt;a href=&quot;#1-Webpack&quot; class=&quot;headerlink&quot; title=&quot;1.Webpack&quot;&gt;&lt;/a&gt;1.Webpack&lt;/h1&gt;&lt;h2 id=&quot;1-1-引入&quot;&gt;&lt;a href=&quot;#1-1-引入&quot; class=&quot;head
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>REACT框架</title>
    <link href="http://yoursite.com/2020/03/25/REACT%E6%A1%86%E6%9E%B6/"/>
    <id>http://yoursite.com/2020/03/25/REACT%E6%A1%86%E6%9E%B6/</id>
    <published>2020-03-25T01:18:55.000Z</published>
    <updated>2020-04-17T06:04:50.713Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-React简介"><a href="#1-React简介" class="headerlink" title="1. React简介"></a>1. React简介</h1><h2 id="1-1-React介绍"><a href="#1-1-React介绍" class="headerlink" title="1.1 React介绍"></a>1.1 React介绍</h2><ul><li><p>React 是一个用于构建用户界面的 JAVASCRIPT库。React主要用于构建UI，很多人认为 React 是 MVC 中的 V（视图）。</p></li><li><p>React 起源于 Facebook 的内部项目，因为该公司对市场上所有 JavaScript MVC 框架都不满意，就决定自己写一套，用来架设 Instagram（照片交友） 的网站。做出来以后，发现这套东西很好用，<strong>就在2013年5月开源了</strong>。</p></li><li><p>React 拥有较高的性能，代码逻辑非常简单，越来越多的人已开始关注和使用它。由于 React 的<strong>设计思想极其独特</strong>，属于革命性创新，性能出众，代码逻辑却非常简单。所以，越来越多的人开始关注和使用，认为它可能是将来 Web 开发的主流工具。</p></li><li><p>清楚两个概念：</p><ul><li><p>library（库）：小而巧的库，只提供了特定的API；优点就是 船小好掉头，可以很方便的从一个库切换到另外的库；但是代码几乎不会改变；比如从jQuery切换到</p></li><li><p>Framework（框架）：大而全的是框架；框架提供了一整套的解决方案；所以如果在项目中间，想切换到另外的框架，是比较困难的；</p></li></ul></li></ul><h2 id="1-2-前端三大主流框架"><a href="#1-2-前端三大主流框架" class="headerlink" title="1.2 前端三大主流框架"></a>1.2 前端三大主流框架</h2><ul><li>Angular.js：出来<strong>较早</strong>的前端框架，学习曲线比较陡，NG1学起来比较麻烦，NG2 ~ NG5开始，进行了一系列的改革，也提供了组件化开发的概念；从NG2开始，也支持使用TS（TypeScript）进行编程；</li></ul><ul><li><p>Vue.js：<strong>最火</strong>（关注的人比较多）的一门前端框架，它是中国人开发的，对我们来说，文档要友好一些；</p></li><li><p>React.js：<strong>最流行</strong>（用的人比较多）的一门框架，因为它的设计很优秀；</p></li></ul><h2 id="1-3-React与Vue的对比"><a href="#1-3-React与Vue的对比" class="headerlink" title="1.3 React与Vue的对比"></a>1.3 React与Vue的对比</h2><p><strong>1、监听数据变化的实现原理不同</strong></p><ul><li>Vue 通过 getter/setter 以及一些函数的劫持，能精确知道数据变化，不需要特别的优化就能达到很好的性能</li><li>React 默认是通过比较引用地址的方式进行的，如果不优化（PureComponent/shouldComponentUpdate）可能导致大量不必要的VDOM的重新渲染</li></ul><p><strong>2、数据流的不同</strong></p><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn1XyhLI/uUnjQtxoKSmXQ5.YSnl4gAk7dXwc4xb6JNA*btZsrXfUKhIY4Mlhhvk6QQqzzrxBHBrQT9uu61Cjk9O.HxVwvA!!/b&bo=OgOQAToDkAEDCSw!&rf=viewer_4"  alt="img"></p><p>大家都知道Vue中默认是支持双向绑定的。在Vue1.0中我们可以实现两种双向绑定：</p><ol><li>父子组件之间，props 可以双向绑定</li><li>组件与DOM之间可以通过 v-model 双向绑定</li></ol><p>在 Vue2.x 中去掉了第一种，也就是父子组件之间不能双向绑定了（但是提供了一个语法糖自动帮你通过事件的方式修改），并且 Vue2.x 已经不鼓励组件对自己的 props 进行任何修改了。所以现在我们只有 组件 &lt;––&gt; DOM 之间的双向绑定这一种。</p><p>然而 React 从诞生之初就不支持双向绑定，React一直提倡的是单向数据流，他称之为 onChange/setState()模式。</p><p>不过由于我们一般都会用 Vuex 以及 Redux 等单向数据流的状态管理框架，因此很多时候我们感受不到这一点的区别了。</p><p><strong>3、模板渲染方式的不同</strong></p><p>在表层上， 模板的语法不同</p><ul><li>React 是通过JSX渲染模板</li><li>而Vue是通过一种拓展的HTML语法进行渲染</li></ul><p>但其实这只是表面现象，毕竟React并不必须依赖JSX。在深层上，模板的原理不同，这才是他们的本质区别：</p><ul><li>React是在组件JS代码中，通过原生JS实现模板中的常见语法，比如插值，条件，循环等，都是通过JS语法实现的</li><li>Vue是在和组件JS代码分离的单独的模板中，通过指令来实现的，比如条件语句就需要 v-if 来实现</li></ul><p><strong>4、Vuex 和 Redux 的区别</strong></p><p>从表面上来说，store 注入和使用方式有一些区别。</p><p>在 Vuex 中，$store 被直接注入到了组件实例中，因此可以比较灵活的使用：</p><ul><li>使用 dispatch 和 commit 提交更新</li><li>通过 mapState 或者直接通过 this.$store 来读取数据</li></ul><p>在 Redux 中，我们每一个组件都需要显示的用 connect 把需要的 props 和 dispatch 连接起来。</p><p>另外 Vuex 更加灵活一些，组件中既可以 dispatch action 也可以 commit reducer，而 Redux 中只能进行 dispatch，并不能直接调用 reducer 进行修改。</p><p>从实现原理上来说，最大的区别是两点：</p><ul><li>Redux 使用的是不可变数据，而Vuex的数据是可变的。Redux每次都是用新的state替换旧的state，而Vuex是直接修改</li><li>Redux 在检测数据变化的时候，是比较对象的引用地址；而Vuex其实和Vue的原理一样，是通过 getter/setter来比较的（如果看Vuex源码会知道，其实他内部直接创建一个Vue实例用来跟踪数据变化）</li></ul><p><strong>5、总结</strong></p><p>React更偏向于构建稳定大型的应用，非常的科班化。相比之下，Vue更偏向于简单迅速的解决问题，更灵活，不那么严格遵循条条框框。因此也会给人一种大型项目用React，小型项目用 Vue 的感觉。</p><h2 id="1-4-React中几个核心的概念"><a href="#1-4-React中几个核心的概念" class="headerlink" title="1.4 React中几个核心的概念"></a>1.4 React中几个核心的概念</h2><h3 id="1-4-1-虚拟DOM（Virtual-Document-Object-Model）"><a href="#1-4-1-虚拟DOM（Virtual-Document-Object-Model）" class="headerlink" title="1.4.1 虚拟DOM（Virtual Document Object Model）"></a>1.4.1 虚拟DOM（Virtual Document Object Model）</h3><ul><li><strong>DOM的本质是什么</strong>：浏览器中的概念，用JS对象来表示页面上的元素，并提供了操作 DOM 对象的API；</li><li><strong>什么是React中的虚拟DOM</strong>：是框架中的概念，是程序员用JS对象来模拟页面上的 DOM 和 DOM嵌套；</li><li><strong>为什么要实现虚拟DOM（虚拟DOM的目的）：</strong>为了实现页面中DOM 元素的高效更新</li><li><strong>DOM和虚拟DOM的区别</strong>：</li></ul><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn1XyhLI/43eWRH6lLSncPe1pJhVzbdWSqN.eymaP4Y0swybruZfE2pJw54iG4e.MLo.1sX41QK2eUtIf5xfRbZwZSm8tat9r8QuYzEoF*JIByABwl1c!/b&bo=OAXWAjgF1gIDGTw!&rf=viewer_4"  alt></p><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn1XyhLI/uUnjQtxoKSmXQ5.YSnl4gP.OPjSV4OMh4MrirZA3ctsgoixiys28APiCkDiUdPuSOyw13*8XMbdg7ihJFWXi8Q!!/b&bo=KgLLACoCywADCSw!&rf=viewer_4"  alt="1552877849641"></p><h3 id="1-4-2-react的Diff算法"><a href="#1-4-2-react的Diff算法" class="headerlink" title="1.4.2 react的Diff算法"></a>1.4.2 react的Diff算法</h3><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn1XyhLI/uUnjQtxoKSmXQ5.YSnl4gIhXMGB7JUW9SA0AZyTppvWfdNC.OQD411Pm3QmE7b*gVdyuoUa1k*UafKghM13eYA!!/b&bo=4AKZAeACmQEDCSw!&rf=viewer_4"  alt="Diff算法图"></p><p>其实传统diff算法就是对每个节点一一对比，循环遍历所有的子节点，然后判断子节点的更新状态。通过循环递归对节点进行依次对比，算法时间复杂度达到 O(n^3) ，n是树的节点数，这个有多可怕呢？——如果要展示1000个节点，得执行上亿次比较。即便是CPU快能执行30亿条命令，也<strong>很难在一秒内</strong>计算出差异。</p><p>React 通过制定大胆的策略，将 O(n^3) 复杂度的问题转换成 O(n) 复杂度的问题。react根据自己的特点，实现了部分代码的简化。</p><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn1XyhLI/uUnjQtxoKSmXQ5.YSnl4gLYniMHBf.WEdNItH3RZVetUwPp5L3GNVzpNcRpJGdTXXI3YCLocZ7*syN0osqiHPQ!!/b&bo=zAJAAcwCQAEDCSw!&rf=viewer_4"  alt="1552878167661"></p><h4 id="a-tree-diff"><a href="#a-tree-diff" class="headerlink" title="a) tree diff"></a>a) tree diff</h4><blockquote><p>（1）React通过updateDepth对Virtual DOM树进行层级控制。<br>（2）对树分层比较，两棵树只对同一层次节点进行比较。如果该节点不存在时，则该节点及其子节点会被完全删除，不会再进一步比较。<br>（3）只需遍历一次就能完成整棵DOM树的比较。</p></blockquote><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn1XyhLI/uUnjQtxoKSmXQ5.YSnl4gILEZt2EwY85Z0*zuNjzuCuFZfJO*6lSJjwjZVCu2W6lhafJVTUk4sK*ciEex1ydIw!!/b&bo=vQEIAb0BCAEDCSw!&rf=viewer_4"  alt="1562723697592"></p><blockquote><p>那么问题来了，如果DOM节点出现了跨层级操作,diff会咋办呢？<br>答：diff只简单考虑同层级的节点位置变换，如果是跨层级的话，只有创建节点和删除节点的操作。</p></blockquote><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn1XyhLI/43eWRH6lLSncPe1pJhVzbQoF4KCfI7SWY.HVHttLf4ckLVIXComi64qWaO.9eEWivwh3UY6jl21WY4i2RYYw1HMKyrG.AtZFnT2Xd8ig4cc!/b&bo=cAIWAXACFgEDGTw!&rf=viewer_4"  alt="1562723819718"></p><blockquote><p>如上图所示，以A为根节点的整棵树会被<strong>重新创建，而不是移动</strong>，因此 <strong>官方建议不要进行DOM节点跨层级操作，可以通过CSS隐藏、显示节点，而不是真正地移除、添加DOM节点</strong>。</p></blockquote><h4 id="b-component-diff"><a href="#b-component-diff" class="headerlink" title="b) component diff"></a>b) component diff</h4><p>React应用是基于组件构建的，对于组件的比较优化侧重于以下几点：</p><blockquote><ol><li>同一类型组件遵从tree diff比较v-dom树</li><li>不同类型组件，先将该组件归类为dirty component，替换下整个组件下的所有子节点</li><li>同一类型组件Virtual Dom没有变化，React允许开发者使用shouldComponentUpdate()来判断该组件是否进行diff，运用得当可以节省diff计算时间，提升性能</li></ol></blockquote><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn1XyhLI/43eWRH6lLSncPe1pJhVzbZklJ*f3DGfU.Yfr4dYxg.tkjqF2bEUy3Vv3Kz8iRTcvk6Q9h7jZXGrMXKN*i7ml7*CoDdtCn0QraXzHp8GM9.g!/b&bo=*gHBAP4BwQADGTw!&rf=viewer_4"  alt="1562723945651"></p><p>如上图，当组件D → 组件G时，diff判断为不同类型的组件，虽然它们的结构相似甚至一样，diff仍然不会比较二者结构，会直接销毁D及其子节点，然后新建一个G相关的子tree，这显然会影响性能，官方虽然认定这种情况极少出现，但是开发中的这种现象造成的影响是非常大的。</p><h4 id="c-element-diff"><a href="#c-element-diff" class="headerlink" title="c) element diff"></a>c) element diff</h4><p>对于同一层级的element节点，diff提供了以下3种节点操作：</p><blockquote><ol><li>INSERT_MARKUP 插入节点</li><li>MOVE_EXISING 移动节点</li><li>REMOVE_NODE 移除节点</li></ol></blockquote><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn1XyhLI/43eWRH6lLSncPe1pJhVzbVjbdFY3cwgD1XXkrfuQyx3SD9ukMui4Fx.lirLfRQdpbxg2arnmS2SI4xYCqKl8P2evBHZS9eVJJGr2c1MYtYI!/b&bo=CgLzAAoC8wADGTw!&rf=viewer_4"  alt="1562724094202"></p><p>一般diff在比较集合[A,B,C,D]和[B，A，D，C]的时候会进行全部对比，即按对应位置逐个比较，发现每个位置对应的元素都有所更新，则把旧集合全部移除，替换成新的集合，如上图，但是这样的操作在React中显然是复杂、低效、影响性能的操作，因为新集合中所有的元素都可以进行复用，无需删除重新创建，耗费性能和内存，只需要移动元素位置即可。</p><p>React对这一现象做出了一个高效的策略：允许开发者对同一层级的同组子节点添加唯一key值进行区分。意义就是代码上的一小步，性能上的一大步，甚至是翻天覆地的变化！</p><h1 id="2-React入门案例"><a href="#2-React入门案例" class="headerlink" title="2. React入门案例"></a>2. React入门案例</h1><h2 id="2-1-创建webpack应用"><a href="#2-1-创建webpack应用" class="headerlink" title="2.1 创建webpack应用"></a>2.1 创建webpack应用</h2><ol><li><p>运行<code>npm init -y</code> 快速初始化项目</p></li><li><p>在项目根目录创建<code>src</code>源代码目录和<code>dist</code>产品目录</p></li><li><p>在 src 目录下创建 <code>index.html和main.js</code></p></li><li><p>安装webpack和webpack-cli</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">npm install webpack@<span class="number">4.27</span><span class="number">.1</span> -d</span><br><span class="line">npm install webpack-cli -d       提供一些基本命令(比如webpack命令)</span><br></pre></td></tr></table></figure></li><li><p>创建webpack.config.js</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">"path"</span>)</span><br><span class="line"><span class="comment">//webpack基于node构建的，所有用的是CommonJS模块化规范</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    mode:<span class="string">"development"</span>,</span><br><span class="line">    entry: path.join(__dirname, <span class="string">'./src/main.js'</span>),</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.join(__dirname, <span class="string">'./dist'</span>),</span><br><span class="line">        filename: <span class="string">'bundle.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>index.html</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">    &lt;script src="../</span>dist/bundle.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>使用webpack命令打包项目，运行index.html查看结果</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">webpack</span><br></pre></td></tr></table></figure></li><li><p>配置webpack-dev-server</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#1.安装webpack-dev-serve</span><br><span class="line">npm install  webpack-dev-server -d</span><br><span class="line"></span><br><span class="line">#2.package.json的scripts添加dev</span><br><span class="line"> <span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>,</span><br><span class="line">    <span class="string">"dev"</span>: <span class="string">"webpack-dev-server --open --port 3000 --hot --host 127.0.0.1"</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line"> #3.npm run dev     webpack-dev-server将打包后的bundle.js托管到项目根路径下(内存中)，所以可以通过下面路径访问</span><br><span class="line">  http:<span class="comment">//localhost:8080/bundle.js    </span></span><br><span class="line"></span><br><span class="line">#4.修改index.html中引入bundle.js的路径</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;!--使用webpack-dev-server打包后内存中的bundle.js--&gt;</span></span><br><span class="line"><span class="regexp">    &lt;script src="../</span>bundle.js<span class="string">"&gt;&lt;/script&gt;</span></span><br><span class="line"><span class="string">&lt;/head&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>使用html-webpack-plugin将index.html配置到内存</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#1.安装html-webpack-plugin</span><br><span class="line">npm i html-webpack-plugin@<span class="number">3.2</span><span class="number">.0</span> --save-dev</span><br><span class="line"></span><br><span class="line">#2.修改webpack.config.js配置</span><br><span class="line"><span class="comment">// 导入自动生成HTMl文件的插件</span></span><br><span class="line"><span class="keyword">var</span> htmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    entry: path.join(__dirname, <span class="string">'./src/main.js'</span>),</span><br><span class="line">    output: &#123; </span><br><span class="line">        path: path.join(__dirname, <span class="string">'./dist'</span>), </span><br><span class="line">        filename: <span class="string">'bundle.js'</span> </span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [ </span><br><span class="line">        <span class="comment">// 添加plugins节点配置插件</span></span><br><span class="line">        <span class="keyword">new</span> htmlWebpackPlugin(&#123;</span><br><span class="line">            template:path.resolve(__dirname, <span class="string">'src/index.html'</span>),<span class="comment">//模板路径</span></span><br><span class="line">            filename:<span class="string">'index.html'</span><span class="comment">//自动生成的HTML文件的名称</span></span><br><span class="line">        &#125;)</span><br><span class="line">    ],</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><h2 id="2-2-在webpack中使用-react"><a href="#2-2-在webpack中使用-react" class="headerlink" title="2.2 在webpack中使用 react"></a>2.2 在webpack中使用 react</h2><ol><li><p>运行 <code>npm install react react-dom -S</code> 安装包</p><ul><li>react： 专门用于创建组件和虚拟DOM的，同时组件的生命周期都在这个包中</li><li>react-dom： 专门进行DOM操作的，最主要的应用场景，就是<code>ReactDOM.render()</code></li></ul></li><li><p>在<code>index.html</code>页面中，创建容器：</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 容器，将来，使用 React 创建的虚拟DOM元素，都会被渲染到这个指定的容器中 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>main.js导入包：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>                        <span class="comment">// 创建组件、虚拟DOM元素，生命周期</span></span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span>      <span class="comment">// 把创建好的 组件 和 虚拟DOM 放到页面上展示的</span></span><br></pre></td></tr></table></figure></li><li><p>创建虚拟DOM元素：</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 这是 创建虚拟DOM元素的 API    &lt;h1 title="啊，五环" id="myh1"&gt;你比四环多一环&lt;/h1&gt;</span></span><br><span class="line"><span class="comment">//  第一个参数： 字符串类型的参数，表示要创建的标签的名称</span></span><br><span class="line"><span class="comment">//  第二个参数：对象类型的参数， 表示 创建的元素的属性节点</span></span><br><span class="line"><span class="comment">//  第三个参数： 子节点（包括 其它 虚拟DOM 获取 文本子节点）</span></span><br><span class="line"><span class="comment">//  参数n :  其它子节点</span></span><br><span class="line"><span class="keyword">const</span> myh1 = React.createElement(<span class="string">'h1'</span>, &#123; <span class="attr">title</span>: <span class="string">'啊，五环'</span>, <span class="attr">id</span>: <span class="string">'myh1'</span> &#125;, <span class="string">'你比四环多一环'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> mydiv = React.createElement(<span class="string">'div'</span>, <span class="literal">null</span>, <span class="string">'这是一个div元素'</span>, myh1)</span><br></pre></td></tr></table></figure></li></ol><ol start="5"><li><p>渲染：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 3. 渲染虚拟DOM元素</span></span><br><span class="line"><span class="comment">// 参数1： 表示要渲染的虚拟DOM对象</span></span><br><span class="line"><span class="comment">// 参数2： 指定容器,注意：这里不能直接放 容器元素的Id字符串，需要放一个容器的DOM对象</span></span><br><span class="line">ReactDOM.render(myh1, <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>))</span><br></pre></td></tr></table></figure></li></ol><h2 id="2-3-JSX语法"><a href="#2-3-JSX语法" class="headerlink" title="2.3 JSX语法"></a>2.3 JSX语法</h2><blockquote><p>什么是JSX语法：就是符合 xml 规范的 JS 语法；（语法格式相对来说，要比HTML严谨很多）</p></blockquote><h3 id="2-3-1-启用-JSX-语法"><a href="#2-3-1-启用-JSX-语法" class="headerlink" title="2.3.1 启用 JSX 语法"></a>2.3.1 启用 JSX 语法</h3><p>浏览器目前还不支持 ES6 模块，比如这种ES6语法在浏览器和node中都不被支持    <code>import fs from &#39;fs&#39;</code>，为了现在就能使用，我们可以使用转码器(ES6–&gt;ES5)，也可以使用Browserify。</p><p>知名度比较大的转码器有Traceur和babel，babel将ES6代码编译为大多数浏览器（包括IE9）支持的ES5代码。</p><ul><li><p>安装 <code>babel</code> 插件</p><ul><li>运行<code>npm i babel-core@6.26.3 babel-loader@7.1.5 babel-plugin-transform-runtime --save-dev</code></li><li>运行<code>npm i babel-preset-env babel-preset-stage-0 --save-dev</code></li></ul></li><li><p>安装能够识别转换jsx语法的包 <code>babel-preset-react</code> </p><ul><li>运行<code>npm i babel-preset-react -D</code></li></ul></li><li><p>添加 <code>.babelrc</code> 配置文件</p><figure class="highlight json"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"presets"</span>: [<span class="string">"env"</span>, <span class="string">"stage-0"</span>, <span class="string">"react"</span>],</span><br><span class="line">  <span class="attr">"plugins"</span>: [<span class="string">"transform-runtime"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>添加babel-loader配置项：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="built_in">module</span>: &#123; <span class="comment">//要打包的第三方模块</span></span><br><span class="line">    rules: [</span><br><span class="line">      &#123; <span class="attr">test</span>: <span class="regexp">/\.js|jsx$/</span>, <span class="attr">use</span>: <span class="string">'babel-loader'</span>, <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span> &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"># 在main.js中使用JSX语法 </span><br><span class="line"><span class="keyword">const</span> mydiv2 = <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">h1</span>&gt;</span>哈哈<span class="tag">&lt;/<span class="name">h1</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">ReactDOM.render(mydiv2, <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>))</span><br></pre></td></tr></table></figure><h3 id="2-3-2-JSX-语法"><a href="#2-3-2-JSX-语法" class="headerlink" title="2.3.2 JSX 语法"></a>2.3.2 JSX 语法</h3><p>JSX语法的本质：并不是直接把 jsx 渲染到页面上，而是内部通过 createElement 再渲染到页面；</p><p>在 jsx 中混合写入 js 表达式：在 jsx 语法中，要把 JS代码写到    <code>{ }</code> 中</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1. 导入包</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//2. JSX中使用数值、字符串、bool、数组等信息</span></span><br><span class="line"><span class="keyword">let</span> a = <span class="number">10</span></span><br><span class="line"><span class="keyword">let</span> str = <span class="string">'你好，中国'</span></span><br><span class="line"><span class="keyword">let</span> boo = <span class="literal">false</span></span><br><span class="line"><span class="keyword">let</span> title = <span class="string">'999'</span></span><br><span class="line"><span class="keyword">const</span> h1 = <span class="xml"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>红火火恍恍惚惚<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="keyword">const</span> arr = [</span><br><span class="line">  &lt;h2&gt;这是h2&lt;<span class="regexp">/h2&gt;,</span></span><br><span class="line"><span class="regexp">  &lt;h3&gt;这是h3&lt;/</span>h3&gt;</span><br><span class="line">]</span><br><span class="line"><span class="keyword">const</span> arrStr = [<span class="string">'毛利兰'</span>, <span class="string">'柯南'</span>, <span class="string">'小五郎'</span>, <span class="string">'灰原哀'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个空数组，将来用来存放 名称 标签【方案1】</span></span><br><span class="line"><span class="keyword">const</span> nameArr = []</span><br><span class="line"><span class="comment">// 注意： React 中，需要把 key 添加给 被 forEach 或 map 或 for 循环直接控制的元素</span></span><br><span class="line">arrStr.forEach(<span class="function"><span class="params">item</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> temp = <span class="xml"><span class="tag">&lt;<span class="name">h5</span> <span class="attr">key</span>=<span class="string">&#123;item&#125;</span>&gt;</span>&#123;item&#125;<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span></span><br><span class="line">  nameArr.push(temp)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 数组的 map 方法, map 中必须写 return</span></span><br><span class="line"><span class="comment">/* const result = arrStr.map(item =&gt; &#123;</span></span><br><span class="line"><span class="comment">  return item + '~~'</span></span><br><span class="line"><span class="comment">&#125;)</span></span><br><span class="line"><span class="comment">console.log(result) */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 调用 render 函数渲染   JSX  XML 比 HTML 严格多了</span></span><br><span class="line"><span class="comment">// 在JSX要使用JS，则需要把 JS 代码写到 &#123;&#125; 中</span></span><br><span class="line">ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">  &#123;a + 2&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="xml">  &#123;str&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="xml">  &#123;boo ? '条件为真' : '条件为假'&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">title</span>=<span class="string">&#123;title&#125;</span>&gt;</span>这是p标签<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">  &#123;h1&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="xml">  &#123;/* &#123;arr&#125; */&#125;</span></span><br><span class="line"><span class="xml">  &#123;</span></span><br><span class="line"><span class="xml">    // 这是注释，你看不见我</span></span><br><span class="line"><span class="xml">  &#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"><span class="xml">  &#123;nameArr&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line">  &#123;arrStr.map(item =&gt; &lt;div key=&#123;item&#125;&gt;&lt;h3&gt;&#123;item&#125;&lt;/h3&gt;</span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span>)&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">htmlFor</span>=<span class="string">"ooo"</span>&gt;</span>11111<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>, <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>))</span><br><span class="line">        </span><br><span class="line">                </span><br><span class="line"> #注意点：</span><br><span class="line"><span class="number">1.</span> 在 JSX 中 写注释：推荐使用&#123; <span class="comment">/* 这是注释 */</span> &#125;</span><br><span class="line"><span class="number">2.</span> 为 JSX 中的htmlFor替换label的<span class="keyword">for</span>属性</span><br><span class="line"><span class="number">3.</span> 在 JSX 创建DOM的时候，所有的节点，必须有唯一的根元素进行包裹；</span><br><span class="line"><span class="number">4.</span> 在 JSX 语法中，标签必须成对出现，如果是单标签，则必须自闭和！</span><br></pre></td></tr></table></figure><blockquote><p>当 编译引擎，在编译JSX代码的时候，如果遇到了<code>&lt;</code>那么就把它当作 HTML代码去编译，如果遇到了 <code>{}</code> 就把 花括号内部的代码当作普通JS代码去编译；</p></blockquote><h1 id="3-React中创建组件"><a href="#3-React中创建组件" class="headerlink" title="3. React中创建组件"></a>3. React中创建组件</h1><h2 id="3-1-使用构造函数来创建组件"><a href="#3-1-使用构造函数来创建组件" class="headerlink" title="3.1 使用构造函数来创建组件"></a>3.1 使用构造函数来创建组件</h2><blockquote><p>如果要接收外界传递的数据，需要在构造函数的参数列表中使用<code>props</code>来接收；</p><p>必须要向外return一个合法的JSX创建的虚拟DOM；</p></blockquote><h3 id="3-1-1-创建组件"><a href="#3-1-1-创建组件" class="headerlink" title="3.1.1 创建组件"></a>3.1.1 创建组件</h3><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 第一种创建组件的方式 ： 注意构造函数首字母必须大写</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Hello</span> (<span class="params">props</span>) </span>&#123; </span><br><span class="line">    <span class="comment">// 如果 在一个组件种 return 一个 null。则表示此组件是空的，什么都不会渲染</span></span><br><span class="line"><span class="comment">// return null </span></span><br><span class="line">    <span class="comment">// 在组件中，必须 返回一个 合法的 JSX 虚拟DOM元素</span></span><br><span class="line"><span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>Hello 组件<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-1-2-为组件传递数据"><a href="#3-1-2-为组件传递数据" class="headerlink" title="3.1.2 为组件传递数据"></a>3.1.2 为组件传递数据</h3><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1. 导入包</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Hello</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// props.name = 'zs'     不论是 Vue 还是 React，组件中的 props 永远都是只读的；不能被重新赋值;</span></span><br><span class="line">  <span class="built_in">console</span>.log(props)</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>这是 Hello 组件 --- &#123;props.name&#125; --- &#123;props.age&#125; --- &#123;props.gender&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> dog = &#123;</span><br><span class="line">  name: <span class="string">'大黄'</span>,</span><br><span class="line">  age: <span class="number">3</span>,</span><br><span class="line">  gender: <span class="string">'雄'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">  123</span></span><br><span class="line"><span class="xml">  &#123;/* 直接把 组件的名称，以标签形式，丢到页面上即可 */&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">Hello</span> <span class="attr">name</span>=<span class="string">&#123;dog.name&#125;</span> <span class="attr">age</span>=<span class="string">&#123;dog.age&#125;</span> <span class="attr">gender</span>=<span class="string">&#123;dog.gender&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Hello</span>&gt;</span></span></span><br><span class="line"><span class="xml">  &#123;/* 使用&#123;...obj&#125;属性扩散传递数据 */&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">Hello</span> &#123;<span class="attr">...dog</span>&#125;&gt;</span><span class="tag">&lt;/<span class="name">Hello</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>, <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>))</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"># 关于es6的展开运算符</span><br><span class="line"><span class="keyword">var</span> o2 = &#123;</span><br><span class="line">  age: <span class="number">22</span>,</span><br><span class="line">  address: <span class="string">'中国北京'</span>,</span><br><span class="line">  phone: <span class="string">'139999'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> o1 = &#123;</span><br><span class="line">  name: <span class="string">'zs'</span>,</span><br><span class="line">  ...o2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(o1)</span><br></pre></td></tr></table></figure><h3 id="3-1-3-封装组件到独立文件"><a href="#3-1-3-封装组件到独立文件" class="headerlink" title="3.1.3 封装组件到独立文件"></a>3.1.3 封装组件到独立文件</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#1. 新建Hello.jsx，并导出组件</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="comment">// 第一种创建组件的方式</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">Hello</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// 如果 在一个组件中 return 一个 null。则表示此组件是空的，什么都不会渲染</span></span><br><span class="line">  <span class="comment">// return null</span></span><br><span class="line">  <span class="comment">// 在组件中，必须 返回一个 合法的 JSX 虚拟DOM元素</span></span><br><span class="line">  <span class="comment">// props.name = 'zs'</span></span><br><span class="line">  <span class="built_in">console</span>.log(props)</span><br><span class="line">  <span class="comment">// 结论：不论是 Vue 还是 React，组件中的 props 永远都是只读的；不能被重新赋值；</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>这是 Hello 组件 --- &#123;props.name&#125; --- &#123;props.age&#125; --- &#123;props.gender&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 把组件暴露出去</span></span><br><span class="line"><span class="comment">// export default Hello</span></span><br><span class="line"></span><br><span class="line">#2.导入Hello.jsx</span><br><span class="line">  <span class="comment">// 1. 导入包</span></span><br><span class="line">  <span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line">  <span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></span><br><span class="line">  <span class="comment">// 注意： 这里的 @ 符号，表示 项目根目录中的 src 这一层目录</span></span><br><span class="line">  <span class="keyword">import</span> Hello <span class="keyword">from</span> <span class="string">'@/components/Hello.jsx'</span></span><br><span class="line">  <span class="keyword">const</span> dog = &#123;</span><br><span class="line">    name: <span class="string">'大黄'</span>,</span><br><span class="line">    age: <span class="number">3</span>,</span><br><span class="line">    gender: <span class="string">'雄'</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    123</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">Hello</span> &#123;<span class="attr">...dog</span>&#125;&gt;</span><span class="tag">&lt;/<span class="name">Hello</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>, <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>))</span><br><span class="line">                  </span><br><span class="line">                  </span><br><span class="line">#3.在导入组件的时候，如何省略组件的.jsx后缀名</span><br><span class="line"><span class="comment">// 打开 webpack.config.js ，并在导出的配置对象中，新增 如下节点：</span></span><br><span class="line">  resolve: &#123;</span><br><span class="line">      extensions: [<span class="string">'.js'</span>, <span class="string">'.jsx'</span>, <span class="string">'.json'</span>], <span class="comment">// 表示，这几个文件的后缀名，可以省略不写</span></span><br><span class="line">      alias: &#123;</span><br><span class="line">          <span class="string">'@'</span>: path.join(__dirname, <span class="string">'./src'</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="3-2-使用-class-关键字来创建组件"><a href="#3-2-使用-class-关键字来创建组件" class="headerlink" title="3.2 使用 class 关键字来创建组件"></a>3.2 使用 class 关键字来创建组件</h2><h3 id="3-2-1-ES6的class关键字"><a href="#3-2-1-ES6的class关键字" class="headerlink" title="3.2.1 ES6的class关键字"></a>3.2.1 ES6的class关键字</h3>  <figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 创建了一个动物类</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Animal</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 每一个类中都有一个构造器，如果我们程序员没有手动指定构造器，那么，可以认为类内部有个隐形的、看不见的 空构造器，类似于 constructor()&#123;&#125;</span></span><br><span class="line">  <span class="comment">// 构造器的作用是每当 new 这个类的时候，必然会优先执行构造器中的代码</span></span><br><span class="line">  <span class="keyword">constructor</span>(name, age) &#123;</span><br><span class="line">    <span class="comment">// 实例属性</span></span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 在 class 内部，通过 static 修饰的属性，就是静态属性</span></span><br><span class="line">  <span class="keyword">static</span> info = <span class="string">"eee"</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 这是动物的实例方法(挂载到原型对象上的实例方法)</span></span><br><span class="line">  jiao() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'动物的实例方法'</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 这是 动物 类的静态方法（今后用的不多）</span></span><br><span class="line">  <span class="keyword">static</span> show() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'这是 Animal 的静态 show 方法'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> a1 = <span class="keyword">new</span> Animal(<span class="string">'大黄'</span>, <span class="number">3</span>)</span><br><span class="line"><span class="built_in">console</span>.log(a1)</span><br><span class="line"><span class="comment">// console.log(a1.name)// 实例属性</span></span><br><span class="line"><span class="comment">// console.log(a1.age) // 实例属性</span></span><br><span class="line"><span class="built_in">console</span>.log(Animal.info) <span class="comment">// info 是 Animal 的静态属性</span></span><br><span class="line">a1.jiao() <span class="comment">// 这是实例方法</span></span><br><span class="line">Animal.show() <span class="comment">// 静态方法</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//其实静态属性和静态方法都挂载到了constructor上面，而构造器又指向了函数本身，所以可以直接通过函数名来调用静态属性和静态方法</span></span><br></pre></td></tr></table></figure><p>ES6的class只是一个语法糖，其本质仍然是通过之前的构造函数来创建对象，而对应的实例属性、实例方法、静态属性、静态方法实质都是向对应的原型和constructor中新增属性和方法，没有实质的变化。</p><h3 id="3-2-2-class继承"><a href="#3-2-2-class继承" class="headerlink" title="3.2.2 class继承"></a>3.2.2 class继承</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 这是父类 </span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(name, age)&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 打招呼 的 实例方法</span></span><br><span class="line">  sayHello()&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'大家好'</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">American</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(name, age)&#123;</span><br><span class="line">    <span class="comment">// super 是一个函数，它是父类的构造器；子类中的 super其实就是父类constructor 构造器的一个引用；</span></span><br><span class="line">    <span class="keyword">super</span>(name, age)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> a1 = <span class="keyword">new</span> American(<span class="string">'Jack'</span>, <span class="number">20</span>)</span><br><span class="line"><span class="built_in">console</span>.log(a1)</span><br><span class="line">a1.sayHello()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// 这是子类 中国人</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Chinese</span> <span class="keyword">extends</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">  <span class="comment">// IDNumber 身份证号 【中国人独有的】，既然是独有的，就不适合 挂载到 父类上；</span></span><br><span class="line">  <span class="keyword">constructor</span>(name, age, IDNumber)&#123;</span><br><span class="line">    <span class="keyword">super</span>(name, age)</span><br><span class="line">    <span class="comment">// 语法规范：在子类中， this 只能放到 super 之后使用</span></span><br><span class="line">    <span class="keyword">this</span>.IDNumber = IDNumber</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> c1 = <span class="keyword">new</span> Chinese(<span class="string">'张三'</span>, <span class="number">22</span>, <span class="string">'130428******'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(c1)</span><br><span class="line">c1.sayHello()</span><br></pre></td></tr></table></figure><h3 id="3-2-3-基于class关键字创建组件"><a href="#3-2-3-基于class关键字创建组件" class="headerlink" title="3.2.3 基于class关键字创建组件"></a>3.2.3 基于class关键字创建组件</h3><p>最基本的组件结构：</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">//让自己的组件继承React.Compoent，重写render方法</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> 组件名称 <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>这是 class 创建的组件<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1. 导入包</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// class 关键字创建组件</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Movie</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="comment">// 构造器</span></span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="comment">// 由于 Movie 组件，继承了 React.Component 这个父类，所以自定义的构造器中必须调用 super()</span></span><br><span class="line">    <span class="keyword">super</span>()</span><br><span class="line">    <span class="comment">// 只有调用了 super() 以后，才能使用 this 关键字。这个 this.state = &#123;&#125; 就相当于 Vue 中的 data() &#123; return &#123; &#125; &#125;</span></span><br><span class="line">    <span class="keyword">this</span>.state = &#123; </span><br><span class="line">      msg: <span class="string">'大家好，我是 class 创建的 Movie组件'</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// render 函数的作用，是 渲染 当前组件所对应的 虚拟DOM元素</span></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      &#123;/* 注意：在 class 组件内部，this 表示 当前组件的实例对象。props数据不可以修改，state数据可以修改 */&#125;</span></span><br><span class="line"><span class="xml">      这是 Movie 组件 -- &#123;this.props.name&#125; -- &#123;this.props.age&#125; -- &#123;this.props.gender&#125;</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">h3</span>&gt;</span>&#123;this.state.msg&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> user = &#123;</span><br><span class="line">  name: <span class="string">'zs'</span>,</span><br><span class="line">  age: <span class="number">22</span>,</span><br><span class="line">  gender: <span class="string">'男'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 调用 render 函数渲染</span></span><br><span class="line">ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">  123</span></span><br><span class="line"><span class="xml">  &#123;/* 这里的 Movie 标签，其实，就是 Movie 类的一个实例对象 */&#125;</span></span><br><span class="line"><span class="xml">  &#123;/* <span class="tag">&lt;<span class="name">Movie</span> <span class="attr">name</span>=<span class="string">&#123;user.name&#125;</span> <span class="attr">age</span>=<span class="string">&#123;user.age&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Movie</span>&gt;</span> */&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">Movie</span> &#123;<span class="attr">...user</span>&#125;&gt;</span><span class="tag">&lt;/<span class="name">Movie</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>, <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>))</span><br></pre></td></tr></table></figure><h3 id="3-2-4-state的修改"><a href="#3-2-4-state的修改" class="headerlink" title="3.2.4 state的修改"></a>3.2.4 state的修改</h3><h4 id="a-不能直接修改-State"><a href="#a-不能直接修改-State" class="headerlink" title="a) 不能直接修改 State"></a>a) 不能直接修改 State</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.state.comment = <span class="string">'Hello'</span>;</span><br><span class="line"></span><br><span class="line"> <span class="comment">//可以这样修改State</span></span><br><span class="line"><span class="keyword">this</span>.setState(&#123;<span class="attr">comment</span>: <span class="string">'Hello'</span>&#125;);</span><br></pre></td></tr></table></figure><h4 id="b-State的更新可能是异步的"><a href="#b-State的更新可能是异步的" class="headerlink" title="b) State的更新可能是异步的"></a>b) State的更新可能是异步的</h4><p>因为 <code>this.props</code> 和 <code>this.state</code> 可能会异步更新，所以你不要依赖他们的值来更新下一个状态。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//调用setState，组件的state并不会立即改变，setState只是把要修改的状态放入一个队列中，React会优化真正的执行时机，并且React会出于性能原因，可能会将多次setState的状态修改合并成一次状态修改。所以不要依赖当前的State，计算下个State。</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="comment">//Wrong</span></span><br><span class="line">  <span class="keyword">this</span>.setState(&#123;<span class="attr">count</span>: <span class="keyword">this</span>.state.count + <span class="number">1</span>&#125;);</span><br><span class="line">  <span class="keyword">this</span>.setState(&#123;<span class="attr">count</span>: <span class="keyword">this</span>.state.count + <span class="number">1</span>&#125;);</span><br><span class="line">  <span class="keyword">this</span>.setState(&#123;<span class="attr">count</span>: <span class="keyword">this</span>.state.count + <span class="number">1</span>&#125;);</span><br><span class="line">  <span class="comment">//结果state的count为1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//Correct</span></span><br><span class="line">add = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(<span class="function"><span class="params">state</span> =&gt;</span> (&#123;</span><br><span class="line">        count: state.count + <span class="number">1</span></span><br><span class="line">    &#125;));</span><br><span class="line">    <span class="keyword">this</span>.setState(<span class="function"><span class="params">state</span> =&gt;</span> (&#123;</span><br><span class="line">        count: state.count + <span class="number">1</span></span><br><span class="line">    &#125;));</span><br><span class="line">    <span class="keyword">this</span>.setState(<span class="function"><span class="params">state</span> =&gt;</span> (&#123;</span><br><span class="line">        count: state.count + <span class="number">1</span></span><br><span class="line">    &#125;));</span><br><span class="line">    <span class="comment">//结果state的count为3</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// Wrong   因为state和props的更新可能是异步的，所以并不能保证counter中所获取到的state和props是最新的</span></span><br><span class="line"><span class="keyword">this</span>.setState(&#123;</span><br><span class="line">  counter: <span class="keyword">this</span>.state.counter + <span class="keyword">this</span>.props.increment,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// Correct    这边的state表示之前的state状态了</span></span><br><span class="line"><span class="keyword">this</span>.setState(<span class="function">(<span class="params">state, props</span>) =&gt;</span> (&#123;</span><br><span class="line">  counter: state.counter + props.increment</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure><blockquote><p>state的更新既可能是同步的，也可能是异步的。 准确地说，在React内部机制能检测到的地方, setState就是异步的；在React检测不到的地方，例如setInterval、setTimeout里，setState就是同步更新的。</p></blockquote><h4 id="c-获取更新之后的state数据"><a href="#c-获取更新之后的state数据" class="headerlink" title="c) 获取更新之后的state数据"></a>c) 获取更新之后的state数据</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">this</span>.setState(</span><br><span class="line">    &#123; <span class="attr">data</span>: newData &#125;,</span><br><span class="line">    () =&gt; &#123;</span><br><span class="line">        <span class="comment">//这里打印的是最新的state值</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.state.data);</span><br><span class="line">    &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h2 id="3-3-两种创建组件方式的对比"><a href="#3-3-两种创建组件方式的对比" class="headerlink" title="3.3 两种创建组件方式的对比"></a>3.3 两种创建组件方式的对比</h2><ol><li>用<strong>构造函数</strong>创建出来的组件：叫做“无状态组件”，只有props，没有自己的私有数据和生命周期函数</li><li>用<strong>class关键字</strong>创建出来的组件：叫做“有状态组件”，有私有数据和生命周期函数</li></ol><blockquote><p>有状态组件和无状态组件之间的<strong>本质区别</strong>就是：有无state属性！无状态组件由于没有私有数据和生命周期函数，运行效率会比有状态组件高一些。</p></blockquote><h2 id="3-4-条件渲染"><a href="#3-4-条件渲染" class="headerlink" title="3.4 条件渲染"></a>3.4 条件渲染</h2><h3 id="3-4-1-通过if来进行条件渲染"><a href="#3-4-1-通过if来进行条件渲染" class="headerlink" title="3.4.1 通过if来进行条件渲染"></a>3.4.1 通过if来进行条件渲染</h3><p><a href="https://blog.csdn.net/crystalqy/article/details/79066347" target="_blank" rel="noopener">https://blog.csdn.net/crystalqy/article/details/79066347</a></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Greeting</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> isLoggedIn = props.isLoggedIn;</span><br><span class="line">  <span class="keyword">if</span> (isLoggedIn) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">UserGreeting</span> /&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">GuestGreeting</span> /&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(</span><br><span class="line">  <span class="comment">// Try changing to isLoggedIn=&#123;true&#125;:</span></span><br><span class="line">  &lt;Greeting isLoggedIn=&#123;<span class="literal">false</span>&#125; /&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="3-4-2-通过-amp-amp-进行条件渲染"><a href="#3-4-2-通过-amp-amp-进行条件渲染" class="headerlink" title="3.4.2 通过&amp;&amp;进行条件渲染"></a>3.4.2 通过&amp;&amp;进行条件渲染</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Mailbox</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> unreadMessages = props.unreadMessages;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;h1&gt;Hello!&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp">      &#123;unreadMessages.length &gt; 0 &amp;&amp;</span></span><br><span class="line"><span class="regexp">        &lt;h2&gt;</span></span><br><span class="line"><span class="regexp">          You have &#123;unreadMessages.length&#125; unread messages.</span></span><br><span class="line"><span class="regexp">        &lt;/</span>h2&gt;</span><br><span class="line">      &#125;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const messages = ['React', 'Re: React', 'Re:Re: React'];</span></span><br><span class="line"><span class="regexp">ReactDOM.render(</span></span><br><span class="line"><span class="regexp">  &lt;Mailbox unreadMessages=&#123;messages&#125; /</span>&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure><h3 id="3-4-3-三元运算符条件渲染"><a href="#3-4-3-三元运算符条件渲染" class="headerlink" title="3.4.3 三元运算符条件渲染"></a>3.4.3 三元运算符条件渲染</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">  <span class="keyword">const</span> isLoggedIn = <span class="keyword">this</span>.state.isLoggedIn;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &#123;isLoggedIn ? (</span><br><span class="line">        &lt;LogoutButton onClick=&#123;<span class="keyword">this</span>.handleLogoutClick&#125; /&gt;</span><br><span class="line">      ) : (</span><br><span class="line">        &lt;LoginButton onClick=&#123;<span class="keyword">this</span>.handleLoginClick&#125; /&gt;</span><br><span class="line">      )&#125;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="3-4-4-阻止组件渲染"><a href="#3-4-4-阻止组件渲染" class="headerlink" title="3.4.4 阻止组件渲染"></a>3.4.4 阻止组件渲染</h3><p>在极少数情况下，你可能希望能隐藏组件，即使它已经被其他组件渲染。若要完成此操作，你可以让 <code>render</code> 方法直接返回 <code>null</code>，而不进行任何渲染。</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">render() &#123;</span><br><span class="line">  <span class="keyword">const</span> isLoggedIn = <span class="keyword">this</span>.state.isLoggedIn;</span><br><span class="line">  <span class="keyword">if</span> (!isLoggedIn) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;LoginButton onClick=&#123;<span class="keyword">this</span>.handleLoginClick&#125; /&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="3-5-列表渲染"><a href="#3-5-列表渲染" class="headerlink" title="3.5 列表渲染"></a>3.5 列表渲染</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">NumberList</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> numbers = props.numbers;</span><br><span class="line">  <span class="keyword">const</span> listItems = numbers.map(<span class="function">(<span class="params">number</span>) =&gt;</span></span><br><span class="line">    &lt;li key=&#123;number.toString()&#125;&gt;</span><br><span class="line">      &#123;number&#125;</span><br><span class="line">    &lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;ul&gt;&#123;listItems&#125;&lt;/u</span>l&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> numbers = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>];</span><br><span class="line">ReactDOM.render(</span><br><span class="line">  &lt;NumberList numbers=&#123;numbers&#125; /&gt;,</span><br><span class="line">  <span class="built_in">document</span>.getElementById(<span class="string">'root'</span>)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">//key 帮助 React 识别哪些元素改变了，比如被添加或删除。因此你应当给数组中的每一个元素赋予一个确定的标识。</span></span><br><span class="line"><span class="comment">//一个元素的 key 最好是这个元素在列表中拥有的一个独一无二的字符串。通常，我们使用来自数据 id 来作为元素的 key。key在兄弟节点之间必须唯一</span></span><br><span class="line"><span class="comment">//当元素没有确定 id 的时候，万不得已你可以使用元素索引 index 作为 key：</span></span><br><span class="line"><span class="keyword">const</span> todoItems = todos.map(<span class="function">(<span class="params">todo, index</span>) =&gt;</span></span><br><span class="line">  <span class="comment">// Only do this if items have no stable IDs</span></span><br><span class="line">  &lt;li key=&#123;index&#125;&gt;</span><br><span class="line">    &#123;todo.text&#125;</span><br><span class="line">  &lt;<span class="regexp">/li&gt;</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure><h2 id="3-6-Fragment的使用"><a href="#3-6-Fragment的使用" class="headerlink" title="3.6 Fragment的使用"></a>3.6 Fragment的使用</h2><p>有时，语义化的 HTML 会被破坏。比如当在 JSX 中使用 <code>&lt;div&gt;</code> 元素来实现 React 代码功能的时候，又或是在使用列表（<code>&lt;ol&gt;</code>， <code>&lt;ul&gt;</code> 和 <code>&lt;dl&gt;</code>）和 HTML <code>&lt;table&gt;</code> 时。 在这种情况下，我们应该使用 <a href="https://react.docschina.org/docs/fragments.html" target="_blank" rel="noopener">React Fragments</a> 来组合各个组件。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Fragment &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">ListItem</span>(<span class="params">&#123; item &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;Fragment&gt;</span><br><span class="line">      &lt;dt&gt;&#123;item.term&#125;&lt;<span class="regexp">/dt&gt;</span></span><br><span class="line"><span class="regexp">      &lt;dd&gt;&#123;item.description&#125;&lt;/</span>dd&gt;</span><br><span class="line">    &lt;<span class="regexp">/Fragment&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function Glossary(props) &#123;</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;dl&gt;</span></span><br><span class="line"><span class="regexp">      &#123;props.items.map(item =&gt; (</span></span><br><span class="line"><span class="regexp">        &lt;ListItem item=&#123;item&#125; key=&#123;item.id&#125; /</span>&gt;</span><br><span class="line">      ))&#125;</span><br><span class="line">    &lt;<span class="regexp">/dl&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="3-7-React组合"><a href="#3-7-React组合" class="headerlink" title="3.7 React组合"></a>3.7 React组合</h2><p>react组合类似于Vue中的slot(插槽)，子组件的内容由父组件来指定</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">FancyBorder</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=&#123;<span class="string">'FancyBorder FancyBorder-'</span> + props.color&#125;&gt;</span><br><span class="line">      &#123;<span class="comment">/*子组件：占坑*/</span>&#125;</span><br><span class="line">      &#123;props.children&#125;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function WelcomeDialog() &#123;</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;FancyBorder color="blue"&gt;</span></span><br><span class="line"><span class="regexp">      &#123;/</span>*父组件中填坑*<span class="regexp">/&#125;</span></span><br><span class="line"><span class="regexp">      &lt;h1 className="Dialog-title"&gt;</span></span><br><span class="line"><span class="regexp">        Welcome</span></span><br><span class="line"><span class="regexp">      &lt;/</span>h1&gt;</span><br><span class="line">      &lt;p className=<span class="string">"Dialog-message"</span>&gt;</span><br><span class="line">        Thank you <span class="keyword">for</span> visiting our spacecraft!</span><br><span class="line">      &lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>FancyBorder&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>少数情况下，你可能需要在一个组件中预留出几个“洞”。这种情况下，我们可以不使用 children，而是自行约定：将所需内容传入 props，并使用相应的 prop。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">SplitPane</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div className=<span class="string">"SplitPane"</span>&gt;</span><br><span class="line">      &lt;div className=<span class="string">"SplitPane-left"</span>&gt;</span><br><span class="line">        &#123;props.left&#125;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">      &lt;div className="SplitPane-right"&gt;</span></span><br><span class="line"><span class="regexp">        &#123;props.right&#125;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>div&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function App() &#123;</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;SplitPane</span></span><br><span class="line"><span class="regexp">      left=&#123;</span></span><br><span class="line"><span class="regexp">        &lt;Contacts /</span>&gt;</span><br><span class="line">      &#125;</span><br><span class="line">      right=&#123;</span><br><span class="line">        &lt;Chat /&gt;</span><br><span class="line">      &#125; /&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="4-评论列表案例"><a href="#4-评论列表案例" class="headerlink" title="4. 评论列表案例"></a>4. 评论列表案例</h1><p>思路：父组件中套了若干个评论Item子组件，所以需要创建两个组件，分别是：CmtList和CmtItem</p><h2 id="4-1-案例完成"><a href="#4-1-案例完成" class="headerlink" title="4.1 案例完成"></a>4.1 案例完成</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#1. CmtList组件</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 导入 评论项 组件</span></span><br><span class="line"><span class="keyword">import</span> CmtItem <span class="keyword">from</span> <span class="string">'@/components/CmtItem'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">CmtList</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>() &#123;</span><br><span class="line">    <span class="keyword">super</span>()</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;</span><br><span class="line">      CommentList: [ <span class="comment">// 评论列表数据</span></span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">user</span>: <span class="string">'张三'</span>, <span class="attr">content</span>: <span class="string">'哈哈，沙发'</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">user</span>: <span class="string">'李四'</span>, <span class="attr">content</span>: <span class="string">'哈哈，板凳'</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">user</span>: <span class="string">'王五'</span>, <span class="attr">content</span>: <span class="string">'哈哈，凉席'</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">4</span>, <span class="attr">user</span>: <span class="string">'赵六'</span>, <span class="attr">content</span>: <span class="string">'哈哈，砖头'</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">id</span>: <span class="number">5</span>, <span class="attr">user</span>: <span class="string">'田七'</span>, <span class="attr">content</span>: <span class="string">'哈哈，楼下山炮'</span> &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      &#123;/* 注意：在 JSX 中如果想写行内样式了，不能为 style 设置字符串的值 */&#125;</span></span><br><span class="line"><span class="xml">      &#123;/* 而是应该 这么写：    style=&#123; &#123; color: 'red' &#125; &#125; */&#125;</span></span><br><span class="line"><span class="xml">      &#123;/* 在 行内样式中，如果 是 数值类型的样式，则可以不用引号包裹，如果是 字符串类型的 样式值，必须使用 引号包裹 */&#125;</span></span><br><span class="line"><span class="xml">      <span class="tag">&lt;<span class="name">h1</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">color:</span> '<span class="attr">red</span>', <span class="attr">fontSize:</span> '<span class="attr">35px</span>', <span class="attr">zIndex:</span> <span class="attr">3</span>, <span class="attr">fontWeight:</span> <span class="attr">200</span>, <span class="attr">textAlign:</span> '<span class="attr">center</span>' &#125;&#125;&gt;</span>这是评论列表组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="xml">      &#123;this.state.CommentList.map(item =&gt; <span class="tag">&lt;<span class="name">CmtItem</span> &#123;<span class="attr">...item</span>&#125; <span class="attr">key</span>=<span class="string">&#123;item.id&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">CmtItem</span>&gt;</span>)&#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">                                  </span><br><span class="line">#2.CmtItem组件</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 第一层封装：将 样式对象 和 UI 结构分离</span></span><br><span class="line"><span class="comment">// const itemStyle = &#123; border: '1px dashed #ccc', margin: '10px', padding: '10px', boxShadow: '0 0 10px #ccc' &#125;</span></span><br><span class="line"><span class="comment">// const userStyle = &#123; fontSize: '14px' &#125;</span></span><br><span class="line"><span class="comment">// const contentStyle = &#123; fontSize: '12px' &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 第二层封装：合并成一个大的样式对象</span></span><br><span class="line"><span class="comment">// const styles = &#123;</span></span><br><span class="line"><span class="comment">//   item: &#123; border: '1px dashed #ccc', margin: '10px', padding: '10px', boxShadow: '0 0 10px #ccc' &#125;,</span></span><br><span class="line"><span class="comment">//   user: &#123; fontSize: '14px' &#125;,</span></span><br><span class="line"><span class="comment">//   content: &#123; fontSize: '12px' &#125;</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 第三层封装：抽离为单独的 样式表 模块</span></span><br><span class="line"><span class="keyword">import</span> styles <span class="keyword">from</span> <span class="string">'@/components/styles'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">CmtItem</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;styles.item&#125;</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">style</span>=<span class="string">&#123;styles.user&#125;</span>&gt;</span>评论人：&#123;props.user&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&#123;styles.content&#125;</span>&gt;</span>评论内容：&#123;props.content&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#3.styles.js </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  item: &#123; <span class="attr">border</span>: <span class="string">'1px dashed #ccc'</span>, <span class="attr">margin</span>: <span class="string">'10px'</span>, <span class="attr">padding</span>: <span class="string">'10px'</span>, <span class="attr">boxShadow</span>: <span class="string">'0 0 10px #ccc'</span> &#125;,</span><br><span class="line">  user: &#123; <span class="attr">fontSize</span>: <span class="string">'14px'</span> &#125;,</span><br><span class="line">  content: &#123; <span class="attr">fontSize</span>: <span class="string">'12px'</span> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-2-使用CSS样式表"><a href="#4-2-使用CSS样式表" class="headerlink" title="4.2 使用CSS样式表"></a>4.2 使用CSS样式表</h2><ol><li><p>修改 <code>webpack.config.js</code>这个配置文件，为 <code>css-loader</code> 添加参数：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">npm install  style-loader  css-loader -D</span><br><span class="line"></span><br><span class="line">&#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader'</span>] &#125;</span><br></pre></td></tr></table></figure></li><li><p>创建CmtList.css</p><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-class">.title</span>&#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">200</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">h1</span>&#123;</span><br><span class="line">  <span class="attribute">font-style</span>: italic;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>在CmtList组件中<code>import</code>导入样式表，并接收模块化的 CSS 样式对象：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> cssObj <span class="keyword">from</span> <span class="string">'../css/CmtList.css'</span> </span><br><span class="line"><span class="built_in">console</span>.log(cssObj)   <span class="comment">// 发现打印是空对象,因为它并不像js有模块化的导出</span></span><br></pre></td></tr></table></figure></li><li><p>在需要的HTML标签上，使用<code>className</code>指定模块化的样式：</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line"><span class="comment">//这边不能&lt;h1 className=&#123;cssObj.title&#125;&gt;评论列表组件&lt;/h1&gt; 这样用，因为cssObj是空对象，但是在webpack打包后title会成为全局样式，所以可以直接使用className="title"</span></span><br><span class="line">&lt;h1 className=<span class="string">"title"</span>&gt;评论列表组件&lt;<span class="regexp">/h1&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>问题</p><blockquote><p>当我们在CmtList.css中指定了h1标签的样式的时候，我们发现  <code>import cssObj from &#39;../css/CmtList.css&#39;</code> 之后，CmtList和CmtItem中的h1标签都变成了倾斜，说明CmtList中的样式全局生效了。原因在于webpack进行打包的时候会将所有内容打包到一个js文件，所以打包后的样式会全局生效。</p></blockquote></li></ol><h2 id="4-3-使用CSS模块化"><a href="#4-3-使用CSS模块化" class="headerlink" title="4.3 使用CSS模块化"></a>4.3 使用CSS模块化</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#1. webpack.config.js  修改css的rules规则，开启css的模块化</span><br><span class="line">&#123; <span class="attr">test</span>: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: [<span class="string">'style-loader'</span>, <span class="string">'css-loader?modules'</span>] &#125;       <span class="comment">//modules表示为css启动模块化(启动模块化之后就有模块作用域)</span></span><br><span class="line"></span><br><span class="line">#2.修改CmtList.css</span><br><span class="line"><span class="comment">/* 注意： 被 :local() 包裹起来的类名会被模块化； 默认情况下所有的类和id选择器都会被模块化了； */</span></span><br><span class="line">.title&#123;</span><br><span class="line">  color: red;</span><br><span class="line">  text-align: center;</span><br><span class="line">  font-weight: <span class="number">200</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* css 模块化只针对类选择器 和 Id选择器生效， 不会对标签选择器模块化 */</span></span><br><span class="line">h1&#123;</span><br><span class="line">  font-style: italic;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">/* 注意：被 :global() 包裹起来的类名，不会被模块化，而是会全局生效； */</span> </span><br><span class="line">:global(.test)&#123;</span><br><span class="line">  font-style: italic;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#3.CmtList组件</span><br><span class="line"><span class="keyword">import</span> cssObj <span class="keyword">from</span> <span class="string">'../css/CmtList.css'</span> </span><br><span class="line"><span class="built_in">console</span>.log(cssObj)   <span class="comment">// 发现开启css模块化之后，这边打印就有内容了</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//所以在页面通过属性绑定指定样式</span></span><br><span class="line">&lt;h1 className=&#123;cssobj.title&#125;&gt;这是评论列表组件&lt;<span class="regexp">/h1&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/如果要指定多个样式，可以像下面这样使用，其实就是className = &#123;'样式1'  '样式2'&#125;</span></span><br><span class="line"><span class="regexp">&lt;h1 className=&#123;[cssobj.title, 'test'].join(' ')&#125;&gt;这是评论列表组件&lt;/</span>h1&gt;</span><br></pre></td></tr></table></figure><h2 id="4-4-CSS模块化注意事项"><a href="#4-4-CSS模块化注意事项" class="headerlink" title="4.4 CSS模块化注意事项"></a>4.4 CSS模块化注意事项</h2><ol><li><p>使用<code>localIdentName</code>自定义生成的类名格式，可选的参数有：</p><ul><li><p>[path]  表示样式表 <code>相对于项目根目录</code> 所在路径</p></li><li><p>[name]  表示 样式表文件名称</p></li><li><p>[local]  表示样式的类名定义名称</p></li><li><p>[hash:length]  表示32位的hash值</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">    loader: <span class="string">'style-loader'</span>,</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">    test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">    loader: <span class="string">'css-loader'</span>,</span><br><span class="line">    options: &#123;</span><br><span class="line">        <span class="comment">//'css-loader?modules'  表示开启css的模块化</span></span><br><span class="line">        modules: &#123;</span><br><span class="line">            <span class="comment">//path:表示原样式文件路径</span></span><br><span class="line">            <span class="comment">//name:表示原样式文件的名称</span></span><br><span class="line">            <span class="comment">//local:原样式的名称</span></span><br><span class="line">            <span class="comment">//hash:base64:5  : 使用hash的base64编码，保留5位</span></span><br><span class="line">            localIdentName: <span class="string">'[path][name]__[local]__[hash:base64:5]'</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></li></ul><p><img src="/" class="lazyload" data-src="/.com//1562727326828.png"  alt="1562727326828"></p></li><li><p>使用 <code>:local()</code> 和 <code>:global()</code></p><ul><li><code>:local()</code>包裹的类名，是被模块化的类名，只能通过<code>className={cssObj.类名}</code>来使用。<code>:local</code>可以省略</li><li><code>:global()</code>包裹的类名，是全局生效的，不会被 <code>css-modules</code> 控制，定义的类名是什么，就是使用定义的类名<code>className=&quot;类名&quot;</code></li></ul></li><li><p>注意：只有<code>.title</code>这样的类样式或者id选择器，才会被模块化控制，类似于<code>body</code>这样的标签选择器，不会被模块化控制；</p></li></ol><h2 id="4-5-Bootstrap样式的使用"><a href="#4-5-Bootstrap样式的使用" class="headerlink" title="4.5 Bootstrap样式的使用"></a>4.5 Bootstrap样式的使用</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">npm install reactstrap bootstrap@<span class="number">4.0</span><span class="number">.0</span>  </span><br><span class="line">npm i url-loader file-loader --save-dev                   <span class="comment">//url加载器</span></span><br><span class="line"></span><br><span class="line">#CmtList.js中引入bootstrap样式</span><br><span class="line"><span class="keyword">import</span> bootcss <span class="keyword">from</span> <span class="string">'bootstrap/dist/css/bootstrap.css'</span></span><br><span class="line"></span><br><span class="line">#使用bootstrap样式</span><br><span class="line"><span class="keyword">import</span> &#123; Button &#125; <span class="keyword">from</span> <span class="string">'reactstrap'</span>;</span><br><span class="line">&lt;!--下面这样用不行，因为bootstrap的css样式被模块化了--&gt;</span><br><span class="line"> &lt;Button color=<span class="string">"primary"</span>&gt;primary&lt;<span class="regexp">/Button&gt;&#123;' '&#125;</span></span><br><span class="line"><span class="regexp">&lt;!--下面这样用才行--&gt;</span></span><br><span class="line"><span class="regexp">&lt;Button className=&#123;[bootcss.btn, bootcss['btn-primary']].join(' ')&#125;&gt;按钮&lt;/</span>Button&gt;</span><br></pre></td></tr></table></figure><blockquote><p>问题：如果都像上面那样使用bootstrap的样式，太麻烦了，我们期望引入bootstrap样式的时候还是<Button classname="btn btn-primary">按钮啊</Button> 这样用，解决方案如下：</p></blockquote><ol><li><p>把自己的样式表，定义为 <code>.less</code>文件</p></li><li><p>第三方的 样式表，还是 以 <code>.css</code> 结尾</p></li><li><p>我们只需要为自己的 .less文件，启用模块化即可；</p></li><li><p>运行<code>npm i less less-loader -D</code> 安装能够解析<code>less</code>文件的loader</p></li><li><p>添加loader规则：</p><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="comment">//给less文件开启模块化</span></span><br><span class="line">&#123;</span><br><span class="line">    test: /\.less$/,</span><br><span class="line">    use: [</span><br><span class="line">        &#123;</span><br><span class="line">            loader: 'style-loader'</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            loader: 'css-loader',</span><br><span class="line">            options: &#123;</span><br><span class="line">                modules: &#123;</span><br><span class="line">                    localIdentName: '[path][name]__[local]--[hash:base64:5]'</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            loader:'less-loader'</span><br><span class="line">        &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure></li></ol><h1 id="5-webpack配置详解"><a href="#5-webpack配置详解" class="headerlink" title="5.webpack配置详解"></a>5.webpack配置详解</h1><blockquote><p>在实际开发中，一般会有两套项目方案：</p></blockquote><ul><li>一套是开发期间的项目，包含了测试文件、测试数据、开发工具、测试工具等相关配置，有利于项目的开发和测试，但是这些文件仅用于开发，发布项目时候需要剔除；</li><li>另一套是部署期间的项目，剔除了那些客户用不到的测试数据测试工具和文件，比较纯净，减少了项目发布后的体积，有利于安装和部署！</li></ul><h2 id="5-1-开发环境配置"><a href="#5-1-开发环境配置" class="headerlink" title="5.1 开发环境配置"></a>5.1 开发环境配置</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"># 1.安装</span><br><span class="line">npm init -y                                                       <span class="comment">//项目初始化</span></span><br><span class="line">npm install webpack@<span class="number">4.27</span><span class="number">.1</span> -d</span><br><span class="line">npm install webpack-cli -d       提供一些基本命令(比如webpack命令)</span><br><span class="line">npm install  webpack-dev-server -d</span><br><span class="line">npm i html-webpack-plugin@<span class="number">3.2</span><span class="number">.0</span> --save-dev</span><br><span class="line">npm install react react-dom -S</span><br><span class="line">npm i babel-core@<span class="number">6.26</span><span class="number">.3</span> babel-loader@<span class="number">7.1</span><span class="number">.5</span> babel-plugin-transform-runtime --save-dev</span><br><span class="line">npm i babel-preset-env babel-preset-stage<span class="number">-0</span> --save-dev</span><br><span class="line">npm i babel-preset-react -D</span><br><span class="line">npm install  style-loader  css-loader -D</span><br><span class="line">npm i less-loader less                                             <span class="comment">//less加载器</span></span><br><span class="line">npm i sass-loader node-sass --save-dev               <span class="comment">//sass加载器</span></span><br><span class="line">npm i url-loader file-loader --save-dev      </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#2.webpack.config.js</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">"path"</span>)</span><br><span class="line"><span class="keyword">var</span> htmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//webpack基于node构建的，所有用的是CommonJS模块化规范</span></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    mode: <span class="string">"development"</span>,</span><br><span class="line">    entry: path.join(__dirname, <span class="string">'./src/main.js'</span>),</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.join(__dirname, <span class="string">'./dist'</span>),</span><br><span class="line">        filename: <span class="string">'bundle.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    resolve: &#123;</span><br><span class="line">        <span class="comment">// 表示，这几个文件的后缀名，可以省略不写</span></span><br><span class="line">        extensions: [<span class="string">'.js'</span>, <span class="string">'.jsx'</span>, <span class="string">'.json'</span>],</span><br><span class="line">        alias: &#123;</span><br><span class="line">            <span class="string">'@'</span>: path.join(__dirname, <span class="string">'./src'</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">        <span class="comment">// 添加plugins节点配置插件</span></span><br><span class="line">        <span class="keyword">new</span> htmlWebpackPlugin(&#123;</span><br><span class="line">            template: path.resolve(__dirname, <span class="string">'src/index.html'</span>),<span class="comment">//模板路径</span></span><br><span class="line">            filename: <span class="string">'index.html'</span><span class="comment">//自动生成的HTML文件的名称</span></span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="comment">//热更新的</span></span><br><span class="line">        <span class="keyword">new</span> webpack.HotModuleReplacementPlugin(), </span><br><span class="line">    ],</span><br><span class="line">    <span class="built_in">module</span>: &#123; <span class="comment">//要打包的第三方模块</span></span><br><span class="line">        rules: [</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.css$/</span>,</span><br><span class="line">                use: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: <span class="string">'style-loader'</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: <span class="string">'css-loader'</span></span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.less$/</span>,</span><br><span class="line">                use: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: <span class="string">'style-loader'</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: <span class="string">'css-loader'</span>,</span><br><span class="line">                        options: &#123;</span><br><span class="line">                            modules: &#123;</span><br><span class="line">                                localIdentName: <span class="string">'[path][name]__[local]--[hash:base64:5]'</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: <span class="string">'less-loader'</span></span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                test: <span class="regexp">/\.scss$/</span>,</span><br><span class="line">                use: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: <span class="string">'style-loader'</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: <span class="string">'css-loader'</span>,</span><br><span class="line">                        options: &#123;</span><br><span class="line">                            modules: &#123;</span><br><span class="line">                                localIdentName: <span class="string">'[path][name]__[local]--[hash:base64:5]'</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: <span class="string">'sass-loader'</span></span><br><span class="line">                    &#125;</span><br><span class="line">                ]</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.js|jsx$/</span>, <span class="attr">use</span>: <span class="string">'babel-loader'</span>, <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.(png|jpg|gif|bmp|jpeg)$/</span>, <span class="attr">use</span>: <span class="string">'url-loader?limit=1024&amp;name=[hash:8]-[name].[ext]'</span> &#125;,</span><br><span class="line">            &#123; <span class="attr">test</span>: <span class="regexp">/\.(ttf|eot|svg|woff|woff2)$/</span>, <span class="attr">use</span>: <span class="string">'url-loader'</span> &#125;, <span class="comment">// 处理 字体文件的 loader</span></span><br><span class="line"></span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    devServer: &#123;</span><br><span class="line">        host: <span class="string">"127.0.0.1"</span>,</span><br><span class="line">        open: <span class="literal">true</span>, <span class="comment">// 自动打开浏览器</span></span><br><span class="line">        port: <span class="number">3000</span>, <span class="comment">// 设置启动时候的运行端口</span></span><br><span class="line">        contentBase: <span class="string">'src'</span>, <span class="comment">// 指定托管的根目录</span></span><br><span class="line">        hot: <span class="literal">true</span> <span class="comment">// 启用热更新 的 第1步</span></span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#3.项目入口文件  main.js</span><br><span class="line"><span class="comment">// 1. 导入包</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./css/index.css'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Hello</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">    <span class="comment">// props.name = 'zs'     不论是 Vue 还是 React，组件中的 props 永远都是只读的；不能被重新赋值;</span></span><br><span class="line">    <span class="built_in">console</span>.log(props)</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">"box"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span>这是 Hello 组件 --- &#123;props.name&#125; --- &#123;props.age&#125; --- &#123;props.gender&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> dog = &#123;</span><br><span class="line">    name: <span class="string">'大黄'</span>,</span><br><span class="line">    age: <span class="number">3</span>,</span><br><span class="line">    gender: <span class="string">'雄'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    &#123;/* 使用&#123;...obj&#125;属性扩散传递数据 */&#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;<span class="name">Hello</span> &#123;<span class="attr">...dog</span>&#125;&gt;</span><span class="tag">&lt;/<span class="name">Hello</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>, <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>))</span><br><span class="line"></span><br><span class="line">#4.index.html</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">"en"</span>&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">    &lt;title&gt;Title&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;div id=<span class="string">"app"</span>&gt;&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>body&gt;</span><br><span class="line">&lt;<span class="regexp">/html&gt;</span></span><br><span class="line"><span class="regexp">                </span></span><br><span class="line"><span class="regexp">#5.css/i</span>ndex.css</span><br><span class="line">div&#123;</span><br><span class="line">    border: <span class="number">1</span>px solid red;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.box&#123;</span><br><span class="line">    width: <span class="number">300</span>px;</span><br><span class="line">    height: <span class="number">500</span>px;</span><br><span class="line">    background: url(<span class="string">"../images/1.jpg"</span>);</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">#6.package.json</span><br><span class="line"> <span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>,</span><br><span class="line">    <span class="string">"dev"</span>: <span class="string">"webpack-dev-server --open --port 3000 --contentBase src --hot"</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">#7.项目根目录 .babelrc</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"presets"</span>: [<span class="string">"env"</span>, <span class="string">"stage-0"</span>, <span class="string">"react"</span>],</span><br><span class="line">  <span class="string">"plugins"</span>: [<span class="string">"transform-runtime"</span>]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5-2-生产环境配置文件"><a href="#5-2-生产环境配置文件" class="headerlink" title="5.2 生产环境配置文件"></a>5.2 生产环境配置文件</h2><h3 id="a-创建生产环境的配置文件"><a href="#a-创建生产环境的配置文件" class="headerlink" title="a) 创建生产环境的配置文件"></a>a) 创建生产环境的配置文件</h3><p>为了满足我们的发布策略，需要新建一个配置文件，命名为<code>webpack.publish.config.js</code>，将<code>webpack.config.js</code>的配置拷贝过去，剔除一些开发配置项即可：</p><ul><li>将<code>devServer</code>节点和热更新插件删掉：</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">devServer: &#123;</span><br><span class="line">    hot: <span class="literal">true</span>,</span><br><span class="line">    open: <span class="literal">true</span>,</span><br><span class="line">    port: <span class="number">4321</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> webpack.HotModuleReplacementPlugin()</span><br></pre></td></tr></table></figure><ol><li>修改<code>url-loader</code>，将图片放入统一的images文件夹之下(<strong>图片路径写在css文件中才会被打包，如果直接写在行内样式里面，不会被打包</strong>)：</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123; <span class="attr">test</span>: <span class="regexp">/\.(png|jpg|gif)$/</span>, <span class="attr">use</span>: <span class="string">'url-loader?limit=5000&amp;name=images/[hash:8]-[name].[ext]'</span> &#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>在<code>package.json</code>中的script节点下新增<code>dev</code>命令，通过<code>--config</code>指定webpack启动时要读取的配置文件：</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="string">"pub"</span>: <span class="string">"webpack --config webpack.publish.config.js"</span></span><br></pre></td></tr></table></figure><h3 id="b-每次重新构建时候删除dist目录"><a href="#b-每次重新构建时候删除dist目录" class="headerlink" title="b) 每次重新构建时候删除dist目录"></a>b) 每次重新构建时候删除dist目录</h3><ol><li>运行<code>npm i clean-webpack-plugin --save-dev</code></li><li>在头部引入这个插件：</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> &#123;CleanWebpackPlugin &#125; = <span class="built_in">require</span>(<span class="string">'clean-webpack-plugin'</span>);</span><br></pre></td></tr></table></figure><ol start="3"><li>在<code>plugins</code>节点下使用这个插件：</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> CleanWebpackPlugin ()</span><br></pre></td></tr></table></figure><h3 id="c-分离第三方包"><a href="#c-分离第三方包" class="headerlink" title="c) 分离第三方包"></a>c) 分离第三方包</h3><ol><li>和plugins节点平级添加下面配置：</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">optimization: &#123;</span><br><span class="line">        splitChunks: &#123;</span><br><span class="line">            cacheGroups: &#123;</span><br><span class="line">                <span class="comment">//自己写的代码打包 一个文件</span></span><br><span class="line">                commons: &#123;</span><br><span class="line">                    name: <span class="string">"commons"</span>,</span><br><span class="line">                    chunks: <span class="string">"initial"</span>,</span><br><span class="line">                    <span class="comment">//在分割之前，这个代码块最小应该被引用的次数</span></span><br><span class="line">                    minChunks: <span class="number">1</span>,</span><br><span class="line">                    <span class="comment">//形成一个新代码块最小的体积</span></span><br><span class="line">                    minSize: <span class="number">0</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="comment">//node_modules代码打包 一个文件</span></span><br><span class="line">                vendor: &#123;</span><br><span class="line">                    chunks: <span class="string">"all"</span>,</span><br><span class="line">                    test: <span class="regexp">/[\\/]node_modules[\\/]/</span>,</span><br><span class="line">                    name: <span class="string">"vendor"</span>,</span><br><span class="line">                    minChunks: <span class="number">1</span>,</span><br><span class="line">                    <span class="comment">//入口最大的并行请求数</span></span><br><span class="line">                    maxInitialRequests: <span class="number">5</span>,</span><br><span class="line">                    <span class="comment">// //形成一个新代码块最小的体积</span></span><br><span class="line">                    minSize: <span class="number">0</span>,</span><br><span class="line">                    <span class="comment">//缓存组打包的先后优先级</span></span><br><span class="line">                    priority: <span class="number">100</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br></pre></td></tr></table></figure><ol start="3"><li><p><code>html-webpack-plugin</code>在生成<code>index.html</code>文件的时候，会自动将抽离的第三方包引入进去！</p><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn1XyhLI/uUnjQtxoKSmXQ5.YSnl4gADE*lKJuwJXfgL00DHe3h6pQvp0BSLU57YVQ2RS5nnAZCbGGVo2uchRbUF9Ak2ljA!!/b&bo=QgMoAEIDKAADCSw!&rf=viewer_4"  alt="1553329256785"></p></li></ol><h3 id="d-优化压缩HTML文件"><a href="#d-优化压缩HTML文件" class="headerlink" title="d) 优化压缩HTML文件"></a>d) 优化压缩HTML文件</h3><p>在<code>plugins</code>节点下的<code>htmlWebpackPlugin</code>插件中，添加<code>minify</code>子节点：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> htmlWebpackPlugin(&#123;</span><br><span class="line">    template: path.join(__dirname, <span class="string">'./src/index.html'</span>),</span><br><span class="line">    filename: <span class="string">'index.html'</span>,</span><br><span class="line">    <span class="comment">//压缩合并html页面</span></span><br><span class="line">    minify: &#123;</span><br><span class="line">        collapseWhitespace: <span class="literal">true</span>, <span class="comment">// 合并多余的空格</span></span><br><span class="line">        removeComments: <span class="literal">true</span>, <span class="comment">// 移除注释</span></span><br><span class="line">        removeAttributeQuotes: <span class="literal">true</span> <span class="comment">// 移除 属性上的双引号</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;),</span><br></pre></td></tr></table></figure><p>其他优化项请参考：<a href="https://github.com/kangax/html-minifier#options-quick-reference" target="_blank" rel="noopener">html-minifier - github</a></p><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn1XyhLI/43eWRH6lLSncPe1pJhVzbTCGQApyh1bIUk2fsI73vShWr.HJ.IIjrTxEpTnABRoSAFcBA6FgVvWGUlQx4svXr.0zpzy8Vuy602YawXew8iw!/b&bo=VgKkAFYCpAADKQw!&rf=viewer_4"  alt="1553150762968"></p><h3 id="e-抽取bundle-js中的CSS到指定文件"><a href="#e-抽取bundle-js中的CSS到指定文件" class="headerlink" title="e) 抽取bundle.js中的CSS到指定文件"></a>e) 抽取bundle.js中的CSS到指定文件</h3><ol><li>运行<code>npm install extract-text-webpack-plugin@next</code>安装抽取CSS文件的插件。</li><li>在配置文件中导入插件：</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> ExtractTextPlugin = <span class="built_in">require</span>(<span class="string">"extract-text-webpack-plugin"</span>);</span><br></pre></td></tr></table></figure><ol start="3"><li>修改CSS和Sass的loader如下：</li></ol><figure class="highlight"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    test: /\.css$/, use: ExtractTextPlugin.extract(&#123;</span><br><span class="line">        fallback: "style-loader",</span><br><span class="line">        use: ["css-loader"],</span><br><span class="line">        publicPath: '../'         // 设置css背景图片的路径</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">    test: /\.scss$/, use: ExtractTextPlugin.extract(&#123;</span><br><span class="line">        fallback: "style-loader",</span><br><span class="line">        use: [</span><br><span class="line">            &#123;</span><br><span class="line">                loader: 'css-loader',</span><br><span class="line">                options: &#123;</span><br><span class="line">                    modules: &#123;</span><br><span class="line">                        localIdentName: '[path][name]__[local]--[hash:base64:5]'</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                loader: 'sass-loader',</span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line">        publicPath: '../'         // 设置css背景图片的路径</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;,</span><br><span class="line">&#123;</span><br><span class="line">    test: /\.less$/, use: ExtractTextPlugin.extract(&#123;</span><br><span class="line">        fallback: "style-loader",</span><br><span class="line">        use: [</span><br><span class="line">            &#123;</span><br><span class="line">                loader: 'css-loader',</span><br><span class="line">                options: &#123;</span><br><span class="line">                    modules: &#123;</span><br><span class="line">                        localIdentName: '[path][name]__[local]--[hash:base64:5]'</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                loader: 'less-loader',</span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line">        publicPath: '../'         // 设置css背景图片的路径</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><ol start="4"><li>在plugins节点下新增插件：</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> ExtractTextPlugin(<span class="string">"css/styles.css"</span>), <span class="comment">// 抽取CSS文件的插件</span></span><br></pre></td></tr></table></figure><h3 id="f-压缩抽取出来的CSS文件"><a href="#f-压缩抽取出来的CSS文件" class="headerlink" title="f) 压缩抽取出来的CSS文件"></a>f) 压缩抽取出来的CSS文件</h3><p><a href="https://github.com/NMFR/optimize-css-assets-webpack-plugin" target="_blank" rel="noopener">https://github.com/NMFR/optimize-css-assets-webpack-plugin</a></p><ol><li>运行<code>npm i optimize-css-assets-webpack-plugin --save-dev</code>安装插件到开发依赖。</li><li>在配置文件头部导入插件：</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> OptimizeCssAssetsPlugin = <span class="built_in">require</span>(<span class="string">'optimize-css-assets-webpack-plugin'</span>);</span><br></pre></td></tr></table></figure><ol start="3"><li>在plugins节点下新增插件：</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">new</span> OptimizeCssAssetsPlugin() <span class="comment">// 压缩CSS文件的插件</span></span><br></pre></td></tr></table></figure><h3 id="g-生产环境配置文件总结"><a href="#g-生产环境配置文件总结" class="headerlink" title="g) 生产环境配置文件总结"></a>g) 生产环境配置文件总结</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"># 新建webpack.pub.config.js</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">"path"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> htmlWebpackPlugin = <span class="built_in">require</span>(<span class="string">'html-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">const</span> &#123;CleanWebpackPlugin &#125; = <span class="built_in">require</span>(<span class="string">'clean-webpack-plugin'</span>);</span><br><span class="line"><span class="keyword">const</span> ExtractTextPlugin = <span class="built_in">require</span>(<span class="string">"extract-text-webpack-plugin"</span>);</span><br><span class="line"><span class="keyword">const</span> OptimizeCssAssetsPlugin = <span class="built_in">require</span>(<span class="string">'optimize-css-assets-webpack-plugin'</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="comment">//生产环境</span></span><br><span class="line">    mode:<span class="string">"production"</span>,</span><br><span class="line">    entry: path.join(__dirname, <span class="string">'./src/main.js'</span>),</span><br><span class="line">    output: &#123;</span><br><span class="line">        path: path.join(__dirname, <span class="string">'./dist'</span>),</span><br><span class="line">        filename: <span class="string">'bundle.js'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [ </span><br><span class="line">        <span class="comment">// 添加plugins节点配置插件</span></span><br><span class="line">        <span class="keyword">new</span> htmlWebpackPlugin(&#123;</span><br><span class="line">            template:path.resolve(__dirname, <span class="string">'src/index.html'</span>),<span class="comment">//模板路径</span></span><br><span class="line">            filename:<span class="string">'index.html'</span>,<span class="comment">//自动生成的HTML文件的名称</span></span><br><span class="line">            <span class="comment">//压缩合并html页面</span></span><br><span class="line">            minify: &#123;</span><br><span class="line">                collapseWhitespace: <span class="literal">true</span>, <span class="comment">// 合并多余的空格</span></span><br><span class="line">                removeComments: <span class="literal">true</span>, <span class="comment">// 移除注释</span></span><br><span class="line">                removeAttributeQuotes: <span class="literal">true</span> <span class="comment">// 移除属性上的双引号</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;),</span><br><span class="line">        <span class="comment">//每次发布项目的时候自动清除之前的dist目录</span></span><br><span class="line">        <span class="keyword">new</span> CleanWebpackPlugin (),</span><br><span class="line">        <span class="keyword">new</span> ExtractTextPlugin(<span class="string">"css/styles.css"</span>),</span><br><span class="line">        <span class="keyword">new</span> OptimizeCssAssetsPlugin() <span class="comment">// 压缩CSS文件的插件</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="built_in">module</span>: &#123; </span><br><span class="line">        rules: [</span><br><span class="line">          &#123; <span class="attr">test</span>: <span class="regexp">/\.(ttf|eot|svg|woff|woff2)$/</span>, <span class="attr">use</span>: <span class="string">'url-loader'</span> &#125;, </span><br><span class="line">          &#123; <span class="attr">test</span>: <span class="regexp">/\.js|jsx$/</span>, <span class="attr">use</span>: <span class="string">'babel-loader'</span>, <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span> &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            test: <span class="regexp">/\.css$/</span>, <span class="attr">use</span>: ExtractTextPlugin.extract(&#123;</span><br><span class="line">                fallback: <span class="string">"style-loader"</span>,</span><br><span class="line">                use: [<span class="string">"css-loader"</span>],</span><br><span class="line">                publicPath: <span class="string">'../'</span>         <span class="comment">// 设置css背景图片的路径</span></span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            test: <span class="regexp">/\.scss$/</span>, <span class="attr">use</span>: ExtractTextPlugin.extract(&#123;</span><br><span class="line">                fallback: <span class="string">"style-loader"</span>,</span><br><span class="line">                use: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: <span class="string">'css-loader'</span>,</span><br><span class="line">                        options: &#123;</span><br><span class="line">                            modules: &#123;</span><br><span class="line">                            localIdentName: <span class="string">'[path][name]__[local]--[hash:base64:5]'</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: <span class="string">'sass-loader'</span>,</span><br><span class="line">                    &#125;</span><br><span class="line">                ],</span><br><span class="line">                publicPath: <span class="string">'../'</span>         <span class="comment">// 设置css背景图片的路径</span></span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;,</span><br><span class="line">          &#123;</span><br><span class="line">            test: <span class="regexp">/\.less$/</span>, <span class="attr">use</span>: ExtractTextPlugin.extract(&#123;</span><br><span class="line">                fallback: <span class="string">"style-loader"</span>,</span><br><span class="line">                use: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: <span class="string">'css-loader'</span>,</span><br><span class="line">                        options: &#123;</span><br><span class="line">                            modules: &#123;</span><br><span class="line">                            localIdentName: <span class="string">'[path][name]__[local]--[hash:base64:5]'</span></span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;,</span><br><span class="line">                    &#123;</span><br><span class="line">                        loader: <span class="string">'less-loader'</span>,</span><br><span class="line">                    &#125;</span><br><span class="line">                ],</span><br><span class="line">                publicPath: <span class="string">'../'</span>         <span class="comment">// 设置css背景图片的路径</span></span><br><span class="line">            &#125;)</span><br><span class="line">          &#125;,</span><br><span class="line"></span><br><span class="line">          <span class="comment">//name=images/[hash:8]-[name].[ext]   发布项目的时候把图片都放到images文件夹下面去</span></span><br><span class="line">          &#123; <span class="attr">test</span>: <span class="regexp">/\.(png|jpg|gif|bmp|jpeg)$/</span>, <span class="attr">use</span>: <span class="string">'url-loader?limit=1024&amp;name=images/[hash:8]-[name].[ext]'</span> &#125;,</span><br><span class="line">        ]</span><br><span class="line">    &#125;,</span><br><span class="line">    resolve: &#123;</span><br><span class="line">        extensions: [<span class="string">'.js'</span>, <span class="string">'.jsx'</span>, <span class="string">'.json'</span>], <span class="comment">// 表示这几个文件的后缀名，可以省略不写</span></span><br><span class="line">        alias: &#123;</span><br><span class="line">            <span class="string">'@'</span>: path.join(__dirname, <span class="string">'./src'</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    optimization: &#123;</span><br><span class="line">        <span class="comment">//分割代码块</span></span><br><span class="line">        splitChunks: &#123;</span><br><span class="line">            cacheGroups: &#123;</span><br><span class="line">                <span class="comment">//创建一个commons块，包含入口点共享的所有代码</span></span><br><span class="line">                commons: &#123;</span><br><span class="line">                    name: <span class="string">"commons"</span>,</span><br><span class="line">                    chunks: <span class="string">"initial"</span>,</span><br><span class="line">                    <span class="comment">//在分割之前，这个代码块最小应该被引用的次数</span></span><br><span class="line">                    minChunks: <span class="number">1</span>,</span><br><span class="line">                    <span class="comment">//形成一个新代码块最小的体积</span></span><br><span class="line">                    minSize: <span class="number">0</span></span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="comment">//node_modules代码打包 一个文件</span></span><br><span class="line">                vendor: &#123;</span><br><span class="line">                    chunks: <span class="string">"all"</span>,</span><br><span class="line">                    test: <span class="regexp">/[\\/]node_modules[\\/]/</span>,</span><br><span class="line">                    name: <span class="string">"vendor"</span>,</span><br><span class="line">                    minChunks: <span class="number">1</span>,</span><br><span class="line">                    <span class="comment">//形成一个新代码块最小的体积</span></span><br><span class="line">                    minSize: <span class="number">0</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#package.json中新增</span><br><span class="line"> <span class="string">"scripts"</span>: &#123;</span><br><span class="line">    <span class="string">"test"</span>: <span class="string">"echo \"Error: no test specified\" &amp;&amp; exit 1"</span>,</span><br><span class="line">    <span class="string">"dev"</span>: <span class="string">"webpack-dev-server --open --port 3000 --contentBase src --hot"</span>,</span><br><span class="line">    <span class="string">"pub"</span>: <span class="string">"webpack --config webpack.publish.config.js"</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><h1 id="6-React-事件处理"><a href="#6-React-事件处理" class="headerlink" title="6. React 事件处理"></a>6. React 事件处理</h1><p><a href="https://reactjs.org/docs/events.html" target="_blank" rel="noopener">https://reactjs.org/docs/events.html</a></p><h2 id="6-1-事件绑定"><a href="#6-1-事件绑定" class="headerlink" title="6.1 事件绑定"></a>6.1 事件绑定</h2><ol><li><p>事件的名称都是React的提供的，因此名称的首字母必须大写<code>onClick</code>、<code>onMouseOver</code></p></li><li><p>为事件提供的处理函数，必须是如下格式 </p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;button onClick=&#123; <span class="function"><span class="keyword">function</span> &#125;&gt;按钮&lt;/<span class="title">button</span>&gt;</span></span><br></pre></td></tr></table></figure></li><li><p>事件绑定方式：</p><figure class="highlight jsx"><table><tr><td class="code"><pre><span class="line">#1.方式1：普通函数绑定</span><br><span class="line">&lt;button onClick=&#123; <span class="keyword">this</span>.show &#125;&gt;按钮&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ 事件的处理函数，需要定义为 一个箭头函数，然后赋值给 函数名称</span></span><br><span class="line"><span class="regexp">function show()&#123;</span></span><br><span class="line"><span class="regexp">    console.log("show方法")</span></span><br><span class="line"><span class="regexp">    console.log(this)   /</span><span class="regexp">/undefined</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">#2.方式2：箭头函数绑定(此种方式用的比较多)</span></span><br><span class="line"><span class="regexp">&lt;button onClick=&#123; () =&gt; this.show('传参') &#125;&gt;按钮&lt;/</span>button&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 事件的处理函数，需要定义为 一个箭头函数，然后赋值给函数名称</span></span><br><span class="line">show = <span class="function">(<span class="params">arg1</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'show方法'</span> + arg1)</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>)   <span class="comment">//当前组件对象</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ol><blockquote><p>注意点：</p><p>1.在react中，箭头函数中的this就代表当前的组件对象，因为箭头函数的this其实质是定义函数时所在作用域中的this。</p><p>2.在react中，普通函数中的this是undefined。</p></blockquote><h2 id="6-2-修改事件的this并传递参数"><a href="#6-2-修改事件的this并传递参数" class="headerlink" title="6.2 修改事件的this并传递参数"></a>6.2 修改事件的this并传递参数</h2><figure class="highlight"><table><tr><td class="code"><pre><span class="line">#方式1：使用bind修改普通函数中的this指向</span><br><span class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span> (props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;<span class="attr">message</span>: <span class="string">'Allo!'</span>&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    handleClick (name, e) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.state.message + name)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render () &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;button onClick=&#123; <span class="keyword">this</span>.handleClick.bind(<span class="keyword">this</span>, <span class="string">'赵四'</span>) &#125;&gt;Say Hello&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#方式2.在构造函数中通过bind修改this指向，返回新函数，然后在render中使用修改this指向后的新函数</span><br><span class="line"><span class="keyword">import</span> React, &#123;Component&#125; <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span> (props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;<span class="attr">message</span>: <span class="string">'Allo!'</span>&#125;</span><br><span class="line">        <span class="keyword">this</span>.handleClick = <span class="keyword">this</span>.handleClick.bind(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    handleClick (e) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.state.message)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render () &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;button onClick=&#123; <span class="keyword">this</span>.handleClick &#125;&gt;Say Hello&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#方式3：使用箭头函数</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span> (props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props)</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;<span class="attr">message</span>: <span class="string">'Allo!'</span>&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    handleClick = <span class="function">(<span class="params">e</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="keyword">this</span>.state.message)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render () &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;button onClick=&#123; <span class="keyword">this</span>.handleClick &#125;&gt;Say Hello&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#注意：第二种和第三种方式如果这样用，&lt;button onClick=&#123; this.handleClick() &#125;&gt;Say Hello&lt;/button&gt; ，此时会直接调用handleClick函数。如果想要点击按钮的时候才触发handleClick方法并且要给this.handleClick函数中传递参数，可以使用箭头函数&lt;button onClick=&#123; ()=&gt;&#123;this.handleClick('aa','bb')&#125; &#125;&gt;Say Hello&lt;/button&gt;。但一旦使用了箭头函数，那么箭头函数中的this就已经指向了当前的组件对象</span><br></pre></td></tr></table></figure><h2 id="6-3-绑定文本框与state中的值"><a href="#6-3-绑定文本框与state中的值" class="headerlink" title="6.3 绑定文本框与state中的值"></a>6.3 绑定文本框与state中的值</h2><ol><li><p>在Vue中提供了<code>v-model</code>指令，可以很方便的实现 <code>数据的双向绑定</code>；</p></li><li><p>但是在React中只是<code>单向数据流</code>，也就是只能把state上的数据绑定到页面，无法把页面中数据的变化自动同步回 state ； 如果需要把页面上数据的变化保存到 state，则需要程序员手动监听<code>onChange</code>事件，拿到最新的数据，手动调用<code>this.setState({  })</code> 更改回去。 这种方式叫受控组件</p></li></ol><h3 id="6-3-1-表单受控组件"><a href="#6-3-1-表单受控组件" class="headerlink" title="6.3.1 表单受控组件"></a>6.3.1 表单受控组件</h3><p>在 HTML 中，表单元素（如<code>&lt;input&gt;</code>、 <code>&lt;textarea&gt;</code> 和 <code>&lt;select&gt;</code>）之类的表单元素通常自己维护 state，并根据用户输入进行更新。而在 React 中，可变状态（mutable state）通常保存在组件的 state 属性中，并且只能通过使用 <a href="https://zh-hans.reactjs.org/docs/react-component.html#setstate" target="_blank" rel="noopener"><code>setState()</code></a>来更新。</p><p>我们可以把两者结合起来，使 React 的 state 成为“唯一数据源”。渲染表单的 React 组件还控制着用户输入过程中表单发生的操作。被 React 以这种方式控制取值的表单输入元素就叫做“受控组件”。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//如果文本框没有指定onChange事件，那么该文本框是只读的，不可以修改</span></span><br><span class="line">render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;input value=<span class="string">"this.state.value"</span> onChange=&#123;<span class="keyword">this</span>.inputChange&#125;/&gt;</span><br><span class="line">    )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">inputChange = <span class="function"><span class="params">e</span> =&gt;</span> <span class="keyword">this</span>.setState(&#123;<span class="attr">value</span>: e.target.value&#125;)</span><br></pre></td></tr></table></figure><h3 id="6-3-2-表单非受控组件"><a href="#6-3-2-表单非受控组件" class="headerlink" title="6.3.2 表单非受控组件"></a>6.3.2 表单非受控组件</h3><p>在大多数情况下，我们推荐使用 <a href="https://zh-hans.reactjs.org/docs/forms.html#controlled-components" target="_blank" rel="noopener">受控组件</a> 来处理表单数据。在一个受控组件中，表单数据是由 React 组件来管理的。另一种替代方案是使用非受控组件，这时表单数据将交由 DOM 节点来处理。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NameForm</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.handleSubmit = <span class="keyword">this</span>.handleSubmit.bind(<span class="keyword">this</span>);</span><br><span class="line">    <span class="keyword">this</span>.input = React.createRef();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  handleSubmit(event) &#123;</span><br><span class="line">    alert(<span class="string">'A name was submitted: '</span> + <span class="keyword">this</span>.input.current.value);</span><br><span class="line">    event.preventDefault();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;form onSubmit=&#123;<span class="keyword">this</span>.handleSubmit&#125;&gt;</span><br><span class="line">        &lt;label&gt;</span><br><span class="line">          Name:</span><br><span class="line">          &lt;input type=<span class="string">"text"</span> ref=&#123;<span class="keyword">this</span>.input&#125; /&gt;</span><br><span class="line">        &lt;<span class="regexp">/label&gt;</span></span><br><span class="line"><span class="regexp">        &lt;input type="submit" value="Submit" /</span>&gt;</span><br><span class="line">      &lt;<span class="regexp">/form&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><p>因为非受控组件将真实数据储存在 DOM 节点中，所以在使用非受控组件时，有时候反而更容易同时集成 React 和非 React 代码。如果你不介意代码美观性，并且希望快速编写代码，使用非受控组件往往可以减少你的代码量。否则，你应该使用受控组件。</p><h3 id="6-3-3-受控组件和非受控组件"><a href="#6-3-3-受控组件和非受控组件" class="headerlink" title="6.3.3 受控组件和非受控组件"></a>6.3.3 受控组件和非受控组件</h3><p>“受控”和“不受控制”的术语通常指的是表单输入，但他们还可以描述任何组件数据的位置。作为props传递进组件的数据可以被认为是<strong>受控的</strong>（因为父组件控制数据）。只存在于内部状态的数据可以被认为是<strong>不受控制的</strong>（因为父类不能直接更改它）。</p><h2 id="6-4-React-createRef"><a href="#6-4-React-createRef" class="headerlink" title="6.4 React.createRef"></a>6.4 React.createRef</h2><h3 id="6-4-1-为dom元素添加ref"><a href="#6-4-1-为dom元素添加ref" class="headerlink" title="6.4.1 为dom元素添加ref"></a>6.4.1 为dom元素添加ref</h3><p><code>React.createRef</code> 创建一个能够通过 ref 属性附加到 React 元素的 <a href="https://zh-hans.reactjs.org/docs/refs-and-the-dom.html" target="_blank" rel="noopener">ref</a>。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomTextInput</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="comment">// 创造一个 textInput DOM 元素的 ref</span></span><br><span class="line">    <span class="keyword">this</span>.textInput = React.createRef();</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;input</span><br><span class="line">        type=<span class="string">"text"</span></span><br><span class="line">        ref=&#123;<span class="keyword">this</span>.textInput&#125;</span><br><span class="line">      /&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">   <span class="comment">// 使用原始的 DOM API 显式地聚焦在 text input 上</span></span><br><span class="line">   <span class="comment">// 注意：我们通过访问 “current” 来获得 DOM 节点</span></span><br><span class="line">   <span class="keyword">this</span>.textInput.current.focus();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>React 会在组件挂载时给 <code>current</code> 属性传入 DOM 元素，并在组件卸载时传入 <code>null</code> 值。<code>ref</code> 会在 <code>componentDidMount</code> 或 <code>componentDidUpdate</code> 生命周期钩子触发前更新。</p><h3 id="6-4-2-为class组件添加ref"><a href="#6-4-2-为class组件添加ref" class="headerlink" title="6.4.2 为class组件添加ref"></a>6.4.2 为class组件添加ref</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AutoFocusTextInput</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.textInput = React.createRef();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="keyword">this</span>.textInput.current.focusTextInput();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;CustomTextInput ref=&#123;<span class="keyword">this</span>.textInput&#125; /&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomTextInput</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="comment">// 创建一个 ref 来存储 textInput 的 DOM 元素</span></span><br><span class="line">    <span class="keyword">this</span>.textInput = React.createRef();</span><br><span class="line">    <span class="keyword">this</span>.focusTextInput = <span class="keyword">this</span>.focusTextInput.bind(<span class="keyword">this</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  focusTextInput() &#123;</span><br><span class="line">    <span class="comment">// 直接使用原生 API 使 text 输入框获得焦点</span></span><br><span class="line">    <span class="comment">// 注意：我们通过 "current" 来访问 DOM 节点</span></span><br><span class="line">    <span class="keyword">this</span>.textInput.current.focus();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="comment">// 告诉 React 我们想把 &lt;input&gt; ref 关联到</span></span><br><span class="line">    <span class="comment">// 构造器里创建的 `textInput` 上</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;input</span><br><span class="line">          type=<span class="string">"text"</span></span><br><span class="line">          ref=&#123;<span class="keyword">this</span>.textInput&#125; /&gt;</span><br><span class="line">        &lt;input</span><br><span class="line">          type=<span class="string">"button"</span></span><br><span class="line">          value=<span class="string">"Focus the text input"</span></span><br><span class="line">          onClick=&#123;<span class="keyword">this</span>.focusTextInput&#125;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="6-4-3-函数组件与ref"><a href="#6-4-3-函数组件与ref" class="headerlink" title="6.4.3 函数组件与ref"></a>6.4.3 函数组件与ref</h3><p>默认情况下，<strong>你不能在函数组件上使用 ref 属性</strong>，因为它们没有实例：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyFunctionComponent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">input</span> /&gt;</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.textInput = React.createRef();</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="comment">// This will *not* work!</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;MyFunctionComponent ref=&#123;<span class="keyword">this</span>.textInput&#125; /&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6-4-4-ref转发"><a href="#6-4-4-ref转发" class="headerlink" title="6.4.4 ref转发"></a>6.4.4 ref转发</h3><p>如果要在函数组件中使用 <code>ref</code>，你可以使用 <a href="https://zh-hans.reactjs.org/docs/forwarding-refs.html" target="_blank" rel="noopener"><code>forwardRef</code></a>，或者可以将该组件转化为 class 组件。</p><p>Ref 转发是一个可选特性，其允许某些组件接收 ref，并将其向下传递（换句话说，“转发”它）给子组件。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> FancyButton = React.forwardRef(<span class="function">(<span class="params">props, ref</span>) =&gt;</span> (</span><br><span class="line">  &lt;button ref=&#123;ref&#125; className=<span class="string">"FancyButton"</span>&gt;</span><br><span class="line">    &#123;props.children&#125;</span><br><span class="line">  &lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">));</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ 你可以直接获取 DOM button 的 ref：</span></span><br><span class="line"><span class="regexp">const ref = React.createRef();</span></span><br><span class="line"><span class="regexp">&lt;FancyButton ref=&#123;ref&#125;&gt;Click me!&lt;/</span>FancyButton&gt;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    以下是对上述示例发生情况的逐步解释：</span></span><br><span class="line"><span class="comment">1.我们通过调用 React.createRef 创建了一个 React ref 并将其赋值给 ref 变量。</span></span><br><span class="line"><span class="comment">2.我们通过指定 ref 为 JSX 属性，将其向下传递给 &lt;FancyButton ref=&#123;ref&#125;&gt;。</span></span><br><span class="line"><span class="comment">3.React 传递 ref 给 fowardRef 内函数 (props, ref) =&gt; ...，作为其第二个参数。</span></span><br><span class="line"><span class="comment">4.我们向下转发该 ref 参数到 &lt;button ref=&#123;ref&#125;&gt;，将其指定为 JSX 属性。</span></span><br><span class="line"><span class="comment">5.当 ref 挂载完成，ref.current 将指向 &lt;button&gt; DOM 节点。</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="6-5-ref回调"><a href="#6-5-ref回调" class="headerlink" title="6.5 ref回调"></a>6.5 ref回调</h2><h3 id="6-5-1-基本使用"><a href="#6-5-1-基本使用" class="headerlink" title="6.5.1 基本使用"></a>6.5.1 基本使用</h3><p>不同于传递 <code>createRef()</code> 创建的 <code>ref</code> 属性，你会传递一个函数。这个函数中接受 React 组件实例或 HTML DOM 元素作为参数，以使它们能在其他地方被存储和访问。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CustomTextInput</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.textInput = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.setTextInputRef = <span class="function"><span class="params">element</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">this</span>.textInput = element;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>.focusTextInput = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 使用原生 DOM API 使 text 输入框获得焦点</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.textInput) <span class="keyword">this</span>.textInput.focus();</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  componentDidMount() &#123;</span><br><span class="line">    <span class="comment">// 组件挂载后，让文本框自动获得焦点</span></span><br><span class="line">    <span class="keyword">this</span>.focusTextInput();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="comment">// 使用 `ref` 的回调函数将 text 输入框 DOM 节点的引用存储到 React</span></span><br><span class="line">    <span class="comment">// 实例上（比如 this.textInput）</span></span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;input</span><br><span class="line">          type=<span class="string">"text"</span></span><br><span class="line">          ref=&#123;<span class="keyword">this</span>.setTextInputRef&#125;</span><br><span class="line">        /&gt;</span><br><span class="line">        &lt;input</span><br><span class="line">          type=<span class="string">"button"</span></span><br><span class="line">          value=<span class="string">"Focus the text input"</span></span><br><span class="line">          onClick=&#123;<span class="keyword">this</span>.focusTextInput&#125;</span><br><span class="line">        /&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><p>React 将在组件挂载时，会调用 <code>ref</code> 回调函数并传入 DOM 元素，当卸载时调用它并传入 <code>null</code>。在 <code>componentDidMount</code> 或 <code>componentDidUpdate</code> 触发前，React 会保证 refs 一定是最新的</p><h3 id="6-5-2-父子之间传递回调ref"><a href="#6-5-2-父子之间传递回调ref" class="headerlink" title="6.5.2 父子之间传递回调ref"></a>6.5.2 父子之间传递回调ref</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">CustomTextInput</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;input ref=&#123;props.inputRef&#125; /&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">class Parent extends React.Component &#123;</span></span><br><span class="line"><span class="regexp">  render() &#123;</span></span><br><span class="line"><span class="regexp">    return (</span></span><br><span class="line"><span class="regexp">      &lt;CustomTextInput</span></span><br><span class="line"><span class="regexp">        inputRef=&#123;el =&gt; this.inputElement = el&#125;</span></span><br><span class="line"><span class="regexp">      /</span>&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在上面的例子中，<code>Parent</code> 把它的 refs 回调函数当作 <code>inputRef</code> props 传递给了 <code>CustomTextInput</code>，而且 <code>CustomTextInput</code> 把相同的函数作为特殊的 <code>ref</code> 属性传递给了 <code>&lt;input&gt;</code>。结果是，在 <code>Parent</code> 中的 <code>this.inputElement</code> 会被设置为与 <code>CustomTextInput</code> 中的 <code>input</code> 元素相对应的 DOM 节点。</p><h2 id="6-6-过时-API：String-类型的-Refs"><a href="#6-6-过时-API：String-类型的-Refs" class="headerlink" title="6.6 过时 API：String 类型的 Refs"></a>6.6 过时 API：String 类型的 Refs</h2><p>如果你之前使用过 React，你可能了解过之前的 API 中的 string 类型的 ref 属性，例如 <code>&quot;textInput&quot;</code>。你可以通过 <code>this.refs.textInput</code> 来访问 DOM 节点。我们不建议使用它，因为 string 类型的 refs 存在 <a href="https://github.com/facebook/react/pull/8333#issuecomment-271648615" target="_blank" rel="noopener">一些问题</a>。它已过时并可能会在未来的版本被移除。</p><h1 id="7-React组件的通信"><a href="#7-React组件的通信" class="headerlink" title="7 React组件的通信"></a>7 React组件的通信</h1><h2 id="7-1-父子组件的通信"><a href="#7-1-父子组件的通信" class="headerlink" title="7.1 父子组件的通信"></a>7.1 父子组件的通信</h2><h3 id="a-父组件传递给子组件"><a href="#a-父组件传递给子组件" class="headerlink" title="a) 父组件传递给子组件"></a>a) 父组件传递给子组件</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//父组件</span></span><br><span class="line">&lt;CMTItem key=&#123;i&#125; &#123;...item&#125;&lt;<span class="regexp">/CMTItem&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/子组件通过this.props可以获取到父组件传递过来的数据</span></span><br></pre></td></tr></table></figure><h3 id="b-子组件传递给父组件"><a href="#b-子组件传递给父组件" class="headerlink" title="b) 子组件传递给父组件"></a>b) 子组件传递给父组件</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//父组件</span></span><br><span class="line"> &lt;CMTBox reload=&#123;<span class="keyword">this</span>.loadCmts&#125;&gt;&lt;<span class="regexp">/CMTBox&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/子组件通过this.props.reload() 来调用父组件的方法，调用的时候可以传递参数</span></span><br></pre></td></tr></table></figure><h3 id="c-评论列表发表评论"><a href="#c-评论列表发表评论" class="headerlink" title="c) 评论列表发表评论"></a>c) 评论列表发表评论</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#1.CmtList.jsx</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> CmtItem <span class="keyword">from</span> <span class="string">'./cmtItem'</span></span><br><span class="line"><span class="keyword">import</span> CmtBox <span class="keyword">from</span> <span class="string">'./cmtBox'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">CmtList</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>()</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            list: [</span><br><span class="line">                &#123; <span class="attr">user</span>: <span class="string">'zs'</span>, <span class="attr">content</span>: <span class="string">'123'</span> &#125;,</span><br><span class="line">                &#123; <span class="attr">user</span>: <span class="string">'ls'</span>, <span class="attr">content</span>: <span class="string">'qqq'</span> &#125;,</span><br><span class="line">                &#123; <span class="attr">user</span>: <span class="string">'xiaohong'</span>, <span class="attr">content</span>: <span class="string">'www'</span> &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    reload = <span class="function">(<span class="params">obj</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(<span class="function">(<span class="params">prev</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123; <span class="attr">list</span>: [...prev.list, obj] &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这是评论列表组件<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">            &#123;</span></span><br><span class="line"><span class="xml">                this.state.list.map(item =&gt; (</span></span><br><span class="line"><span class="xml">                    <span class="tag">&lt;<span class="name">CmtItem</span> <span class="attr">key</span>=<span class="string">&#123;item.user&#125;</span> &#123;<span class="attr">...item</span>&#125;&gt;</span><span class="tag">&lt;/<span class="name">CmtItem</span>&gt;</span></span></span><br><span class="line"><span class="xml">                ))</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">CmtBox</span> <span class="attr">reload</span>=<span class="string">&#123;this.reload&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">CmtBox</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#2.CmtItem.jsx</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (props) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">border:</span> '<span class="attr">1px</span> <span class="attr">solid</span> #<span class="attr">ccc</span>', <span class="attr">margin:</span> '<span class="attr">10px</span> <span class="attr">0</span>' &#125;&#125;&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span>评论人：&#123;props.user&#125;<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;<span class="name">h5</span>&gt;</span>评论内容：&#123;props.content&#125;<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#3.CmtBox.jsx</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">CmtBox</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="keyword">super</span>()</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            user:<span class="string">""</span>,</span><br><span class="line">            content:<span class="string">""</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//操作的是哪个文本框就去修改哪个文本框的数据</span></span><br><span class="line">    changeHandler = <span class="function">(<span class="params">e</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> tag = e.currentTarget.id;</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            [tag]:e.currentTarget.value</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    postComment = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.state.user &amp;&amp; <span class="keyword">this</span>.state.content)&#123;</span><br><span class="line">            <span class="keyword">this</span>.props.reload(&#123;</span><br><span class="line">                user: <span class="keyword">this</span>.state.user,</span><br><span class="line">                content: <span class="keyword">this</span>.state.content</span><br><span class="line">            &#125;)</span><br><span class="line">            <span class="keyword">this</span>.state.user = <span class="keyword">this</span>.state.content = <span class="string">""</span> </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">htmlFor</span>=<span class="string">"user"</span>&gt;</span>用户名<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"user"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">value</span>=<span class="string">&#123;this.state.user&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;this.changeHandler&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">input</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">label</span> <span class="attr">htmlFor</span>=<span class="string">"content"</span>&gt;</span>内容<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"content"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">value</span>=<span class="string">&#123;this.state.content&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;this.changeHandler&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">input</span>&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"发表评论"</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span> =&gt;</span> this.postComment()&#125; /&gt;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="7-2-使用Context实现跨组件通信"><a href="#7-2-使用Context实现跨组件通信" class="headerlink" title="7.2 使用Context实现跨组件通信"></a>7.2 使用Context实现跨组件通信</h2><p>当你不想在组件树中通过逐层传递 <code>props</code>或者<code>state</code>的方式来传递数据时，可以使用<code>Context</code>来实现<strong>跨层级</strong>的组件数据传递。</p><h3 id="a-父子组件传递数据的方式"><a href="#a-父子组件传递数据的方式" class="headerlink" title="a) 父子组件传递数据的方式"></a>a) 父子组件传递数据的方式</h3><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn1XyhLI/uUnjQtxoKSmXQ5.YSnl4gMjQsVgQLv*SL8WsrhSKMS8TfGYBtNiyMsQKS7PtlMOLUSHY7OnuH359QfPOG50HDA!!/b&bo=fwJjAX8CYwEDCSw!&rf=viewer_4"  alt="1553135155547"></p><h3 id="b-使用Context跨级传递数据"><a href="#b-使用Context跨级传递数据" class="headerlink" title="b) 使用Context跨级传递数据"></a>b) 使用Context跨级传递数据</h3><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn1XyhLI/43eWRH6lLSncPe1pJhVzba2qafoyOfmrgSPvVD4cI9P*sWLN4PNv7O6xVecQzIWmPYIb8sr90nJ3BHG48VKwoepwid3zxEmPMwUNPzBa2C4!/b&bo=fQKlAX0CpQEDGTw!&rf=viewer_4"  alt="1553135231745"></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//创建一个Context对象</span></span><br><span class="line"><span class="keyword">const</span> ThemeContext = React.createContext(<span class="string">"light"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">ContextComp</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="comment">//ThemeContext.Provider 数据的提供者，允许消费组件订阅context的变化</span></span><br><span class="line">        <span class="comment">//value就是给子组件暴露的数据</span></span><br><span class="line">        <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">ThemeContext.Provider</span> <span class="attr">value</span>=<span class="string">&#123;&#123;name:</span>"<span class="attr">zhangsan</span>"&#125;&#125;&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">ThemedButton</span>&gt;</span><span class="tag">&lt;/<span class="name">ThemedButton</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">ThemeContext.Provider</span>&gt;</span></span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThemedButton</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="comment">//这能让你使用 this.context 来消费最近 Context 上的那个值</span></span><br><span class="line">    <span class="keyword">static</span> contextType = ThemeContext;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">Content</span>&gt;</span><span class="tag">&lt;/<span class="name">Content</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span>&gt;</span>&#123;this.context.name&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ThemeContext.Consumer 允许我们在函数组件中使用Context</span></span><br><span class="line"><span class="comment">//ThemeContext.Consumer中的箭头函数的入参就是最近一个Provider所暴露的数据</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Content</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">ThemeContext.Consumer</span>&gt;</span>&#123;</span></span><br><span class="line"><span class="xml">        obj =&gt; &#123;</span></span><br><span class="line"><span class="xml">            return <span class="tag">&lt;<span class="name">div</span>&gt;</span>&#123;obj.name&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">        &#125;</span></span><br><span class="line"><span class="xml">    &#125;<span class="tag">&lt;/<span class="name">ThemeContext.Consumer</span>&gt;</span></span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="7-3-使用自定义事件实现组件通讯"><a href="#7-3-使用自定义事件实现组件通讯" class="headerlink" title="7.3 使用自定义事件实现组件通讯"></a>7.3 使用自定义事件实现组件通讯</h2><p>在没有嵌套关系的组件中，我们可以使用自定义事件的方式实现组件通信。</p><blockquote><p>1.在componentDidMount事件中，订阅事件</p><p>2.在组件卸载的时候，在componentWillUnmount事件中取消事件的订阅;</p><p>3.以常用的发布/订阅模式，借用Node.js Events模块的浏览器版实现</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">npm install events --save</span><br></pre></td></tr></table></figure><p>在src下新建一个util目录里面建一个events.js</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; EventEmitter &#125; <span class="keyword">from</span> <span class="string">'events'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> EventEmitter();</span><br></pre></td></tr></table></figure><p>list1.jsx</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> emitter <span class="keyword">from</span> <span class="string">'../util/events'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">List</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            message: <span class="string">'List1'</span>,</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    componentDidMount() &#123;</span><br><span class="line">        <span class="comment">// 组件装载完成以后声明一个自定义事件</span></span><br><span class="line">        <span class="keyword">this</span>.eventEmitter = emitter.addListener(<span class="string">'changeMessage'</span>, (message) =&gt; &#123;</span><br><span class="line">            <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">                message,</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    componentWillUnmount() &#123;</span><br><span class="line">        emitter.removeListener(<span class="keyword">this</span>.eventEmitter);</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &#123;<span class="keyword">this</span>.state.message&#125;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        );</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default List;</span></span><br></pre></td></tr></table></figure><p>List2.jsx</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> emitter <span class="keyword">from</span> <span class="string">'../util/events'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">List2</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    handleClick = <span class="function">(<span class="params">message</span>) =&gt;</span> &#123;</span><br><span class="line">        emitter.emit(<span class="string">'changeMessage'</span>, message);</span><br><span class="line">    &#125;;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;button onClick=&#123;<span class="keyword">this</span>.handleClick.bind(<span class="keyword">this</span>, <span class="string">'List2'</span>)&#125;&gt;点击我改变List1组件中显示信息&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>App.jsx</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> List1 <span class="keyword">from</span> <span class="string">'./components/List1'</span>;</span><br><span class="line"><span class="keyword">import</span> List2 <span class="keyword">from</span> <span class="string">'./components/List2'</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;List1 /&gt;</span><br><span class="line">                &lt;List2 /&gt;</span><br><span class="line">            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">        );</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><p>自定义事件是典型的发布订阅模式,通过向事件对象上添加监听器和触发事件来实现组件之间的通信</p><h1 id="8-React组件的生命周期"><a href="#8-React组件的生命周期" class="headerlink" title="8. React组件的生命周期"></a>8. React组件的生命周期</h1><h2 id="8-1-生命周期钩子函数介绍"><a href="#8-1-生命周期钩子函数介绍" class="headerlink" title="8.1 生命周期钩子函数介绍"></a>8.1 生命周期钩子函数介绍</h2><ul><li><p>生命周期的概念：每个组件的实例，从创建、运行、到销毁，在这个过程中会出发一些列事件，这些事件就叫做组件的生命周期函数；</p></li><li><p>React组件生命周期(React 16.4+)分为三部分：</p><ul><li><strong>组件创建阶段</strong>：</li></ul><blockquote><p>static 开头的     只会执行一次</p><p>constructor    构造器     只会执行一次</p><p>getDerivedStateFromProps: 每次re-rendering之前被调用，作用：将传递的props映射到state里面       会执行多次</p><p>render           构建虚拟dom，但是此时虚拟dom还没有渲染到页面        会执行多次</p><p>componentDidMount:组建的虚拟dom已经挂载到页面                      只会执行一次</p></blockquote><ul><li><strong>组件运行阶段</strong>：根据 props 属性 或 state 状态的改变，有选择性的执行0到多次</li></ul><blockquote><p>getDerivedStateFromProps:每次re-rendering之前被调用</p><p>shouldComponentUpdate:组件是否需要被更新，返回值是true或者false。此时可以获取最新的props和state数据</p><p>render: 重新更新渲染组件的虚拟dom</p><p>getSnapshotBeforeUpdate：在最近一次渲染提交到 DOM 节点之前调用。它的含义是在React更新Dom元素之前，获取一个快照，它返回的结果将作为componentDidUpdate的第三个参数。一般的用法就是获取更新前的DOM。</p><p>componentDidUpdate: 组件完成了更新，此时页面已经是最新的了</p></blockquote><ul><li><strong>组件卸载阶段</strong>：只执行一次</li></ul><blockquote><p>componentWillUnmount: 当组件从 DOM 中移除时会调用如下方法，此时组件还可以被使用</p><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn1XyhLI/uUnjQtxoKSmXQ5.YSnl4gPjui2ExyNQ6tAUPSRsMPbxlUiO.Qhv31fANkIbypRGCpphlrTGDlQlFkiip.Vl8xg!!/b&bo=EAMYAhADGAIDCSw!&rf=viewer_4"  alt="1574654437154"></p></blockquote></li></ul><p>React生命周期的回调函数总结成表格如下：<br><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn1XyhLI/43eWRH6lLSncPe1pJhVzbUoFAroECW*jspuWyR2qPkgo7VIgkVQb1iR1NfiVjMAK9C3iY9W6wtHTFXmKyg3fyQ9ZBTmU*9Ah1K*pM8VNbjE!/b&bo=nQMwAp0DMAIDGTw!&rf=viewer_4"  alt="1574666830021"></p><h2 id="8-2-defaultProps及类型校验"><a href="#8-2-defaultProps及类型校验" class="headerlink" title="8.2 defaultProps及类型校验"></a>8.2 defaultProps及类型校验</h2><h3 id="8-2-1-prop-types"><a href="#8-2-1-prop-types" class="headerlink" title="8.2.1 prop-types"></a>8.2.1 prop-types</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> PropTypes <span class="keyword">from</span> <span class="string">'prop-types'</span>;</span><br><span class="line"></span><br><span class="line">MyComponent.propTypes = &#123;</span><br><span class="line">  <span class="comment">// 你可以声明一个 prop 是一个特定的 JS 原始类型。 默认情况下，这些都是可选的。</span></span><br><span class="line">  optionalArray: PropTypes.array,</span><br><span class="line">  optionalBool: PropTypes.bool,</span><br><span class="line">  optionalFunc: PropTypes.func,</span><br><span class="line">  optionalNumber: PropTypes.number,</span><br><span class="line">  optionalObject: PropTypes.object,</span><br><span class="line">  optionalString: PropTypes.string,</span><br><span class="line">  optionalSymbol: PropTypes.symbol,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 任何东西都可以被渲染:numbers, strings, elements,数组或者是包含这些类型的片段。</span></span><br><span class="line">  optionalNode: PropTypes.node,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 一个 React 元素  例如 &lt;MyComponent /&gt;</span></span><br><span class="line">  optionalElement: PropTypes.element,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 你也可以声明一个 prop 是类的一个实例。 </span></span><br><span class="line">  <span class="comment">// 使用 JS 的 instanceof 运算符。</span></span><br><span class="line">  optionalMessage: PropTypes.instanceOf(Message),</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 你可以声明 prop 是特定的值，类似于枚举</span></span><br><span class="line">  optionalEnum: PropTypes.oneOf([<span class="string">'News'</span>, <span class="string">'Photos'</span>]),</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 一个对象可以是多种类型其中之一</span></span><br><span class="line">  optionalUnion: PropTypes.oneOfType([</span><br><span class="line">    PropTypes.string,</span><br><span class="line">    PropTypes.number,</span><br><span class="line">    PropTypes.instanceOf(Message)</span><br><span class="line">  ]),</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 一个某种类型的数组</span></span><br><span class="line">  optionalArrayOf: PropTypes.arrayOf(PropTypes.number),</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 属性值为某种类型的对象</span></span><br><span class="line">  optionalObjectOf: PropTypes.objectOf(PropTypes.number),</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 一个特定形式的对象</span></span><br><span class="line">  optionalObjectWithShape: PropTypes.shape(&#123;</span><br><span class="line">    color: PropTypes.string,</span><br><span class="line">    fontSize: PropTypes.number</span><br><span class="line">  &#125;),</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 你可以使用 `isRequired' 链接上述任何一个，以确保在没有提供 prop 的情况下显示警告。</span></span><br><span class="line">  requiredFunc: PropTypes.func.isRequired,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 任何数据类型的值</span></span><br><span class="line">  requiredAny: PropTypes.any.isRequired,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="8-2-2-defaultProps"><a href="#8-2-2-defaultProps" class="headerlink" title="8.2.2 defaultProps"></a>8.2.2 defaultProps</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="comment">//  组件创建的时候，会先执行static开头的属性和方法</span></span><br><span class="line">    <span class="comment">//  静态属性：设置props的初始值(在使用当前组件的时候，没有给当前组件传递props的时候，该初始值会生效)</span></span><br><span class="line">    <span class="keyword">static</span> defaultProps = &#123;</span><br><span class="line">        initcount: <span class="number">1000</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> propTypes = &#123;</span><br><span class="line">        <span class="comment">// 使用 prop-types 包 来定义 initcount 为 number 类型</span></span><br><span class="line">        <span class="comment">// isRequired 表示这个props属性是必须要传递的</span></span><br><span class="line">        initcount: ReactTypes.number.isRequired</span><br><span class="line">    &#125;</span><br><span class="line">    ........</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h2 id="8-3-生命周期函数详解"><a href="#8-3-生命周期函数详解" class="headerlink" title="8.3 生命周期函数详解"></a>8.3 生命周期函数详解</h2><blockquote><p>在组件创建之前，会先初始化默认的props属性，这是全局调用一次，严格地来说，这不是组件的生命周期的一部分。</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#1.Counter.jsx</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> ReactTypes <span class="keyword">from</span> <span class="string">'prop-types'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Counter</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="comment">//-------------------------------组件创建阶段----------------------------------------</span></span><br><span class="line">    <span class="comment">//1.在组件的创建阶段：第一个执行的是static开头的属性</span></span><br><span class="line">    <span class="comment">//设定props的默认值：当父组件没有给子组件传递props的时候就会使用这个默认值</span></span><br><span class="line">    <span class="keyword">static</span> defaultProps = &#123;</span><br><span class="line">        initCount: <span class="number">100</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//约定props的类型</span></span><br><span class="line">    <span class="comment">//PropTypes.number 表示是一个数值类型</span></span><br><span class="line">    <span class="comment">//isRequired 表示必须要有一个初始值</span></span><br><span class="line">    <span class="keyword">static</span> propTypes = &#123;</span><br><span class="line">        initCount: PropTypes.number.isRequired</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.在组件创建阶段，第二个执行的是构造函数 (创建一个组件对象执行一次)</span></span><br><span class="line">    <span class="comment">//构造函数的作用：主要就是用来创建组件对象</span></span><br><span class="line">    <span class="comment">//我们可以在构造函数中声明当前组件的state</span></span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>()</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"constructor方法执行了"</span>)</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            msg: <span class="string">"张三"</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//构造函数中只可以给state赋予初始值，不能够通过setState()来修改state的值</span></span><br><span class="line">        <span class="comment">// this.setState(&#123;</span></span><br><span class="line">        <span class="comment">//     msg:"李四"</span></span><br><span class="line">        <span class="comment">// &#125;)</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.在组件的创建阶段，第三个执行的是getDerivedStateFromProps</span></span><br><span class="line">    <span class="comment">//这个方法的作用：就是将props映射到state中</span></span><br><span class="line">    <span class="comment">//在每一次re-render的时候执行</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    static getDerivedStateFromProps(nextProps, prevState)&#123;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//4.在组件的创建阶段，第四个执行的是render()方法。(在一个组件的各种生命周期阶段中，至少执行一次)</span></span><br><span class="line">    <span class="comment">//render()方法的主要作用：在内存中构建虚拟dom(此时虚拟dom还没有被挂载到页面)</span></span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            &#123;</span></span><br><span class="line"><span class="xml">                // 在render()函数中不能通过setState()来修改state状态，因为这样会陷入死循环</span></span><br><span class="line"><span class="xml">                // 其实render()函数应该是一个纯函数，这个函数的作用本身就是给他什么数据，他就显示什么数据</span></span><br><span class="line"></span><br><span class="line"><span class="xml">                // this.setState(&#123;</span></span><br><span class="line"><span class="xml">                //     msg:"李四"</span></span><br><span class="line"><span class="xml">                // &#125;)</span></span><br><span class="line"><span class="xml">            &#125;</span></span><br><span class="line"><span class="xml">            &#123;console.log("render方法执行了")&#125;</span></span><br><span class="line"><span class="xml">            这是counter组件 &#123;this.state.msg&#125;</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>当前数量:&#123;this.props.initCount&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5.在组件的创建阶段，第五个执行的是componentDidMount。(创建一个组件对象执行一次)</span></span><br><span class="line">    <span class="comment">//componentDidMount执行的时候就表示内存中的虚拟dom已经挂载到页面了，此时页面是最新的</span></span><br><span class="line">    <span class="comment">//只有componentDidMount()钩子函数才可以通过setState()来修改state</span></span><br><span class="line">    componentDidMount() &#123;</span><br><span class="line">        <span class="comment">//componentDidMount()方法允许我们通过setState()来修改状态</span></span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            msg: <span class="string">"李四"</span></span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"componentDidMount方法执行了"</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//-------------------------------组价的运行阶段-------------------------------</span></span><br><span class="line">    <span class="comment">//当前组件的状态发生改变之后，会进入组件的运行阶段</span></span><br><span class="line">    <span class="comment">//1.在组件运行阶段，第一个执行的函数是getDerivedStateFromProps</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    static getDerivedStateFromProps(nextProps, prevState)&#123;</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//2.在组件的运行阶段，第二个执行的函数是shouldComponentUpdate。(在组件的各种生命周期阶段中，执行&gt;=0次)</span></span><br><span class="line">    <span class="comment">//作用：让程序员手动控制是否要更新组件</span></span><br><span class="line">    <span class="comment">//如果这个方法返回false，就不会更新组件(后续的生命周期函数就不会执行了)；如果这个方法返回true，就会更新组件(后续的生命周期会执行)</span></span><br><span class="line">    shouldComponentUpdate(nextProps, nextState) &#123;</span><br><span class="line">        <span class="comment">// shouldComponentUpdate() 方法中也不能通过setState()来更改state，此时仍然会进入死循环</span></span><br><span class="line">        <span class="comment">// this.setState(&#123;</span></span><br><span class="line">        <span class="comment">//     msg:"王五"</span></span><br><span class="line">        <span class="comment">// &#125;)</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"shouldComponentUpdate"</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//3.在组件的运行阶段，第三个执行的函数是render()函数</span></span><br><span class="line">    <span class="comment">//render()函数的作用：在内存中构建虚拟dom(此时虚拟dom还没有被挂载到页面)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//4.在组件的运行阶段，第四个执行的函数是getSnapshotBeforeUpdate。(在组件的各种生命周期阶段中，执行&gt;=0次)</span></span><br><span class="line">    <span class="comment">//主要作用：获取更新页面之前的dom信息</span></span><br><span class="line">    <span class="comment">//这个方法的返回值会作为componentDidUpdate()方法第三个参数入参</span></span><br><span class="line">    <span class="comment">//https://react.docschina.org/docs/react-component.html</span></span><br><span class="line">    getSnapshotBeforeUpdate() &#123;</span><br><span class="line">        <span class="comment">// getSnapshotBeforeUpdate() 方法中也不能通过setState()来更改state，此时仍然会进入死循环</span></span><br><span class="line">        <span class="comment">// this.setState(&#123;</span></span><br><span class="line">        <span class="comment">//     msg:"王五"</span></span><br><span class="line">        <span class="comment">// &#125;)</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"getSnapshotBeforeUpdate"</span>)</span><br><span class="line">        <span class="keyword">return</span> &#123; <span class="attr">aa</span>: <span class="number">123</span> &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//5.在组件的运行阶段，第五个执行的函数是componentDidUpdate。(在组件的各种生命周期阶段中，执行&gt;=0次)</span></span><br><span class="line">    <span class="comment">//主要作用：虚拟dom已经挂载到页面，此时页面是最新的</span></span><br><span class="line">    componentDidUpdate(prevProps, prevState, snapshot) &#123;</span><br><span class="line">        <span class="comment">// componentDidUpdate() 方法中也不能通过setState()来更改state，此时仍然会进入死循环</span></span><br><span class="line">        <span class="comment">// this.setState(&#123;</span></span><br><span class="line">        <span class="comment">//     msg: "王五"</span></span><br><span class="line">        <span class="comment">// &#125;)</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"componentDidUpdate"</span>, snapshot)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//----------------------------组件的卸载阶段-----------------------------</span></span><br><span class="line">    <span class="comment">//可以在componentWillUnmount()方法中进行一些资源的释放工作。比如关闭定时器、移除事件监听。(卸载一个组件执行一次)</span></span><br><span class="line">    componentWillUnmount() &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"componentWillUnmount"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#App.jsx</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> Counter <span class="keyword">from</span> <span class="string">'@/components/counter'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>()&#123;</span><br><span class="line">        <span class="keyword">super</span>()</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            count:<span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    handleClick = <span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(<span class="function"><span class="params">prev</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                count:++prev.count</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            这是App组件</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">Counter</span> <span class="attr">initCount</span>=<span class="string">&#123;this.state.count&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">Counter</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">Counter</span>&gt;</span><span class="tag">&lt;/<span class="name">Counter</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick&#125;</span>&gt;</span>改变count<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="8-4-组件的重新渲染和优化"><a href="#8-4-组件的重新渲染和优化" class="headerlink" title="8.4 组件的重新渲染和优化"></a>8.4 组件的重新渲染和优化</h2><p>组件的重新渲染的执行时机：</p><blockquote><p>1.组件重新被创建</p><p>2.当前组件的state发生变化</p><p>3.父组件的state发生变化</p></blockquote><p>也就是说父组件和当前组件的state发生任何变化，都会引起组件的re-render，进而触发一系列的生命周期钩子(getDerivedStateFromProps\shouldComponentUpdate\render\getSnapshotBeforeUpdate\componentDidMount\componentDidUpdate)。</p><p>当我们在父组件修改了与子组件无关的state，发现子组件也会re-render，这个时候就需要借助shouldComponentUpdate钩子函数来做优化。</p><h3 id="8-4-1-shouldComponentUpdate优化"><a href="#8-4-1-shouldComponentUpdate优化" class="headerlink" title="8.4.1 shouldComponentUpdate优化"></a>8.4.1 shouldComponentUpdate优化</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//作用：让程序员手动控制是否要更新组件</span></span><br><span class="line"><span class="comment">//如果这个方法返回false，就不会更新组件(后续的生命周期函数就不会执行了)；如果这个方法返回true，就会更新组件(后续的生命周期会执行)</span></span><br><span class="line">shouldComponentUpdate(nextProps, nextState) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"shouldComponentUpdate"</span>,nextProps,<span class="keyword">this</span>.props)</span><br><span class="line">    <span class="comment">//如果下次传递过来的initCount和当前组件props中所保持的initCount一致的时候，此时就没有必要做组件re-render</span></span><br><span class="line">    <span class="keyword">if</span>(nextProps.initCount == <span class="keyword">this</span>.props.initCount)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="8-4-2-PureComponent优化"><a href="#8-4-2-PureComponent优化" class="headerlink" title="8.4.2 PureComponent优化"></a>8.4.2 PureComponent优化</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//方式二：使用PureComponent类 </span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ListOfWords</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">PureComponent</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            &#123;console.log("render")&#125;</span></span><br><span class="line"><span class="xml">            &#123;this.props.words.join(',')&#125;</span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> ListOfWords</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//App.js</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> ListOfWords <span class="keyword">from</span> <span class="string">'@/components/listOfWords'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>()</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            words: [<span class="string">'marklar'</span>]</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    handleClick = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> words = <span class="keyword">this</span>.state.words;</span><br><span class="line">        words.push(<span class="string">"marklar"</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//因为PureComponent对于引用类型而言，比较的是内存地址是否一致</span></span><br><span class="line">        <span class="comment">//所以我们修改state的时候，需要给words赋值一个新的数组，此时新数组和原来数组的内存地址肯定不一致，从而组件才可能更新</span></span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            words:[...words] </span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            这是App2组件</span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">ListOfWords</span> <span class="attr">words</span>=<span class="string">&#123;this.state.words&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">ListOfWords</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleClick&#125;</span>&gt;</span>添加words<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">1.继承PureComponent时，不能再重写shouldComponentUpdate</span></span><br><span class="line"><span class="comment">2.继承PureComponent时，进行的是浅比较，也就是说，如果是引用类型的数据，只会比较是不是同一个地址，而不会比较具体这个地址存的数据是否完全一致</span></span><br><span class="line"><span class="comment">3.上面代码中，无论你怎么点击按钮，ListOfWords渲染的结果始终没变化，原因就是WordAdder的word的引用地址始终是同一个。</span></span><br><span class="line"><span class="comment">4.我们可以这样修改state，此时页面会发生变化，因为给words赋值了一个新对象</span></span><br><span class="line"><span class="comment">   this.setState(&#123;words:[...words]&#125;);</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><h2 id="8-5-getDerivedStateFromProps存在的问题"><a href="#8-5-getDerivedStateFromProps存在的问题" class="headerlink" title="8.5 getDerivedStateFromProps存在的问题"></a>8.5 getDerivedStateFromProps存在的问题</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//getDerivedStateFromProps 函数会在每次re-rendering之前被调用</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//为什么要用getDerivedStateFromProps？答案：组件接收的props数据是只读的，我们可以使用该方法将传递的props映射到state里面，实现修改(会有诸多问题)</span></span><br><span class="line"><span class="comment">//注意点：该方法是一个静态方法，方法中没有this，故而不可以直接通过this.setState()来改变状态，而是需要通过return来改变状态</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//参数：</span></span><br><span class="line"><span class="comment">//1.nextProps外部传递过来的props属性</span></span><br><span class="line"><span class="comment">//2.prevState之前的state状态</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">static</span> getDerivedStateFromProps(nextProps, prevState) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"getDerivedStateFromProps"</span>, nextProps, prevState)</span><br><span class="line">    <span class="comment">//获取到父组件中传递过来的initcount值</span></span><br><span class="line">    <span class="keyword">const</span> &#123; initcount &#125; = nextProps;</span><br><span class="line">    <span class="comment">//当父组件中传递过来的initcount发生改变了</span></span><br><span class="line">    <span class="keyword">if</span> (initcount != prevState.prevCount) &#123;</span><br><span class="line">        <span class="comment">//在方法中返回&#123;count:initcount&#125; 替换掉当前state中的 count值</span></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            count: initcount,</span><br><span class="line">            prevCount:initcount</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//如果props传入的内容不需要影响到你的state，那么就需要返回一个null</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">null</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//问题：</span></span><br><span class="line"><span class="number">1.</span>当前组件的状态由多个源控制，父组件中控制列表数据，子组件中又控制了type这个state。</span><br><span class="line">因此父组件state改掉之后，会触发子组件重新渲染；本身组件state改掉之后，会触发当前组件重新渲染</span><br><span class="line"></span><br><span class="line"><span class="number">2.</span>如果你的组件内部既需要修改自己的type，又需要接收从外部修改的type。逻辑非常混乱！getDerivedStateFromProps中你根本不知道该做什么。</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (initcount != prevState.prevCount) &#123;</span><br><span class="line">    <span class="comment">//在方法中返回&#123;count:initcount&#125; 替换掉当前state中的 count值</span></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        count: initcount,</span><br><span class="line">        prevCount:initcount</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">如果彻底解决这个问题呢？</span><br><span class="line">答案：好好组织你的组件，在非必须的时候，摒弃这种写法(派生属性)。type要么由props驱动，要么完全由state驱动。</span><br><span class="line"></span><br><span class="line">从这个生命周期的更新来看，react更希望将受控的props和state进行分离，就如同Redux作者Dan Abramov在redux文档当中写的一样Presentational and Container Components，将所有的组件分离称为展示型组件和容器型组件，一个只负责接收props来改变自己的样式，一个负责保持其整个模块的state。这样可以让代码更加清晰。但是在实际的业务逻辑中，我们有时很难做到这一点，而且这样可能会导致容器型组件变得非常庞大以致难以管理，如何进行取舍还是需要根据实际场景决定的</span><br></pre></td></tr></table></figure><h2 id="8-6-React老版本生命周期"><a href="#8-6-React老版本生命周期" class="headerlink" title="8.6 React老版本生命周期"></a>8.6 React老版本生命周期</h2><p><img src="/" class="lazyload" data-src="/.com//3284159097-5bbb08d17db33_articlex-1584956954768.png"  alt="3284159097-5bbb08d17db33_articlex"></p><h1 id="9-React-router"><a href="#9-React-router" class="headerlink" title="9. React-router"></a>9. React-router</h1><h2 id="9-1-前端路由的两种实现方案"><a href="#9-1-前端路由的两种实现方案" class="headerlink" title="9.1 前端路由的两种实现方案"></a>9.1 前端路由的两种实现方案</h2><ol><li><p>hash : hash原本的作用是为一个很长的文档页添加锚点信息，它自带不改变url刷新页面的功能，所以自然而然被用单页面应用程序中了。</p></li><li><p>history : 应该说history是主流的解决方案，浏览器的前进后退用的就是这个，它是window对象下的，以前的history提供的方法只能做页面之间的前进后退，如下：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">history.go(number|URL) 可加载历史列表中的某个具体的页面</span><br><span class="line">history.forward() 可加载历史列表中的下一个 URL</span><br><span class="line">history.back() 可加载历史列表中的前一个 URL</span><br></pre></td></tr></table></figure><p>为了在不刷新浏览器的情况下，创建新的浏览记录并插入浏览记录队列中，html5新增了如下方法：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1. history.pushState(state, title, url)</span><br><span class="line">   添加一条历史记录， state用于传递参数，可以为空。title是设置历史记录的标题，可以为空。url是历史记录的URL，不可以为空。</span><br><span class="line"></span><br><span class="line">2.history.replaceState(state, title, url)</span><br><span class="line">将history堆栈中当前的记录替换成这里的url，参数同上。</span><br><span class="line"></span><br><span class="line">这个特性后来用到了单页面应用中比如：vue-router，react-router-dom里面。</span><br></pre></td></tr></table></figure></li></ol><h2 id="9-2-Reac中的路由"><a href="#9-2-Reac中的路由" class="headerlink" title="9.2 Reac中的路由"></a>9.2 Reac中的路由</h2><p><code>&lt;Router&gt;</code>是React中实现路由最外层的容器，一般情况下我们不再需要直接使用它，而是使用在它基础之上封装的几个适用于不同环境的组件，react-router-dom的Router有四种：</p><table><thead><tr><th>Router</th><th>适用情况</th></tr></thead><tbody><tr><td><a href="https://link.jianshu.com?t=https%3A%2F%2Freacttraining.com%2Freact-router%2Fweb%2Fapi%2FBrowserRouter" target="_blank" rel="noopener">BrowserRouter</a></td><td>react-router-dom扩展，利用HTML5 新增的history API (pushState, replaceState)，是web应用最常用的路由组件</td></tr><tr><td><a href="https://link.jianshu.com?t=https%3A%2F%2Freacttraining.com%2Freact-router%2Fweb%2Fapi%2FHashRouter" target="_blank" rel="noopener">HashRouter</a></td><td>react-router-dom扩展，利用window.location.hash，适用于低版本浏览器或者一些特殊情境</td></tr><tr><td><a href="https://link.jianshu.com?t=https%3A%2F%2Freacttraining.com%2Freact-router%2Fweb%2Fapi%2FMemoryRouter" target="_blank" rel="noopener">MemoryRouter</a></td><td>继承自react-router ，用户在地址栏看不到任何路径变化，一般用在测试或者非浏览器环境开发中</td></tr><tr><td><a href="https://link.jianshu.com?t=https%3A%2F%2Freacttraining.com%2Freact-router%2Fweb%2Fapi%2FStaticRouter" target="_blank" rel="noopener">StaticRouter</a></td><td>继承自react-router，某些页面从渲染出来以后没有多的交互，所以没有状态的变化需要存储，就可以使用静态路由，静态路由适用于服务器端</td></tr></tbody></table><p>一般我们很少会用到MemoryRouter和StaticRouter，在web应用中更多的是用   <code>react-router-dom</code>扩展出来的BrowserRouter和HashRouter，这两个就是我前面提到的前端路由的两种解决办法的各自实现。</p><h2 id="9-3-HashRouter的基本使用"><a href="#9-3-HashRouter的基本使用" class="headerlink" title="9.3 HashRouter的基本使用"></a>9.3 HashRouter的基本使用</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">npm install react-router-dom -S</span><br><span class="line"></span><br><span class="line">#1.main.js </span><br><span class="line"><span class="comment">// 1. 导入包</span></span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> ReactDOM <span class="keyword">from</span> <span class="string">'react-dom'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> App <span class="keyword">from</span> <span class="string">'./App.jsx'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 render 函数渲染 虚拟DOM</span></span><br><span class="line">ReactDOM.render(<span class="xml"><span class="tag">&lt;<span class="name">App</span>&gt;</span><span class="tag">&lt;/<span class="name">App</span>&gt;</span></span>, <span class="built_in">document</span>.getElementById(<span class="string">'app'</span>))</span><br><span class="line">                </span><br><span class="line"></span><br><span class="line">#2.App.jsx</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// HashRouter 表示一个路由的跟容器，所有的路由相关的东西，都要包裹在 HashRouter 里面</span></span><br><span class="line"><span class="comment">// Route 表示一个路由规则， 在 Route 上有两个比较重要的属性：path   component</span></span><br><span class="line"><span class="comment">// Link 表示一个路由的链接 ，就好比 vue 中的 &lt;router-link to=""&gt;&lt;/router-link&gt;</span></span><br><span class="line"><span class="keyword">import</span> &#123; HashRouter, Route, Link &#125; <span class="keyword">from</span> <span class="string">'react-router-dom'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> Home <span class="keyword">from</span> <span class="string">'./components/Home.jsx'</span></span><br><span class="line"><span class="keyword">import</span> Movie <span class="keyword">from</span> <span class="string">'./components/Movie.jsx'</span></span><br><span class="line"><span class="keyword">import</span> About <span class="keyword">from</span> <span class="string">'./components/About.jsx'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props)</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="comment">// 当 使用 HashRouter 把 App 根组件的元素包裹起来之后，网站就已经启用路由了</span></span><br><span class="line">    <span class="comment">// 在一个 HashRouter 中，只能有唯一的一个根元素</span></span><br><span class="line">    <span class="comment">// 在一个网站中，只需要使用 唯一的一次 &lt;HashRouter&gt;&lt;/HashRouter&gt; 就行了</span></span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">HashRouter</span>&gt;</span></span></span><br><span class="line">      &lt;div&gt;</span><br><span class="line">        &lt;h1&gt;这是网站的APP根组件&lt;/h1&gt;</span><br><span class="line">      </span><br><span class="line">        &lt;Link to="/home"&gt;首页&lt;/Link&gt;&amp;nbsp;&amp;nbsp;</span><br><span class="line">        &lt;Link to="/movie/top250/10"&gt;电影&lt;/Link&gt;&amp;nbsp;&amp;nbsp;</span><br><span class="line">        &lt;Link to="/about"&gt;关于&lt;/Link&gt;</span><br><span class="line"></span><br><span class="line">        &lt;hr /&gt;</span><br><span class="line"></span><br><span class="line">        &#123;/* Route 创建的标签，就是路由规则，其中 path 表示要匹配的路由，component 表示要展示的组件 */&#125;</span><br><span class="line">        &#123;/* 在 vue 中有个 router-view 的路由标签专门用来放置匹配到的路由组件的，但是在 react-router 中并没有类似于这样的标签，而是直接把 Route 标签当作的坑（占位符） */&#125;</span><br><span class="line">        &#123;/* Route 具有两种身份：1. 它是一个路由匹配规则； 2. 它是一个占位符，表示将来匹配到的组件都放到这个位置， 如果想让路由规则进行精确匹配，可以为 Route添加 exact 属性，表示启用精确匹配模式 */&#125;</span><br><span class="line">        &lt;Route path="/home" component=&#123;Home&#125;&gt;&lt;/Route&gt;</span><br><span class="line"></span><br><span class="line">        &lt;hr /&gt;</span><br><span class="line"></span><br><span class="line">        &#123;/* 注意：默认情况下，路由中的规则是模糊匹配的，如果路由可以部分匹配成功，就会展示这个路由对应的组件 */&#125;</span><br><span class="line">        &#123;/* 如果要匹配参数，可以在匹配规则中使用 : 修饰符，表示这个位置匹配到的是参数 */&#125;</span><br><span class="line">        &lt;Route path="/movie/:type/:id" component=&#123;Movie&#125; exact&gt;&lt;/Route&gt;</span><br><span class="line"></span><br><span class="line">        &lt;hr /&gt;</span><br><span class="line"></span><br><span class="line">        &lt;Route path="/about" component=&#123;About&#125;&gt;&lt;/Route&gt;</span><br><span class="line"><span class="xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">HashRouter</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#3.components/Home.jsx    </span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Home</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props)</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      Home</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#4. components/Movie.jsx </span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Movie</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>);</span><br><span class="line">    <span class="comment">// 如果想要从路由规则中，提取匹配到的参数进行使用，可以使用 this.props.match.params.*** 来访问</span></span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      Movie --- &#123;this.props.match.params.type&#125; --- &#123;this.props.match.params.id&#125;</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#5. components/About.jsx</span><br><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">About</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">    <span class="keyword">super</span>(props)</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;&#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">      About</span></span><br><span class="line"><span class="xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="9-4-匹配规则"><a href="#9-4-匹配规则" class="headerlink" title="9.4 匹配规则"></a>9.4 匹配规则</h2><p><strong>默认：</strong></p><table><thead><tr><th>路径</th><th>location.pathname</th><th>是否匹配</th></tr></thead><tbody><tr><td>/one</td><td>/one</td><td>是</td></tr><tr><td>/one</td><td>/one/</td><td>是</td></tr><tr><td>/one</td><td>/one/111</td><td>是</td></tr><tr><td>/one</td><td>/one/aaa/bbb</td><td>是</td></tr></tbody></table><p><strong>exact配置：</strong>exact属性为true时路径中的hash值必须和path完全一致才渲染对应的组件，如果为false则’/‘也可以匹配’/xxx’</p><table><thead><tr><th>路径</th><th>location.pathname</th><th>exact</th><th>是否匹配</th></tr></thead><tbody><tr><td>/one</td><td>/one/two</td><td>true</td><td>否</td></tr><tr><td>/one</td><td>/one/two</td><td>false</td><td>是</td></tr></tbody></table><p><strong>strict配置：</strong>strict属性主要就是匹配反斜杠，规定是否匹配末尾包含反斜杠的路径，如果strict为true，则如果path中不包含反斜杠结尾，则他也不能匹配包含反斜杠结尾的路径</p><table><thead><tr><th>路径</th><th>location.pathname</th><th>strict</th><th>是否匹配</th></tr></thead><tbody><tr><td>/one/</td><td>/one</td><td>true</td><td>否</td></tr><tr><td>/one/</td><td>/one/</td><td>true</td><td>是</td></tr><tr><td>/one/</td><td>/one/two</td><td>true</td><td>是</td></tr></tbody></table><h2 id="9-5-Switch和Redirect"><a href="#9-5-Switch和Redirect" class="headerlink" title="9.5 Switch和Redirect"></a>9.5 Switch和Redirect</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; HashRouter, Route, Link, Switch,Redirect&#125; <span class="keyword">from</span> <span class="string">'react-router-dom'</span></span><br><span class="line"></span><br><span class="line">render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;HashRouter&gt;</span><br><span class="line">                &#123;<span class="comment">/*</span></span><br><span class="line"><span class="comment">                Switch表示路由互斥，如果没有Switch，会根据路由找到所有匹配的组件显示</span></span><br><span class="line"><span class="comment">                比如http://localhost:3000/#/user  会找到/、/user所匹配的路由(下面home没有找到是因为精确匹配了)</span></span><br><span class="line"><span class="comment">                */</span>&#125;</span><br><span class="line">                &lt;Switch&gt;</span><br><span class="line">                    &#123;<span class="comment">/*</span></span><br><span class="line"><span class="comment">                    path:/ 表示访问根路径的情况下默认载入home组件</span></span><br><span class="line"><span class="comment">                    exact精确匹配，为了给其他组件一个机会获取到url改变</span></span><br><span class="line"><span class="comment">                    */</span>&#125;</span><br><span class="line">                    &lt;Route path=<span class="string">'/'</span> exact  component=&#123;Home&#125;/&gt;</span><br><span class="line">                    &lt;Route path=<span class="string">'/city'</span> component=&#123;City&#125;/&gt;</span><br><span class="line">                    &#123;<span class="comment">/*</span></span><br><span class="line"><span class="comment">                    strict 在确定路径是否与当前URL匹配时，将考虑路径后的斜线；</span></span><br><span class="line"><span class="comment">                    */</span>&#125;</span><br><span class="line">                    &lt;Route path=<span class="string">'/login/'</span> strict component=&#123;Login&#125;/&gt;</span><br><span class="line">                    &lt;Route path=<span class="string">'/user'</span> component=&#123;User&#125;/&gt;</span><br><span class="line">                    &lt;Route path=<span class="string">'/search/:category/'</span> strict component=&#123;Search&#125;/&gt;</span><br><span class="line">                    &lt;Route path=<span class="string">'/detail/:id'</span> component=&#123;Detail&#125;/&gt;</span><br><span class="line">                    &#123;<span class="comment">/*没有匹配到路径的时候重定向到根路径*/</span>&#125;</span><br><span class="line">                    &lt;Redirect to=<span class="string">"/"</span> /&gt;</span><br><span class="line">                &lt;<span class="regexp">/Switch&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>HashRouter&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h2 id="9-6-React中的编程式导航和路由传参"><a href="#9-6-React中的编程式导航和路由传参" class="headerlink" title="9.6 React中的编程式导航和路由传参"></a>9.6 React中的编程式导航和路由传参</h2><h3 id="9-6-1-withRouter的使用"><a href="#9-6-1-withRouter的使用" class="headerlink" title="9.6.1 withRouter的使用"></a>9.6.1 withRouter的使用</h3><p>withRouter可以包装任何自定义组件，将react-router 的 history,location,match 三个对象传入。 </p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;Route exact path=<span class="string">"/Home"</span> component=&#123;Home&#125;/&gt;</span><br></pre></td></tr></table></figure><blockquote><p> 1.只有包裹在Route组件里的才能使用<code>this.props.location</code>，<br> 2.假如有个需求，是面包屑或者导航组件里需要拿到<code>this.props.location</code>（导航组件或者面包屑一般不会包裹在<code>Route</code>里），那么直接这么写显然就不行了。<br> 这个时候<code>withRouter</code>修饰一下，就可以这么写了。</p></blockquote><h3 id="9-6-2-使用withRouter跳转页面"><a href="#9-6-2-使用withRouter跳转页面" class="headerlink" title="9.6.2 使用withRouter跳转页面"></a>9.6.2 使用withRouter跳转页面</h3><blockquote><p>只有在 <Route> 包裹的组件中才能在 this.props 属性中找到 history 对象。但有些情况下我们就是希望在一个没被 <Route> 包裹的组件中用到 history 对象，我们可以这样用</Route></Route></p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; withRouter &#125; <span class="keyword">from</span> <span class="string">'react-router-dom'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> withRouter(YourComponent)</span><br><span class="line"></span><br><span class="line"><span class="comment">//此时就可以在组件中使用this.props.history跳转路由了</span></span><br><span class="line"><span class="keyword">this</span>.props.history.push(&#123;<span class="attr">pathname</span>:<span class="string">"/path/"</span>&#125;);</span><br></pre></td></tr></table></figure><h3 id="9-6-3-路由传参"><a href="#9-6-3-路由传参" class="headerlink" title="9.6.3 路由传参"></a>9.6.3 路由传参</h3><h4 id="a-params方式传参"><a href="#a-params方式传参" class="headerlink" title="a) params方式传参"></a>a) params方式传参</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;Route path=<span class="string">'/path/:name'</span> component=&#123;Path&#125;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;Link to=<span class="string">"/path/2"</span>&gt;xxx&lt;<span class="regexp">/Link&gt;</span></span><br><span class="line"><span class="regexp">this.props.history.push(&#123;pathname:"/</span>path/<span class="string">" + name&#125;);</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">读取参数用:this.props.match.params.name</span></span><br></pre></td></tr></table></figure><p>优势 ： 刷新地址栏，参数依然存在<br>缺点  :   只能传字符串，并且如果传的值太多的话，url会变得长而丑陋。</p><h4 id="b-query方式传参"><a href="#b-query方式传参" class="headerlink" title="b) query方式传参"></a>b) query方式传参</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;Route path=<span class="string">'/query'</span> component=&#123;Query&#125;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;Link to=&#123;&#123; <span class="attr">pathname</span> : <span class="string">' /query'</span> , <span class="attr">query</span> : &#123; <span class="attr">name</span> : <span class="string">'sunny'</span> &#125;&#125;&#125;&gt;</span><br><span class="line"><span class="keyword">this</span>.props.history.push(&#123;<span class="attr">pathname</span>:<span class="string">"/query"</span>,<span class="attr">query</span>: &#123; <span class="attr">name</span> : <span class="string">'sunny'</span> &#125;&#125;);</span><br><span class="line"></span><br><span class="line">读取参数用: <span class="keyword">this</span>.props.location.query.name</span><br></pre></td></tr></table></figure><p>优势：传参优雅，传递参数可传对象；<br>缺点：刷新地址栏，参数丢失</p><h4 id="c-state方式传参"><a href="#c-state方式传参" class="headerlink" title="c) state方式传参"></a>c) state方式传参</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;Route path=<span class="string">'/sort '</span> component=&#123;Sort&#125;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;Link to=&#123;&#123; <span class="attr">pathname</span> : <span class="string">' /sort '</span> , <span class="attr">state</span> : &#123; <span class="attr">name</span> : <span class="string">'sunny'</span> &#125;&#125;&#125;&gt; </span><br><span class="line"><span class="keyword">this</span>.props.history.push(&#123;<span class="attr">pathname</span>:<span class="string">"/sort "</span>,<span class="attr">state</span> : &#123; <span class="attr">name</span> : <span class="string">'sunny'</span> &#125;&#125;);</span><br><span class="line"></span><br><span class="line">读取参数用: <span class="keyword">this</span>.props.location.state.name</span><br></pre></td></tr></table></figure><p>优势：传参优雅，传递参数可传对象，state传的参数是加密的<br>缺点：刷新地址栏，参数丢失</p><h4 id="d-search方式传参"><a href="#d-search方式传参" class="headerlink" title="d) search方式传参"></a>d) search方式传参</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;Route path=<span class="string">'/web/departManange '</span> component=&#123;DepartManange&#125;/&gt;</span><br><span class="line"></span><br><span class="line">&lt;link to=<span class="string">"web/departManange?tenantId=12121212"</span>&gt;xxx&lt;<span class="regexp">/Link&gt;</span></span><br><span class="line"><span class="regexp">this.props.history.push(&#123;pathname:"/</span>web/departManange<span class="string">",search: 'tenantId=12121212'&#125;)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">读取参数用: this.props.location.search</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">//search参数的解析</span></span><br><span class="line"><span class="string">npm install --save url</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">httpUrl = this.props.location.search;</span></span><br><span class="line"><span class="string">url.parse(httpUrl, true).query.tenantId;</span></span><br></pre></td></tr></table></figure><p>优势 ： 刷新地址栏，参数依然存在</p><p>缺点  :   只能传字符串，并且如果传的值太多的话，url会变得长而丑陋。</p><h2 id="9-7-组件懒加载"><a href="#9-7-组件懒加载" class="headerlink" title="9.7 组件懒加载"></a>9.7 组件懒加载</h2><p><code>React.lazy</code> 函数能让你像渲染常规组件一样处理动态引入（的组件）。</p><p><code>React.lazy</code> 接受一个函数，这个函数需要动态调用 <code>import()</code>。它必须返回一个 <code>Promise</code>，该 Promise 需要 resolve 一个 <code>defalut</code> export 的 React 组件。</p><p>然后应在 <code>Suspense</code> 组件中渲染 lazy 组件(Suspense 就是实现所谓的延迟加载效果)，如此使得我们可以使用在等待加载 lazy 组件时做优雅降级（如 loading 指示器等）。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React, &#123; Suspense &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> OtherComponent = React.lazy(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">'./OtherComponent'</span>));</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">MyComponent</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;Suspense fallback=&#123;&lt;div&gt;Loading...&lt;<span class="regexp">/div&gt;&#125;&gt;</span></span><br><span class="line"><span class="regexp">        &lt;OtherComponent /</span>&gt;</span><br><span class="line">      &lt;<span class="regexp">/Suspense&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="9-8-基于路由的代码分割"><a href="#9-8-基于路由的代码分割" class="headerlink" title="9.8 基于路由的代码分割"></a>9.8 基于路由的代码分割</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; BrowserRouter <span class="keyword">as</span> Router, Route, Switch &#125; <span class="keyword">from</span> <span class="string">'react-router-dom'</span>;</span><br><span class="line"><span class="keyword">import</span> React, &#123; Suspense, lazy &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> Home = lazy(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">'./routes/Home'</span>));</span><br><span class="line"><span class="keyword">const</span> About = lazy(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">import</span>(<span class="string">'./routes/About'</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> App = <span class="function"><span class="params">()</span> =&gt;</span> (</span><br><span class="line">  &lt;Router&gt;</span><br><span class="line">    <span class="comment">//fallback 属性接受任何在组件加载过程中你想展示的 React 元素</span></span><br><span class="line">    &lt;Suspense fallback=&#123;&lt;div&gt;Loading...&lt;<span class="regexp">/div&gt;&#125;&gt;</span></span><br><span class="line"><span class="regexp">      &lt;Switch&gt;</span></span><br><span class="line"><span class="regexp">        &lt;Route exact path="/</span><span class="string">" component=&#123;Home&#125;/&gt;</span></span><br><span class="line"><span class="string">        &lt;Route path="</span>/about<span class="string">" component=&#123;About&#125;/&gt;</span></span><br><span class="line"><span class="string">      &lt;/Switch&gt;</span></span><br><span class="line"><span class="string">    &lt;/Suspense&gt;</span></span><br><span class="line"><span class="string">  &lt;/Router&gt;</span></span><br><span class="line"><span class="string">);</span></span><br></pre></td></tr></table></figure><h1 id="10-ReactTransitionGroup动画"><a href="#10-ReactTransitionGroup动画" class="headerlink" title="10.ReactTransitionGroup动画"></a>10.ReactTransitionGroup动画</h1><p><a href="https://reactcommunity.org/react-transition-group/" target="_blank" rel="noopener">https://reactcommunity.org/react-transition-group/</a></p><p>react-transition-group 一个官网提供的动画过度库。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># npm</span><br><span class="line">npm install react-transition-group --save</span><br><span class="line"></span><br><span class="line"># yarn</span><br><span class="line">yarn add react-transition-group</span><br></pre></td></tr></table></figure><p>而官方提供的四个组建<code>Transition</code>，<code>CSSTransition</code>，<code>SwitchTransiton</code>，<code>TransitonGroup</code>。</p><h2 id="10-1-Transition"><a href="#10-1-Transition" class="headerlink" title="10.1 Transition"></a>10.1 Transition</h2><p>过渡组件(Transiton)允许您用一个简单的声明性API描述随着时间的推移从一个组件状态到另一个组件状态的转换。最常用的是用来动画一个组件的安装和卸载，但也可以用来描述在适当的过渡状态。默认情况下，该组件不会更改其呈现的组件的行为，它只跟踪组件的“进入”和“退出”的状态。由你来为这些状态定义效果。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; Transition &#125; <span class="keyword">from</span> <span class="string">'react-transition-group'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Fade</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">        <span class="keyword">super</span>(props);</span><br><span class="line">    &#125;</span><br><span class="line">    done = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'结束了'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    addEndListener = <span class="function">(<span class="params">node</span>) =&gt;</span> &#123; <span class="comment">//原生时间transition运动的事件</span></span><br><span class="line">        node.addEventListener(<span class="string">'transitionend'</span>, <span class="keyword">this</span>.done, <span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 三个进入状态的事件，可以做你想做的事情</span></span><br><span class="line">    onEnter = <span class="function">(<span class="params">node, isAppearing</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(isAppearing, <span class="string">'onEnter'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    onEntering = <span class="function">(<span class="params">node, isAppearing</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(isAppearing, <span class="string">'onEntering'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    onEntered = <span class="function">(<span class="params">node, isAppearing</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(isAppearing, <span class="string">'onEntered'</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 三个退出的状态的事件</span></span><br><span class="line">    onExit = <span class="function">(<span class="params">node</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'onExit'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    onExiting = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'onExiting'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    onExited = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'onExited'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> &#123; <span class="attr">in</span>: inProp &#125; = <span class="keyword">this</span>.props;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> defaultStyle = &#123;</span><br><span class="line">            transition: <span class="string">`transform <span class="subst">$&#123;<span class="number">300</span>&#125;</span>ms ease-in-out, opacity <span class="subst">$&#123;<span class="number">300</span>&#125;</span>ms ease-in-out`</span>,</span><br><span class="line">            transform: <span class="string">'translateX(100px)'</span>,</span><br><span class="line">            opacity: <span class="string">'0'</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> transitionStyles = &#123;</span><br><span class="line">            entering: &#123; <span class="attr">transform</span>: <span class="string">'translateX(100px)'</span>, <span class="attr">opacity</span>: <span class="string">'0'</span> &#125;,</span><br><span class="line">            entered: &#123; <span class="attr">transform</span>: <span class="string">'translateX(0px)'</span>, <span class="attr">opacity</span>: <span class="string">'1'</span> &#125;,</span><br><span class="line">            exiting: &#123; <span class="attr">transform</span>: <span class="string">'translateX(0px)'</span>, <span class="attr">opacity</span>: <span class="string">'1'</span> &#125;,</span><br><span class="line">            exited: &#123; <span class="attr">transform</span>: <span class="string">'translateX(100px)'</span>, <span class="attr">opacity</span>: <span class="string">'0'</span> &#125;</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> duration = &#123;</span><br><span class="line">            enter: <span class="number">300</span>,</span><br><span class="line">            exit: <span class="number">300</span>,</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 上面的都是基本参数，样式的转变以及时间的设定，具体的可以看官网文档</span></span><br><span class="line">        <span class="comment">// 样式也可以写成className 例如&lt;MyComponent className=&#123;`fade fade-$&#123;status&#125;`&#125; /&gt;</span></span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;Transition</span><br><span class="line">                onEnter=&#123;<span class="keyword">this</span>.onEnter&#125;</span><br><span class="line">                onEntering=&#123;<span class="keyword">this</span>.onEntering&#125;</span><br><span class="line">                onEntered=&#123;<span class="keyword">this</span>.onEntered&#125;</span><br><span class="line"></span><br><span class="line">                onExit=&#123;<span class="keyword">this</span>.onExit&#125;</span><br><span class="line">                onExiting=&#123;<span class="keyword">this</span>.onExiting&#125;</span><br><span class="line">                onExited=&#123;<span class="keyword">this</span>.onExited&#125;</span><br><span class="line"></span><br><span class="line">                addEndListener=&#123;<span class="keyword">this</span>.addEndListener&#125;</span><br><span class="line">                <span class="keyword">in</span>=&#123;inProp&#125;</span><br><span class="line">                unmountOnExit=&#123;<span class="literal">false</span>&#125; <span class="comment">// 为true 代表退出的时候移除dom</span></span><br><span class="line">                appear=&#123;<span class="literal">true</span>&#125;     <span class="comment">// 为true 初始动画</span></span><br><span class="line">                timeout=&#123;duration&#125;</span><br><span class="line">            &gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    state =&gt; &#123;</span><br><span class="line">                        <span class="built_in">console</span>.log(state, <span class="string">'###'</span>) <span class="comment">//你可以很直观的看到组件加载和卸载时候的状态</span></span><br><span class="line">                        <span class="keyword">return</span> (</span><br><span class="line">                            &lt;div style=&#123;&#123;</span><br><span class="line">                                ...defaultStyle,</span><br><span class="line">                                ...transitionStyles[state]</span><br><span class="line">                            &#125;&#125;&gt;</span><br><span class="line">                                &#123;<span class="keyword">this</span>.props.children&#125;</span><br><span class="line">                            &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">                        )</span></span><br><span class="line"><span class="regexp">                    &#125;</span></span><br><span class="line"><span class="regexp">                &#125;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>Transition&gt;</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> Fade <span class="keyword">from</span> <span class="string">'./Fade.js'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Dnd</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    state = &#123;</span><br><span class="line">        flag:<span class="literal">true</span></span><br><span class="line">    &#125;</span><br><span class="line">    handle = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(<span class="function"><span class="params">prev</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                flag: !prev.flag</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (</span><br><span class="line">            &lt;div&gt;</span><br><span class="line">                &lt;button onClick=&#123;() =&gt; <span class="keyword">this</span>.handle()&#125;&gt;点击transition&lt;<span class="regexp">/button&gt;</span></span><br><span class="line"><span class="regexp">                &lt;Fade in=&#123;this.state.flag&#125;&gt;</span></span><br><span class="line"><span class="regexp">                    &lt;div&gt;动画&lt;/</span>div&gt;</span><br><span class="line">                &lt;<span class="regexp">/Fade&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>div&gt;</span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="10-2-CSSTransition"><a href="#10-2-CSSTransition" class="headerlink" title="10.2 CSSTransition"></a>10.2 CSSTransition</h2><p>此组件是在转换的出现、进入、退出阶段应用一对类名(也就是className)，靠这个来激活CSS动画。所以参数和平时的className不同，参数为：<code>classNames</code><br>参数：（主要）in, timeout, unmountOnExit, classNames, 用法同Transition。看如下例子：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./star.css'</span></span><br><span class="line"><span class="keyword">import</span> &#123; CSSTransition &#125; <span class="keyword">from</span> <span class="string">'react-transition-group'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">Star</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    state = &#123;</span><br><span class="line">        star: <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    handleStar = <span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(<span class="function"><span class="params">prev</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                star:!prev.star</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;()</span>=&gt;</span>&#123;this.handleStar()&#125;&#125;&gt;start<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">            &lt;CSSTransition</span><br><span class="line">                in=&#123;this.state.star&#125;</span><br><span class="line">                timeout=&#123;300&#125;</span><br><span class="line">                classNames="star"</span><br><span class="line">                unmountOnExit  //为true 代表退出的时候移除dom</span><br><span class="line">            &gt;</span><br><span class="line">                &#123;/*指定默认样式*/&#125;   </span><br><span class="line">                &lt;div className="star"&gt;星星&lt;/div&gt;</span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">CSSTransition</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">.star &#123;</span><br><span class="line">    display: inline-block;</span><br><span class="line">    margin-left: <span class="number">0.5</span>rem;</span><br><span class="line">    transform: scale(<span class="number">1.25</span>);</span><br><span class="line">&#125;</span><br><span class="line">.star-enter &#123;</span><br><span class="line">    opacity: <span class="number">0.01</span>;</span><br><span class="line">    transform: translateY(<span class="number">-100</span>%) scale(<span class="number">0.75</span>);</span><br><span class="line">&#125;</span><br><span class="line">.star-enter-active &#123;</span><br><span class="line">    opacity: <span class="number">1</span>;</span><br><span class="line">    transform: translateY(<span class="number">0</span>%) scale(<span class="number">1.25</span>);</span><br><span class="line">    transition: all <span class="number">300</span>ms ease-out;</span><br><span class="line">&#125;</span><br><span class="line">.star-exit &#123;</span><br><span class="line">    opacity: <span class="number">1</span>;</span><br><span class="line">    transform: scale(<span class="number">1.25</span>);</span><br><span class="line">&#125;</span><br><span class="line">.star-exit-active &#123;</span><br><span class="line">    opacity: <span class="number">0</span>;</span><br><span class="line">    transform: scale(<span class="number">4</span>);</span><br><span class="line">    transition: all <span class="number">300</span>ms ease-<span class="keyword">in</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="10-3-SwitchTransition"><a href="#10-3-SwitchTransition" class="headerlink" title="10.3 SwitchTransition"></a>10.3 SwitchTransition</h2><p>受vue过渡模式启发的过渡组件， 当您要控制状态转换之间的渲染时，可以使用它。SwitchTransition不提供任何形式的动画，具体的动画取决与你包裹的Transition || CSSTransition的动画。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; SwitchTransition, CSSTransition &#125; <span class="keyword">from</span> <span class="string">'react-transition-group'</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">'./switch.css'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">SwitchAnim</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>()</span><br><span class="line"></span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            flag: <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    toggle = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(<span class="function">(<span class="params">prev</span>) =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                flag: !prev.flag</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.toggle&#125;</span>&gt;</span>点我切换组件<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">            &lt;SwitchTransition&gt;</span><br><span class="line">                &lt;CSSTransition</span><br><span class="line">                    key=&#123;this.state.flag ? "A" : "B"&#125;</span><br><span class="line">                    classNames="fade"</span><br><span class="line">                    timeout=&#123;300&#125;&gt;</span><br><span class="line">                    &#123;this.state.flag ? &lt;div&gt;AAAA&lt;/div&gt; : &lt;div&gt;BBBB&lt;/div&gt;&#125;</span><br><span class="line">                &lt;/CSSTransition&gt;</span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">SwitchTransition</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">        )</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">.fade-enter &#123;</span><br><span class="line">    opacity: <span class="number">0.01</span>;  </span><br><span class="line">&#125;</span><br><span class="line">.fade-enter-active &#123;</span><br><span class="line">    opacity: <span class="number">1</span>;</span><br><span class="line">    transition: opacity <span class="number">500</span>ms ease-<span class="keyword">in</span>;</span><br><span class="line">&#125;</span><br><span class="line">.fade-exit &#123;</span><br><span class="line">    opacity: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">.fade-exit-active &#123;</span><br><span class="line">    opacity: <span class="number">0.01</span>;</span><br><span class="line">    transition: opacity <span class="number">500</span>ms ease-<span class="keyword">in</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="10-4-TransitionGroup"><a href="#10-4-TransitionGroup" class="headerlink" title="10.4 TransitionGroup"></a>10.4 TransitionGroup</h2><p>一看group就知道肯定是列表形态的动画了！但是看了官网后知道，TransitionGroup不提供任何形式的动画，具体的动画取决与你包裹的Transition || CSSTransition的动画，所以你可以在列表里面做出不同类型的动画出来。</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span></span><br><span class="line"><span class="keyword">import</span> &#123; TransitionGroup, CSSTransition &#125; <span class="keyword">from</span> <span class="string">'react-transition-group'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./switch.css'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="class"><span class="keyword">class</span> <span class="title">ListAnim</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>()</span><br><span class="line">        <span class="keyword">this</span>.state = &#123;</span><br><span class="line">            items: [</span><br><span class="line">                &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">text</span>: <span class="string">'Buy eggs'</span> &#125;,  <span class="comment">//0</span></span><br><span class="line">                &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">text</span>: <span class="string">'Pay bills'</span> &#125;,  <span class="comment">//1</span></span><br><span class="line">                &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">text</span>: <span class="string">'Invite friends over'</span> &#125;, <span class="comment">//2</span></span><br><span class="line">                &#123; <span class="attr">id</span>: <span class="number">4</span>, <span class="attr">text</span>: <span class="string">'Fix the TV'</span> &#125;,  <span class="comment">//3</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    handleAdd = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> items = <span class="keyword">this</span>.state.items;</span><br><span class="line">        items.unshift(&#123; <span class="attr">id</span>: items.length + <span class="number">1</span>, <span class="attr">text</span>: <span class="string">"张三"</span> &#125;);</span><br><span class="line">        <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">            items: [...items]</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    handleRemove = <span class="function">(<span class="params">id</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">this</span>.setState(<span class="function"><span class="params">prev</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                items: prev.items.filter(<span class="function"><span class="params">item</span> =&gt;</span> item.id != id)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    render() &#123;</span><br><span class="line">        <span class="keyword">const</span> items = <span class="keyword">this</span>.state.items;</span><br><span class="line">        <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line">            &lt;TransitionGroup&gt;</span><br><span class="line">                &#123;</span><br><span class="line">                    items.map(item =&gt; (</span><br><span class="line">                        &lt;CSSTransition</span><br><span class="line">                            key=&#123;item.id&#125;  //这边的key一定要能唯一标识当前元素</span><br><span class="line">                            timeout=&#123;300&#125;</span><br><span class="line">                            classNames="fade"</span><br><span class="line">                        &gt;</span><br><span class="line">                            &lt;div style=&#123;&#123; background: "red" &#125;&#125;&gt;</span><br><span class="line">                                &#123;item.text&#125;</span><br><span class="line">                                &lt;button onClick=&#123;() =&gt; this.handleRemove(item.id)&#125;&gt;&amp;times;&lt;/button&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                        &lt;/CSSTransition&gt;</span><br><span class="line">                    ))</span><br><span class="line">                &#125;</span><br><span class="line"><span class="xml">            <span class="tag">&lt;/<span class="name">TransitionGroup</span>&gt;</span></span></span><br><span class="line"><span class="xml">            <span class="tag">&lt;<span class="name">button</span> <span class="attr">onClick</span>=<span class="string">&#123;this.handleAdd&#125;</span>&gt;</span>添加元素<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">.fade-enter &#123;</span><br><span class="line">    opacity: <span class="number">0.01</span>;  </span><br><span class="line">&#125;</span><br><span class="line">.fade-enter-active &#123;</span><br><span class="line">    opacity: <span class="number">1</span>;</span><br><span class="line">    transition: opacity <span class="number">500</span>ms ease-<span class="keyword">in</span>;</span><br><span class="line">&#125;</span><br><span class="line">.fade-exit &#123;</span><br><span class="line">    opacity: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line">.fade-exit-active &#123;</span><br><span class="line">    opacity: <span class="number">0.01</span>;</span><br><span class="line">    transition: opacity <span class="number">500</span>ms ease-<span class="keyword">in</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="11-高阶组件"><a href="#11-高阶组件" class="headerlink" title="11.高阶组件"></a>11.高阶组件</h1><h2 id="11-1-高阶函数"><a href="#11-1-高阶函数" class="headerlink" title="11.1 高阶函数"></a>11.1 高阶函数</h2><p><strong>高阶函数是一个函数，它接收函数作为参数或将函数作为输出返回</strong></p><ul><li><p>举个栗子:</p><ul><li><p>接收函数作为参数</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">function a(x) &#123;</span><br><span class="line">  x();</span><br><span class="line">&#125;</span><br><span class="line">function b() &#123;</span><br><span class="line">  alert(&#39;hello&#39;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">a(b);</span><br></pre></td></tr></table></figure></li><li><p>将函数作为输出返回</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">function a() &#123;</span><br><span class="line">  function b() &#123;</span><br><span class="line">    alert(&#39;hello&#39;);</span><br><span class="line">  &#125;</span><br><span class="line">  return b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">a()();</span><br></pre></td></tr></table></figure></li></ul></li><li><p>以上函数a就是一个高阶函数, 用法非常简单, 那么实际开发中又有哪些是高阶函数呢？</p><ul><li>Array 的 map 、reduce 、filter 等方法</li><li>Object 的 keys 、values 等方法</li></ul></li></ul><h2 id="11-2-高阶组件"><a href="#11-2-高阶组件" class="headerlink" title="11.2 高阶组件"></a>11.2 高阶组件</h2><ul><li><p>概念：<strong>高阶组件就是一个函数，且该函数接受一个组件作为参数，并返回一个新的组件</strong></p></li><li><p>举个栗子：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">'./logo.svg'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./App.css'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</span><br><span class="line">   render()&#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello React<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>)</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br><span class="line">            </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HocComponent</span>(<span class="params">WrappedComponent</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">WrappedComponent</span>/&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> NewComponent = HocComponent(MyComponent)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;NewComponent&gt;&lt;<span class="regexp">/NewComponent&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br></pre></td></tr></table></figure></li><li><p>HocComponent函数就是一个高阶组件。</p></li></ul><blockquote><p>高阶组件可以看做是装饰器模式(Decorator Pattern)在React的实现。即允许向一个现有的对象添加新的功能，同时又不改变其结构，属于包装模式(Wrapper Pattern)的一种。最大的特点就是重用组件逻辑</p></blockquote><h3 id="11-2-1-高阶组件的实现方式-属性代理"><a href="#11-2-1-高阶组件的实现方式-属性代理" class="headerlink" title="11.2.1 高阶组件的实现方式-属性代理"></a>11.2.1 高阶组件的实现方式-属性代理</h3><p>属性代理(Props Proxy)：<code>HOC</code>是包裹在普通组件外面的一层高阶函数，任何要传入普通组件内的<code>props</code> 或者 <code>state</code> 首先都要经过 <code>HOC</code>。</p><p><code>props</code>和 <code>state</code>等属性原本是要流向 目标组件的腰包的，但是却被 雁过拔毛的<code>HOC</code>拦路打劫，那么最终这些 <code>props</code>和 <code>states</code>数据到底还能不能再到达 目标组件，或者哪些能到达以及到达多少就全由 <code>HOC</code>说了算了，也就是说，<code>HOC</code>拥有了提前对这些属性进行修改的能力。</p><p>属性代理的作用：</p><ul><li>更改prop</li><li>通过refs获取组件实例</li><li>抽象state</li><li>把WrappedComponent与其他elements包装在一起</li></ul><h4 id="a-属性代理-更改props"><a href="#a-属性代理-更改props" class="headerlink" title="a) 属性代理-更改props"></a>a) 属性代理-更改props</h4><p>在高阶组件中添加新的 props，可以在 WrappedComponent 中通过 this.props.name访问到。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">'./logo.svg'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./App.css'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</span><br><span class="line">  render()&#123;</span><br><span class="line">  <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello React &#123;this.props.name&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HocComponent</span>(<span class="params">WrappedComponent</span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span></span>&#123;</span><br><span class="line">    render()&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">WrappedComponent</span> &#123;<span class="attr">...this.props</span>&#125;/&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> NewComponent = HocComponent(MyComponent)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;NewComponent name=<span class="string">"zhangsan"</span>&gt;&lt;<span class="regexp">/NewComponent&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br></pre></td></tr></table></figure><h4 id="b-属性代理-通过refs获取组件实例"><a href="#b-属性代理-通过refs获取组件实例" class="headerlink" title="b) 属性代理-通过refs获取组件实例"></a>b) 属性代理-通过refs获取组件实例</h4><p>当我们包装WrappedComponent的时候，想获取到它的实例怎么办，可以通过引用(ref),在WrappedComponent组件挂载的时候，会执行ref的回调函数，在hoc中取到组件的实例。通过打印可以看到它的props、 state、方法都是可以取到的。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">'./logo.svg'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./App.css'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  say()&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"say say say ....."</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Hello React &#123;this.props.name&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HocComponent</span>(<span class="params">WrappedComponent</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="comment">//此处的instance会拿到被包装的组件实例，然后访问被包装的组件对象的属性和方法</span></span><br><span class="line">    proc(instance) &#123;</span><br><span class="line">      instance.say();</span><br><span class="line">      <span class="built_in">console</span>.log(instance.props.name)</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">WrappedComponent</span> &#123;<span class="attr">...this.props</span>&#125; <span class="attr">ref</span>=<span class="string">&#123;this.proc&#125;</span> /&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> NewComponent = HocComponent(MyComponent)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;NewComponent name=<span class="string">"zhangsan"</span>&gt;&lt;<span class="regexp">/NewComponent&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br></pre></td></tr></table></figure><h4 id="c-属性代理-抽取state"><a href="#c-属性代理-抽取state" class="headerlink" title="c) 属性代理-抽取state"></a>c) 属性代理-抽取state</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">'./logo.svg'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./App.css'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyInput</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;</span><br><span class="line">      value:<span class="string">""</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.handleChange = <span class="keyword">this</span>.handleChange.bind(<span class="keyword">this</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  handleChange(event)&#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      value:event.target.value</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">value</span>=<span class="string">&#123;this.state.value&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;this.handleChange&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">input</span>&gt;</span></span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyTextArea</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  <span class="keyword">constructor</span>(props)&#123;</span><br><span class="line">    <span class="keyword">super</span>(props);</span><br><span class="line">    <span class="keyword">this</span>.state = &#123;</span><br><span class="line">      value:<span class="string">""</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">this</span>.handleChange = <span class="keyword">this</span>.handleChange.bind(<span class="keyword">this</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  handleChange(event)&#123;</span><br><span class="line">    <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">      value:event.target.value</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">value</span>=<span class="string">&#123;this.state.value&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;this.handleChange&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HocComponent</span>(<span class="params">WrappedComponent</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">WrappedComponent</span>/&gt;</span></span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> NewInput = HocComponent(MyInput)</span><br><span class="line"><span class="keyword">const</span> NewTextArea = HocComponent(MyTextArea)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;NewInput&gt;&lt;<span class="regexp">/NewInput&gt;</span></span><br><span class="line"><span class="regexp">      &lt;NewTextArea&gt;&lt;/</span>NewTextArea&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/这边代码存在的问题：MyInput和MyTextArea组件都有自己的state和change方法，代码重用性太大</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">'./logo.svg'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./App.css'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyInput</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">input</span> <span class="attr">value</span>=<span class="string">&#123;this.props.value&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;this.props.onChange&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">input</span>&gt;</span></span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyTextArea</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">value</span>=<span class="string">&#123;this.props.value&#125;</span> <span class="attr">onChange</span>=<span class="string">&#123;this.props.onChange&#125;</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HocComponent</span>(<span class="params">WrappedComponent</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    <span class="comment">//将所有被包含组件的state和change都抽取到高阶组件中</span></span><br><span class="line">    <span class="keyword">constructor</span>(props) &#123;</span><br><span class="line">      <span class="keyword">super</span>(props);</span><br><span class="line">      <span class="keyword">this</span>.state = &#123;</span><br><span class="line">        value: <span class="string">""</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">this</span>.handleChange = <span class="keyword">this</span>.handleChange.bind(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    handleChange(event) &#123;</span><br><span class="line">      <span class="keyword">this</span>.setState(&#123;</span><br><span class="line">        value: event.target.value</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    render() &#123;</span><br><span class="line">      <span class="keyword">const</span> newProps = &#123;</span><br><span class="line">        value: <span class="keyword">this</span>.state.value,</span><br><span class="line">        onChange: <span class="keyword">this</span>.handleChange</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        <span class="comment">//向被包含组件传递属性</span></span><br><span class="line">        &lt;WrappedComponent &#123;...this.props&#125; &#123;...newProps&#125; /&gt;</span><br><span class="line">      )</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> NewInput = HocComponent(MyInput)</span><br><span class="line"><span class="keyword">const</span> NewTextArea = HocComponent(MyTextArea)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;NewInput&gt;&lt;<span class="regexp">/NewInput&gt;</span></span><br><span class="line"><span class="regexp">      &lt;NewTextArea&gt;&lt;/</span>NewTextArea&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br></pre></td></tr></table></figure><h4 id="d-属性代理-用其他元素包装组件"><a href="#d-属性代理-用其他元素包装组件" class="headerlink" title="d) 属性代理-用其他元素包装组件"></a>d) 属性代理-用其他元素包装组件</h4><p>为了封装样式、布局或别的目的，可以用其它组件和元素包裹 WrappedComponent。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">'./logo.svg'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./App.css'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">p</span>&gt;</span>被包裹组件<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">HocComponent</span>(<span class="params">WrappedComponent</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        &lt;div style=&#123;&#123;<span class="attr">color</span>:<span class="string">"red"</span>&#125;&#125;&gt;</span><br><span class="line">          &lt;WrappedComponent &#123;...this.props&#125; /&gt;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">      )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">const NewComponent = HocComponent(MyComponent)</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">function App() &#123;</span></span><br><span class="line"><span class="regexp">  return (</span></span><br><span class="line"><span class="regexp">    &lt;div&gt;</span></span><br><span class="line"><span class="regexp">      &lt;NewComponent&gt;&lt;/</span>NewComponent&gt;</span><br><span class="line">    &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">export default App;</span></span><br></pre></td></tr></table></figure><h3 id="11-2-2-高阶组件的实现方式-反向继承"><a href="#11-2-2-高阶组件的实现方式-反向继承" class="headerlink" title="11.2.2 高阶组件的实现方式-反向继承"></a>11.2.2 高阶组件的实现方式-反向继承</h3><p>反向继承( Inheritance Inversion )：返回的 HOC 类（Enhancer）继承了 WrappedComponent。之所以被称为 Inheritance Inversion 是因为 WrappedComponent 被 Enhancer 继承了，而不是 WrappedComponent 继承了 Enhancer。在这种方式中，它们的关系看上去被反转（inverse）了。</p><p>通过继承WrappedComponent，除了一些静态方法，包括生命周期，state，各种function，我们都可以得到。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">iiHOC</span>(<span class="params">WrappedComponent</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="class"><span class="keyword">class</span> <span class="title">Enhancer</span> <span class="keyword">extends</span> <span class="title">WrappedComponent</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">super</span>.render()</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>反向继承的作用：</p><ul><li>渲染劫持</li><li>操作state</li></ul><h4 id="a-反向继承-渲染劫持"><a href="#a-反向继承-渲染劫持" class="headerlink" title="a) 反向继承-渲染劫持"></a>a) 反向继承-渲染劫持</h4><p>之所以被称为渲染劫持是因为 HOC 控制着 WrappedComponent 的渲染输出，可以用它做各种各样的事。通过渲染劫持可以：</p><ul><li>在由 render输出的任何 React 元素中读取、添加、编辑、删除 props</li><li>读取和修改由 render 输出的 React 元素树</li><li>有条件地渲染元素树</li><li>把样式包裹进元素树（就像在 Props Proxy 中的那样）</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> logo <span class="keyword">from</span> <span class="string">'./logo.svg'</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">'./App.css'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyComponent</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (<span class="xml"><span class="tag">&lt;<span class="name">p</span> <span class="attr">name</span>=<span class="string">"pp"</span>&gt;</span>被包裹组件<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">iiHOC</span>(<span class="params">WrappedComponent</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="class"><span class="keyword">class</span> <span class="title">Enhancer</span> <span class="keyword">extends</span> <span class="title">WrappedComponent</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">      <span class="keyword">const</span> elementsTree = <span class="keyword">super</span>.render();</span><br><span class="line">      <span class="comment">//打印父组件的属性值</span></span><br><span class="line">      <span class="built_in">console</span>.log(elementsTree.props)</span><br><span class="line">      <span class="comment">//添加新的 属性返回</span></span><br><span class="line">      <span class="keyword">let</span> newProps = &#123;<span class="attr">style</span>:&#123;<span class="attr">color</span>:<span class="string">'red'</span>&#125;&#125;;</span><br><span class="line">      <span class="keyword">const</span> props = <span class="built_in">Object</span>.assign(&#123;&#125;,elementsTree.props,newProps);</span><br><span class="line">      <span class="keyword">const</span> newElement = React.cloneElement(elementsTree, props, elementsTree.props.children)</span><br><span class="line">      <span class="keyword">return</span> newElement;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> NewComponent = iiHOC(MyComponent)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">App</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;NewComponent&gt;&lt;<span class="regexp">/NewComponent&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> App;</span><br></pre></td></tr></table></figure><h4 id="b-反向继承-修改state"><a href="#b-反向继承-修改state" class="headerlink" title="b) 反向继承-修改state"></a>b) 反向继承-修改state</h4><p>HOC 可以读取、编辑和删除 WrappedComponent 实例的 state，如果需要，也可以给它添加更多的 state。但是这会搞乱 WrappedComponent 的 state，可能会导致破坏某些东西，通常不建议使用高阶组件修改添加state。</p><p>下面通过访问 WrappedComponent 的 props 和 state 来做测试。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">IIHOCDEBUGGER</span>(<span class="params">WrappedComponent</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="class"><span class="keyword">class</span> <span class="title">II</span> <span class="keyword">extends</span> <span class="title">WrappedComponent</span> </span>&#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        &lt;div&gt;</span><br><span class="line">          &lt;h2&gt;HOC Debugger Component&lt;<span class="regexp">/h2&gt;</span></span><br><span class="line"><span class="regexp">          &lt;p&gt;Props&lt;/</span>p&gt; <span class="xml"><span class="tag">&lt;<span class="name">pre</span>&gt;</span>&#123;JSON.stringify(this.props)&#125;<span class="tag">&lt;/<span class="name">pre</span>&gt;</span></span></span><br><span class="line">          &lt;p&gt;State&lt;<span class="regexp">/p&gt;&lt;pre&gt;&#123;JSON.stringify(this.state)&#125;&lt;/</span>pre&gt;</span><br><span class="line">          &#123;<span class="keyword">super</span>.render()&#125;</span><br><span class="line">        &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">      )</span></span><br><span class="line"><span class="regexp">    &#125;</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure><h1 id="12-相关文章"><a href="#12-相关文章" class="headerlink" title="12. 相关文章"></a>12. 相关文章</h1><ul><li><a href="https://mp.weixin.qq.com/s/gV-w_rRfdBVAqsOpBGZaVw" target="_blank" rel="noopener">2018 年，React 将独占前端框架鳌头？</a></li><li><a href="https://mp.weixin.qq.com/s/0wXWqKIigaKzMSfy4vJMVw" target="_blank" rel="noopener">前端框架三巨头年度走势对比：Vue 增长率最高</a></li></ul><ul><li><a href="http://www.cnblogs.com/tim100/p/6050514.html" target="_blank" rel="noopener">React数据流和组件间的沟通总结</a></li><li><a href="https://segmentfault.com/q/1010000005876655/a-1020000005876751" target="_blank" rel="noopener">单向数据流和双向绑定各有什么优缺点？</a></li><li><a href="https://www.zhihu.com/question/29504639?sort=created" target="_blank" rel="noopener">怎么更好的理解虚拟DOM?</a></li><li><a href="http://www.css88.com/react/index.html" target="_blank" rel="noopener">React中文文档 - 版本较低</a></li><li><a href="http://blog.csdn.net/yczz/article/details/49886061" target="_blank" rel="noopener">React 源码剖析系列 － 不可思议的 react diff</a></li><li><a href="http://www.infoq.com/cn/articles/react-dom-diff?from=timeline&isappinstalled=0" target="_blank" rel="noopener">深入浅出React（四）：虚拟DOM Diff算法解析</a></li><li><a href="http://www.cocoachina.com/webapp/20150721/12692.html" target="_blank" rel="noopener">一看就懂的ReactJs入门教程（精华版）</a></li><li><a href="http://www.ruanyifeng.com/blog/2016/06/css_modules.html" target="_blank" rel="noopener">CSS Modules 用法教程</a></li><li><a href="http://blog.csdn.net/itzhongzi/article/details/66045880" target="_blank" rel="noopener">将MarkDown转换为HTML页面</a></li><li><a href="https://jingyan.baidu.com/article/0320e2c1c9cf0e1b87507b26.html" target="_blank" rel="noopener">win7命令行 端口占用 查询进程号 杀进程</a></li><li><a href="https://facebook.github.io/react/docs/typechecking-with-proptypes.html" target="_blank" rel="noopener">类型校验</a></li></ul><ul><li><a href="https://reactjs.org/docs/animation.html#high-level-api-reactcsstransitiongroup" target="_blank" rel="noopener">Animation Add-Ons</a></li></ul><h2 id="安装-React-Developer-Tools-调试工具"><a href="#安装-React-Developer-Tools-调试工具" class="headerlink" title="安装 React Developer Tools 调试工具"></a>安装 React Developer Tools 调试工具</h2><p><a href="https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi?hl=zh-CN" target="_blank" rel="noopener">React Developer Tools - Chrome 扩展下载安装地址</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;1-React简介&quot;&gt;&lt;a href=&quot;#1-React简介&quot; class=&quot;headerlink&quot; title=&quot;1. React简介&quot;&gt;&lt;/a&gt;1. React简介&lt;/h1&gt;&lt;h2 id=&quot;1-1-React介绍&quot;&gt;&lt;a href=&quot;#1-1-React介绍&quot;
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>ES6语法详解</title>
    <link href="http://yoursite.com/2020/03/14/ES6%E8%AF%AD%E6%B3%95%E8%AF%A6%E8%A7%A3/"/>
    <id>http://yoursite.com/2020/03/14/ES6%E8%AF%AD%E6%B3%95%E8%AF%A6%E8%A7%A3/</id>
    <published>2020-03-14T01:18:55.000Z</published>
    <updated>2020-04-13T08:04:46.886Z</updated>
    
    <content type="html"><![CDATA[<h2 id="1-ES6介绍"><a href="#1-ES6介绍" class="headerlink" title="1.ES6介绍"></a>1.ES6介绍</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">《ECMAScript <span class="number">6</span> 入门》</span><br><span class="line">《深入浅出ES6》              阮一峰</span><br><span class="line">http:<span class="comment">//es6.ruanyifeng.com/</span></span><br><span class="line"></span><br><span class="line">ECMAScript <span class="number">6.0</span>（以下简称 ES6）是 JavaScript 语言的下一代标准，已经在 <span class="number">2015</span> 年 <span class="number">6</span> 月正式发布了。它的目标，是使得 JavaScript 语言可以用来编写复杂的大型应用程序，成为企业级开发语言。</span><br><span class="line"></span><br><span class="line">ES6 提供了许多新特性，但并不是所有的浏览器都能够完美支持。好在目前各大浏览器自身也加快速度兼容 ES6 的新特性，其中对 ES6 新特性最友好的是 Chrome 和 Firefox 浏览器。</span><br></pre></td></tr></table></figure><h3 id="1-1-ES6的兼容性"><a href="#1-1-ES6的兼容性" class="headerlink" title="1.1 ES6的兼容性"></a>1.1 ES6的兼容性</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">一、桌面端浏览器对ES2015的支持情况</span><br><span class="line">Chrome：<span class="number">51</span> 版起便可以支持 <span class="number">97</span>% 的 ES6 新特性。</span><br><span class="line">Firefox：<span class="number">53</span> 版起便可以支持 <span class="number">97</span>% 的 ES6 新特性。</span><br><span class="line">Safari：<span class="number">10</span> 版起便可以支持 <span class="number">99</span>% 的 ES6 新特性。</span><br><span class="line">IE：Edge <span class="number">15</span>可以支持 <span class="number">96</span>% 的 ES6 新特性。Edge <span class="number">14</span> 可以支持 <span class="number">93</span>% 的 ES6 新特性。（IE7~<span class="number">11</span> 基本不支持 ES6）</span><br><span class="line"></span><br><span class="line">二、移动端浏览器对ES2015的支持情况</span><br><span class="line">iOS：<span class="number">10.0</span> 版起便可以支持 <span class="number">99</span>% 的 ES6 新特性。</span><br><span class="line">Android：基本不支持 ES6 新特性（<span class="number">5.1</span> 仅支持 <span class="number">25</span>%）</span><br><span class="line"></span><br><span class="line">三、服务器对ES2015的支持情况</span><br><span class="line">Node.js：<span class="number">6.5</span> 版起便可以支持 <span class="number">97</span>% 的 ES6 新特性。（<span class="number">6.0</span> 支持 <span class="number">92</span>%）</span><br><span class="line"></span><br><span class="line">附：如何使用ES6的新特性，又能保证浏览器的兼容？</span><br><span class="line">针对 ES6 的兼容性问题，很多团队为此开发出了多种语法解析转换工具，把我们写的 ES6 语法转换成 ES5，相当于在 ES6 和浏览器之间做了一个翻译官。比较通用的工具方案有 babel，jsx，traceur，es6-shim 等。</span><br></pre></td></tr></table></figure><h3 id="1-2-ES6语法"><a href="#1-2-ES6语法" class="headerlink" title="1.2 ES6语法"></a>1.2 ES6语法</h3><h4 id="1-2-1-变量声明let与const"><a href="#1-2-1-变量声明let与const" class="headerlink" title="1.2.1 变量声明let与const"></a>1.2.1 变量声明let与const</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"># 1. let  变量</span><br><span class="line"><span class="comment">//1.1 let声明的变量不存在预解析</span></span><br><span class="line"><span class="comment">//1.2 let声明的变量在同一个作用域内不允许重复</span></span><br><span class="line"><span class="comment">//1.3 let声明的变量一定要在声明后使用，否则报错。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//之前作用域包含：全局作用域和函数作用域，不存在块级作用域。在ES6引入了块级作用域。</span></span><br><span class="line"><span class="comment">//所谓块级作用域就是  &#123; &#125; </span></span><br><span class="line"><span class="keyword">if</span>(<span class="literal">true</span>)&#123;</span><br><span class="line"><span class="comment">//块级作用域内的变量不可以被外部访问</span></span><br><span class="line">    <span class="keyword">let</span> flag = <span class="number">123</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(flag);</span><br><span class="line"></span><br><span class="line"><span class="comment">//for循环()中用let声明的变量只能在循环体内使用</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;<span class="number">5</span>;i++)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(i); <span class="comment">//无法访问</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//1.3 在代码块内，使用let命令声明变量之前，该变量都是不可用的。这在语法上，称为“暂时性死区”</span></span><br><span class="line"><span class="comment">// 只要块级作用域内存在let命令，它所声明的变量就“绑定”（binding）这个区域，不再受外部的影响。</span></span><br><span class="line"><span class="keyword">var</span> tmp = <span class="number">123</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">   tmp = <span class="string">'abc'</span>; <span class="comment">// 暂时性死区</span></span><br><span class="line">   <span class="keyword">let</span> tmp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># 2. const  常量</span><br><span class="line"><span class="keyword">const</span>  a = <span class="number">1</span>;   <span class="comment">//const声明的常量必须初始化</span></span><br><span class="line">a = <span class="number">2</span>;  <span class="comment">//错误，a不可以被改变</span></span><br></pre></td></tr></table></figure><h4 id="1-2-2-解构赋值"><a href="#1-2-2-解构赋值" class="headerlink" title="1.2.2 解构赋值"></a>1.2.2 解构赋值</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1.什么是解构赋值</span></span><br><span class="line">语法上就是赋值的作用。</span><br><span class="line">解构:左边一种结构，右边一种结构，左右一一对应进行赋值。</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.数组的解构赋值</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> [a,b,c] = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">    <span class="built_in">console</span>.log(a,b,c);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.使用解构赋值进行变量交换</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> a=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">let</span> b=<span class="number">2</span>;</span><br><span class="line">    [a,b] = [b,a];</span><br><span class="line">    <span class="built_in">console</span>.log(a,b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//4.返回多个参数</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> [<span class="number">1</span>,<span class="number">2</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> [a,b] = f();<span class="comment">//[a,b]=[1,2]</span></span><br><span class="line">    <span class="built_in">console</span>.log(a,b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//5.对象的解构赋值</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> &#123;foo,bar&#125; = &#123;<span class="attr">foo</span>:<span class="string">'hello'</span>,<span class="attr">bar</span>:<span class="string">'hi'</span>&#125;;</span><br><span class="line">    <span class="comment">//给对象取别名(如果有了别名，那么原来的名字就无效了)</span></span><br><span class="line">    <span class="keyword">let</span> &#123;<span class="attr">foo</span>:abc,bar&#125; = &#123;<span class="attr">foo</span>:<span class="string">'hello'</span>,<span class="attr">bar</span>:<span class="string">'hi'</span>&#125;;</span><br><span class="line">    <span class="built_in">console</span>.log(foo,bar);</span><br><span class="line">    <span class="comment">//将对象中的属性赋值给对应成员</span></span><br><span class="line">    <span class="keyword">let</span> &#123;cos,sin,random&#125; = <span class="built_in">Math</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(cos,sin,random);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//6.对象的解构赋值</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> metaData=&#123;</span><br><span class="line">        title:<span class="string">"abc"</span>,</span><br><span class="line">        test:[&#123;</span><br><span class="line">            title:<span class="string">"test"</span>,</span><br><span class="line">            desc:<span class="string">"description"</span></span><br><span class="line">        &#125;]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> &#123;<span class="attr">title</span>:esTitle,<span class="attr">test</span>:[&#123;<span class="attr">title</span>:cnTitle&#125;]&#125; = metaData;</span><br><span class="line">    <span class="built_in">console</span>.log(esTitle,cnTitle);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//7.字符串的解构赋值</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> [a,b,c,d,e] = <span class="string">"hello"</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(a,b,c,d,e);</span><br><span class="line">    <span class="comment">//获取字符串长度</span></span><br><span class="line">    <span class="keyword">let</span> &#123;length&#125; = <span class="string">"abc"</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(length);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="1-2-3-字符串扩展"><a href="#1-2-3-字符串扩展" class="headerlink" title="1.2.3 字符串扩展"></a>1.2.3 字符串扩展</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment">//常用方法</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"hello world"</span>.includes(<span class="string">"world"</span>,<span class="number">3</span>));   <span class="comment">//3指定开始搜索的位置</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"hello world"</span>.startsWith(<span class="string">"h"</span>));</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"hello world"</span>.endsWith(<span class="string">"d"</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//字符串复制</span></span><br><span class="line">    <span class="keyword">let</span> str = <span class="string">"abc"</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(str.repeat(<span class="number">2</span>)); <span class="comment">//str重复两次</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">//模板字符串  反引号</span></span><br><span class="line">    <span class="keyword">let</span> obj = &#123;</span><br><span class="line">        name:<span class="string">"zhangsan"</span>,</span><br><span class="line">        age:<span class="number">18</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">gender</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> gender;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> str = <span class="string">`姓名<span class="subst">$&#123;obj.name&#125;</span>,年龄<span class="subst">$&#123;obj.age&#125;</span>,性别<span class="subst">$&#123;fn(<span class="string">'男'</span>)&#125;</span>`</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//前补后补字符串</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"a"</span>.padStart(<span class="number">2</span>,<span class="string">"0"</span>));</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"a"</span>.padEnd(<span class="number">2</span>,<span class="string">"0"</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//标签模板字符串</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    (1)定义：模板字符串紧跟在一个函数后面，该函数将被调用来处理这个模板字符串</span></span><br><span class="line"><span class="comment">    (2)是函数调用的一种特殊方式，标签就是函数，紧跟在后面的模板字符串就是参数</span></span><br><span class="line"><span class="comment">    (3)如果模板字符串里面有变量，先将模板字符串处理成多个参数，再调用函数</span></span><br><span class="line"><span class="comment">    (4)函数tag会接收多个参数</span></span><br><span class="line"><span class="comment">    </span></span><br><span class="line"><span class="comment">    function tag(stringArr, value1, value2)&#123;</span></span><br><span class="line"><span class="comment">         // stringArr:该数组的成员是模板字符串中那些没有变量替换的部分</span></span><br><span class="line"><span class="comment">         // value1,...:模板字符串各个变量被替换后的值</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">5</span>;</span><br><span class="line">    <span class="keyword">var</span> b = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">tag</span>(<span class="params">s,v1,v2</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(s);  <span class="comment">//字符串模板，数组</span></span><br><span class="line">        <span class="built_in">console</span>.log(v1);<span class="comment">//第一个$&#123;a+b&#125;</span></span><br><span class="line">        <span class="built_in">console</span>.log(v2);<span class="comment">//第二个$&#123;a*b&#125;</span></span><br><span class="line">        <span class="comment">//通过手动return 来过滤字符串</span></span><br><span class="line">        <span class="keyword">return</span> s[<span class="number">0</span>]+v1;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(tag<span class="string">`Hello <span class="subst">$&#123;a+b&#125;</span> world <span class="subst">$&#123;a*b&#125;</span>`</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="1-2-4-函数扩展"><a href="#1-2-4-函数扩展" class="headerlink" title="1.2.4 函数扩展"></a>1.2.4 函数扩展</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment">//1.参数默认值(带有默认值的参数需要放在无默认值参数的右边)</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">param = <span class="string">'hello'</span></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(param);</span><br><span class="line">    &#125;</span><br><span class="line">    foo();</span><br><span class="line">    foo(<span class="string">"你好"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//2.参数结构赋值</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">&#123;uname=<span class="string">'lisi'</span>,age=<span class="number">13</span>&#125;=&#123;&#125;</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(uname,age);</span><br><span class="line">    &#125;</span><br><span class="line">    foo(&#123;<span class="attr">uname</span>:<span class="string">'zhangsan'</span>,age<span class="string">"15"</span>&#125;);</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//3.rest参数  (剩余参数)  ...  将多个参数变成数组</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">a,b,...param</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(a,param);</span><br><span class="line">    &#125;</span><br><span class="line">    foo(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//4.扩展运算符  ...  将数组变为离散值</span></span><br><span class="line">    <span class="keyword">let</span> arr1 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">    <span class="keyword">let</span> arr2 = [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>];</span><br><span class="line">    <span class="keyword">let</span> arr3 = [...arr1,...arr2];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//5.扩展运算符  ...  将数组变为多个参数</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">a,b,c,</span>)</span>&#123;</span><br><span class="line">         <span class="built_in">console</span>.log(a+b+c);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">    foo.apply(<span class="literal">null</span>,arr); <span class="comment">//apply()方法第二个参数是数组</span></span><br><span class="line">    foo(...arr);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//6.箭头函数   代码块</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"hello"</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> foo = <span class="function"><span class="params">()</span> =&gt;</span> &#123;<span class="built_in">console</span>.log(<span class="string">"hello"</span>)&#125;;</span><br><span class="line">    foo();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> foo2 = <span class="function">(<span class="params">name</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">let</span> c = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"hello"</span>+name +c);</span><br><span class="line">    &#125;;</span><br><span class="line">    foo2(<span class="string">"小明"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//7.箭头函数应用</span></span><br><span class="line">    arr.forEach(<span class="function">(<span class="params">element,index</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(element,index);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//8.箭头函数的注意事项：</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="comment">//8.1 箭头函数中的this是定义函数时所在的执行环境</span></span><br><span class="line">        setTimeout(<span class="function"><span class="params">()</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="keyword">this</span>.num);</span><br><span class="line">        &#125;,<span class="number">1000</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    foo.call(&#123;<span class="attr">num</span>:<span class="number">1</span>&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//8.2 箭头函数不可以使用arguments获取参数列表，可以用reset参数替代</span></span><br><span class="line">    <span class="comment">//   箭头函数不能new，没有原型链</span></span><br><span class="line">    <span class="keyword">let</span> foo = <span class="function">(<span class="params">...param</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(param);</span><br><span class="line">    &#125;</span><br><span class="line">    foo(<span class="number">123</span>,<span class="number">456</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//8.3 如果箭头函数中没有形参，()不能省略</span></span><br><span class="line">    <span class="comment">//8.4 如果箭头函数中只有一条return语句，可以省略&#123;&#125;和return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="1-2-5-数组扩展"><a href="#1-2-5-数组扩展" class="headerlink" title="1.2.5 数组扩展"></a>1.2.5 数组扩展</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//Array.from  方法从一个类似数组或可迭代对象中创建一个新的数组实例</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//去数组中的重复元素</span></span><br><span class="line">    <span class="keyword">let</span> arr = [<span class="number">12</span>,<span class="number">13</span>,<span class="number">12</span>,<span class="number">11</span>,<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">let</span> arr1 = <span class="built_in">Array</span>.from(<span class="keyword">new</span> <span class="built_in">Set</span>(arr));</span><br><span class="line">        <span class="built_in">console</span>.log(arr1);<span class="comment">//输出：12,13,11,0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//获取数组的所有key</span></span><br><span class="line">    [<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>].keys();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取数组的所有values </span></span><br><span class="line">    [<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>].values();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//获取所有的key和value</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> o <span class="keyword">of</span> [<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>]) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(o);   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//数组查找</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">console</span>.log([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>].find(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>)</span>&#123;<span class="keyword">return</span> item&gt;<span class="number">3</span>&#125;))</span><br><span class="line">    <span class="built_in">console</span>.log([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>].findIndex(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>)</span>&#123;<span class="keyword">return</span> item&gt;<span class="number">3</span>&#125;))<span class="comment">//返回第一个找到的值</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//数组包含</span></span><br><span class="line">&#123;</span><br><span class="line">     <span class="built_in">console</span>.log([<span class="number">1</span>,<span class="number">2</span>,<span class="literal">NaN</span>].includes(<span class="number">1</span>));</span><br><span class="line">     <span class="built_in">console</span>.log([<span class="number">1</span>,<span class="number">2</span>,<span class="literal">NaN</span>].includes(<span class="literal">NaN</span>));<span class="comment">//字符串处理</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="1-2-6-对象扩展"><a href="#1-2-6-对象扩展" class="headerlink" title="1.2.6 对象扩展"></a>1.2.6 对象扩展</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1.es5对象和es6对象对比</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">let</span> o = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">let</span> k = <span class="number">2</span>;</span><br><span class="line">    <span class="comment">//es5</span></span><br><span class="line">    <span class="keyword">let</span> es5 = &#123;</span><br><span class="line">        o:o,</span><br><span class="line">        k:k,</span><br><span class="line">        say:<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"hello"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">//es6</span></span><br><span class="line">    <span class="keyword">let</span> es6 = &#123;</span><br><span class="line">        o,</span><br><span class="line">        k,</span><br><span class="line">        say()&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"say"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="built_in">console</span>.log(es5,es6);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.属性表达式</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> a=<span class="string">"b"</span>;</span><br><span class="line">    <span class="keyword">let</span> es5_obj = &#123;</span><br><span class="line">        a:<span class="string">"c"</span></span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> es6_obj=&#123;</span><br><span class="line">        <span class="comment">//这里的[a]这个值为上面的b</span></span><br><span class="line">        [a]:<span class="string">"c"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.新增API</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//Object.is 相当于===</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">Object</span>.is(<span class="string">"abc"</span>,<span class="string">"abc"</span>));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//拷贝</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="built_in">Object</span>.assign(&#123;<span class="attr">a</span>:<span class="string">"a"</span>&#125;,&#123;<span class="attr">b</span>:<span class="string">"b"</span>&#125;))</span><br><span class="line"></span><br><span class="line"><span class="comment">//遍历对象</span></span><br><span class="line">    <span class="keyword">let</span> test = &#123;<span class="attr">k</span>:<span class="number">123</span>,<span class="attr">o</span>:<span class="number">456</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> key <span class="keyword">in</span> test)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(key,test[key]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="1-2-7-Symbol"><a href="#1-2-7-Symbol" class="headerlink" title="1.2.7 Symbol"></a>1.2.7 Symbol</h4><pre><code>ES6中新增了Symbol数据类型。Symbol不可以new之前的基本数据类型有6种：Undefined、Null、布尔值（Boolean）、字符串（String）、数值（Number）、对象（Object）。Symbol声明的变量是唯一的，意义在于减少命名冲突</code></pre><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="comment">//Symbol的变量是唯一的，所以a1和a2永远不相等</span></span><br><span class="line">    <span class="keyword">let</span> a1 = <span class="built_in">Symbol</span>();</span><br><span class="line">    <span class="keyword">let</span> a2 = <span class="built_in">Symbol</span>();</span><br><span class="line">    <span class="built_in">console</span>.log(a1 === a2);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//Symbol全局注册表是一个类似全局作用域的共享环境</span></span><br><span class="line">    <span class="comment">//Symbol.for()方法首先在全局Symbol注册表中搜索键为"a3"的Symbol是否存在，如果存在，直接返回已有的Symbol；否则，创建一个新的Symbol，并使用这个键在Symbol全局注册表中注册，随即返回新创建的Symbol。后续如果再传入同样的键调用Symbol.for()会返回相同的Symbol</span></span><br><span class="line">    <span class="keyword">let</span> a3 = <span class="built_in">Symbol</span>.for(<span class="string">"a3"</span>);</span><br><span class="line">    <span class="keyword">let</span> a4 = <span class="built_in">Symbol</span>.for(<span class="string">"a3"</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(a3 === a4);  <span class="comment">//true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//Symbol作为key</span></span><br><span class="line">    <span class="keyword">let</span> a1 = <span class="built_in">Symbol</span>.for(<span class="string">"abc"</span>);</span><br><span class="line">    <span class="keyword">let</span> obj = &#123;</span><br><span class="line">        [a1]:<span class="string">"123"</span>,</span><br><span class="line">        <span class="string">"abc"</span>:<span class="number">345</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(obj);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> key <span class="keyword">in</span> obj)&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(key,obj[key]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//Symbol作用：</span></span><br><span class="line">    <span class="comment">//有时我们可能希望在不同的代码中共享同一个Symbol，例如，在你的应用中有两种不同的对象类型，但是你希望它们使用同一个Symbol属性来表示一个独特的标识符。</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">let</span> a1 = <span class="built_in">Symbol</span>.for(<span class="string">"abc"</span>);</span><br><span class="line">        <span class="keyword">let</span> obj = &#123;</span><br><span class="line">            [a1]:<span class="string">"123"</span>,</span><br><span class="line">            <span class="string">"abc"</span>:<span class="number">345</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">console</span>.log(obj);</span><br><span class="line">    &#125;</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//这里拿到的Symbol和上面一个代码块拿到的Symbol是同一个东西</span></span><br><span class="line">        <span class="keyword">let</span> a1 = <span class="built_in">Symbol</span>.for(<span class="string">"abc"</span>);</span><br><span class="line">        <span class="keyword">let</span> obj2 = &#123;</span><br><span class="line">            [a1]:<span class="string">"123"</span>,</span><br><span class="line">            <span class="string">"abc"</span>:<span class="number">34544</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">console</span>.log(obj2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1-3-ES6数据结构"><a href="#1-3-ES6数据结构" class="headerlink" title="1.3. ES6数据结构"></a>1.3. ES6数据结构</h3><h4 id="1-3-1-Array和Set"><a href="#1-3-1-Array和Set" class="headerlink" title="1.3.1 Array和Set"></a>1.3.1 Array和Set</h4><h5 id="a-Array"><a href="#a-Array" class="headerlink" title="a) Array"></a>a) Array</h5><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   let  arr &#x3D; [1,2,3]; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="b-Set"><a href="#b-Set" class="headerlink" title="b) Set"></a>b) Set</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1.Set元素是无序唯一</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> list = <span class="keyword">new</span> <span class="built_in">Set</span>();</span><br><span class="line">    list.add(<span class="number">5</span>);</span><br><span class="line">    list.add(<span class="number">7</span>);</span><br><span class="line">    list.add(<span class="string">"a"</span>);</span><br><span class="line">    list.add(<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">console</span>.log(list);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//2.Set的方法</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">let</span> arr=[<span class="string">'add'</span>,<span class="string">'delete'</span>,<span class="string">'clear'</span>,<span class="string">'has'</span>];</span><br><span class="line">  <span class="keyword">let</span> list=<span class="keyword">new</span> <span class="built_in">Set</span>(arr);</span><br><span class="line"></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'has'</span>,list.has(<span class="string">'add'</span>));</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'delete'</span>,list.delete(<span class="string">'add'</span>),list);</span><br><span class="line">  list.clear();</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'list'</span>,list);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//3.Set的遍历</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">let</span> arr=[<span class="string">'add'</span>,<span class="string">'delete'</span>,<span class="string">'clear'</span>,<span class="string">'has'</span>];</span><br><span class="line">  <span class="keyword">let</span> list=<span class="keyword">new</span> <span class="built_in">Set</span>(arr);</span><br><span class="line"></span><br><span class="line">  list.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>)</span>&#123;<span class="built_in">console</span>.log(item);&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//4.Set转Array</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> list = <span class="keyword">new</span> <span class="built_in">Set</span>();</span><br><span class="line">    list.add(<span class="number">5</span>);</span><br><span class="line">    list.add(<span class="number">7</span>);</span><br><span class="line">    list.add(<span class="string">"a"</span>);</span><br><span class="line">    list.add(<span class="number">1</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> arr = [...list];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="c-WeakSet"><a href="#c-WeakSet" class="headerlink" title="c) WeakSet"></a>c) WeakSet</h5><pre><code>WeakSet 结构与 Set 类似，也是不重复的值的集合。但是，它与 Set 有下面区别。</code></pre><blockquote><p>1.WeakSet 的成员只能是对象，而不能是其他类型的值。</p><p>2.WeakSet 中的对象都是弱引用，即垃圾回收机制不考虑 WeakSet 对该对象的引用，也就是说，如果其他对象都不再引用该对象，那么垃圾回收机制会自动回收该对象所占用的内存，不考虑该对象还存在于 WeakSet 之中。</p><p>3.WeakSet 只有add/delete/clear/hass四个方法，不能遍历，没有size属性等</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="keyword">let</span> weakList=<span class="keyword">new</span> <span class="built_in">WeakSet</span>();</span><br><span class="line">  <span class="keyword">let</span> arg=&#123;&#125;;</span><br><span class="line">  weakList.add(arg);</span><br><span class="line">  <span class="comment">// weakList.add(2);</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'weakList'</span>,weakList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="d-Array和Set对比"><a href="#d-Array和Set对比" class="headerlink" title="d) Array和Set对比"></a>d) Array和Set对比</h5><blockquote><p>1.在Set中我们不能像访问数组元素那样直接通过索引来访问集合中的元素，如有需要，需要先将Set转换为数组。<br>2.Array中的数组元素是可以重复的，Set中的数组元素不能重复<br>3.Array的key默认是索引值，value是数组内容；Set的key和value都是实际内容</p></blockquote><h4 id="1-3-2-Object和Map"><a href="#1-3-2-Object和Map" class="headerlink" title="1.3.2 Object和Map"></a>1.3.2 Object和Map</h4><h5 id="a-Object"><a href="#a-Object" class="headerlink" title="a) Object"></a>a) Object</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> obj = &#123;</span><br><span class="line">        key:<span class="string">"value"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="b-Map"><a href="#b-Map" class="headerlink" title="b) Map"></a>b) Map</h5><pre><code>Map结构提供了“值—值”的对应，是一种更完善的Hash结构实现。如果你需要“键值对”的数据结构，Map比Object更合适。它类似于对象，也是键值对的集合，但是“键”的范围不限于字符串，各种类型的值（包括对象）都可以当作键。</code></pre><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">//基本使用</span></span><br><span class="line">  <span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line">  <span class="keyword">let</span> arr=[<span class="string">'123'</span>];</span><br><span class="line">  map.set(arr,<span class="number">456</span>);<span class="comment">//为map添加或更新一个指定了键(key)和值(value)的(新)键值对。</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'map'</span>,map,map.get(arr));<span class="comment">//get获取对应的值</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//Map的第二种定义</span></span><br><span class="line">  <span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([[<span class="string">'a'</span>,<span class="number">123</span>],[<span class="string">'b'</span>,<span class="number">456</span>]]);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'map args'</span>,map);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'size'</span>,map.size);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'delete'</span>,map.delete(<span class="string">'a'</span>),map);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'clear'</span>,map.clear(),map);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//has(key),delete(key),clear()</span></span><br><span class="line">    <span class="keyword">let</span> m = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line"></span><br><span class="line">    m.set(<span class="string">'edition'</span>, <span class="number">6</span>);</span><br><span class="line">    m.set(<span class="number">262</span>, <span class="string">'standard'</span>);</span><br><span class="line">    m.set(<span class="literal">undefined</span>, <span class="string">'nah'</span>);</span><br><span class="line"></span><br><span class="line">    m.has(<span class="string">'edition'</span>)     <span class="comment">// true</span></span><br><span class="line">    m.has(<span class="string">'years'</span>)       <span class="comment">// false</span></span><br><span class="line">    m.has(<span class="number">262</span>)           <span class="comment">// true</span></span><br><span class="line">    m.has(<span class="literal">undefined</span>)     <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line">    m.delete(<span class="literal">undefined</span>)</span><br><span class="line">    m.has(<span class="literal">undefined</span>)       <span class="comment">// false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//Map的遍历  Map遍历的顺序就是插入的顺序</span></span><br><span class="line">    <span class="keyword">let</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>([</span><br><span class="line">      [<span class="string">'F'</span>, <span class="string">'no'</span>],</span><br><span class="line">      [<span class="string">'T'</span>,  <span class="string">'yes'</span>],</span><br><span class="line">    ]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//遍历map</span></span><br><span class="line">    map.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">value, key, map</span>) </span>&#123;</span><br><span class="line">       <span class="built_in">console</span>.log(key,value);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="c-WeakMap"><a href="#c-WeakMap" class="headerlink" title="c) WeakMap"></a>c) WeakMap</h5><blockquote><p>1.WeakMap的key值只能是对象，而不能是其他类型的值。</p><p>2.WeakMap中的key值都是弱引用</p><p>3.WeakMap不能遍历，没有size属性等</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="keyword">let</span> weakmap=<span class="keyword">new</span> <span class="built_in">WeakMap</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> o=&#123;&#125;;</span><br><span class="line">  weakmap.set(o,<span class="number">123</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(weakmap.get(o));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="d-Object和Map区别"><a href="#d-Object和Map区别" class="headerlink" title="d) Object和Map区别"></a>d) Object和Map区别</h5><blockquote><ol><li>一个对象的键只能是字符串或者 Symbols，但一个 Map 的键可以是任意值，包括函数、对象、基本类型。</li><li>Map 中的键值是有序的，而添加到对象中的键则不是。因此，当对它进行遍历时，Map对象是按插入的顺序返回键值。</li><li>通过 size 属性直接获取一个 Map 的键值对个数，而 Object 的键值对个数只能手动计算。</li><li>Map 在频繁增删键值对的场景下会有些性能优势。</li></ol></blockquote><h3 id="1-4-Proxy和Reflect"><a href="#1-4-Proxy和Reflect" class="headerlink" title="1.4 Proxy和Reflect"></a>1.4 Proxy和Reflect</h3><h4 id="1-4-1-Proxy介绍"><a href="#1-4-1-Proxy介绍" class="headerlink" title="1.4.1 Proxy介绍"></a>1.4.1 Proxy介绍</h4><pre><code>Proxy 可以理解成，在目标对象之前架设一层“拦截”，外界对该对象的访问，都必须先通过这层拦截，因此提供了一种机制，可以对外界的访问进行过滤和改写。Proxy 这个词的原意是代理，用在这里表示由它来“代理”某些操作，可以译为“代理器”。</code></pre><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var p &#x3D; new Proxy(target, handler);</span><br><span class="line">参数一target：目标对象，即拦截目标，可以是原生对象或者内置对象（比如是Object或者其他）；</span><br><span class="line">参数二handler：拦截配置。你对参数一拦截哪些属性，拦截后的操作如何，都是在这里配置的；</span><br><span class="line">返回值p：返回代理对象。需要注意，p和target并不相等。对返回值p进行的操作，会触发handler中自定义的方法。</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> person=&#123;</span><br><span class="line">        time:<span class="string">'2017-03-11'</span>,</span><br><span class="line">        name:<span class="string">'小明'</span>,</span><br><span class="line">        age:<span class="number">18</span></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> monitor=<span class="keyword">new</span> <span class="built_in">Proxy</span>(person,&#123;</span><br><span class="line">        <span class="comment">// 拦截对象属性的读取</span></span><br><span class="line">        <span class="keyword">get</span>(target,key)&#123;</span><br><span class="line">            <span class="keyword">if</span>(key === <span class="string">"name"</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="string">"不告诉你"</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> target[key];</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// 拦截对象设置属性</span></span><br><span class="line">        <span class="keyword">set</span>(target,key,value)&#123;</span><br><span class="line">            <span class="keyword">if</span>(key===<span class="string">'time'</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> target[key]=value;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> target[key];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// 拦截key in object操作</span></span><br><span class="line">        has(target,key)&#123;</span><br><span class="line">            <span class="keyword">if</span>(key===<span class="string">'name'</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> target[key]</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// 拦截delete</span></span><br><span class="line">        deleteProperty(target,key)&#123;</span><br><span class="line">            <span class="keyword">if</span>(key === <span class="string">"age"</span>)&#123;</span><br><span class="line">                <span class="keyword">delete</span> target[key];</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="comment">// 拦截Object.keys,Object.getOwnPropertySymbols,Object.getOwnPropertyNames</span></span><br><span class="line">        ownKeys(target)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">Object</span>.keys(target).filter(<span class="function"><span class="params">item</span>=&gt;</span>item!=<span class="string">'time'</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//直接访问name。会被拦截</span></span><br><span class="line">    <span class="built_in">console</span>.log(monitor.name);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//修改time成功，修改age被拦截</span></span><br><span class="line">    monitor.time=<span class="string">'2018'</span>;</span><br><span class="line">    monitor.age= <span class="number">200</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(monitor);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//name值为true，time值为false 被拦截了</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'name'</span> <span class="keyword">in</span> monitor,<span class="string">'time'</span> <span class="keyword">in</span> monitor);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//age被删除，name不被删除</span></span><br><span class="line">    <span class="keyword">delete</span> monitor.age;</span><br><span class="line">    <span class="keyword">delete</span> monitor.name;</span><br><span class="line">    <span class="built_in">console</span>.log(monitor);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//因为写了ownKeys的拦截，此时所有的time都不会被打印</span></span><br><span class="line">    <span class="built_in">console</span>.log(monitor);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="1-4-2-Proxy实现对象属性值的校验"><a href="#1-4-2-Proxy实现对象属性值的校验" class="headerlink" title="1.4.2 Proxy实现对象属性值的校验"></a>1.4.2 Proxy实现对象属性值的校验</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> animal = &#123;</span><br><span class="line">    name:<span class="string">'dog'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> monitor=<span class="keyword">new</span> <span class="built_in">Proxy</span>(animal,&#123;</span><br><span class="line">    <span class="keyword">set</span>: function(target, key, value) &#123;</span><br><span class="line">        <span class="comment">//animalValidator中对应属性的校验逻辑是否存在</span></span><br><span class="line">        <span class="keyword">if</span> (animalValidator[key]) &#123;</span><br><span class="line">            <span class="comment">//调用animalValidator对应属性的校验方法，入参属性值，如果条件满足</span></span><br><span class="line">            <span class="keyword">if</span> (animalValidator[key](value)) &#123;</span><br><span class="line">                target[key] = value;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">`Cannot set <span class="subst">$&#123;key&#125;</span> to <span class="subst">$&#123;value&#125;</span>. Invalid.`</span>)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            target[key] = value</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//校验逻辑</span></span><br><span class="line"><span class="keyword">var</span> animalValidator = &#123;</span><br><span class="line">    name: <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 动物的名字必须是字符串类型的</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">typeof</span> name === <span class="string">'string'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">monitor.name = <span class="string">'dog'</span>;</span><br><span class="line"><span class="built_in">console</span>.log(monitor.name);</span><br><span class="line"><span class="comment">// Uncaught Error: Cannot set name to 123. Invalid.</span></span><br><span class="line">monitor.name = <span class="number">123</span>;</span><br></pre></td></tr></table></figure><h4 id="1-4-3-Reflect"><a href="#1-4-3-Reflect" class="headerlink" title="1.4.3 Reflect"></a>1.4.3 Reflect</h4><pre><code>反射机制是指程序在运行的时候访问、检测和修改它本身状态或行为的一种能力，例如一个对象能够在运行时知道自己有哪些方法和属性。反射的概念在编译型的编程语言中比较明显，比如java、C#、Object-c等。对于     `JavaScript`来说，反射就是获取对象的内部结构的信息，所以JS中的反射随处可见，比如for...in方式遍历对象。从ECMAScript6开始，JS引入Reflect这个API专门用于操作反射。Reflect引入的目的主要有下面几个：</code></pre><h5 id="a-抽取语言内部的方法"><a href="#a-抽取语言内部的方法" class="headerlink" title="a) 抽取语言内部的方法"></a>a) 抽取语言内部的方法</h5><pre><code>从ECMAScript6开始，JS将Object对象的一些明显属于语言内部的方法（ 比如Object.defineProperty）放到Reflect对象上。 现阶段某些方法同时在Object和Reflect对象上部署， 未来的新方法将只部署在Reflect对象上。并且修改某些 Object 方法的返回结果， 让其变得更合理。 比如， Object.defineProperty(obj, name, desc) 在无法定义属性时， 会抛出一个错误，而Reflect.defineProperty(obj, name, desc) 则会返回false。</code></pre><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> person = &#123;&#125;</span><br><span class="line"><span class="keyword">let</span> temp = <span class="literal">null</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>&#123;</span><br><span class="line">    <span class="comment">//一旦定义属性不成功会抛出一个异常</span></span><br><span class="line">    <span class="built_in">Object</span>.defineProperty(person, <span class="string">'name'</span>, &#123;</span><br><span class="line">        <span class="keyword">get</span>: function () &#123;</span><br><span class="line">            <span class="keyword">return</span> temp</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="keyword">set</span>: function (val) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"sss"</span>)</span><br><span class="line">            <span class="comment">//异常 ： 程序出现的不正常现象</span></span><br><span class="line">            <span class="keyword">var</span> a = <span class="literal">null</span>;</span><br><span class="line">            <span class="built_in">console</span>.log(a.toString())</span><br><span class="line">            <span class="comment">//产生异常之后的代码都不会执行</span></span><br><span class="line"></span><br><span class="line">            temp = val</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    person.name = <span class="string">"xxxx"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"aaaa"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">catch</span>(e)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"异常被捕获了"</span>);</span><br><span class="line">    <span class="comment">//一旦处理了异常之后，程序就可以继续向下执行了</span></span><br><span class="line">    <span class="built_in">console</span>.log(person);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//  新写法</span></span><br><span class="line"><span class="keyword">if</span>(<span class="built_in">Reflect</span>.defineProperty(target, property, attributes)) &#123;</span><br><span class="line"><span class="comment">// success</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">// failure</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="c-让Object操作都变成函数行为。"><a href="#c-让Object操作都变成函数行为。" class="headerlink" title="c) 让Object操作都变成函数行为。"></a>c) 让Object操作都变成函数行为。</h5><pre><code>某些Object操作是命令式， 比如name in obj和delete obj[name]，而Reflect.has(obj, name) 和Reflect.deleteProperty(obj, name) 让它们变成了函数行为。</code></pre><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//  老写法</span></span><br><span class="line"><span class="string">'assign'</span> <span class="keyword">in</span> <span class="built_in">Object</span> <span class="comment">// true</span></span><br><span class="line"><span class="comment">//  新写法</span></span><br><span class="line"><span class="built_in">Reflect</span>.has(<span class="built_in">Object</span>, <span class="string">'assign'</span>) <span class="comment">// true</span></span><br></pre></td></tr></table></figure><h5 id="c-Proxy和Reflect结合使用"><a href="#c-Proxy和Reflect结合使用" class="headerlink" title="c) Proxy和Reflect结合使用"></a>c) Proxy和Reflect结合使用</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> loggedObj = <span class="keyword">new</span> <span class="built_in">Proxy</span>(obj, &#123;</span><br><span class="line"><span class="keyword">get</span>(target, name) &#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'get'</span>, target, name);</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Reflect</span>.get(target, name);</span><br><span class="line">&#125;,</span><br><span class="line">deleteProperty(target, name) &#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'delete'</span> + name);</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Reflect</span>.deleteProperty(target, name);</span><br><span class="line">&#125;,</span><br><span class="line">has(target, name) &#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'has'</span> + name);</span><br><span class="line"><span class="keyword">return</span> <span class="built_in">Reflect</span>.has(target, name);</span><br><span class="line">&#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h5 id="d-代码可读性更好"><a href="#d-代码可读性更好" class="headerlink" title="d) 代码可读性更好"></a>d) 代码可读性更好</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#1. Reflect.apply()</span><br><span class="line">&#123;</span><br><span class="line">     <span class="comment">//Math的min只能获取指定参数中的最小值，要获取指定数组中的最小值，这个方法就不行了。</span></span><br><span class="line">    <span class="built_in">Math</span>.min(<span class="number">10</span>,<span class="number">8</span>,<span class="number">3</span>,<span class="number">29</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//要获取数组中的最小值，我们可以使用Math.min.apply(thisArg,[params])方法，apply()方法两个参数，第一个用作修改调用函数中的this指向，第二个给指定函数传递参数(数组)</span></span><br><span class="line">    <span class="keyword">var</span> ages = [<span class="number">11</span>, <span class="number">33</span>, <span class="number">12</span>, <span class="number">54</span>, <span class="number">18</span>, <span class="number">96</span>];</span><br><span class="line">    <span class="keyword">var</span> youngest = <span class="built_in">Math</span>.min.apply(<span class="built_in">Math</span>, ages);  </span><br><span class="line">    <span class="keyword">var</span> oldest = <span class="built_in">Math</span>.max.apply(<span class="built_in">Math</span>, ages);  </span><br><span class="line">    <span class="comment">//输出youngest的类型</span></span><br><span class="line">    <span class="keyword">var</span> type = <span class="built_in">Object</span>.prototype.toString.call(youngest);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//以上是之前的解决方案，有了反射之后，我们可以使用Reflect.apply()方法</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">       Reflect.apply()方法有三个参数：</span></span><br><span class="line"><span class="comment">    　 第一个参数为： 需要执行的函数；</span></span><br><span class="line"><span class="comment">　　 第二个参数为： 需要执行函数的上下文this；</span></span><br><span class="line"><span class="comment">　 　第三个参数为： 是一个数组或者伪数组， 会作为执行函数的参数；</span></span><br><span class="line"><span class="comment">　 */</span></span><br><span class="line">    <span class="keyword">var</span> youngest = <span class="built_in">Reflect</span>.apply(<span class="built_in">Math</span>.min, <span class="built_in">Math</span>, ages);  </span><br><span class="line">    <span class="keyword">var</span> oldest = <span class="built_in">Reflect</span>.apply(<span class="built_in">Math</span>.max, <span class="built_in">Math</span>, ages);  </span><br><span class="line">    <span class="keyword">var</span> type = <span class="built_in">Reflect</span>.apply(<span class="built_in">Object</span>.prototype.toString, youngest , [youngest]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1-5-类和对象"><a href="#1-5-类和对象" class="headerlink" title="1.5 类和对象"></a>1.5 类和对象</h3><pre><code>ES6引入了Class（类）这个概念，作为对象的模板。通过class关键字，可以定义类。基本上，ES6的class可以看做只是一个语法糖，它的绝大部分功能，ES5都可以做到，新的class写法只是让对象原型的写法更加清晰、更像面向对象编程的语法而已。</code></pre><h4 id="1-5-1-类的定义和创建实例"><a href="#1-5-1-类的定义和创建实例" class="headerlink" title="1.5.1 类的定义和创建实例"></a>1.5.1 类的定义和创建实例</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//es6对js的类进行了规范：方法写在原型上，把属性写在构造函数里面</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// 基本定义和生成实例</span></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Parent</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(name='zs')&#123;</span><br><span class="line">      <span class="keyword">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line">    showMsg()&#123;    <span class="comment">//定义在原型上</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">this</span>.name)</span><br><span class="line">&#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">let</span> v_parent=<span class="keyword">new</span> Parent(<span class="string">'v'</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'构造函数和实例'</span>,v_parent);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="1-5-2-继承"><a href="#1-5-2-继承" class="headerlink" title="1.5.2 继承"></a>1.5.2 继承</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">// 继承</span></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Parent</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(name='zs')&#123;</span><br><span class="line">      <span class="keyword">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Child</span> <span class="keyword">extends</span> <span class="title">Parent</span></span>&#123;</span><br><span class="line"></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'继承'</span>,<span class="keyword">new</span> Child());</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// 继承传递参数</span></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Parent</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(name='zs')&#123;</span><br><span class="line">      <span class="keyword">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Child</span> <span class="keyword">extends</span> <span class="title">Parent</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(name='child')&#123;</span><br><span class="line">      <span class="comment">//先初始化父亲的信息，在初始化自己的信息  </span></span><br><span class="line">      <span class="keyword">super</span>(name);</span><br><span class="line">      <span class="keyword">this</span>.type=<span class="string">'child'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'继承传递参数'</span>,<span class="keyword">new</span> Child(<span class="string">'hello'</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="1-5-3-getter和setter"><a href="#1-5-3-getter和setter" class="headerlink" title="1.5.3 getter和setter"></a>1.5.3 getter和setter</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//getter和setter方法的作用：给成员变量赋值</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span> (name, age) &#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;   <span class="comment">//访问set name()方法</span></span><br><span class="line">        <span class="keyword">this</span>.age = age;         <span class="comment">//由于age没有get和set方法，所以这里直接给age成员变量赋值</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">set</span> name (name) &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"setter"</span>);</span><br><span class="line">        <span class="keyword">this</span>._name = name;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">get</span> name () &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"getter"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>._name;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Person(<span class="string">"zhang"</span>, <span class="number">25</span>);</span><br><span class="line"><span class="built_in">console</span>.log(p._name);     <span class="comment">//访问真实成员变量_name</span></span><br><span class="line"><span class="built_in">console</span>.log(p.name);      <span class="comment">//访问get  name()方法，在这个方法中再去访问真实成员变量_name</span></span><br><span class="line"></span><br><span class="line">#getter和setter注意点：</span><br><span class="line"><span class="number">1.</span>一旦某个属性写了getter和setter方法，则在使用<span class="keyword">this</span>.xxx,p.xxx的时候都是去访问getter和setter方法</span><br><span class="line"><span class="number">2.</span>一旦某个属性写了getter和setter方法，真实的成员变量就不在是xxx了，而是_xxx</span><br><span class="line"><span class="number">3.</span>getter和setter方法要写就都一起写上</span><br><span class="line"><span class="number">4.</span>getter和setter方法中注意死循环的问题</span><br></pre></td></tr></table></figure><h4 id="1-5-4-静态方法和静态属性"><a href="#1-5-4-静态方法和静态属性" class="headerlink" title="1.5.4 静态方法和静态属性"></a>1.5.4 静态方法和静态属性</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//静态方法和静态属性：属于类/函数的信息，可以直接通过类名和函数名直接访问，不需要创建对象</span></span><br><span class="line"><span class="comment">//实例对象访问不到</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// 静态方法</span></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Parent</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(name='zs')&#123;</span><br><span class="line">      <span class="keyword">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> tell()&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'tell'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  Parent.tell();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">// 静态属性</span></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Parent</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(name='zs')&#123;</span><br><span class="line">      <span class="keyword">this</span>.name=name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> tell()&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'tell'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  Parent.type=<span class="string">'test'</span>;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'静态属性'</span>,Parent.type);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1-6-异步"><a href="#1-6-异步" class="headerlink" title="1.6 异步"></a>1.6 异步</h3><h4 id="1-6-1-异步的问题"><a href="#1-6-1-异步的问题" class="headerlink" title="1.6.1 异步的问题"></a>1.6.1 异步的问题</h4><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)<span class="comment">//require('fs')（fs模块用于对系统文件及目录进行读写操作。）</span></span><br><span class="line"></span><br><span class="line">fs.readFile(<span class="string">'./data/a.txt'</span>, <span class="string">'utf8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="keyword">throw</span> err</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">fs.readFile(<span class="string">'./data/b.txt'</span>, <span class="string">'utf8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="keyword">throw</span> err</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">fs.readFile(<span class="string">'./data/c.txt'</span>, <span class="string">'utf8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="keyword">throw</span> err</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;)</span><br><span class="line"># 上面代码的问题：无法保证a文件读完了接着读取b，b文件读完了接着读取c</span><br></pre></td></tr></table></figure><h4 id="1-6-2-方案1-使用异步回调"><a href="#1-6-2-方案1-使用异步回调" class="headerlink" title="1.6.2 方案1:使用异步回调"></a>1.6.2 方案1:使用异步回调</h4><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line">fs.readFile(<span class="string">'./data/a.txt'</span>, <span class="string">'utf8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (err) &#123;</span><br><span class="line">    <span class="keyword">throw</span> err</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(data)</span><br><span class="line">  fs.readFile(<span class="string">'./data/b.txt'</span>, <span class="string">'utf8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (err) &#123;</span><br><span class="line">      <span class="keyword">throw</span> err</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">    fs.readFile(<span class="string">'./data/c.txt'</span>, <span class="string">'utf8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        <span class="keyword">throw</span> err</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="built_in">console</span>.log(data)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"># 回调的问题：回调地狱，回调的层次太深，代码很难维护</span><br></pre></td></tr></table></figure><h4 id="1-6-3-方案2-使用Promise"><a href="#1-6-3-方案2-使用Promise" class="headerlink" title="1.6.3 方案2:使用Promise"></a>1.6.3 方案2:使用Promise</h4><h5 id="a-Promise介绍"><a href="#a-Promise介绍" class="headerlink" title="a) Promise介绍"></a>a) Promise介绍</h5><pre><code>所谓Promise，简单说就是一个容器，里面保存着某个未来才会结束的事件（通常是一个异步操作）的结果。</code></pre><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">    fs.readFile(<span class="string">'./data/a.txt'</span>, <span class="string">'utf8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(err)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(data);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">#1.通过打印顺序我们可以发现 1--&gt;2--&gt;3 --&gt;"aaa"</span><br><span class="line">#2. Promise本身不是异步的，只是Promise中的任务是异步的</span><br><span class="line">#3. Promise中第一个参数的function是new之后就立刻执行的</span><br></pre></td></tr></table></figure><h5 id="b-Promise的状态"><a href="#b-Promise的状态" class="headerlink" title="b) Promise的状态"></a>b) Promise的状态</h5><pre><code>Promise有三种状态：</code></pre><blockquote><ul><li>Pending（进行中、未完成的）</li><li>Resolved（已完成，又称 Fulfilled）</li><li>Rejected（已失败）。</li></ul></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    fs.readFile(<span class="string">'./data/a.txt'</span>, <span class="string">'utf8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            <span class="comment">//异步任务完毕，修改Promise状态，向下一个then传递数据</span></span><br><span class="line">            reject(err)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            resolve(data)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">&#125;,<span class="function"><span class="keyword">function</span>(<span class="params">error</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//then方法需要Promise对象来调用，表示异步任务执行完毕之后做的事情</span></span><br></pre></td></tr></table></figure><h5 id="c-Promise的链"><a href="#c-Promise的链" class="headerlink" title="c) Promise的链"></a>c) Promise的链</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"11111"</span>)</span><br><span class="line">        setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            resolve()</span><br><span class="line">        &#125;, <span class="number">1000</span>);</span><br><span class="line">    &#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"22222"</span>)</span><br><span class="line">        <span class="comment">//注意：如果此处返回的不是Promise对象，那么再后面一个then不会异步</span></span><br><span class="line">        <span class="comment">//要保证Promise的链式编程，需要在当前then中返回Promise</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">            setTimeout(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                resolve()</span><br><span class="line">            &#125;, <span class="number">2000</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">     &#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'3333'</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="e-使用Promise读文件"><a href="#e-使用Promise读文件" class="headerlink" title="e) 使用Promise读文件"></a>e) 使用Promise读文件</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">#1.基本实现</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    fs.readFile(<span class="string">'./data/a.txt'</span>, <span class="string">'utf8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            reject(err)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(data);</span><br><span class="line">            resolve(data)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">        fs.readFile(<span class="string">'./data/b.txt'</span>, <span class="string">'utf8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                reject(err)</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(data);</span><br><span class="line">                resolve(data)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;).then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">    fs.readFile(<span class="string">'./data/c.txt'</span>, <span class="string">'utf8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (err) &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(err)</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="built_in">console</span>.log(data);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#2.代码封装</span><br><span class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">pReadFile</span>(<span class="params">filePath</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    fs.readFile(filePath, <span class="string">'utf8'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">err, data</span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (err) &#123;</span><br><span class="line">        reject(err)</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        resolve(data)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">pReadFile(<span class="string">'./data/a.txt'</span>)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">    <span class="keyword">return</span> pReadFile(<span class="string">'./data/b.txt'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">    <span class="keyword">return</span> pReadFile(<span class="string">'./data/c.txt'</span>)</span><br><span class="line">  &#125;)</span><br><span class="line">  .then(<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(data)</span><br><span class="line">  &#125;)</span><br></pre></td></tr></table></figure><h5 id="f-Promise的异常捕获"><a href="#f-Promise的异常捕获" class="headerlink" title="f) Promise的异常捕获"></a>f) Promise的异常捕获</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="keyword">let</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建一个Promise实例</span></span><br><span class="line">    <span class="comment">//1.Promise中的function是new Promise()的时候就执行的</span></span><br><span class="line">    <span class="comment">//2.Promise可以帮我们解决异步回调的问题(当你有异步回调操作的时候就可以用Promise)</span></span><br><span class="line">    <span class="comment">//3.Promise本身不是异步的，只不过Promise中可以有异步任务</span></span><br><span class="line">    <span class="keyword">let</span> p = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"111"</span>);</span><br><span class="line">        <span class="comment">//fs.readFile()是一个异步操作</span></span><br><span class="line">        fs.readFile(<span class="string">"./m.txt"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (err) &#123;</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"222"</span>);</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"出错了"</span>+err);</span><br><span class="line">                reject(<span class="string">"错错错"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">console</span>.log(data.toString(<span class="string">"utf-8"</span>));</span><br><span class="line">                <span class="built_in">console</span>.log(<span class="string">"333"</span>);</span><br><span class="line">                resolve(<span class="string">"返回文件数据"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//p是一个Promise对象</span></span><br><span class="line">    <span class="comment">//Promise对象有一个then方法,then方法的第一个函数是在Promise中的function的函数中调用resolve() 之后执行的</span></span><br><span class="line">    <span class="comment">//then方法的第二个函数是在Promise中的function的函数中调用reject() 之后执行的</span></span><br><span class="line">    <span class="comment">//.catch(function(error)&#123;&#125;) 主要用来捕获promise中的异常的，注意点：不要在promise的function中抛出异常，catch方法是捕获不到的。可以在</span></span><br><span class="line">    <span class="comment">//reject的回调函数中抛出异常，这样catch方法可以捕获reject回调函数抛出的异常</span></span><br><span class="line">    p.then(<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"4444"</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(data);</span><br><span class="line">    &#125;,<span class="function"><span class="keyword">function</span>(<span class="params">data</span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"5555"</span>);</span><br><span class="line">        <span class="built_in">console</span>.log(data);</span><br><span class="line">        <span class="comment">//抛出异常</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"错错错错匆促错"</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="keyword">function</span>(<span class="params">error</span>)</span>&#123;</span><br><span class="line">        <span class="comment">//捕获异常的代码</span></span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"66666"</span>,error);</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="g-Promise-all和Promise-race"><a href="#g-Promise-all和Promise-race" class="headerlink" title="g) Promise.all和Promise.race"></a>g) Promise.all和Promise.race</h5><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1.Promise.all   等所有的promise执行完了再执行then</span></span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        resolve(<span class="string">"P1"</span>);</span><br><span class="line">    &#125;,<span class="number">500</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        resolve(<span class="string">"P2"</span>);</span><br><span class="line">    &#125;,<span class="number">2000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">Promise</span>.all([p1, p2]).then(<span class="function"><span class="keyword">function</span> (<span class="params">results</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(results); <span class="comment">// 获得一个Array: ['P1', 'P2']</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//2.Promise.race   有任何一个promise执行完了就执行then</span></span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">     setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        resolve(<span class="string">"P1"</span>);</span><br><span class="line">    &#125;,<span class="number">500</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="keyword">var</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        resolve(<span class="string">"P2"</span>);</span><br><span class="line">    &#125;,<span class="number">2000</span>);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">Promise</span>.race([p1, p2]).then(<span class="function"><span class="keyword">function</span> (<span class="params">result</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(result); <span class="comment">// 'P1'</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h4 id="1-6-4-jquery中Promise"><a href="#1-6-4-jquery中Promise" class="headerlink" title="1.6.4 jquery中Promise"></a>1.6.4 jquery中Promise</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"button"</span> <span class="attr">value</span>=<span class="string">"获取数据"</span> <span class="attr">id</span>=<span class="string">"btn"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"./lib/jquery/dist/jquery.min.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="javascript">    $(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">      $(<span class="string">'#btn'</span>).on(<span class="string">'click'</span>, <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">        $.ajax(&#123;</span></span><br><span class="line"><span class="actionscript">          <span class="comment">//请求本地数据</span></span></span><br><span class="line"><span class="actionscript">          url: <span class="string">'./data.json'</span>,</span></span><br><span class="line"><span class="actionscript">          type: <span class="string">'get'</span>,</span></span><br><span class="line"><span class="actionscript">          dataType: <span class="string">'json'</span></span></span><br><span class="line">        &#125;)</span><br><span class="line"><span class="actionscript">          .then(<span class="function"><span class="keyword">function</span> <span class="params">(data)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">console</span>.log(data)</span></span><br><span class="line">          &#125;)</span><br><span class="line">      &#125;)</span><br><span class="line">    &#125;);</span><br><span class="line">  <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="1-7-Iterator"><a href="#1-7-Iterator" class="headerlink" title="1.7 Iterator"></a>1.7 Iterator</h3><h4 id="1-7-1-遍历方式的总结"><a href="#1-7-1-遍历方式的总结" class="headerlink" title="1.7.1 遍历方式的总结"></a>1.7.1 遍历方式的总结</h4><h5 id="a-普通for循环"><a href="#a-普通for循环" class="headerlink" title="a) 普通for循环"></a>a) 普通for循环</h5><pre><code>自Javascript诞生起就一直用的 就是for循环，它用来遍历数组</code></pre><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]</span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">0</span> ; i&lt; arr.length ; i++)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(arr[i])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="b-forEach"><a href="#b-forEach" class="headerlink" title="b) forEach"></a>b) forEach</h5><pre><code>从ES5开始 Javascript内置了forEach方法用来遍历数组</code></pre><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>]</span><br><span class="line">arr.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">val, idx, arr</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(val + <span class="string">', index = '</span> + idx) <span class="comment">// val是当前元素，index当前元素索引，arr数组</span></span><br><span class="line">    <span class="built_in">console</span>.log(arr)</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">//写法简单了很多，但是也存在一个局限 就是你不能中断循环(使用break语句或使用return语句）</span></span><br></pre></td></tr></table></figure><h5 id="c-for-in"><a href="#c-for-in" class="headerlink" title="c) for-in"></a>c) for-in</h5><pre><code>for in更适合遍历对象，不要使用for in遍历数组，虽然for in也可以遍历数组，但是会存在以下问题：1.index索引为字符串型数字，不能直接进行几何运算2.遍历顺序有可能不是按照实际数组的内部顺序3.使用for in会遍历数组所有的可枚举属性，包括原型。例如原型方法method和name属性</code></pre><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;<span class="attr">a</span>: <span class="string">'1'</span>, <span class="attr">b</span>: <span class="string">'2'</span>, <span class="attr">c</span>: <span class="string">'3'</span>, <span class="attr">d</span>: <span class="string">'4'</span>&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> o <span class="keyword">in</span> obj) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(o)    <span class="comment">//遍历的实际上是对象的属性名称 a,b,c,d</span></span><br><span class="line">    <span class="built_in">console</span>.log(obj[o])  <span class="comment">//这个才是属性对应的值1，2，3，4</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="d-for…of"><a href="#d-for…of" class="headerlink" title="d) for…of"></a>d) for…of</h5><pre><code>它是ES6中新增加的语法,主要用来循环实现了Iterator接口类型的对象。for of遍历的只是数组内的元素，而不包括数组的原型属性method和索引name。但是for...of不可以遍历对象，因为对象没有实现Iterator接口。</code></pre><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//for ... of 可以遍历Array、Set、Map不能遍历Object </span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="string">'China'</span>, <span class="string">'America'</span>, <span class="string">'Korea'</span>]</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> o <span class="keyword">of</span> arr) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(o) <span class="comment">//China, America, Korea</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> [index,value] <span class="keyword">of</span> [<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>].entries()) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(index,value);   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="1-7-2-迭代器介绍"><a href="#1-7-2-迭代器介绍" class="headerlink" title="1.7.2 迭代器介绍"></a>1.7.2 迭代器介绍</h4><p>1.遍历器（Iterator）是一种接口，为各种不同的数据结构提供统一的访问机制。任何数据结构只要部署Iterator接口，就可以完成遍历操作（即依次处理该数据结构的所有成员）。</p><p>2.Iterator的作用有三个：</p><pre><code>一是为各种数据结构，提供一个统一的、简便的访问接口；二是使得数据结构的成员能够按某种次序排列；三是ES6创造了一种新的遍历命令for...of循环，Iterator接口主要供for...of消费。</code></pre><p>3.在ES6中，有些数据结构原生具备Iterator接口（比如数组），即不用任何处理，就可以被for…of循环遍历，有些就不行（比如对象）。凡是部署了Symbol.iterator属性的数据结构，就称为部署了遍历器接口。调用这个接口，就会返回一个遍历器对象。</p><p>4.在ES6中，有三类数据结构原生具备Iterator接口：数组、某些类似数组的对象、Set和Map结构。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//iterator基本使用</span></span><br><span class="line">&#123;</span><br><span class="line">      <span class="keyword">let</span> arr=[<span class="string">'hello'</span>,<span class="string">'world'</span>];</span><br><span class="line">      <span class="comment">//获取迭代器对象</span></span><br><span class="line">      <span class="keyword">let</span> map=arr[<span class="built_in">Symbol</span>.iterator]();</span><br><span class="line">      <span class="built_in">console</span>.log(map.next());</span><br><span class="line">      <span class="built_in">console</span>.log(map.next());</span><br><span class="line">      <span class="built_in">console</span>.log(map.next());</span><br><span class="line">    </span><br><span class="line">      <span class="comment">//内部遍历的时候就使用了迭代器</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> item <span class="keyword">of</span> arr) &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(item); </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="1-8-async和await"><a href="#1-8-async和await" class="headerlink" title="1.8 async和await"></a>1.8 async和await</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> fs = <span class="built_in">require</span>(<span class="string">"fs"</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">readFile</span>(<span class="params">file</span>)</span>&#123;</span><br><span class="line"><span class="comment">//返回一个Promise()</span></span><br><span class="line"><span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line"><span class="comment">//Promise中有一个读文件的异步任务</span></span><br><span class="line">fs.readFile(file,<span class="function"><span class="keyword">function</span>(<span class="params">err,data</span>)</span>&#123;</span><br><span class="line"><span class="keyword">if</span>(err)&#123;</span><br><span class="line">reject(<span class="string">"cuowu"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="comment">//console.log(data.toString("utf-8"))</span></span><br><span class="line"><span class="comment">//当文件读取成功返回成功的数据</span></span><br><span class="line">resolve(data.toString(<span class="string">"utf-8"</span>));</span><br><span class="line">&#125;</span><br><span class="line">&#125;)</span><br><span class="line">&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*readFile("./a.txt")</span></span><br><span class="line"><span class="comment">.then(function()&#123;</span></span><br><span class="line"><span class="comment">return readFile("./b.txt")</span></span><br><span class="line"><span class="comment">&#125;)</span></span><br><span class="line"><span class="comment">.then(function()&#123;</span></span><br><span class="line"><span class="comment">return readFile("./c.txt")</span></span><br><span class="line"><span class="comment">&#125;)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//async 加在函数上，表示该函数是一个异步函数</span></span><br><span class="line"><span class="comment">//如果函数上有声明async，此时在函数内部就可以使用await</span></span><br><span class="line"><span class="comment">//await 表示等待，可以将原来异步的任务变成同步</span></span><br><span class="line"><span class="comment">//这里的read方法里面的几个读取文件的任务由于加了await，所有此时这些任务是同步的，会按照顺序向下执行</span></span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"3"</span>)</span><br><span class="line"><span class="keyword">var</span> data = <span class="keyword">await</span> readFile(<span class="string">"./a.txt"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(data);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> data = <span class="keyword">await</span> readFile(<span class="string">"./b.txt"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(data);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> data = <span class="keyword">await</span> readFile(<span class="string">"./c.txt"</span>);</span><br><span class="line"><span class="built_in">console</span>.log(data);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"4"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"1"</span>)</span><br><span class="line">read();  <span class="comment">//这个read方法是异步的，所以程序不会停在48行等read方法执行完毕</span></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"2"</span>)</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;1-ES6介绍&quot;&gt;&lt;a href=&quot;#1-ES6介绍&quot; class=&quot;headerlink&quot; title=&quot;1.ES6介绍&quot;&gt;&lt;/a&gt;1.ES6介绍&lt;/h2&gt;&lt;figure class=&quot;highlight javascript&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td c
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Canvas</title>
    <link href="http://yoursite.com/2019/12/27/Canvas/"/>
    <id>http://yoursite.com/2019/12/27/Canvas/</id>
    <published>2019-12-27T10:25:50.000Z</published>
    <updated>2020-04-13T10:36:17.136Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Canvas笔记"><a href="#Canvas笔记" class="headerlink" title="Canvas笔记"></a>Canvas笔记</h1><h2 id="什么是Canvas"><a href="#什么是Canvas" class="headerlink" title="什么是Canvas"></a>什么是Canvas</h2><ul><li>canvas 是 HTML5 提供的一个用于展示绘图效果的标签</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">canvas 提供了一个空白的图形区域，可以使用特定的JavaScript API来绘画图形（canvas 2D或WebGL）</span><br></pre></td></tr></table></figure><h3 id="关于Canvas的一些说明"><a href="#关于Canvas的一些说明" class="headerlink" title="关于Canvas的一些说明"></a>关于Canvas的一些说明</h3><ul><li>canvas 是一个矩形区域的画布，可以用 JS 在上面绘画。</li><li>canvas 标签使用 JS 在网页上绘制图像，本身不具备绘图功能。</li><li>canvas 拥有多种绘制路径、矩形、圆形、文字以及添加图像的方法。</li><li>canvas的标准： <ul><li><a href="https://www.w3.org/TR/2dcontext/" target="_blank" rel="noopener">标准</a></li><li>目前来说，标准还在完善中。</li></ul></li></ul><h3 id="canvas主要应用的领域（了解）"><a href="#canvas主要应用的领域（了解）" class="headerlink" title="canvas主要应用的领域（了解）"></a>canvas主要应用的领域（了解）</h3><ul><li>1、游戏：canvas 在基于Web的图像显示方面比 Flash 更加立体、更加精巧，canvas游戏在流畅度和跨平台方面更牛。</li><li>2、<strong>可视化数据</strong>（数据图表化），比如: <a href="http://echarts.baidu.com/" target="_blank" rel="noopener">百度的ECharts</a>、<a href="https://d3js.org/" target="_blank" rel="noopener">d3.js</a>、<a href="http://threejs.org/" target="_blank" rel="noopener">three.js</a> <a href>highcharts</a></li><li>3、<strong>banner广告</strong>：Flash曾经辉煌的时代，智能手机还未曾出现。现在以及未来的智能机时代，HTML5技术能够在banner广告上发挥巨大作用，用Canvas实现动态的广告效果再合适不过。</li><li>4、未来<ul><li>模拟器：无论从视觉效果还是核心功能方面来说，模拟器产品可以完全由JavaScript来实现。</li><li>图形编辑器：Photoshop图形编辑器将能够100%基于Web实现。</li></ul></li></ul><h3 id="课程目标"><a href="#课程目标" class="headerlink" title="课程目标"></a>课程目标</h3><ul><li>学会使用基本的 canvas API, 使用 canvas 可以完成简单的绘图</li><li>实现数据的可视化</li></ul><h2 id="Canvas标签介绍"><a href="#Canvas标签介绍" class="headerlink" title="Canvas标签介绍"></a>Canvas标签介绍</h2><ul><li>作用：展示绘图的内容，但不能进行绘图</li></ul><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">width</span>=<span class="string">"600"</span> <span class="attr">height</span>=<span class="string">"400"</span>&gt;</span><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="canvas的兼容性"><a href="#canvas的兼容性" class="headerlink" title="canvas的兼容性"></a>canvas的兼容性</h3><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">canvas</span> <span class="attr">width</span>=<span class="string">"600"</span> <span class="attr">height</span>=<span class="string">"400"</span>&gt;</span></span><br><span class="line">    IE9及其以上版本的浏览器，才支持canvas标签</span><br><span class="line">    提示：您的浏览器不支持canvas，请升级浏览器</span><br><span class="line"><span class="tag">&lt;/<span class="name">canvas</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="设置宽高注意点"><a href="#设置宽高注意点" class="headerlink" title="设置宽高注意点"></a>设置宽高注意点</h3><ul><li>1 可以使用 html属性/DOM属性 <code>width</code> 和 <code>height</code>来设置</li><li>2 <em>不要：使用CSS样式来设置宽高</em></li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">使用 属性设置宽高，实际上相当于增加了 canvas画布的像素</span><br><span class="line">默认宽高： 300*150，表示：水平方向有300个像素，垂直方向有150个像素</span><br><span class="line">使用属性设置宽高，是增加或减少了canvas画布的像素；</span><br><span class="line">而使用css样式，不会增加像素点，只是将每个像素点扩大了！</span><br></pre></td></tr></table></figure><h3 id="绘图"><a href="#绘图" class="headerlink" title="绘图"></a>绘图</h3><ul><li>使用JavaScript中提供的绘图API来绘制</li></ul><h4 id="绘图的基本步骤"><a href="#绘图的基本步骤" class="headerlink" title="绘图的基本步骤"></a>绘图的基本步骤</h4><ul><li>1 拿到canvas画布</li><li>2 通过canvas拿到绘图上下文（一系列的API集合）</li><li>3 使用API绘制需要的图形</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1 找到canvas</span></span><br><span class="line"><span class="keyword">var</span> cas = <span class="built_in">document</span>.getElementById(<span class="string">"canvasId"</span>);</span><br><span class="line"><span class="comment">// 2 拿到canvas绘图上下文</span></span><br><span class="line"><span class="keyword">var</span> ctx = cas.getContext(<span class="string">"2d"</span>);</span><br><span class="line"><span class="comment">// 3 使用上下文中的API绘制图形</span></span><br><span class="line">ctx.moveTo(<span class="number">100</span>, <span class="number">100</span>);   <span class="comment">// 将画笔移动到 100,100 的位置</span></span><br><span class="line">ctx.lineTo(<span class="number">200</span>, <span class="number">100</span>);   <span class="comment">// 从 100,100 到 200,100 画一条线段</span></span><br><span class="line">ctx.stroke();           <span class="comment">// 描边</span></span><br></pre></td></tr></table></figure><ul><li>注意点：</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">getContext(&quot;2d&quot;), 参数&#96;2d&#96;是指获取到绘制平面图形的上下文;</span><br><span class="line">如果想绘制立体图形，需要传入参数：&quot;webgl&quot;</span><br><span class="line"></span><br><span class="line">2d上下文类型：CanvasRenderingContext2D</span><br><span class="line"></span><br><span class="line">获得 webgl 上下文：（了解, 部分浏览器默认不支持）</span><br><span class="line">var cas &#x3D; document.createElement(&quot;canvas&quot;);</span><br><span class="line">console.log(cas.getContext(&quot;webgl&quot;));</span><br></pre></td></tr></table></figure><h2 id="canvas的基本使用"><a href="#canvas的基本使用" class="headerlink" title="canvas的基本使用"></a>canvas的基本使用</h2><h3 id="canvas中的坐标系"><a href="#canvas中的坐标系" class="headerlink" title="canvas中的坐标系"></a>canvas中的坐标系</h3><ul><li><p>canvas坐标系，从最左上角0,0开始。x向右增大， y向下增大</p><ul><li>联想：CSS中的盒模型</li></ul></li><li><p><img src="/" class="lazyload" data-src="/.com//%E8%AF%BE%E4%BB%B6/canvas/1-%E6%95%99%E5%AD%A6%E8%B5%84%E6%96%99/imgs/canvas-x-y.png"  alt="canvas坐标系"></p></li></ul><h3 id="绘制直线的常用API"><a href="#绘制直线的常用API" class="headerlink" title="绘制直线的常用API"></a>绘制直线的常用API</h3><ul><li>步骤：先绘制路径再描边（在画布中展示）</li></ul><h4 id="moveTo-设置绘制起点"><a href="#moveTo-设置绘制起点" class="headerlink" title="moveTo -设置绘制起点"></a>moveTo -设置绘制起点</h4><ul><li>语法：ctx.moveTo(x, y); </li><li>解释：设置上下文绘制路径的起点。相当于移动画笔到某个位置</li><li>参数：x,y 都是相对于 canvas盒子的坐标。</li><li>注意：<strong>绘制线段前必须先设置起点，不然绘制无效。</strong></li></ul><h4 id="lineTo-绘制直线"><a href="#lineTo-绘制直线" class="headerlink" title="lineTo -绘制直线"></a>lineTo -绘制直线</h4><ul><li>语法：ctx.lineTo(x, y);</li><li>解释：从x,y的位置绘制一条直线到起点或者上一个线头点。</li><li>参数：x,y 线头点坐标。</li></ul><h4 id="stroke-描边"><a href="#stroke-描边" class="headerlink" title="stroke -描边"></a>stroke -描边</h4><ul><li>语法：ctx.stroke();</li><li>解释：根据路径绘制线。路径只是草稿，真正绘制线必须执行stroke</li></ul><h4 id="练习"><a href="#练习" class="headerlink" title="练习"></a>练习</h4><ul><li>绘制正方形、三角形和梯形<br><img src="/" class="lazyload" data-src="/.com//%E8%AF%BE%E4%BB%B6/canvas/1-%E6%95%99%E5%AD%A6%E8%B5%84%E6%96%99/imgs/stroke-line-exc-1.png"  alt></li></ul><h3 id="fill-填充"><a href="#fill-填充" class="headerlink" title="fill -填充"></a>fill -填充</h3><ul><li><p>语法：ctx.fill(); </p></li><li><p>解释：填充，是将闭合的路径的内容填充具体的颜色, 默认黑色。</p></li><li><p>如果所有的描点没有构成封闭结构，也会自动构成一个封闭图形</p></li><li><p>练习：<br><img src="/" class="lazyload" data-src="/.com//%E8%AF%BE%E4%BB%B6/canvas/1-%E6%95%99%E5%AD%A6%E8%B5%84%E6%96%99/imgs/no-zero-exc-1.png"  alt></p></li></ul><h3 id="线宽"><a href="#线宽" class="headerlink" title="线宽"></a>线宽</h3><ul><li>语法：ctx.lineWidth</li><li>解释：设置或返回当前的线条宽度，沿着起始坐标往上下两边扩展</li></ul><h3 id="描边和填充的样式说明"><a href="#描边和填充的样式说明" class="headerlink" title="描边和填充的样式说明"></a>描边和填充的样式说明</h3><ul><li>fillStyle  : 设置或返回用于填充绘画的颜色</li><li>strokeStyle: 设置或返回用于描边的颜色</li></ul><p>以上两个值都可以接受：颜色名、16进制数据、rgb值，甚至rgba.<br>一般先进行设置样式然后进行绘制。</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">ctx.strokeStyle = <span class="string">"red"</span>;</span><br><span class="line">ctx.strokeStyle = <span class="string">"#ccc"</span>;</span><br><span class="line">ctx.strokeStyle = <span class="string">"rgb(255,0,0)"</span>;</span><br><span class="line">ctx.strokeStyle = <span class="string">"rgba(255,0,0,6)"</span>;</span><br></pre></td></tr></table></figure><h4 id="非零环绕原则"><a href="#非零环绕原则" class="headerlink" title="非零环绕原则"></a>非零环绕原则</h4><ul><li>注意：交叉路径的填充问题，“非零环绕原则”，顺逆时针穿插次数决定是否填充。</li><li><img src="/" class="lazyload" data-src="/.com//%E8%AF%BE%E4%BB%B6/canvas/1-%E6%95%99%E5%AD%A6%E8%B5%84%E6%96%99/imgs/no-zero.png"  alt="非零环绕"></li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">以下是非0环绕原则的原理：（了解即可，非常少会用到复杂的路径）</span><br><span class="line">“非零环绕规则”是这么来判断有自我交叉情况的路径的：对于路径中的任意给定区域，</span><br><span class="line">从该区域内部画一条足够长的线段，使此线段的终点完全落在路径范围之外。</span><br><span class="line"></span><br><span class="line">接下来，将计数器初始化为0，</span><br><span class="line">然后，每当这条线段与路径上的直线或曲线相交时，</span><br><span class="line">就改变计数器的值。如果是与路径的顺时针部分相交，则加1，</span><br><span class="line">如果是与路径的逆时针部分相交，则减1。若计数器的最终值不是0，那么此区域就在路径里面，</span><br><span class="line">在调用fill()方法时，浏览器就会对其进行填充。</span><br><span class="line">如果最终值是0，那么此区域就不在路径内部，浏览器也就不会对其进行填充了</span><br></pre></td></tr></table></figure><h3 id="路径开始和闭合"><a href="#路径开始和闭合" class="headerlink" title="路径开始和闭合"></a>路径开始和闭合</h3><ul><li>开始路径：ctx.beginPath();</li><li>闭合路径：ctx.closePath();</li><li>解释：如果复杂路径绘制，必须使用路径开始和结束。闭合路径会自动把最后的线头和开始的线头连在一起。</li><li>beginPath: 核心的作用开启新路径<br>每次执行此方法，表示重新绘制一个路径, 后面的绘制跟beginPath之前的绘制的路径就无关了。</li></ul><h4 id="beginPath注意点"><a href="#beginPath注意点" class="headerlink" title="beginPath注意点:"></a>beginPath注意点:</h4><ul><li>canvas 是基于状态的绘图</li><li>状态：包含当前与当前绘制相关的属性，如：颜色、线宽等</li><li>新的状态会 “继承” 原先的状态, 虽然旧路径被清除了, 但是状态会保留下来, 线宽, 颜色等还是设置过的状态</li></ul><h3 id="绘制线的练习"><a href="#绘制线的练习" class="headerlink" title="绘制线的练习"></a>绘制线的练习</h3><ul><li><p>练习1: 绘制坐标网格</p></li><li><p><img src="/" class="lazyload" data-src="/.com//%E8%AF%BE%E4%BB%B6/canvas/1-%E6%95%99%E5%AD%A6%E8%B5%84%E6%96%99/imgs/wangge.png"  alt="绘制网格"></p></li><li><p>练习2: 绘制坐标系</p></li><li><p><img src="/" class="lazyload" data-src="/.com//%E8%AF%BE%E4%BB%B6/canvas/1-%E6%95%99%E5%AD%A6%E8%B5%84%E6%96%99/imgs/zuobiaoxi.png"  alt="绘制坐标系"></p></li><li><p>练习3: 绘制折线图<br><img src="/" class="lazyload" data-src="/.com//%E8%AF%BE%E4%BB%B6/canvas/1-%E6%95%99%E5%AD%A6%E8%B5%84%E6%96%99/imgs/zhexiantu.png"  alt></p></li></ul><h2 id="其他绘制状态（了解即可）"><a href="#其他绘制状态（了解即可）" class="headerlink" title="其他绘制状态（了解即可）"></a>其他绘制状态（了解即可）</h2><h3 id="绘制线的其他属性"><a href="#绘制线的其他属性" class="headerlink" title="绘制线的其他属性"></a>绘制线的其他属性</h3><ul><li>lineCap     设置线条端点(线头、线冒)样式<ul><li>butt  ：  默认。向线条的每个末端添加平直的边缘。</li><li>round ：  向线条的每个末端添加圆形线帽。</li><li>square：  向线条的每个末端添加正方形线帽。<br><img src="/" class="lazyload" data-src="/.com//%E8%AF%BE%E4%BB%B6/canvas/1-%E6%95%99%E5%AD%A6%E8%B5%84%E6%96%99/imgs/line-cap.png"  alt></li></ul></li><li>lineJoin    设置拐角类型<ul><li>bevel:   创建斜角。</li><li>round:   创建圆角。</li><li>miter:   默认。创建尖角<br><img src="/" class="lazyload" data-src="/.com//%E8%AF%BE%E4%BB%B6/canvas/1-%E6%95%99%E5%AD%A6%E8%B5%84%E6%96%99/imgs/line-join.png"  alt></li></ul></li><li>miterLimit  设置或返回最大斜接长度<ul><li>斜接长度指的是在两条线交汇处内角和外角之间的距离。</li><li>一般用默认值：10就可以了。除非需要特别长的尖角时，使用此属性。<br><img src="/" class="lazyload" data-src="/.com//%E8%AF%BE%E4%BB%B6/canvas/1-%E6%95%99%E5%AD%A6%E8%B5%84%E6%96%99/imgs/line-miterlimit.png"  alt></li></ul></li></ul><h3 id="绘制虚线"><a href="#绘制虚线" class="headerlink" title="绘制虚线"></a>绘制虚线</h3><ul><li>设置： setLineDash(数组)</li><li>读取： getLineDash()</li></ul><h4 id="一些说明"><a href="#一些说明" class="headerlink" title="一些说明"></a>一些说明</h4><ul><li>getLineDash() 与 setLineDash() 方法使用数组描述实线与虚线的长度.</li></ul><h2 id="绘制矩形"><a href="#绘制矩形" class="headerlink" title="绘制矩形"></a>绘制矩形</h2><h3 id="快速创建矩形rect-方法"><a href="#快速创建矩形rect-方法" class="headerlink" title="快速创建矩形rect()方法"></a>快速创建矩形rect()方法</h3><ul><li><p>语法：ctx.rect(x, y, width, height);</p></li><li><p>解释：x, y是矩形左上角坐标， width和height都是以像素计</p></li><li><p>rect方法只是规划了矩形的路径，并没有填充和描边, 所以最后还是要调用 fill 或者 stroke 方法绘制</p></li></ul><h3 id="快速创建描边矩形和填充矩形"><a href="#快速创建描边矩形和填充矩形" class="headerlink" title="快速创建描边矩形和填充矩形"></a>快速创建描边矩形和填充矩形</h3><ul><li><p>语法：ctx.strokeRect(x, y, width, height);</p><ul><li>注意此方法直接进行stroke绘制, 不会产生路径</li></ul></li><li><p>语法：ctx.fillRect(x, y, width, height);</p><ul><li>此方法直接进行 fill 填充绘制, 不会产生路径</li></ul></li></ul><h3 id="清除矩形-clearRect"><a href="#清除矩形-clearRect" class="headerlink" title="清除矩形(clearRect)"></a>清除矩形(clearRect)</h3><ul><li><p>语法：ctx.clearRect(x, y, width, hegiht);</p></li><li><p>解释：清除某个矩形内的绘制的内容，相当于橡皮擦。</p></li></ul><h3 id="清除整个画布"><a href="#清除整个画布" class="headerlink" title="清除整个画布"></a>清除整个画布</h3><ul><li><p>1 ctx.clearRect(0, 0, cv.width, cv.height);</p></li><li><p>2 cv.width = cv.width;</p></li></ul><h3 id="练习-1"><a href="#练习-1" class="headerlink" title="练习"></a>练习</h3><ul><li>练习：让矩形运动的简单动画</li></ul><h2 id="绘制圆弧"><a href="#绘制圆弧" class="headerlink" title="绘制圆弧"></a>绘制圆弧</h2><h3 id="arc-方法"><a href="#arc-方法" class="headerlink" title="arc 方法"></a>arc 方法</h3><ul><li>概述：arc() 方法创建弧/曲线（用于创建圆或部分圆）。</li><li>语法：ctx.arc(x, y, r, sAngle, eAngle, counterclockwise);</li><li>解释：<ul><li>x,y：圆心坐标。 </li><li>r：半径大小。</li><li>sAngle:绘制开始的角度。</li><li>eAngel:结束的角度，注意是弧度。π</li><li>counterclockwise：是否是逆时针。true是逆时针，false：顺时针</li></ul></li></ul><p><img src="/" class="lazyload" data-src="/.com//%E8%AF%BE%E4%BB%B6/canvas/1-%E6%95%99%E5%AD%A6%E8%B5%84%E6%96%99/imgs/arc-angle&radian.gif"  alt></p><h3 id="弧度和角度"><a href="#弧度和角度" class="headerlink" title="弧度和角度"></a>弧度和角度</h3><ul><li><p>弧度和角度的转换公式： rad = deg /180 * Math.PI;</p></li><li><p>在Math提供的方法中 <strong>Math.sin、Math.cos等都使用的单位也是弧度</strong></p></li></ul><h4 id="封装角度和弧度的转换函数"><a href="#封装角度和弧度的转换函数" class="headerlink" title="封装角度和弧度的转换函数"></a>封装角度和弧度的转换函数</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">toRadian</span>(<span class="params">angle</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> angle / <span class="number">180</span> * <span class="built_in">Math</span>.PI;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">toAngle</span>(<span class="params">radian</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> radian / <span class="built_in">Math</span>.PI * <span class="number">180</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="零度角"><a href="#零度角" class="headerlink" title="零度角"></a>零度角</h4><ul><li><p>圆心水平到最右边点是0度，顺时针方向弧度（角度为正）增大。</p></li><li><p>练习： 绘制圆弧，圆心在画布中间，从-60度到120度</p></li></ul><h3 id="绘制圆弧和起始点的问题"><a href="#绘制圆弧和起始点的问题" class="headerlink" title="绘制圆弧和起始点的问题"></a>绘制圆弧和起始点的问题</h3><ul><li>问题说明：</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">如果在绘制圆弧的时候 如果已经移动了画笔，那么画笔的坐标点与绘制圆弧的起始点画一条连线！</span><br></pre></td></tr></table></figure><ul><li><p>解决方式：</p><ul><li>beginPath</li></ul></li></ul><h3 id="绘制扇形"><a href="#绘制扇形" class="headerlink" title="绘制扇形"></a>绘制扇形</h3><ul><li>步骤：先moveTo到圆心，再绘制圆弧，最后closePath</li><li>如果是 fill 填充的扇形图，那么不需要 closePath 就会自动填充</li></ul><h3 id="计算圆弧上点的坐标"><a href="#计算圆弧上点的坐标" class="headerlink" title="计算圆弧上点的坐标"></a>计算圆弧上点的坐标</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">计算圆弧上点的坐标的公式:</span><br><span class="line">x &#x3D; x0 + r * Math.cos(a);</span><br><span class="line">y &#x3D; y0 + r * Math.sin(a);</span><br></pre></td></tr></table></figure><ul><li>sin在 1 2象限是正 3 4象限是负 <ul><li>sin在角度为：0-180度之间为正，-90-0度和180-270度之间为负</li></ul></li><li>cos在 1 4象限是正 2 3象限是负<ul><li>cos在角度为：0-90度和-90-0度之间为正，90-270度之间为负</li></ul></li></ul><h3 id="练习-2"><a href="#练习-2" class="headerlink" title="练习"></a>练习</h3><ul><li>练习：动画绘制整个圆</li><li>练习：绘制饼型图（三等分）</li><li>练习：绘制普通的饼型图</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">var data &#x3D; [&#123;</span><br><span class="line">    &quot;value&quot;: .2,</span><br><span class="line">    &quot;color&quot;: &quot;red&quot;,</span><br><span class="line">    &quot;title&quot;: &quot;应届生&quot;</span><br><span class="line">&#125;,&#123;</span><br><span class="line">    &quot;value&quot;: .3,</span><br><span class="line">    &quot;color&quot;: &quot;blue&quot;,</span><br><span class="line">    &quot;title&quot;: &quot;社会招生&quot;</span><br><span class="line">&#125;,&#123;</span><br><span class="line">    &quot;value&quot;: .4,</span><br><span class="line">    &quot;color&quot;: &quot;green&quot;,</span><br><span class="line">    &quot;title&quot;: &quot;老学员推荐&quot;</span><br><span class="line">&#125;,&#123;</span><br><span class="line">    &quot;value&quot;: .1,</span><br><span class="line">    &quot;color&quot;: &quot;pink&quot;,</span><br><span class="line">    &quot;title&quot;: &quot;公开课&quot;</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure><h2 id="绘制文字"><a href="#绘制文字" class="headerlink" title="绘制文字"></a>绘制文字</h2><h3 id="常用绘制文字方法"><a href="#常用绘制文字方法" class="headerlink" title="常用绘制文字方法"></a>常用绘制文字方法</h3><ul><li><p>ctx.fillText()      在画布上绘制“被填充的”文本</p><ul><li>参数：文字, x坐标, y坐标</li></ul></li><li><p>ctx.strokeText()    在画布上绘制文本（无填充）</p></li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">ctx.fillText(str,<span class="number">100</span>,<span class="number">94</span>);</span><br><span class="line">   ctx.strokeText(str1,<span class="number">100</span>,<span class="number">294</span>);</span><br></pre></td></tr></table></figure><h3 id="常用绘制文字属性-了解"><a href="#常用绘制文字属性-了解" class="headerlink" title="常用绘制文字属性(了解)"></a>常用绘制文字属性(了解)</h3><ul><li>font 设置或返回文本内容的当前字体属性（与 CSS font 属性相同）</li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">ctx.font = <span class="string">'18px "微软雅黑"'</span>;</span><br></pre></td></tr></table></figure><ul><li>textAlign       设置或返回文本内容的当前对齐方式</li><li>记忆: left right center<ul><li>start :    默认。文本在指定的位置开始。</li><li>end   :    文本在指定的位置结束。</li><li>center:    文本的中心被放置在指定的位置。</li><li>left  :    文本左对齐。</li><li>right :    文本右对齐。</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">ctx.textAlign = <span class="string">'left'</span>;</span><br></pre></td></tr></table></figure><p><img src="/" class="lazyload" data-src="/.com//%E8%AF%BE%E4%BB%B6/canvas/1-%E6%95%99%E5%AD%A6%E8%B5%84%E6%96%99/imgs/textAlign-demo.png"  alt="对齐图片"></p><ul><li>textBaseline      设置或返回在绘制文本时使用的当前文本基线</li><li>记忆: top  middle  bottom     默认: alphabetic (基线对齐)<ul><li>alphabetic ：   默认。文本基线是普通的字母基线。</li><li>top        ：   文本基线是 em 方框的顶端。</li><li>hanging    ：   文本基线是悬挂基线。</li><li>middle     ：   文本基线是 em 方框的正中。</li><li>ideographic：   文本基线是em基线。</li><li>bottom     ：   文本基线是 em 方框的底端。</li></ul></li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">例如： ctx.textBaseline &#x3D; &#39;top&#39;;</span><br></pre></td></tr></table></figure><ul><li><a href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/textBaseline" target="_blank" rel="noopener">textBaseline的介绍</a></li></ul><p><img src="/" class="lazyload" data-src="/.com//%E8%AF%BE%E4%BB%B6/canvas/1-%E6%95%99%E5%AD%A6%E8%B5%84%E6%96%99/imgs/textBaseline-demo.png"  alt="设置文字为主"><br><img src="/" class="lazyload" data-src="/.com//%E8%AF%BE%E4%BB%B6/canvas/1-%E6%95%99%E5%AD%A6%E8%B5%84%E6%96%99/imgs/textBaseline.gif"  alt></p><h3 id="练习-3"><a href="#练习-3" class="headerlink" title="练习"></a>练习</h3><ul><li>练习：绘制带有文字的饼型图</li></ul><h2 id="绘制图片（drawImage）（重点）"><a href="#绘制图片（drawImage）（重点）" class="headerlink" title="绘制图片（drawImage）（重点）"></a>绘制图片（drawImage）（重点）</h2><h3 id="绘制图片用法1-基本使用"><a href="#绘制图片用法1-基本使用" class="headerlink" title="绘制图片用法1 -基本使用"></a>绘制图片用法1 -基本使用</h3><ul><li><p>context.drawImage(img, x, y);</p></li><li><p>参数：</p><ul><li><p>img : 图片dom对象</p></li><li><p>x,y 绘制图片到画布中坐标</p></li></ul></li></ul><h3 id="绘制图片用法2-设置高度和宽度"><a href="#绘制图片用法2-设置高度和宽度" class="headerlink" title="绘制图片用法2 -设置高度和宽度"></a>绘制图片用法2 -设置高度和宽度</h3><ul><li>context.drawImage(img, x, y, width, height);</li><li>width：绘制到canvas中展示的宽度</li></ul><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">如果指定宽高，最好成比例，不然图片会被拉伸</span><br><span class="line">等比公式：  height &#x3D; imgHeight &#x2F; imgWidth * width;</span><br><span class="line">           设置高 &#x3D; 原高度 &#x2F; 原宽度 * 设置宽;</span><br></pre></td></tr></table></figure><h3 id="绘制图片用法3-图片裁剪"><a href="#绘制图片用法3-图片裁剪" class="headerlink" title="绘制图片用法3 -图片裁剪"></a>绘制图片用法3 -图片裁剪</h3><ul><li>context.drawImage(img, imgX, imgY, sWidth, sHeight, x, y, width, height);</li><li>参数：<ul><li>imgX, imgY：被剪裁图片的起始位置, 图片中的x,y坐标</li><li>sWidth：裁剪宽度  sHeight: 裁剪高度</li><li>x, y  : 要绘制到画布上的位置</li><li>width ：要绘制到画布上的宽度</li><li>height：要绘制到画布上的高度</li><li></li></ul></li></ul><h3 id="用JavaScript创建img对象"><a href="#用JavaScript创建img对象" class="headerlink" title="用JavaScript创建img对象"></a>用JavaScript创建img对象</h3><ul><li><p>第一种方式： </p><ul><li>var img = document.createElement(“img”);</li></ul></li><li><p>第二种方式：</p></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> img = <span class="keyword">new</span> Image(); <span class="comment">//这个就是 img标签的dom对象</span></span><br><span class="line">img.src = <span class="string">"imgs/arc.gif"</span>;</span><br><span class="line">img.alt = <span class="string">"文本信息"</span>;</span><br><span class="line">img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//图片加载完成后，执行此方法</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="绘制图片的步骤"><a href="#绘制图片的步骤" class="headerlink" title="绘制图片的步骤"></a>绘制图片的步骤</h3><ul><li>1 创建图片对象</li><li>2 等待图片加载完成</li><li>3 开始绘制图片</li></ul><h4 id="加载图片的问题"><a href="#加载图片的问题" class="headerlink" title="加载图片的问题"></a>加载图片的问题</h4><ul><li>需要使用 onload事件 等待图片加载完成之后，再绘制！</li></ul><h3 id="练习-4"><a href="#练习-4" class="headerlink" title="练习"></a>练习</h3><ul><li><p>练习1: 绘制整个图片</p></li><li><p>练习2: 绘制图片的一部分</p></li><li><p>练习3: 绘制序列帧动画</p></li></ul><h2 id="变换-（重点）"><a href="#变换-（重点）" class="headerlink" title="变换 （重点）"></a>变换 （重点）</h2><p><strong>所有的变换都是针对坐标系的，旋转的是坐标系，移动的是坐标系，放缩 的是坐标系，坐标系了改不了，绘制的所有图像都会随之改变</strong></p><h3 id="平移"><a href="#平移" class="headerlink" title="平移"></a>平移</h3><ul><li><p>ctx.translate(x,y) </p></li><li><p>参数说明：</p><ul><li>x：   整个坐标轴位移到 原来水平坐标（x）上的值</li><li>y：   整个坐标轴位移到 原来垂直坐标（y）上的值</li></ul></li><li><p>发生位移后，相当于把画布的0,0坐标 更换到新的x,y的位置，所有绘制的新元素都被影响。</p></li><li><p>位移画布一般配合缩放和旋转等。</p></li></ul><h3 id="缩放"><a href="#缩放" class="headerlink" title="缩放"></a>缩放</h3><ul><li><p>scale() 方法缩放当前绘图，更大或更小</p></li><li><p>语法：context.scale(scalewidth,scaleheight)</p><ul><li>scalewidth  :  缩放当前绘图的宽度 (1=100%, 0.5=50%, 2=200%)</li><li>scaleheight :  缩放当前绘图的高度 (1=100%, 0.5=50%, 2=200%)</li></ul></li><li><p>注意：缩放的是整个画布，缩放后，继续绘制的图形会被放大或缩小。</p><pre><code>​</code></pre></li></ul><h3 id="旋转"><a href="#旋转" class="headerlink" title="旋转"></a>旋转</h3><ul><li><p>context.rotate(radian); 旋转当前的坐标轴</p></li><li><p>注意参数是弧度（PI）</p></li></ul><h3 id="练习-5"><a href="#练习-5" class="headerlink" title="练习"></a>练习</h3><ul><li><p>在画布左右两侧分别绘制两个圆</p></li><li><p>绘制两个正方形（宽度：100 和 50）</p></li><li><p>绘制旋转的矩形</p></li></ul><h2 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h2><p>前面提到 Canvas 是含有状态的, 也就是说需要修改颜色, 直线样式等, 这些状态都会保留下来 </p><p>但是有时候, 如果需要回到默认状态中绘制另外的形状, 那么只有再将修改过的样式再更改回来. </p><p>如果在该状态中修改的属性较多, 那么每次在回到之前状态时, 就有很多的代码, 就很麻烦</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">Canvas 中引入了状态的保持机制. </span><br><span class="line">使用 CanvasRenderingContext2D.save() 方法可以保存当前状态. </span><br><span class="line">如果需要恢复到已经保存的状态, 只需要调用 CanvasRenderingContext2D.restore() 方法即可.</span><br><span class="line"></span><br><span class="line">状态保持的机制是基于状态栈实现的. 也就是说 save 一次就存储一个状态. </span><br><span class="line">restore 一次就将刚刚存入的恢复. 如果 save 两次, 就需要 restore 两次, 才可以恢复到最先的状态.</span><br><span class="line"></span><br><span class="line">一般在封装绘图的时候都会采用开始绘制之前, save 一次, 然后 开启一个新路径 beginPath, </span><br><span class="line">然后绘制结束后 restore, 这样保持当前状态不会对其他绘图代码构成影响.</span><br></pre></td></tr></table></figure><h3 id="绘制环境保存和还原"><a href="#绘制环境保存和还原" class="headerlink" title="绘制环境保存和还原"></a>绘制环境保存和还原</h3><ul><li><p>ctx.save()        保存当前环境的状态</p></li><li><p>ctx.restore()     返回之前保存过的路径状态和属性</p></li></ul><h3 id="画布保存base64编码内容-了解"><a href="#画布保存base64编码内容-了解" class="headerlink" title="画布保存base64编码内容(了解)"></a>画布保存base64编码内容(了解)</h3><ul><li>把 canvas绘制的内容 输出成base64内容。 </li><li>语法：canvas.toDataURL(type, encoderOptions);</li><li>例如：canvas.toDataURL(“image/png”,1);</li><li>参数：<ul><li>type，设置输出的类型，比如 image/png   image/jpeg等</li><li>encoderOptions： 0-1之间的数字，用于标识输出图片的质量，1表示无损压缩(可选)</li></ul></li></ul><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">"canvas"</span>);</span><br><span class="line"><span class="keyword">var</span> dataURL = canvas.toDataURL();</span><br><span class="line"><span class="built_in">console</span>.log(dataURL);</span><br><span class="line"><span class="comment">// "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNby</span></span><br><span class="line"><span class="comment">// blAAAADElEQVQImWNgoBMAAABpAAFEI8ARAAAAAElFTkSuQmCC"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> img = <span class="built_in">document</span>.querySelector(<span class="string">"#img-demo"</span>);<span class="comment">//拿到图片的dom对象</span></span><br><span class="line">img.src = canvas.toDataURL(<span class="string">"image/png"</span>);      <span class="comment">//将画布的内容给图片标签显示</span></span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Canvas笔记&quot;&gt;&lt;a href=&quot;#Canvas笔记&quot; class=&quot;headerlink&quot; title=&quot;Canvas笔记&quot;&gt;&lt;/a&gt;Canvas笔记&lt;/h1&gt;&lt;h2 id=&quot;什么是Canvas&quot;&gt;&lt;a href=&quot;#什么是Canvas&quot; class=&quot;he
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>CSS3-02</title>
    <link href="http://yoursite.com/2019/12/21/CSS3-02/"/>
    <id>http://yoursite.com/2019/12/21/CSS3-02/</id>
    <published>2019-12-21T08:13:53.000Z</published>
    <updated>2020-04-17T06:09:13.605Z</updated>
    
    <content type="html"><![CDATA[<h1 id="渐变"><a href="#渐变" class="headerlink" title="渐变"></a>渐变</h1><h2 id="线性渐变"><a href="#线性渐变" class="headerlink" title="线性渐变"></a>线性渐变</h2><blockquote><p>linear-gradient指沿着某条直线朝一个方向产生的渐变效果。</p></blockquote><p>线性渐变的核心：</p><ul><li>渐变方向</li><li>颜色</li><li>渐变范围</li></ul><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 注意：渐变实际上相当与一张图片，因为需要加给background-image才会生效 */</span></span><br><span class="line"><span class="comment">/* 渐变的核心：渐变方向，渐变颜色, 渐变范围 */</span></span><br><span class="line"><span class="comment">/* background-image: linear-gradient( 方向, 颜色 范围, 颜色 范围, 颜色 范围 ); */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/* 最简单的渐变 */</span></span><br><span class="line"><span class="selector-tag">background-image</span>: <span class="selector-tag">linear-gradient</span>(<span class="selector-tag">red</span>, <span class="selector-tag">green</span>);</span><br><span class="line"><span class="comment">/* 设定渐变的方向  */</span></span><br><span class="line"><span class="selector-tag">background-image</span>: <span class="selector-tag">linear-gradient</span>(<span class="selector-tag">to</span> <span class="selector-tag">right</span>, <span class="selector-tag">red</span>, <span class="selector-tag">green</span>);</span><br><span class="line"><span class="comment">/* 也可以设定渐变的角度  */</span></span><br><span class="line"><span class="selector-tag">background-image</span>: <span class="selector-tag">linear-gradient</span>(45<span class="selector-tag">deg</span>, <span class="selector-tag">red</span>, <span class="selector-tag">green</span>);</span><br><span class="line"><span class="comment">/* 设定渐变的范围  */</span></span><br><span class="line"><span class="selector-tag">background-image</span>: <span class="selector-tag">linear-gradient</span>(<span class="selector-tag">to</span> <span class="selector-tag">right</span>, <span class="selector-tag">red</span> 20%, <span class="selector-tag">green</span> 80%)</span><br><span class="line"><span class="comment">/* 每一个区间表示渐变颜色的范围  */</span></span><br><span class="line"><span class="selector-tag">background-image</span>: <span class="selector-tag">linear-gradient</span>(<span class="selector-tag">to</span> <span class="selector-tag">right</span>, <span class="selector-tag">red</span> 20%, <span class="selector-tag">green</span> 20%)</span><br></pre></td></tr></table></figure><p>【演示：渐变-线性渐变.html】</p><p>【演示：导航按钮.html】</p><p>【案例：渐变-案例-发廊效果.html】</p><h2 id="径向渐变"><a href="#径向渐变" class="headerlink" title="径向渐变"></a>径向渐变</h2><blockquote><p>radial-gradient指从一个中心点开始沿着四周产生渐变效果</p></blockquote><p>径向渐变的核心：</p><ul><li>圆的大小</li><li>圆心的位置</li><li>颜色</li></ul><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*1. 最简单的渐变*/</span></span><br><span class="line"><span class="selector-tag">background-image</span>: <span class="selector-tag">radial-gradient</span>(<span class="selector-tag">red</span>, <span class="selector-tag">green</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*2. 指定圆的半径和圆心*/</span></span><br><span class="line"><span class="selector-tag">background-image</span>: <span class="selector-tag">radial-gradient</span>(200<span class="selector-tag">px</span> <span class="selector-tag">at</span> <span class="selector-tag">center</span>, <span class="selector-tag">red</span>, <span class="selector-tag">green</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*3. 指定椭圆*/</span></span><br><span class="line"><span class="selector-tag">background-image</span>: <span class="selector-tag">radial-gradient</span>(200<span class="selector-tag">px</span> 80<span class="selector-tag">px</span> <span class="selector-tag">at</span> <span class="selector-tag">center</span>, <span class="selector-tag">red</span>, <span class="selector-tag">green</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*4. 指定范围*/</span></span><br><span class="line"><span class="selector-tag">background-image</span>: <span class="selector-tag">radial-gradient</span>(200<span class="selector-tag">px</span> <span class="selector-tag">at</span> <span class="selector-tag">center</span>, <span class="selector-tag">green</span> 50%, <span class="selector-tag">red</span> 50%);</span><br></pre></td></tr></table></figure><p>【演示：径向渐变-语法.html】</p><p>【案例：径向渐变-立体小球.html】</p><h1 id="过渡"><a href="#过渡" class="headerlink" title="过渡"></a>过渡</h1><h2 id="过渡的属性"><a href="#过渡的属性" class="headerlink" title="过渡的属性"></a>过渡的属性</h2><ol><li>如果两个状态发生改变，没有过渡，效果是瞬间变化的</li><li>如果加上了过渡，那么这个过程就会有动画的效果。</li><li>整个状态变化的过程是由浏览器来完成的，我们只需要关注开始状态与结束状态即可。</li></ol><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*transition-property：设置过渡属性</span></span><br><span class="line"><span class="comment">/*也可以是width,height*/</span></span><br><span class="line"><span class="selector-tag">transition-property</span><span class="selector-pseudo">:all</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*transition-duration:设置过渡时间*/</span></span><br><span class="line"><span class="selector-tag">transition-duration</span><span class="selector-pseudo">:1s</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*transition-delay：设置过渡延时*/</span></span><br><span class="line"><span class="selector-tag">transition-delay</span><span class="selector-pseudo">:2s</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*transition-timing-function:设置过渡的速度*/</span></span><br><span class="line"><span class="comment">/*linear，ease，ease-in，ease-out，ease-in-out， steps(10)*/</span></span><br><span class="line"><span class="selector-tag">transition-timing-function</span><span class="selector-pseudo">:linear</span>;</span><br></pre></td></tr></table></figure><p>【演示：过渡基本语法】</p><h2 id="属性合写"><a href="#属性合写" class="headerlink" title="属性合写"></a>属性合写</h2><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 属性 时间 延时 速度 */</span></span><br><span class="line"><span class="selector-tag">transition</span>: <span class="selector-tag">width</span> 1<span class="selector-tag">s</span> 3<span class="selector-tag">s</span> <span class="selector-tag">linear</span>;</span><br></pre></td></tr></table></figure><p>过渡的注意点：</p><ul><li>过渡必须要有两个状态的变化。</li><li>过渡可以写在A状态，也可以写在B状态，但是如果写在B状态，那么回来的时候，就没有过渡效果了。</li></ul><p>【案例：手风琴效果】</p><h1 id="2D转换"><a href="#2D转换" class="headerlink" title="2D转换"></a>2D转换</h1><blockquote><p>transform: 转换，是CSS3最具颠覆性的几个特性之一，既可以用于2D转换，也可以用于3D转换。</p><p>transform：2D转换，元素在平面上实现移动、旋转、缩放、斜切等操作</p></blockquote><h2 id="scale缩放"><a href="#scale缩放" class="headerlink" title="scale缩放"></a>scale缩放</h2><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">scaleX</span>(0<span class="selector-class">.5</span>);<span class="comment">/*让宽度变化*/</span></span><br><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">scaleY</span>(0<span class="selector-class">.5</span>);<span class="comment">/*让高度变化，注意不能写多个transform，不然会覆盖。*/</span></span><br><span class="line"><span class="selector-tag">transform</span>: <span class="selector-tag">scale</span>(0<span class="selector-class">.5</span>);<span class="comment">/*让宽度和高度同时变化*/</span></span><br></pre></td></tr></table></figure><p>注意：</p><ul><li>scale接收的值是倍数，因此没有单位</li><li>scale可以是一个值，如果是一个值，不是说仅仅缩放宽度，高度也会等比例的缩放。</li><li>可以通过transform-origin设定旋转原点</li></ul><h2 id="translate平移"><a href="#translate平移" class="headerlink" title="translate平移"></a>translate平移</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">transform: translateX(<span class="number">100</span>px);</span><br><span class="line">transform: translateY(<span class="number">100</span>px);</span><br><span class="line">transform: translate(<span class="number">100</span>px, <span class="number">100</span>px);</span><br><span class="line">transform: translate(<span class="number">50</span>%, <span class="number">50</span>%);</span><br></pre></td></tr></table></figure><p>注意：</p><ul><li>translate的值可以是px，也可以是百分比，如果是百分比，那么参照的是自身的宽高。</li><li>translate移动的元素并不会影响其他盒子，类似于相对定位。</li></ul><h2 id="rotate旋转"><a href="#rotate旋转" class="headerlink" title="rotate旋转"></a>rotate旋转</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">transform: rotate(<span class="number">360</span>deg);<span class="comment">//旋转360度</span></span><br><span class="line">transform: rotate(<span class="number">-360</span>deg);<span class="comment">//逆时针旋转360度</span></span><br></pre></td></tr></table></figure><p>注意：</p><ul><li>单位是deg，角度，不是px</li><li>正值顺时针转，负值逆时针转</li><li>可以通过transition-origin设定旋转原点</li></ul><h2 id="skew斜切-变形"><a href="#skew斜切-变形" class="headerlink" title="skew斜切(变形)"></a>skew斜切(变形)</h2><blockquote><p>skew在实际开发中，是用的最少的一个属性。一般来说，x和y只会倾斜其中的一个</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*在水平方向倾斜30deg*/</span></span><br><span class="line">transform: skewX(<span class="number">30</span>deg);</span><br><span class="line"><span class="comment">/*在垂直方向倾斜30deg*/</span></span><br><span class="line">transform: skewY(<span class="number">30</span>deg);</span><br></pre></td></tr></table></figure><p>【案例：扫光效果.html】</p><h2 id="transform-origin转换原点"><a href="#transform-origin转换原点" class="headerlink" title="transform-origin转换原点"></a>transform-origin转换原点</h2><blockquote><p>通过transform-origin可以设置转换的中心原点。</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">transform-origin: center center;</span><br><span class="line">transform-origin: <span class="number">40</span>px <span class="number">40</span>px;</span><br></pre></td></tr></table></figure><h2 id="转换合写问题"><a href="#转换合写问题" class="headerlink" title="转换合写问题"></a>转换合写问题</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">transform:translateX(<span class="number">800</span>px) scale(<span class="number">1.5</span>) rotate(<span class="number">360</span>deg) ;</span><br><span class="line"><span class="comment">//1. transform属性只能写一个，如果写了多个会覆盖</span></span><br><span class="line"><span class="comment">//2. transform属性可以连写，但是顺序对效果影响的，因为它会在第一个效果的基础上执行第二个效果，然后执行第三个效果（通常会把rotate放后面）</span></span><br><span class="line"><span class="comment">//3. 如果对transform进行过度效果的时候，初始状态和结束状态一一对应</span></span><br></pre></td></tr></table></figure><p>【案例：盾牌打散与合并效果.html】</p><h1 id="3D转换"><a href="#3D转换" class="headerlink" title="3D转换"></a>3D转换</h1><blockquote><p>transform:不仅可以2D转换，还可以进行3D转换。</p></blockquote><p>思考：2D与3D的区别？</p><h2 id="坐标轴"><a href="#坐标轴" class="headerlink" title="坐标轴"></a>坐标轴</h2><blockquote><p>用X、Y、Z分别表示空间的3个维度，三条轴互相垂直。<strong>注意+Y是向下的。</strong></p></blockquote><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn338xpF/43eWRH6lLSncPe1pJhVzbdBlJGKpztmEJJT6vUaks1cf1poK4OAJlcCHklTQBLJRiiWaQqGBzjOJBWoyNM7ccd52C*aEn5uDllDNU.zguZs!/b&bo=cAGSAXABkgEDGTw!&rf=viewer_4"  alt="img"></p><h2 id="perspective透视"><a href="#perspective透视" class="headerlink" title="perspective透视"></a>perspective透视</h2><blockquote><p>电脑显示屏是一个2D的平面，因为我们看不出来旋转的方向，通过perspective属性，可以定义3D 元素距视图的距离，单位是px。</p><p>说白了，设置了perspective属性后，就有了进大远小的效果了，在视觉上，让我们能看出来3d的效果。</p><p>注意：当为元素定义 perspective 属性时，其子元素会获得透视效果，而不是元素本身。</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">perspective：<span class="number">500</span>px;</span><br></pre></td></tr></table></figure><p>关于近大远小</p><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn338xpF/43eWRH6lLSncPe1pJhVzbW2BBphfeqyUmYEWhB5FcQP0TBi8TQ*qNHo**CdlPIiQUd87RQVXtg8hjiqy*.QiP8aef5Di88YB9ES67x4eI70!/b&bo=6QMlAukDJQIRGS4!&rf=viewer_4"  alt="img"></p><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn338xpF/43eWRH6lLSncPe1pJhVzbXGmrC4tAv0AXA9.9RY6YnKuW3ChcwP8K60cABekglTL9Gsva*mzq3E.BJwcw*S8vpSMKD06aXhIRE0AN2Cf8bc!/b&bo=AASqAgAEqgIRGS4!&rf=viewer_4"  alt="img"></p><p>对于我们眼睛来说，离我们越近的房子，我们会感觉到这个房子越大，离我们越远的房子，就会感觉越小，其实房子的大小都是一样的，只是在视觉上的一种不同。</p><h2 id="rotate旋转-1"><a href="#rotate旋转-1" class="headerlink" title="rotate旋转"></a>rotate旋转</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">transform: rotate(<span class="number">45</span>deg);<span class="comment">// 让元素在平面2D中旋转</span></span><br><span class="line">transform: rotateX(<span class="number">45</span>deg);<span class="comment">// 让元素沿着X轴转45度</span></span><br><span class="line">transform: rotateY(<span class="number">45</span>deg);<span class="comment">// 让元素沿着Y轴转45度</span></span><br><span class="line">transform: rotateZ(<span class="number">45</span>deg);<span class="comment">// 让元素沿着Z轴转45度</span></span><br></pre></td></tr></table></figure><p>【01-3D转换-旋转.html】</p><p>问题：看不出来怎么转的，为什么现实生活中能够看出来？</p><h2 id="translate平移-1"><a href="#translate平移-1" class="headerlink" title="translate平移"></a>translate平移</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*沿着X轴的正方向移动45px*/</span></span><br><span class="line">transform: translateX(<span class="number">45</span>px);</span><br><span class="line"><span class="comment">/*沿着Y轴的正方向移动45px*/</span></span><br><span class="line">transform: translateY(<span class="number">45</span>px);</span><br><span class="line"><span class="comment">/*沿着Y轴的正方向移动45px*/</span></span><br><span class="line">transform: translateZ(<span class="number">45</span>px);</span><br></pre></td></tr></table></figure><p>【02-3D转换-平移.html】</p><p>【立方体.html】</p><h2 id="transform-style"><a href="#transform-style" class="headerlink" title="transform-style"></a>transform-style</h2><blockquote><p>transform-style 属性规定如何在 3D 空间中呈现被嵌套的元素。注意这个属性只能给父元素添加。</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">flat:默认值，<span class="number">2</span>d显示</span><br><span class="line">preserve<span class="number">-3</span>d: <span class="number">3</span>d显示</span><br></pre></td></tr></table></figure><p>transform-style与perspective的区别</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*透视：透视只是相当于设置了一个距离，辅助我们查看3D效果的工具，*/</span></span><br><span class="line"><span class="comment">/*preserve-3d:给父盒子添加，让子元素保留3D的位置，说白了，只有设置了preserve-3d，这个元素才能被称之为3d元素。 */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//一个3d元素可以没有perspective，但是不能没有transform-style</span></span><br></pre></td></tr></table></figure><p>【3d导航案例.html】</p><p>【切割轮播图案例】</p><p>【美女相册案例】</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;渐变&quot;&gt;&lt;a href=&quot;#渐变&quot; class=&quot;headerlink&quot; title=&quot;渐变&quot;&gt;&lt;/a&gt;渐变&lt;/h1&gt;&lt;h2 id=&quot;线性渐变&quot;&gt;&lt;a href=&quot;#线性渐变&quot; class=&quot;headerlink&quot; title=&quot;线性渐变&quot;&gt;&lt;/a&gt;线性渐变&lt;/h
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>CSS3-01</title>
    <link href="http://yoursite.com/2019/12/20/CSS3-01/"/>
    <id>http://yoursite.com/2019/12/20/CSS3-01/</id>
    <published>2019-12-20T03:10:31.000Z</published>
    <updated>2020-04-17T06:08:28.835Z</updated>
    
    <content type="html"><![CDATA[<h1 id="CSS3简介"><a href="#CSS3简介" class="headerlink" title="CSS3简介"></a>CSS3简介</h1><blockquote><p> 如同人类的的进化一样，CSS3是CSS2的“进化”版本，在CSS2基础上，<strong>增强</strong> 或<strong>新增</strong> 了许多特性， 弥补了CSS2的众多不足之处，使得Web开发变得更为高效和便捷。 </p></blockquote><h2 id="CSS3的现状"><a href="#CSS3的现状" class="headerlink" title="CSS3的现状"></a>CSS3的现状</h2><ul><li>PC端浏览器支持程度差，需要添加私有前缀</li><li>移动端支持优于PC端</li><li>不断改进中</li><li>应用相对广泛</li></ul><p>关于私有前缀：</p><blockquote><p>在标准还未确定时，部分浏览器已经根据最初草案实现了部分功能，为了与之后确定下来的标准进行兼容，所以每种浏览器使用了自己的私有前缀与标准进行区分，当标准确立后，各大浏览器将逐步支持不带前缀的css3新属性</p><p>目前已有很多私有前缀可以不写了，但为了兼容老版本的浏览器，可以仍沿用私有前缀和标准方法，逐渐过渡。</p><p>一般来说，移动端更新迭代很快，对CSS3支持良好, 因此我们在移动端没必要写太多的前缀，因为移动端的ios和Android的浏览器都是webkit内核。</p></blockquote><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">谷歌、苹果浏览器：-webkit-</span><br><span class="line">火狐浏览器：-moz-</span><br><span class="line">IE浏览器：-ms-</span><br><span class="line">欧朋浏览器：-o-</span><br></pre></td></tr></table></figure><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: pink;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">100px</span> auto;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*谷歌浏览器和safari浏览器的前缀 -webkit-*/</span></span><br><span class="line">    <span class="attribute">-webkit-transform</span>: <span class="built_in">rotate</span>(<span class="number">45deg</span>);</span><br><span class="line">    <span class="comment">/*火狐浏览器的前缀 -moz-*/</span></span><br><span class="line">    <span class="attribute">-moz-transform</span>: <span class="built_in">rotate</span>(<span class="number">45deg</span>);</span><br><span class="line">    <span class="comment">/*ie浏览器的前缀 -ms-*/</span></span><br><span class="line">    <span class="attribute">-ms-transform</span>: <span class="built_in">rotate</span>(<span class="number">45deg</span>);</span><br><span class="line">    <span class="comment">/*opera浏览器的前缀 -o-*/</span></span><br><span class="line">    <span class="attribute">-o-transform</span>: <span class="built_in">rotate</span>(<span class="number">45deg</span>);</span><br><span class="line">    <span class="comment">/*规范化后的写法*/</span></span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">45deg</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>【css3初体验】</p><h1 id="CSS3选择器"><a href="#CSS3选择器" class="headerlink" title="CSS3选择器"></a>CSS3选择器</h1><h2 id="关系选择器"><a href="#关系选择器" class="headerlink" title="关系选择器"></a>关系选择器</h2><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn338xpF/uUnjQtxoKSmXQ5.YSnl4gJXDDrRhrnF6QglHAEdA7YjAMC9o8.6JLKtMp512OqvHujhOfcNTQc.RjqieiOVsZA!!/b&bo=oAMbAaADGwEDCSw!&rf=viewer_4"  alt="img"></p><h2 id="属性选择器"><a href="#属性选择器" class="headerlink" title="属性选择器"></a>属性选择器</h2><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn338xpF/43eWRH6lLSncPe1pJhVzbYnQ*dsfNniKRhRa5Bjq0otxcwByLoCArNuVwS.S6aKHm*c32W6eotRFIm.lQFWVsy3gvMvtrdKeL1vrO0DQlWI!/b&bo=nwNPAZ8DTwEDGTw!&rf=viewer_4"  alt="img"></p><h2 id="伪类选择器"><a href="#伪类选择器" class="headerlink" title="伪类选择器"></a>伪类选择器</h2><blockquote><p>伪类选择器的语法：都带有一个 冒号 <code>:</code></p></blockquote><h3 id="child系列（重点）"><a href="#child系列（重点）" class="headerlink" title="child系列（重点）"></a>child系列（重点）</h3><p><img src="/" class="lazyload" data-src="http://m.qpic.cn/psc?/V1497zRn338xpF/43eWRH6lLSncPe1pJhVzbXgDZvD4ppx5UNvqW2l.xdajsJyodmmvdjYPMUvXQFu0AZNjbz4WyGov7UvMQFe7E61gx9jfOCkJMsLxLRKY3ZM!/b&bo=nANRAZwDUQEDGTw!&rf=viewer_4"  alt="img"></p><p>思考：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">1. 第一列变成红色</span><br><span class="line">2. 最后一列变成红色</span><br><span class="line">3. 倒数第二列变成红色</span><br></pre></td></tr></table></figure><h3 id="其他伪类选择器"><a href="#其他伪类选择器" class="headerlink" title="其他伪类选择器"></a>其他伪类选择器</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">:of-type系列，  用法与child系列很像，但是找的是子元素中对应类型的下标（了解，用的不多）</span><br><span class="line">:focus    查找获取到焦点的文本框</span><br><span class="line">:checked 获得选中的checkbox</span><br><span class="line">:disabled 获得不可用的框</span><br><span class="line">:enabled 获得可用的框</span><br><span class="line">:not(selector)选择不匹配selector的那些元素</span><br><span class="line">:target  获取当前活跃的锚链接</span><br></pre></td></tr></table></figure><h2 id="伪元素选择器"><a href="#伪元素选择器" class="headerlink" title="伪元素选择器"></a>伪元素选择器</h2><h3 id="before和after"><a href="#before和after" class="headerlink" title="before和after"></a>before和after</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">注意事项：</span><br><span class="line">&#x2F;&#x2F;1.    必须指定content属性，可以在content属性中写入文本内容，但是通常为空字符串。</span><br><span class="line">&#x2F;&#x2F;2.    默认是行内元素，无法设置宽高，需要指定display:block或者position:absolute</span><br><span class="line">E::before :在元素子节点的最前面添加一个内容。</span><br><span class="line">E::after  :在元素子节点的最后面添加一个内容。</span><br></pre></td></tr></table></figure><p>关于单冒号和双冒号问题：</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">关于:before与::before的区别</span><br><span class="line">:before是css2中伪元素的写法，但是呢，在css3中严格规定，伪类采用单冒号，伪元素需要使用双冒号。为了兼容旧的代码，当浏览器碰到了:before之后，会自动的转换成::before。</span><br><span class="line">如果需要兼容老的浏览器，比如IE678，推荐使用:before</span><br><span class="line">如果不需要兼容老的浏览器，比如移动端，推荐使用::before</span><br></pre></td></tr></table></figure><h3 id="其他伪元素选择器"><a href="#其他伪元素选择器" class="headerlink" title="其他伪元素选择器"></a>其他伪元素选择器</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">::first-letter  :获取元素的第一个字符</span><br><span class="line">::first-line   :获取元素的第一行</span><br><span class="line">::selection   ：获取选中的元素</span><br></pre></td></tr></table></figure><h1 id="CSS3阴影"><a href="#CSS3阴影" class="headerlink" title="CSS3阴影"></a>CSS3阴影</h1><h2 id="如何查看css3文档"><a href="#如何查看css3文档" class="headerlink" title="如何查看css3文档"></a>如何查看css3文档</h2><p>学会使用工具，可以让我们事半功倍。</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">[]        表示全部可选项</span><br><span class="line">||        表示或者</span><br><span class="line">|        表示多选一</span><br><span class="line">？       表示0个或者1个</span><br><span class="line">*        表示0个或者多个</span><br><span class="line">&#123;2,3&#125;        表示范围</span><br></pre></td></tr></table></figure><h2 id="文字阴影"><a href="#文字阴影" class="headerlink" title="文字阴影"></a>文字阴影</h2><blockquote><p>text-shadow:文字阴影</p></blockquote><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">语法： text-shadow：水平偏移 垂直偏移 羽化大小 颜色</span><br></pre></td></tr></table></figure><h2 id="边框阴影"><a href="#边框阴影" class="headerlink" title="边框阴影"></a>边框阴影</h2><blockquote><p>box-shadow:边框阴影</p></blockquote><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">none： 无阴影 </span><br><span class="line">&lt;length&gt;：第1个长度值用来设置对象的阴影水平偏移值。可以为负值 </span><br><span class="line">&lt;length&gt;：第2个长度值用来设置对象的阴影垂直偏移值。可以为负值 </span><br><span class="line">&lt;length&gt;：如果提供了第3个长度值则用来设置对象的阴影模糊值。不允许负值 </span><br><span class="line">&lt;length&gt;：如果提供了第4个长度值则用来设置对象的阴影外延值。可以为负值 </span><br><span class="line">&lt;color&gt;：设置对象的阴影的颜色。 </span><br><span class="line">inset：设置对象的阴影类型为内阴影。该值为空时，则对象的阴影类型为外阴影</span><br></pre></td></tr></table></figure><h1 id="CSS3背景"><a href="#CSS3背景" class="headerlink" title="CSS3背景"></a>CSS3背景</h1><blockquote><p>在css2中已经有background属性了，用于设置盒子的背景相关的一些样式，在CSS3中新增加了几个背景相关的几个属性。</p></blockquote><h2 id="background-size"><a href="#background-size" class="headerlink" title="background-size"></a>background-size</h2><blockquote><p>用户设置背景图片的尺寸大小</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//注意：这两种设置方式会导致图片失真。</span></span><br><span class="line"><span class="comment">/*background-size:设置背景图片的大小*/</span></span><br><span class="line">background-size: <span class="number">600</span>px <span class="number">400</span>px;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 百分比是相对于盒子自身的宽度和高度 */</span></span><br><span class="line">background-size: <span class="number">100</span>% <span class="number">100</span>%;</span><br></pre></td></tr></table></figure><p>不失真的设置方式（等比例缩放）</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*containe保证等比例缩放,但是会出现留白*/</span></span><br><span class="line">background-size: contain;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*cover保证等比例缩放,并且不会留白，但是出现有一部分图片不显示*/</span></span><br><span class="line">background-size: cover;</span><br></pre></td></tr></table></figure><p>【演示：01-background-size的使用.html】</p><p>【案例：02-全屏背景.html】</p><h2 id="background-clip"><a href="#background-clip" class="headerlink" title="background-clip"></a>background-clip</h2><blockquote><p>设置背景区域的大小</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*盒子的背景区域是整个盒子，包括边框和padding*/</span></span><br><span class="line"><span class="comment">/*默认值，设置背景区域包括了边框*/</span></span><br><span class="line">background-clip: border-box;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*背景区域只包含padding和content*/</span></span><br><span class="line">background-clip: padding-box;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*背景区域只包含content*/</span></span><br><span class="line">background-clip: content-box;</span><br></pre></td></tr></table></figure><p>【演示：03-background-clip.html】</p><h2 id="background-origin"><a href="#background-origin" class="headerlink" title="background-origin"></a>background-origin</h2><blockquote><p>设置背景图片的原点的位置，默认是padding的地方开始</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">background-image: url(images/bg.jpg);</span><br><span class="line"><span class="comment">/*设置原点从border开始*/</span></span><br><span class="line">background-origin: border-box;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*设置原点从padding开始,默认值*/</span></span><br><span class="line">background-origin: padding-box;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*设置原点从content开始*/</span></span><br><span class="line">background-origin: content-box;</span><br></pre></td></tr></table></figure><p>【演示：04-background-origin.html】</p><h2 id="多重背景"><a href="#多重背景" class="headerlink" title="多重背景"></a>多重背景</h2><blockquote><p>background设置背景的时候，可以设置多个背景图片，使用逗号隔开。注意颜色只能设置一次，并且通常来说，颜色都是在最后面进行设置。</p><p>background是一个合写的属性，如果在background之前设置了background相关的样式，会被覆盖掉。</p></blockquote><figure class="highlight"><table><tr><td class="code"><pre><span class="line">background: url(images/mn1.jpg) no-repeat top left, url("images/mn2.jpg") no-repeat right bottom, pink;</span><br></pre></td></tr></table></figure><p>【多重背景-语法.html】</p><p>【多重背景-小泡泡.html】</p><p>【多重背景的应用.html】</p><h1 id="CSS3渐变"><a href="#CSS3渐变" class="headerlink" title="CSS3渐变"></a>CSS3渐变</h1><h2 id="线性渐变"><a href="#线性渐变" class="headerlink" title="线性渐变"></a>线性渐变</h2><blockquote><p>linear-gradient指沿着某条直线朝一个方向产生的渐变效果。</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//注意：渐变实际上相当与一张图片，因为需要加给background-image才会生效</span></span><br><span class="line"><span class="comment">//渐变的两个要求：有区间，有颜色变化。</span></span><br><span class="line"><span class="comment">//最简单的渐变</span></span><br><span class="line">background-image: linear-gradient(red, green);</span><br><span class="line"><span class="comment">//设定渐变的方向</span></span><br><span class="line">background-image: linear-gradient(to right, red, green);</span><br><span class="line"><span class="comment">//也可以设定渐变的角度</span></span><br><span class="line">background-image: linear-gradient(<span class="number">45</span>deg, red, green);</span><br><span class="line"><span class="comment">//设定渐变的范围</span></span><br><span class="line">background-image: linear-gradient(to right, red <span class="number">20</span>%, green <span class="number">80</span>%)</span><br><span class="line"><span class="comment">//每一个区间表示渐变颜色的范围</span></span><br><span class="line">background-image: linear-gradient(to right, red <span class="number">20</span>%, green <span class="number">20</span>%)</span><br></pre></td></tr></table></figure><p>【演示：01-渐变-线性渐变.html】</p><p>【演示：02-导航按钮.html】</p><p>【案例：03-渐变-案例-发廊效果.html】</p><h2 id="径向渐变"><a href="#径向渐变" class="headerlink" title="径向渐变"></a>径向渐变</h2><blockquote><p>radial-gradient指从一个中心点开始沿着四周产生渐变效果</p></blockquote><figure class="highlight css"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*1. 最简单的渐变*/</span></span><br><span class="line"><span class="selector-tag">background-image</span>: <span class="selector-tag">radial-gradient</span>(<span class="selector-tag">red</span>, <span class="selector-tag">green</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*2. 指定圆的半径和圆心*/</span></span><br><span class="line"><span class="selector-tag">background-image</span>: <span class="selector-tag">radial-gradient</span>(200<span class="selector-tag">px</span> <span class="selector-tag">at</span> <span class="selector-tag">center</span>, <span class="selector-tag">red</span>, <span class="selector-tag">green</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*3. 指定椭圆*/</span></span><br><span class="line"><span class="selector-tag">background-image</span>: <span class="selector-tag">radial-gradient</span>(200<span class="selector-tag">px</span> 80<span class="selector-tag">px</span> <span class="selector-tag">at</span> <span class="selector-tag">center</span>, <span class="selector-tag">red</span>, <span class="selector-tag">green</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*4. 指定范围*/</span></span><br><span class="line"><span class="selector-tag">background-image</span>: <span class="selector-tag">radial-gradient</span>(200<span class="selector-tag">px</span> <span class="selector-tag">at</span> <span class="selector-tag">center</span>, <span class="selector-tag">green</span> 50%, <span class="selector-tag">red</span> 50%);</span><br></pre></td></tr></table></figure><h1 id="CSS3盒子模型"><a href="#CSS3盒子模型" class="headerlink" title="CSS3盒子模型"></a>CSS3盒子模型</h1><blockquote><p>CSS3中可以通过box-sizing 来指定盒模型，即可指定为content-box、border-box，这样我们计算盒子大小的方式就发生了改变。</p></blockquote><p>可以分成两种情况： </p><ul><li>box-sizing: border-box 计算方式为content = width – border - padding </li><li>box-sizing: content-box 计算方式为content = width</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;CSS3简介&quot;&gt;&lt;a href=&quot;#CSS3简介&quot; class=&quot;headerlink&quot; title=&quot;CSS3简介&quot;&gt;&lt;/a&gt;CSS3简介&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt; 如同人类的的进化一样，CSS3是CSS2的“进化”版本，在CSS2基础上，&lt;st
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>ajax</title>
    <link href="http://yoursite.com/2019/12/09/ajax/"/>
    <id>http://yoursite.com/2019/12/09/ajax/</id>
    <published>2019-12-09T10:23:57.000Z</published>
    <updated>2020-04-14T03:04:23.001Z</updated>
    
    <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>我们使用php动态渲染页面时，有很多比较麻烦的地方。</p><ul><li>在前端写好页面以后，需要后台进行修改，意味这后端程序员也需要懂前端的知识，其实渲染的工作应该交给前端来做。</li><li>前端没有写好页面的话，后端无法开始工作，需要等待前端的页面完成之后才能开始工作，拖延项目的进度。</li><li>这种渲染，属于同步渲染，先获取数据, 如果数据获取的慢了, 会严重影响整个页面渲染速度</li></ul><p>【演示：同步渲染】</p><h1 id="http-协议回顾"><a href="#http-协议回顾" class="headerlink" title="http 协议回顾"></a>http 协议回顾</h1><blockquote><p>HTTP协议，即超文本传输协议(Hypertext transfer protocol)。是一种详细规定了浏览器和服务器之间互相通信的规则</p><p>HTTP协议规定了<strong>请求</strong> 和<strong>响应</strong> 的标准</p></blockquote><h2 id="请求与请求报文"><a href="#请求与请求报文" class="headerlink" title="请求与请求报文"></a>请求与请求报文</h2><p><strong>get请求的请求报文详解</strong> </p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//--------------------------请求行--------------------------------</span></span><br><span class="line"><span class="comment">// GET  请求方式</span></span><br><span class="line"><span class="comment">// /day02/01.php?username=pp&amp;password=123456    请求路径+参数（注意点）</span></span><br><span class="line"><span class="comment">// HTTP/1.1 HTTP的版本号</span></span><br><span class="line">GET /day02/<span class="number">01.</span>php?username=pp&amp;password=<span class="number">123456</span> HTTP/<span class="number">1.1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//--------------------------请求头--------------------------------</span></span><br><span class="line">Host: www.study.com</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; WOW64) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Chrome/<span class="number">58.0</span><span class="number">.3029</span><span class="number">.96</span> Safari/<span class="number">537.36</span></span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/webp,<span class="string">`*/*`</span>;q=<span class="number">0.8</span></span><br><span class="line">Accept-Encoding: gzip, deflate, sdch</span><br><span class="line">Accept-Language: zh-CN,zh;q=<span class="number">0.8</span>,en;q=<span class="number">0.6</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//----------------------------请求体-------------------------------------</span></span><br><span class="line"><span class="comment">//get请求没有请求体，但是参数会拼接到请求行中</span></span><br></pre></td></tr></table></figure><p><strong>POST请求的请求报文</strong> </p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//-----------------------请求行---------------------------------------------</span></span><br><span class="line">POST /day02/<span class="number">01.</span>php HTTP/<span class="number">1.1</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//-----------------------请求头--------------------------------------------</span></span><br><span class="line">Host: www.study.com</span><br><span class="line">Connection: keep-alive</span><br><span class="line"><span class="comment">//传递的参数的长度。</span></span><br><span class="line">Content-Length: <span class="number">29</span></span><br><span class="line">Cache-Control: max-age=<span class="number">0</span></span><br><span class="line">Origin: http:<span class="comment">//www.study.com</span></span><br><span class="line">Upgrade-Insecure-Requests: <span class="number">1</span></span><br><span class="line">User-Agent: Mozilla/<span class="number">5.0</span> (Windows NT <span class="number">10.0</span>; WOW64) AppleWebKit/<span class="number">537.36</span> (KHTML, like Gecko) Chrome/<span class="number">58.0</span><span class="number">.3029</span><span class="number">.96</span> Safari/<span class="number">537.36</span></span><br><span class="line"><span class="comment">//内容类型：表单数据，如果是post请求，必须指定这个属性。</span></span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=<span class="number">0.9</span>,image/webp,<span class="string">`*/*`</span>;q=<span class="number">0.8</span></span><br><span class="line">Referer: http:<span class="comment">//www.study.com/day02/01-login.html</span></span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept-Language: zh-CN,zh;q=<span class="number">0.8</span>,en;q=<span class="number">0.6</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//------------------------请求体------------------------------------------</span></span><br><span class="line">username=pp&amp;password=<span class="number">123456</span></span><br></pre></td></tr></table></figure><p><strong>GET请求与POST请求的对比</strong> </p><ul><li>GET请求没有请求体，因为GET请求的参数拼接到地址栏中了</li><li>POST请求有请求体，就是传递的参数</li><li>POST请求需要指定content-type属性。</li></ul><h2 id="响应与响应报文"><a href="#响应与响应报文" class="headerlink" title="响应与响应报文"></a>响应与响应报文</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//---------------------状态行（响应行）-------------------------------</span></span><br><span class="line"><span class="comment">//HTTP/1.1  HTTP版本</span></span><br><span class="line"><span class="comment">//200 响应的状态</span></span><br><span class="line"><span class="comment">//200表示成功</span></span><br><span class="line"><span class="comment">//304表示读缓存</span></span><br><span class="line"><span class="comment">//404表示找不到资源</span></span><br><span class="line"><span class="comment">//500表示服务端错误</span></span><br><span class="line">HTTP/<span class="number">1.1</span> <span class="number">200</span> OK</span><br><span class="line"></span><br><span class="line"><span class="comment">//----------------------响应头-----------------------------------------------</span></span><br><span class="line"><span class="built_in">Date</span>: Thu, <span class="number">22</span> Jun <span class="number">2017</span> <span class="number">16</span>:<span class="number">51</span>:<span class="number">22</span> GMT</span><br><span class="line">Server: Apache/<span class="number">2.4</span><span class="number">.23</span> (Win32) OpenSSL/<span class="number">1.0</span><span class="number">.2</span>j PHP/<span class="number">5.4</span><span class="number">.45</span></span><br><span class="line">X-Powered-By: PHP/<span class="number">5.4</span><span class="number">.45</span></span><br><span class="line">Content-Length: <span class="number">18</span></span><br><span class="line">Keep-Alive: timeout=<span class="number">5</span>, max=<span class="number">100</span></span><br><span class="line">Connection: Keep-Alive</span><br><span class="line"><span class="comment">//内容类型，告诉浏览器该如何解析响应结果</span></span><br><span class="line">Content-Type: text/html;charset=utf<span class="number">-8</span></span><br><span class="line"><span class="comment">//-----------------------响应体------------------------------------------------</span></span><br><span class="line">hello world</span><br></pre></td></tr></table></figure><h1 id="AJAX"><a href="#AJAX" class="headerlink" title="AJAX"></a>AJAX</h1><blockquote><p>即 Asynchronous [e’sɪŋkrənəs] Javascript And XML， AJAX 不是一门的新的语言，而是对现有技术的综合利用。 本质是在HTTP协议的基础上以异步的方式与服务器进行通信。</p></blockquote><h2 id="同步与异步"><a href="#同步与异步" class="headerlink" title="同步与异步"></a>同步与异步</h2><p>同步和异步概念：</p><p>同步: 指的就是事情要一件一件做。等做完前一件才能做后一件任务</p><p>异步: 不受当前任务的影响，两件事情同时进行，做一件事情时，不影响另一件事情的进行。</p><p>编程中：异步程序代码执行时不会阻塞其它程序代码执行,从而提升整体执行效率。</p><p><img src="/" class="lazyload" data-src="/.com//01-%E8%8C%B6%E6%B0%B4.png"  alt></p><p>网页异步应用：</p><ol><li>验证你的用户名是否已经存在（一边输入，一边获取你的信息，和后台比对）。</li><li>百度搜索提示，及相关内容展示（一边输入，一边找出了你可能要的内容）。</li><li>新浪微博评论（异步加载）。</li></ol><p>XMLHttpRequest可以以异步方式的请求数据处理程序,  可实现对网页的部分更新， 而不是刷新整个页面</p><h2 id="XMLHttpRequest对象"><a href="#XMLHttpRequest对象" class="headerlink" title="XMLHttpRequest对象"></a>XMLHttpRequest对象</h2><blockquote><p>浏览器内建对象，用于与服务器通信(交换数据) ，可以发送ajax请求。 由此我们便可实现对网页的部分更新，而不是刷新整个页面。这个请求是异步的，即在往服务器发送请求时，并不会阻碍程序的运行，浏览器会继续渲染后续的结构。</p></blockquote><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">请求由客户端发起，其规范格式为：请求行、请求头、请求主体。</span><br></pre></td></tr></table></figure><p><img src="/" class="lazyload" data-src="/.com//02-%E8%AF%B7%E6%B1%82%E8%A7%84%E8%8C%83%E6%A0%BC%E5%BC%8F.png"  alt></p><h3 id="发送get请求"><a href="#发送get请求" class="headerlink" title="发送get请求"></a>发送get请求</h3><p>XMLHttpRequest以异步的方式发送HTTP请求，因此在发送请求时，一样需要遵循HTTP协议。</p><blockquote><p> 使用XMLHttpRequest发送get请求的步骤</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1. 创建一个XMLHttpRequest对象</span></span><br><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line"></span><br><span class="line"><span class="comment">//2. 设置请求行</span></span><br><span class="line"><span class="comment">// 第一个参数:请求方式  get/post</span></span><br><span class="line"><span class="comment">// 第二个参数:请求的地址 需要在url后面拼上参数列表</span></span><br><span class="line"><span class="comment">//第三个参数：是否异步 默认true，可不写</span></span><br><span class="line">xhr.open(<span class="string">"get"</span>, <span class="string">"01.php?name=Jepson&amp;age18"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//3. 设置请求头</span></span><br><span class="line"><span class="comment">//请求头中可以设置Content-Type,用以说明请求主体的内容是如何编码,get请求时没有请求体,无需设置</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//4. 设置请求体</span></span><br><span class="line"><span class="comment">//send（请求体）</span></span><br><span class="line"><span class="comment">//get请求的请求体为空,因为参数列表拼接到url后面了</span></span><br><span class="line">xhr.send(<span class="literal">null</span>);</span><br></pre></td></tr></table></figure><p>注意点 :</p><ul><li>get请求,设置请求行时,需要把参数列表拼接到url后面</li><li>get请求不用设置请求头, 不用说明请求主体的编码方式</li><li>get请求的请求体为null</li></ul><h3 id="发送post请求"><a href="#发送post请求" class="headerlink" title="发送post请求"></a>发送post请求</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 1. 设置请求行 post请求的参数列表在请求体</span></span><br><span class="line">xhr.open(<span class="string">"post"</span>, <span class="string">"02.php"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2. 设置请求头, post 请求必须要设置 content-type, 标记请求体内容的解析方式, 不然后端无法解析获取数据</span></span><br><span class="line">xhr.setRequestHeader( <span class="string">"content-type"</span>, <span class="string">"application/x-www-form-urlencoded"</span> );</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3. 设置请求体</span></span><br><span class="line">xhr.send( <span class="string">"name=Jepson&amp;age=18"</span> );</span><br></pre></td></tr></table></figure><p>注意点 :</p><ul><li>post请求, 设置请求行时, 不拼接参数列表</li><li>post必须设置请求头中的content-type为application/x-www-form-urlencoded, 标记请求体解析方式</li><li>post 请求需要将参数列表设置到请求体中</li></ul><h3 id="获取响应-readyState"><a href="#获取响应-readyState" class="headerlink" title="获取响应 readyState"></a>获取响应 readyState</h3><p>readyState:记录了XMLHttpRequest对象的当前状态</p><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">readyState有五种可能的值：</span><br><span class="line">xhr.readyState &#x3D; 0时，UNSENT open尚未调用</span><br><span class="line">xhr.readyState &#x3D; 1时，OPENED open已调用</span><br><span class="line">xhr.readyState &#x3D; 2时，HEADERS_RECEIVED 接收到响应头信息</span><br><span class="line">xhr.readyState &#x3D; 3时，LOADING 接收到响应主体</span><br><span class="line">xhr.readyState &#x3D; 4时，DONE 响应完成</span><br><span class="line"></span><br><span class="line">不用记忆状态，只需要了解有状态变化这个概念</span><br></pre></td></tr></table></figure><p>HTTP响应分为3个部分，状态行、响应头、响应体。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//给xhr注册一个onreadystatechange事件，当xhr的状态发生状态发生改变时，会触发这个事件。</span></span><br><span class="line">xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">if</span>(xhr.readyState == <span class="number">4</span>)&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//1. 获取状态行</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"状态行:"</span>+xhr.status);<span class="comment">//200</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//2. 获取响应头</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"所有的响应头:"</span>+xhr.getAllResponseHeaders());</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"指定响应头:"</span>+xhr.getResponseHeader(<span class="string">"content-type"</span>));</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//3. 获取响应体</span></span><br><span class="line">    <span class="built_in">console</span>.log(xhr.responseText);</span><br><span class="line">    </span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h3><p>【判断用户名是否存在】//in_array($content,$arr) 判断$content在$arr中是否存在，如果存在，输出true,否则false</p><p>【用户登录案例】</p><h2 id="数据交互"><a href="#数据交互" class="headerlink" title="数据交互"></a>数据交互</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">浏览器端只是负责用户的交互和数据的收集以及展示，真正的数据都是存储在服务器端的。</span><br><span class="line"></span><br><span class="line">我们现在通过ajax的确可以返回一些简单的数据（一个字符串）, </span><br><span class="line">但是在实际开发过程中，肯定会会设计到大量的复杂类型的数据传输，</span><br><span class="line">比如数组、对象等，但是每个编程语言的语法都不一样。</span><br><span class="line"></span><br><span class="line">因此我们会采用通过的数据交换格式（XML、JSON）来进行数据的交互。</span><br></pre></td></tr></table></figure><h3 id="XML-了解即可"><a href="#XML-了解即可" class="headerlink" title="XML(了解即可)"></a>XML(了解即可)</h3><p><strong>什么是XML</strong></p><ul><li>XML 指可扩展标记语言（EXtensible Markup Language）</li><li>XML 是一种标记语言，很类似 HTML</li><li>XML 的设计宗旨是传输数据，而非显示数据</li><li>XML 标签没有被预定义。您需要自行定义标签。</li></ul><p><strong>语法规范</strong></p><ul><li>第一行必须是版本信息</li><li>必须有一个根元素（有且仅有一个）</li><li>标签不可有空格、不可以数字或.开头、大小写敏感</li><li>不可交叉嵌套，都是双标签，如果是单标签，必须闭合</li><li>属性双引号（浏览器自动修正成双引号了）</li><li>特殊符号要使用实体</li><li>注释和HTML一样</li></ul><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="utf-8" ?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">students</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">student</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>张三<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">age</span>&gt;</span>18<span class="tag">&lt;/<span class="name">age</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">gender</span>&gt;</span>男<span class="tag">&lt;/<span class="name">gender</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">desc</span>&gt;</span>路人甲<span class="tag">&lt;/<span class="name">desc</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">student</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">student</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>李四<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">age</span>&gt;</span>20<span class="tag">&lt;/<span class="name">age</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">gender</span>&gt;</span>男<span class="tag">&lt;/<span class="name">gender</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">desc</span>&gt;</span>路人乙<span class="tag">&lt;/<span class="name">desc</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">student</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">students</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>php获取xml文件的内容</strong></p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 注意: 如果需要返回 xml 数据, 需要将 content-type 改成 text/xml, 不然浏览器以 text/html 解析</span></span><br><span class="line">header( <span class="string">'content-type:text/xml;charset=utf-8'</span> );</span><br><span class="line"><span class="comment">// file_get_content 用于获取文件的内容</span></span><br><span class="line"><span class="comment">// 参数: 文件的路径</span></span><br><span class="line">$result = file_get_content( <span class="string">"data.xml"</span> );</span><br><span class="line"><span class="keyword">echo</span> $result;</span><br></pre></td></tr></table></figure><p><strong>js解析xml</strong></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//获取服务端返回的xml数据，需要使用xhr.responseXML，这是一个document对象，可以使用DOM中的方法查找元素。</span></span><br><span class="line"><span class="keyword">var</span> data = xhr.responseXML;</span><br><span class="line"><span class="comment">//获取所有的学生</span></span><br><span class="line"><span class="keyword">var</span> students = data.querySelectorAll(<span class="string">"student"</span>);</span><br></pre></td></tr></table></figure><p>缺点：虽然可以描述和传输复杂数据，但是其解析过于复杂,  并且体积较大，所以实现开发已经很少使用了。</p><h3 id="JSON数据"><a href="#JSON数据" class="headerlink" title="JSON数据"></a>JSON数据</h3><p>JSON(JavaScript Object Notation, JS 对象标记) 是一种轻量级的数据交换格式。它基于 ECMAScript 规范，采用独立于编程语言的文本格式来存储和表示数据。</p><ul><li>数据在 键值对 中</li><li>数据由逗号分隔(最后一个 键值对 不能带逗号)</li><li>花括号保存对象，方括号保存数组</li><li>键使用双引号</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">a</span>: <span class="string">'Hello'</span>, <span class="attr">b</span>: <span class="string">'World'</span>&#125;; <span class="comment">//这是一个对象</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 这是一个 JSON 字符串，本质是一个字符串</span></span><br><span class="line"><span class="keyword">var</span> json = <span class="string">'&#123;"a": "Hello", "b": "World"&#125;'</span>;</span><br></pre></td></tr></table></figure><p><strong>JSON数据在不同语言进行传输时，类型为字符串，不同的语言各自也都对应有解析方法，解析完成后就能很方便的使用了</strong></p><h4 id="php处理json"><a href="#php处理json" class="headerlink" title="php处理json"></a>php处理json</h4><ul><li>php关联数组 ==&gt;  json   ( json_encode )</li></ul><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">// php的关联数组</span></span><br><span class="line">$obj = <span class="keyword">array</span>(</span><br><span class="line">  <span class="string">"a"</span> =&gt; <span class="string">"hello"</span>,</span><br><span class="line">  <span class="string">"b"</span> =&gt; <span class="string">"world"</span>,</span><br><span class="line">  <span class="string">"name"</span> =&gt; <span class="string">"鹏鹏"</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">//json字符串</span></span><br><span class="line">$json = json_encode( $obj );</span><br><span class="line"><span class="keyword">echo</span> $json;</span><br></pre></td></tr></table></figure><ul><li>json ==&gt; php对象/关联数组    ( json_decode )</li></ul><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">$json = <span class="string">'&#123;"a": "Hello", "b": "World"&#125;'</span>;<span class="comment">//json字符串</span></span><br><span class="line"><span class="comment">//第一个参数：json字符串</span></span><br><span class="line"><span class="comment">//第二个参数：</span></span><br><span class="line"><span class="comment">//false，将json转换成对象(默认)</span></span><br><span class="line"><span class="comment">//true：将json转换成数组(推荐)</span></span><br><span class="line">$obj = json_decode($json,<span class="keyword">true</span>);</span><br><span class="line"><span class="keyword">echo</span> $obj[<span class="string">'a'</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//通过json文件获取到的内容就是一个json字符串。</span></span><br><span class="line">$data = file_get_contents(<span class="string">"data.json"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//将json转换成数组</span></span><br><span class="line">$result = json_decode($data, <span class="keyword">true</span>);</span><br><span class="line">print_r($result);</span><br></pre></td></tr></table></figure><h4 id="JS处理json"><a href="#JS处理json" class="headerlink" title="JS处理json"></a>JS处理json</h4><ul><li>JS对象 ==&gt; JSON字符串 JSON.stringify(obj)</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//obj是一个js对象</span></span><br><span class="line"><span class="keyword">var</span> obj = &#123;<span class="attr">a</span>: <span class="string">'Hello'</span>, <span class="attr">b</span>: <span class="string">'World'</span>&#125;</span><br><span class="line"><span class="comment">//result就变成了一个json字符串了</span></span><br><span class="line"><span class="keyword">var</span> result = <span class="built_in">JSON</span>.stringify(obj);<span class="comment">// '&#123;"a": "Hello", "b": "World"&#125;'</span></span><br></pre></td></tr></table></figure><ul><li>JSON字符串 ==&gt; JS对象  JSON.parse(obj)</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//json是一个json字符串</span></span><br><span class="line"><span class="keyword">var</span> json = <span class="string">'&#123;"a": "Hello", "b": "World"&#125;'</span>;</span><br><span class="line"><span class="comment">//obj就变成了一个js对象</span></span><br><span class="line"><span class="keyword">var</span> obj = <span class="built_in">JSON</span>.parse(json);<span class="comment">// &#123;a: 'Hello', b: 'World'&#125;</span></span><br></pre></td></tr></table></figure><p>使用json进行数据传输</p><p>思考：</p><ol><li>js有一个对象，如何发送到php后台</li><li>php中有一个对象，如何发送到前台。</li></ol><p>【案例：获取表格数据.html】</p><h2 id="兼容性处理-了解-不用处理"><a href="#兼容性处理-了解-不用处理" class="headerlink" title="兼容性处理 (了解, 不用处理)"></a>兼容性处理 (了解, 不用处理)</h2><p>现在一般最多兼容到 IE8,  这里以后见到了知道是在处理兼容性就行了</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="literal">null</span>;</span><br><span class="line"><span class="keyword">if</span>(XMLHttpRequest)&#123;</span><br><span class="line">  <span class="comment">//现代浏览器 IE7+</span></span><br><span class="line">  xhr = <span class="keyword">new</span>  XMLHttpRequest();</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="comment">//老版本的 Internet Explorer （IE5 和 IE6）使用 ActiveX 对象：</span></span><br><span class="line">  xmlHttp = <span class="keyword">new</span> ActiveXObject(<span class="string">"Microsoft.XMLHTTP"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="封装ajax工具函数"><a href="#封装ajax工具函数" class="headerlink" title="封装ajax工具函数"></a>封装ajax工具函数</h2><blockquote><p>每次发送ajax请求，其实步骤都是一样的，重复了大量代码，我们完全可以封装成一个工具函数。</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1. 创建xhr对象</span></span><br><span class="line"><span class="comment">//2. 设置请求行</span></span><br><span class="line"><span class="comment">//3. 设置请求头</span></span><br><span class="line"><span class="comment">//3. 设置请求体</span></span><br><span class="line"><span class="comment">//4. 监听响应状态</span></span><br><span class="line"><span class="comment">//5. 获取响应内容</span></span><br></pre></td></tr></table></figure><h3 id="参数提取"><a href="#参数提取" class="headerlink" title="参数提取"></a>参数提取</h3><table><thead><tr><th>参数名</th><th>参数类型</th><th>描述</th><th>传值</th><th>默认值</th></tr></thead><tbody><tr><td>type</td><td>string</td><td>请求方式</td><td>get/post</td><td>只要不传post，就是get</td></tr><tr><td>url</td><td>string</td><td>请求地址</td><td>接口地址</td><td>如果不传地址，不发送请求</td></tr><tr><td>async</td><td>boolean</td><td>是否异步</td><td>true/fase</td><td>只要不传false，那就是true，异步请求</td></tr><tr><td>data</td><td>object</td><td>请求数据</td><td><code>{key:value,key1:value2}</code></td><td>需要把这个对象拼接成参数的格式 uname=hucc&amp;upass=12345</td></tr><tr><td>dataType</td><td>string</td><td>返回的数据类型</td><td>xml/json/text</td><td>text</td></tr><tr><td>success</td><td>function</td><td>响应成功时调用</td><td>-</td><td>-</td></tr><tr><td>error</td><td>function</td><td>响应失败时调用</td><td>-</td><td>-</td></tr></tbody></table><h3 id="参数检测"><a href="#参数检测" class="headerlink" title="参数检测"></a>参数检测</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 要求参数obj必须传递，否则直接不发送请求</span></span><br><span class="line"><span class="keyword">if</span>(!obj || <span class="keyword">typeof</span> obj !== <span class="string">"object"</span>)&#123;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 如果type传递的是post，那就发送post请求，否则发送get请求</span></span><br><span class="line"><span class="keyword">var</span> type = obj.type == <span class="string">"post"</span>?<span class="string">"post"</span>:<span class="string">'get'</span>;</span><br><span class="line"><span class="keyword">var</span> url = obj.url;</span><br><span class="line"><span class="keyword">if</span>(!url)&#123;</span><br><span class="line">  <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 只有当async传递了false，才会发送同步请求，不然只发送异步请求</span></span><br><span class="line"><span class="keyword">var</span> <span class="keyword">async</span> = obj.async == <span class="literal">false</span>? <span class="literal">false</span>:<span class="literal">true</span>;</span><br></pre></td></tr></table></figure><h3 id="完整版本"><a href="#完整版本" class="headerlink" title="完整版本"></a>完整版本</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> $ = &#123;</span><br><span class="line">  ajax: <span class="function"><span class="keyword">function</span> (<span class="params">options</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//如果options参数没有传递，直接返回。</span></span><br><span class="line">    <span class="keyword">if</span> (!options || <span class="keyword">typeof</span> options !== <span class="string">"object"</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//处理默认参数</span></span><br><span class="line">    <span class="comment">//如果参数不是post，那就默认为get</span></span><br><span class="line">    <span class="keyword">var</span> type = options.type == <span class="string">"post"</span> ? <span class="string">"post"</span> : <span class="string">"get"</span>;</span><br><span class="line">    <span class="comment">//如果没有传url，那就传当前地址</span></span><br><span class="line">    <span class="keyword">var</span> url = options.url || location.pathname;</span><br><span class="line">    <span class="comment">//如果参数不是false，那就默认是true，发异步请求</span></span><br><span class="line">    <span class="keyword">var</span> <span class="keyword">async</span> = options.async == <span class="literal">false</span> ? <span class="literal">false</span> : <span class="literal">true</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> params = <span class="keyword">this</span>.getParams(options.data);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//设置请求行</span></span><br><span class="line">    <span class="keyword">if</span> (type == <span class="string">"get"</span>) &#123;</span><br><span class="line">      url = url + <span class="string">"?"</span> + params;</span><br><span class="line">    &#125;</span><br><span class="line">    xhr.open(type, url, <span class="keyword">async</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//设置请求头</span></span><br><span class="line">    <span class="keyword">if</span> (type == <span class="string">"post"</span>) &#123;</span><br><span class="line">      xhr.setRequestHeader(<span class="string">"content-type"</span>, <span class="string">"application/x-www-form-urlencoded"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//设置请求参数</span></span><br><span class="line">    xhr.send(params);</span><br><span class="line">    </span><br><span class="line">    xhr.onreadystatechange = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (xhr.readyState == <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (xhr.status == <span class="number">200</span>) &#123;</span><br><span class="line">          <span class="comment">/*根据响应头的content-type属性指定方法接收到的内容*/</span></span><br><span class="line">          <span class="keyword">var</span> contentType = xhr.getResponseHeader(<span class="string">'content-type'</span>);</span><br><span class="line">          <span class="keyword">var</span> data = <span class="literal">null</span>;</span><br><span class="line">          <span class="keyword">if</span> (contentType.indexOf(<span class="string">'json'</span>) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">            data = <span class="built_in">JSON</span>.parse(xhr.responseText);</span><br><span class="line">          &#125; <span class="keyword">else</span> <span class="keyword">if</span> (contentType.indexOf(<span class="string">'xml'</span>) &gt; <span class="number">-1</span>) &#123;</span><br><span class="line">            data = xhr.responseXML;</span><br><span class="line">          &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            data = xhr.responseText;</span><br><span class="line">          &#125;</span><br><span class="line">          <span class="comment">/*执行成功函数*/</span></span><br><span class="line">          options.success &amp;&amp; options.success(data);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          options.error &amp;&amp; options.error(xhr.responseText);</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  getParams: <span class="function"><span class="keyword">function</span> (<span class="params">obj</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//将obj对象转换成参数</span></span><br><span class="line">    <span class="comment">//将对象转换成参数列表</span></span><br><span class="line">    <span class="keyword">if</span> (!obj) &#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> arr = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> k <span class="keyword">in</span> obj) &#123;</span><br><span class="line">      arr.push(k + <span class="string">"="</span> + obj[k]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> arr.join(<span class="string">"&amp;"</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>【登录案例】</p><h2 id="jQuery中的ajax方法"><a href="#jQuery中的ajax方法" class="headerlink" title="jQuery中的ajax方法"></a>jQuery中的ajax方法</h2><blockquote><p>jQuery为我们提供了更强大的Ajax封装</p></blockquote><h3 id="ajax"><a href="#ajax" class="headerlink" title="$.ajax"></a>$.ajax</h3><p>参数列表</p><table><thead><tr><th>参数名称</th><th>描述</th><th>取值</th><th>示例</th></tr></thead><tbody><tr><td>url</td><td>接口地址</td><td></td><td>url:”02.php”</td></tr><tr><td>type</td><td>请求方式</td><td>get/post</td><td>type:”get”</td></tr><tr><td>timeout</td><td>超时时间</td><td>单位毫秒</td><td>timeout:5000</td></tr><tr><td>dataType</td><td>服务器返回的格式</td><td>json/xml/text(默认)</td><td>dataType:”json”</td></tr><tr><td>data</td><td>发送的请求数据</td><td>对象</td><td>data:{name:”zs”, age:18}</td></tr><tr><td>beforeSend</td><td>调用前的回调函数</td><td>function(){}</td><td>beforeSend:function(){ alert(1) }</td></tr><tr><td>success</td><td>成功的回调函数</td><td>function (data) {}</td><td>success:function (data) {}</td></tr><tr><td>error</td><td>失败的回调函数</td><td>function (error) {}</td><td>error:function(data) {}</td></tr><tr><td>complete</td><td>完成后的回调函数</td><td>function () {}</td><td>complete:function () {}</td></tr></tbody></table><p>使用示例：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$.ajax(&#123;</span><br><span class="line">  type:<span class="string">"get"</span>,<span class="comment">//请求类型</span></span><br><span class="line">  url:<span class="string">"02.php"</span>,<span class="comment">//请求地址</span></span><br><span class="line">  data:&#123;<span class="attr">name</span>:<span class="string">"zs"</span>, <span class="attr">age</span>:<span class="number">18</span>&#125;,<span class="comment">//请求数据</span></span><br><span class="line">  dataType:<span class="string">"json"</span>,<span class="comment">//希望接受的数据类型</span></span><br><span class="line">  timeout:<span class="number">5000</span>,<span class="comment">//设置超时时间</span></span><br><span class="line">  beforeSend:<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//alert("发送前调用");</span></span><br><span class="line">  &#125;,</span><br><span class="line">  success:<span class="function"><span class="keyword">function</span> (<span class="params">data</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//alert("成功时调用");</span></span><br><span class="line">    <span class="built_in">console</span>.log(data);</span><br><span class="line">  &#125;,</span><br><span class="line">  error:<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</span><br><span class="line">    <span class="comment">//alert("失败时调用");</span></span><br><span class="line">    <span class="built_in">console</span>.log(error);</span><br><span class="line">  &#125;,</span><br><span class="line">  complete:<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//alert("请求完成时调用");</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>【案例：登录案例.html】</p><h3 id="其他api-了解"><a href="#其他api-了解" class="headerlink" title="其他api(了解)"></a>其他api(了解)</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//$.post(url, callback, [dataType]);只发送post请求</span></span><br><span class="line"><span class="comment">//$.get(url, callback, [dataType]);</span></span><br><span class="line"><span class="comment">//$.getJSON(url, callback);</span></span><br><span class="line"><span class="comment">//$.getScript(url,callback);//载入服务器端的js文件</span></span><br><span class="line"><span class="comment">//$("div").load(url);//载入一个服务器端的html页面。</span></span><br></pre></td></tr></table></figure><h3 id="接口化开发"><a href="#接口化开发" class="headerlink" title="接口化开发"></a>接口化开发</h3><p>请求地址即所谓的接口，通常我们所说的接口化开发，其实是指一个接口对应一个功能， 并且严格约束了<strong>请求参数</strong> 和<strong>响应结果</strong> 的格式，这样前后端在开发过程中，可以减少不必要的讨论， 从而并行开发，可以极大的提升开发效率，另外一个好处，当网站进行改版后，服务端接口进行调整时，并不影响到前端的功能。</p><h4 id="获取短信验证码"><a href="#获取短信验证码" class="headerlink" title="获取短信验证码"></a>获取短信验证码</h4><p><strong>需求文档(产品)</strong> </p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">总需求：点击获取验证码按钮，向服务端发送请求, 调用服务器端短信接口, 服务器端根据传参, 调用第三方短信接口, 给手机发送验证码</span><br><span class="line"></span><br><span class="line">需求<span class="number">1</span>：格式校验</span><br><span class="line">(<span class="number">1</span>) 手机号码不能为空   如果为空提示<span class="string">"手机号不能为空"</span></span><br><span class="line">(<span class="number">2</span>) 手机号码格式必须正确, 提示<span class="string">"请输入正确的手机号码"</span></span><br><span class="line">  </span><br><span class="line">需求<span class="number">2</span>：点击发送时，按钮显示为<span class="string">"发送中"</span>,并且不能重复提交请求</span><br><span class="line"></span><br><span class="line">需求<span class="number">3</span>：根据不同的响应结果，进行响应。</span><br><span class="line">(<span class="number">1</span>)如果接口调用成功</span><br><span class="line">   如果响应代码为<span class="number">100</span>，倒计时</span><br><span class="line">   如果响应代码为<span class="number">101</span>，提示手机号重复</span><br><span class="line">(<span class="number">2</span>)如果接口调用失败，告诉用户<span class="string">"服务器繁忙，请稍候再试"</span></span><br></pre></td></tr></table></figure><p><strong>接口文档</strong></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">接口说明：获取短信验证码</span><br><span class="line">接口地址：getCode.php</span><br><span class="line">请求方式：<span class="keyword">get</span></span><br><span class="line">接口传参：mobile 手机号</span><br><span class="line">返回类型  json</span><br><span class="line">接口返回：&#123;</span><br><span class="line"><span class="string">"code"</span>:<span class="string">"101"</span>, </span><br><span class="line"><span class="string">"msg"</span>:<span class="string">"手机号码存在"</span>, </span><br><span class="line"><span class="string">"mobile"</span>:<span class="string">"18511249258"</span></span><br><span class="line">&#125;</span><br><span class="line">参数说明: code 当前业务逻辑的处理成功失败的标识  <span class="number">100</span>:成功   <span class="number">101</span>:手机号码存在</span><br><span class="line"> msg  当前系统返回给前端提示</span><br><span class="line"> mobile  当前的手机号码</span><br></pre></td></tr></table></figure><h4 id="注册接口"><a href="#注册接口" class="headerlink" title="注册接口"></a>注册接口</h4><p><strong>表单序列化</strong> serialize</p><p>jquery提供了一个<code>serialize()</code>方法序列化表单，说白就是将表单中带有name属性的所有参数拼成一个格式为<code>name=value&amp;name1=value1</code>这样的字符串。方便我们获取表单的数据。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//serialize将表单参数序列化成一个字符串。必须指定name属性</span></span><br><span class="line"><span class="comment">//name=pp&amp;pass=123456&amp;repass=123456&amp;mobile=15751776629&amp;code=1234</span></span><br><span class="line">$(<span class="string">'form'</span>).serialize();</span><br></pre></td></tr></table></figure><p>jquery的ajax方法，data参数能够直接识别表单序列化的数据</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$.post(&#123;</span><br><span class="line">  url:<span class="string">"register.php"</span>,</span><br><span class="line">  data:$(<span class="string">'form'</span>).serialize(),</span><br><span class="line">  dataType:<span class="string">'json'</span>,</span><br><span class="line">  success:<span class="function"><span class="keyword">function</span> (<span class="params">info</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(info);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><strong>需求文档</strong></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">注册功能</span><br><span class="line">总需求：点击注册按钮，向服务端发送请求</span><br><span class="line"></span><br><span class="line">需求<span class="number">1</span>:表单校验</span><br><span class="line">    <span class="number">1.1</span> 用户名不能为空，否则提示<span class="string">"请输入用户名"</span></span><br><span class="line">    <span class="number">1.2</span> 密码不能为空，否则提示<span class="string">"请输入密码"</span></span><br><span class="line">    <span class="number">1.3</span> 确认密码必须与密码一直，否则提示<span class="string">"确认密码与密码不一致"</span></span><br><span class="line">    <span class="number">1.4</span> 手机号码不能为空，否则提示<span class="string">"请输入手机号码"</span>;</span><br><span class="line">    <span class="number">1.5</span> 手机号码格式必须正确，否则提示<span class="string">"手机号格式错误"</span></span><br><span class="line">    <span class="number">1.6</span> 短信验证码必须是<span class="number">4</span>位的数字，否则提示<span class="string">"验证码格式错误"</span></span><br><span class="line">      </span><br><span class="line">需求<span class="number">2</span>：点击注册按钮时，按钮显示为<span class="string">"注册中..."</span>,并且不能重复提交请求</span><br><span class="line"></span><br><span class="line">需求<span class="number">3</span>：根据不同响应结果，处理响应</span><br><span class="line"><span class="number">3.1</span> 接口调用成功</span><br><span class="line">        <span class="number">100</span> 提示用户注册成功，<span class="number">3</span>s后跳转到首页</span><br><span class="line">        <span class="number">101</span> 提示用户<span class="string">"用户名jepson已经存在"</span></span><br><span class="line">        <span class="number">102</span> 提示用户<span class="string">"验证码错误"</span></span><br><span class="line">    <span class="number">3.2</span> 接口调用失败，提示<span class="string">"服务器繁忙，请稍后再试"</span>,恢复按钮的值</span><br></pre></td></tr></table></figure><p><strong>接口文档</strong></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">接口说明：注册</span><br><span class="line">接口地址：register.php</span><br><span class="line">请求方式：post</span><br><span class="line">接口传参：name:用户名 pass:密码 code:验证码  mobile:手机号</span><br><span class="line">返回类型  json</span><br><span class="line">接口返回：&#123;</span><br><span class="line"><span class="string">"code"</span>:<span class="string">"100"</span>,</span><br><span class="line"><span class="string">"msg"</span>:<span class="string">"注册成功"</span>,</span><br><span class="line"><span class="string">"name"</span>:<span class="string">"Jepson"</span></span><br><span class="line">&#125;</span><br><span class="line">参数说明:</span><br><span class="line">      code 当前业务逻辑的处理成功失败的标识  <span class="number">100</span>:成功  <span class="number">101</span>:用户存在 <span class="number">102</span>:验证码错误</span><br><span class="line">      msg  当前系统返回给前端提示</span><br><span class="line">      name: 注册的用户名</span><br></pre></td></tr></table></figure><h1 id="模板引擎"><a href="#模板引擎" class="headerlink" title="模板引擎"></a>模板引擎</h1><blockquote><p>是为了使用户界面与业务数据（内容）分离而产生的，它可以生成特定格式的文档，用于网站的模板引擎就会生成一个标准的HTML文档。</p></blockquote><h2 id="为什么要使用模板引擎"><a href="#为什么要使用模板引擎" class="headerlink" title="为什么要使用模板引擎"></a>为什么要使用模板引擎</h2><p>我们通过ajax获取到数据后，需要把数据渲染到页面，在学习模板引擎前，我们的做法是大量的拼接字符串，对于结构简单的页面，这么做还行 </p><p>但是如果页面结构很复杂，使用拼串的话<strong>代码可阅读性非常的差，而且非常容易出错，后期代码维护也是相当的麻烦。</strong> </p><p>【演示：使用拼串进行渲染的缺点.html】</p><p>总结来说拼串渲染两大缺点：</p><ol><li>js中大量充斥着 html 结构拼串代码， 很冗余， 可读性差</li><li>字符串拼接很麻烦， 且维护起来也很麻烦， 容易出错</li></ol><h2 id="常见的模板引擎"><a href="#常见的模板引擎" class="headerlink" title="常见的模板引擎"></a>常见的模板引擎</h2><p>BaiduTemplate：<a href="http://tangram.baidu.com/BaiduTemplate/" target="_blank" rel="noopener">http://tangram.baidu.com/BaiduTemplate/</a><br>velocity.js：<a href="https://github.com/shepherdwind/velocity.js/" target="_blank" rel="noopener">https://github.com/shepherdwind/velocity.js/</a><br>ArtTemplate：<a href="https://github.com/aui/artTemplate" target="_blank" rel="noopener">https://github.com/aui/artTemplate</a></p><p>artTemplate是使用最广泛，效率最高的模板引擎，需要大家掌握。</p><h2 id="artTemplate的使用"><a href="#artTemplate的使用" class="headerlink" title="artTemplate的使用"></a>artTemplate的使用</h2><p><a href="https://github.com/aui/art-template" target="_blank" rel="noopener">github地址</a></p><p><a href="https://aui.github.io/art-template/docs/" target="_blank" rel="noopener">中文api地址</a></p><h3 id="artTemplate入门"><a href="#artTemplate入门" class="headerlink" title="artTemplate入门"></a>artTemplate入门</h3><p><strong>1.引入模板引擎的js文件</strong> </p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">&lt;script src=<span class="string">"template-web.js"</span>&gt;&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure><p><strong>2.准备模板</strong> </p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">  指定了type为text/html后，这一段script标签并不会解析，也不会显示。</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/html"</span> <span class="attr">id</span>=<span class="string">"myTmp"</span>&gt;</span></span><br><span class="line"><span class="handlebars"><span class="xml">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>姓名：隔壁老王<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>年龄：18<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>技能：查水表<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>描述：年轻力气壮<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>3.准备数据</strong></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//3. 准备数据,数据是后台获取的，可以随时变化</span></span><br><span class="line"><span class="keyword">var</span> json = &#123;</span><br><span class="line">  userName:<span class="string">"隔壁老王"</span>,</span><br><span class="line">  age:<span class="number">18</span>,</span><br><span class="line">  skill:<span class="string">"查水表"</span>,</span><br><span class="line">  desc:<span class="string">"年轻气壮"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>4.将模板与数据进行绑定</strong></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//第一个参数：模板的id</span></span><br><span class="line"><span class="comment">//第二个参数：数据</span></span><br><span class="line"><span class="comment">//返回值：根据模板生成的字符串。</span></span><br><span class="line"><span class="keyword">var</span> html = template(<span class="string">"myTmp"</span>, json);</span><br><span class="line"><span class="built_in">console</span>.log(html);</span><br></pre></td></tr></table></figure><p><strong>5.修改模板</strong></p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/html"</span> <span class="attr">id</span>=<span class="string">"myTmp"</span>&gt;</span></span><br><span class="line"><span class="handlebars"><span class="xml">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>姓名：</span><span class="template-variable">&#123;&#123;userName&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>年龄：</span><span class="template-variable">&#123;&#123;age&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>技能：</span><span class="template-variable">&#123;&#123;skill&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span></span><br><span class="line"><span class="handlebars"><span class="xml">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>描述：</span><span class="template-variable">&#123;&#123;desc&#125;&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>6.将数据显示到页面</strong></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> div = <span class="built_in">document</span>.querySelector(<span class="string">"div"</span>);</span><br><span class="line">div.innerHTML = html;</span><br></pre></td></tr></table></figure><h3 id="artTemplate标准语法"><a href="#artTemplate标准语法" class="headerlink" title="artTemplate标准语法"></a>artTemplate标准语法</h3><p><strong>if语法</strong></p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">&#123;&#123;if gender='男'&#125;&#125;</span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"man"</span>&gt;</span></span><br><span class="line">&#123;&#123;else&#125;&#125;</span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"woman"</span>&gt;</span></span><br><span class="line">&#123;&#123;/if&#125;&#125;</span><br></pre></td></tr></table></figure><p><strong>each语法</strong></p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">  1. &#123;&#123;each data&#125;&#125;  可以通过$value 和 $index获取值和下标</span></span><br><span class="line"><span class="comment">  2. &#123;&#123;each data v i&#125;&#125;  自己指定值为v，下标为i</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">&#123;&#123;each data v i&#125;&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"&#123;&#123;v.url&#125;&#125;"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"&#123;&#123;v.src&#125;&#125;"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123;v.content&#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">&#123;&#123;/each&#125;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//如果返回的数据是个数组，必须使用对象进行包裹，因为在&#123;&#123;&#125;&#125;中只写书写对象的属性。</span></span><br><span class="line"><span class="keyword">var</span> html = template(<span class="string">"navTmp"</span>, &#123;<span class="attr">data</span>:info&#125;);</span><br></pre></td></tr></table></figure><h1 id="瀑布流案例"><a href="#瀑布流案例" class="headerlink" title="瀑布流案例"></a>瀑布流案例</h1><h2 id="封装jQuery瀑布流插件"><a href="#封装jQuery瀑布流插件" class="headerlink" title="封装jQuery瀑布流插件"></a>封装jQuery瀑布流插件</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//特点分析：</span></span><br><span class="line"><span class="comment">//1. 跟以前将的瀑布流不一样的是，这次的瀑布流固定版心为1200px</span></span><br><span class="line"><span class="comment">//2. 瀑布流固定摆放5列，每一列的宽度固定为232px。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//思路分析：</span></span><br><span class="line"><span class="comment">//1. 计算每一列之间的缝隙</span></span><br><span class="line"><span class="comment">//2. 初始化一个数组，用户存储每一列的高度 [0,0,0,0,0]</span></span><br><span class="line"><span class="comment">//3. 查找数组的最小列，每次都把图片定位到最小列的位置</span></span><br><span class="line"><span class="comment">//4. 更新数组最小列的高度（加上定位过来的图片的高度）</span></span><br></pre></td></tr></table></figure><p>代码参考：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$.fn.waterfall = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> $box = $(<span class="keyword">this</span>);</span><br><span class="line">  <span class="keyword">var</span> $item = $box.children();</span><br><span class="line">  <span class="keyword">var</span> boxWidth = $box.width();<span class="comment">//父盒子的宽度</span></span><br><span class="line">  <span class="keyword">var</span> itemWidth = <span class="number">232</span>;<span class="comment">//每个盒子固定宽度为232</span></span><br><span class="line">  <span class="keyword">var</span> columns = <span class="number">5</span>;<span class="comment">//固定摆放5列</span></span><br><span class="line">  <span class="keyword">var</span> gap = (boxWidth - columns * itemWidth) / (columns - <span class="number">1</span>);<span class="comment">//缝隙的宽度 10</span></span><br><span class="line">  <span class="keyword">var</span> arr = [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]; <span class="comment">//初始化数组</span></span><br><span class="line">  $item.each(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">//查找最小列</span></span><br><span class="line">    <span class="keyword">var</span> min = arr[<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">var</span> minIndex = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">      <span class="keyword">if</span> (min &gt; arr[i]) &#123;</span><br><span class="line">        min = arr[i];</span><br><span class="line">        minIndex = i;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//设置位置</span></span><br><span class="line">    $(<span class="keyword">this</span>).css(&#123;</span><br><span class="line">      left: minIndex * (itemWidth + gap),</span><br><span class="line">      top: min</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="comment">//更新数组</span></span><br><span class="line">    arr[minIndex] = min + $(<span class="keyword">this</span>).outerHeight() + gap;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="瀑布流完整版"><a href="#瀑布流完整版" class="headerlink" title="瀑布流完整版"></a>瀑布流完整版</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//需求分析：</span></span><br><span class="line"><span class="comment">//1. 页面刚开始，没有任何一张图片。因此需要从通过ajax获取图片</span></span><br><span class="line"><span class="comment">//2. 使用模版引擎将获取到的数据渲染到页面</span></span><br><span class="line"><span class="comment">//3. 因为图片路径是从服务端获取的，加载需要时间，需要等待图片加载完成后才能使用瀑布流进行布局。</span></span><br><span class="line"><span class="comment">//4. 给window注册scroll事件，当触底时，需要动态的加载图片。</span></span><br><span class="line"><span class="comment">//5. 加载时，显示加载中的提示信息，并且要求不能重复发送ajax请求</span></span><br><span class="line"><span class="comment">//6. 当服务端返回图片数量为0时，提示用户没有更多数据。</span></span><br></pre></td></tr></table></figure><p>接口文档</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//接口说明：瀑布流分页数据</span></span><br><span class="line"><span class="comment">//接口地址：data.php</span></span><br><span class="line"><span class="comment">//请求方式：get</span></span><br><span class="line"><span class="comment">//接口参数：page 当前是第几页    pageSize 当前页需要显示多少条</span></span><br><span class="line"><span class="comment">//返回类型  json</span></span><br><span class="line"><span class="comment">//返回数据：</span></span><br><span class="line">&#123;</span><br><span class="line">  page: <span class="number">2</span>,</span><br><span class="line">  items:[</span><br><span class="line">    &#123;<span class="attr">path</span>: <span class="string">"./images/1.jpg"</span>,<span class="attr">text</span>:<span class="string">'这是描述信息'</span>&#125;,</span><br><span class="line">    &#123;<span class="attr">path</span>: <span class="string">"./images/2.jpg"</span>,<span class="attr">text</span>:<span class="string">'这是描述信息'</span>&#125;</span><br><span class="line">    &#123;<span class="attr">path</span>: <span class="string">"./images/2.jpg"</span>,<span class="attr">text</span>:<span class="string">'这是描述信息'</span>&#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//page   下一页的页码</span></span><br><span class="line"><span class="comment">//items  返回当前页的数据</span></span><br><span class="line"><span class="comment">//path 图片地址</span></span><br><span class="line"><span class="comment">//text 文字</span></span><br></pre></td></tr></table></figure><h1 id="同源与跨域"><a href="#同源与跨域" class="headerlink" title="同源与跨域"></a>同源与跨域</h1><h2 id="同源"><a href="#同源" class="headerlink" title="同源"></a>同源</h2><h3 id="同源策略的基本概念"><a href="#同源策略的基本概念" class="headerlink" title="同源策略的基本概念"></a>同源策略的基本概念</h3><blockquote><p>1995年，同源政策由 Netscape 公司引入浏览器。目前，所有浏览器都实行这个政策。<br>同源策略：最初，它的含义是指，A网页设置的 Cookie，B网页不能打开，除非这两个网页”同源”。所谓”同源”指的是”三个相同”。</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">协议相同</span><br><span class="line">域名相同</span><br><span class="line">端口相同</span><br></pre></td></tr></table></figure><p>举例来说，这个网址<code>http://www.example.com/dir/page.html</code>协议是<code>http://</code>，</p><p>域名是<code>www.example.com</code>，端口是<code>80</code>（默认端口可以省略）。它的同源情况如下。</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">http:<span class="comment">//www.example.com/dir2/other.html：同源</span></span><br><span class="line"></span><br><span class="line">file:<span class="comment">///F:/phpStudy/WWW/day01/04-demo/04.html 不同源(协议不同)</span></span><br><span class="line">http:<span class="comment">//v2.www.example.com/dir/other.html：不同源（域名不同）</span></span><br><span class="line">http:<span class="comment">//www.example.com:81/dir/other.html：不同源（端口不同）</span></span><br></pre></td></tr></table></figure><h3 id="同源策略的目的"><a href="#同源策略的目的" class="headerlink" title="同源策略的目的"></a>同源策略的目的</h3><blockquote><p>同源政策的目的，是为了保证用户信息的安全，防止恶意的网站窃取数据。</p></blockquote><h3 id="同源策略的限制范围"><a href="#同源策略的限制范围" class="headerlink" title="同源策略的限制范围"></a>同源策略的限制范围</h3><blockquote><p>随着互联网的发展，“同源策略”越来越严格，目前，如果非同源，以下三种行为都将收到限制。</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span> Cookie、LocalStorage 和 IndexDB 无法读取。</span><br><span class="line"><span class="number">2.</span> DOM 无法获得。</span><br><span class="line"><span class="number">3.</span> AJAX 请求不能发送。</span><br></pre></td></tr></table></figure><p>虽然这些限制是很有必要的，但是也给我们日常开发带来不好的影响。比如实际开发过程中，往往都会把服务器端架设到一台甚至是一个集群的服务器中，把客户端页面放到另外一个单独的服务器。那么这时候就会出现不同源的情况，如果我们知道两个网站都是安全的话，我们是希望两个不同源的网站之间可以相互请求数据的。这就需要使用到<strong>跨域</strong> 。</p><h2 id="跨域"><a href="#跨域" class="headerlink" title="跨域"></a>跨域</h2><p>【演示跨域问题.html】</p><h3 id="jsonp-无兼容性问题"><a href="#jsonp-无兼容性问题" class="headerlink" title="jsonp( 无兼容性问题 )"></a>jsonp( 无兼容性问题 )</h3><blockquote><p>JSONP(JSON with Padding)、可用于解决主流浏览器的跨域数据访问的问题。</p><p>原理：服务端返回一个定义好的js函数的调用，并且将服务器的数据以该函数参数的形式传递过来，这个方法需要前后端配合</p></blockquote><p><code>script</code> 标签是不受同源策略的限制的，它可以载入任意地方的 JavaScript 文件。类似的还有<code>img</code>和<code>link</code>标签</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!--不受同源策略限制的标签--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"http://www.api.com/1.jpg"</span> <span class="attr">alt</span>=<span class="string">""</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"http://www.api.com/1.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://www.api.com/1.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h4 id="jsonp演化过程1"><a href="#jsonp演化过程1" class="headerlink" title="jsonp演化过程1"></a>jsonp演化过程1</h4><p>php文件</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">header(<span class="string">"content-type:text/html;charset=utf-8"</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"alert(1111)"</span>;</span><br></pre></td></tr></table></figure><p>html文件</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://www.api.com/testjs.php"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>原理：其实src的路径是什么文件不重要，无论引入js文件还是php文件，最后返回给浏览器的都是字符串，因此我们script标签是可以引入一个php文件的。</p><h4 id="jsonp演化过程2"><a href="#jsonp演化过程2" class="headerlink" title="jsonp演化过程2"></a>jsonp演化过程2</h4><p>php文件</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">header(<span class="string">"content-type:text/html;charset=utf-8"</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"var a = 118;"</span>;</span><br></pre></td></tr></table></figure><p>html文件</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://www.api.com/testjs.php"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">  <span class="comment">//a打印出来了118</span></span></span><br><span class="line"><span class="javascript">  <span class="built_in">console</span>.log(a);</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>我们现在做到了一件事情，从不同源的php文件中获取到了数据</strong> </p><p>缺点：获取数据的script标签必须写在使用的script标签的前面，必须保证先有数据才能对数据进行渲染。</p><h4 id="jsonp演化过程3"><a href="#jsonp演化过程3" class="headerlink" title="jsonp演化过程3"></a>jsonp演化过程3</h4><p>php代码</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">header(<span class="string">"content-type:text/html;charset=utf-8"</span>);</span><br><span class="line">$arr = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">"name"</span>=&gt;<span class="string">"zs"</span>,</span><br><span class="line">    <span class="string">"age"</span>=&gt;<span class="number">18</span></span><br><span class="line">);</span><br><span class="line">$result = json_encode($arr);</span><br><span class="line"><span class="comment">//这是一段js函数的调用的代码，$result就是我们想要的数据</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">"func($result)"</span>;</span><br></pre></td></tr></table></figure><p>js代码</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="actionscript">  <span class="function"><span class="keyword">function</span> <span class="title">func</span><span class="params">(data)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="built_in">console</span>.log(data);</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://www.api.com/testjs.php"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>缺点：后端必须知道前端声明的方法的名字，后端才能调用。</p><h4 id="jsonp演化过程4"><a href="#jsonp演化过程4" class="headerlink" title="jsonp演化过程4"></a>jsonp演化过程4</h4><p>php代码</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">header(<span class="string">"content-type:text/html;charset=utf-8"</span>);</span><br><span class="line">$arr = <span class="keyword">array</span>(</span><br><span class="line">    <span class="string">"name"</span>=&gt;<span class="string">"zs"</span>,</span><br><span class="line">    <span class="string">"age"</span>=&gt;<span class="number">18</span></span><br><span class="line">);</span><br><span class="line">$result = json_encode($arr);</span><br><span class="line"><span class="comment">//这是一段js函数的调用的代码，$result就是我们想要的数据</span></span><br><span class="line"><span class="keyword">echo</span> $_GET[<span class="string">'callback'</span>].<span class="string">"($result)"</span>;</span><br></pre></td></tr></table></figure><p>javascript代码</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span>(<span class="params">data</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(data);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> button = <span class="built_in">document</span>.querySelector(<span class="string">"button"</span>);</span><br><span class="line">button.onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> script = <span class="built_in">document</span>.createElement(<span class="string">"script"</span>);</span><br><span class="line">  script.src = <span class="string">"http://www.api.com/testjs.php?callback=fun"</span>;</span><br><span class="line">  <span class="built_in">document</span>.body.appendChild(script);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>说白了，jsonp的原理就是 借助了script标签 src 请求资源时, 不受同源策略的限制.</li><li>在服务端返回一个函数的调用，将数据当前调用函数的实参。</li><li>在浏览器端，需要程序要声明一个全局函数，通过形参就可以获取到服务端返回的对应的值</li></ol><p>jsonp原理大家需要知道，但不用太过于去纠结这个原理，因为jquery已经帮我们封装好了，我们使用起来非常的方便。</p><h3 id="jquery对于jsonp的封装"><a href="#jquery对于jsonp的封装" class="headerlink" title="jquery对于jsonp的封装"></a>jquery对于jsonp的封装</h3><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//使用起来相当的简单，跟普通的get请求没有任何的区别，只需要把dataType固定成jsonp即可。</span></span><br><span class="line">$.ajax(&#123;</span><br><span class="line">  type:<span class="string">"get"</span>,</span><br><span class="line">  url:<span class="string">"http://www.Jepson.com/testjs.php"</span>,</span><br><span class="line">  dataType:<span class="string">"jsonp"</span>,</span><br><span class="line">  data:&#123;</span><br><span class="line">    uname:<span class="string">"Jepson"</span>,</span><br><span class="line">    upass:<span class="string">"123456"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  success:<span class="function"><span class="keyword">function</span> (<span class="params">info</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(info);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>【案例：查询天气.html】</p><p><a href="https://www.jisuapi.com/api/weather/" target="_blank" rel="noopener">天气查询api地址</a></p><p>【案例：省市区三级联动.html】</p><p><a href="https://www.jisuapi.com/api/area/" target="_blank" rel="noopener">api地址</a> </p><h1 id="XMLHttpRequest2-0"><a href="#XMLHttpRequest2-0" class="headerlink" title="XMLHttpRequest2.0"></a>XMLHttpRequest2.0</h1><blockquote><p>XMLHttpRequest是一个javascript内置对象，使得Javascript可以进行异步的HTTP通信。2008年2月，就提出了XMLHttpRequest Level 2 草案。</p></blockquote><p>老版本的XMLHttpRequest的缺点：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span> 仅支持传输文本数据，无法传说二进制文件，比如图片视频等。</span><br><span class="line"><span class="number">2.</span> 传输数据时，没有进度信息，只能提示完成与否。</span><br><span class="line"><span class="number">3.</span> 受到了<span class="string">"同源策略"</span>的限制</span><br></pre></td></tr></table></figure><p>新版本的功能：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span> 可以设置timeout超时时间</span><br><span class="line"><span class="number">2.</span> 可以使用formData对象管理表单数据</span><br><span class="line"><span class="number">3.</span> 允许请求不同域名下的数据（跨域）</span><br><span class="line"><span class="number">4.</span> 支持上传二进制文件</span><br><span class="line"><span class="number">5.</span> 可以获取数据传输的进度信息</span><br></pre></td></tr></table></figure><p><strong>注意：我们现在使用new XMLHttpRequest创建的对象就是2.0对象了，我们之前学的是1.0的语法，现在学习一些2.0的新特性即可。</strong>  </p><h2 id="timeout设置超时"><a href="#timeout设置超时" class="headerlink" title="timeout设置超时"></a>timeout设置超时</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">xhr.timeout = <span class="number">3000</span>;<span class="comment">//设置超时时间</span></span><br><span class="line">xhr.ontimeout = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  alert(<span class="string">"请求超时"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="formData管理表单数据"><a href="#formData管理表单数据" class="headerlink" title="formData管理表单数据"></a>formData管理表单数据</h2><blockquote><p>formData对象类似于jquery的serialize方法，用于管理表单数据</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">使用特点： </span><br><span class="line"><span class="number">1.</span> 实例化一个formData对象， <span class="keyword">new</span> formData(form); form就是表单元素</span><br><span class="line"><span class="number">2.</span> formData对象可以直接作为 xhr.send(formData)的参数。注意此时数据是以二进制的形式进行传输。</span><br><span class="line"><span class="number">3.</span> formData有一个append方法，可以添加参数。formData.append(<span class="string">"id"</span>, <span class="string">"1111"</span>);</span><br><span class="line"><span class="number">4.</span> 这种方式只能以post形式传递，不需要设置请求头，浏览器会自动为我们设置一个合适的请求头。</span><br></pre></td></tr></table></figure><p>代码示例：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1. 使用formData必须发送post请求</span></span><br><span class="line">    xhr.open(<span class="string">"post"</span>, <span class="string">"02-formData.php"</span>);</span><br><span class="line">    </span><br><span class="line"><span class="comment">//2. 获取表单元素</span></span><br><span class="line"><span class="keyword">var</span> form = <span class="built_in">document</span>.querySelector(<span class="string">"#myForm"</span>);</span><br><span class="line"><span class="comment">//3. 创建form对象，可以直接作为send的参数。</span></span><br><span class="line"><span class="keyword">var</span> formData = <span class="keyword">new</span> FormData(form);</span><br><span class="line"></span><br><span class="line"><span class="comment">//4. formData可以使用append方法添加参数</span></span><br><span class="line">formData.append(<span class="string">"id"</span>, <span class="string">"1111"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//5. 发送，不需要指定请求头，浏览器会自动选择合适的请求头</span></span><br><span class="line">xhr.send(formData);</span><br></pre></td></tr></table></figure><h2 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h2><blockquote><p>以前，文件上传需要借助表单进行上传，但是表单上传是同步的，也就是说文件上传时，页面需要提交和刷新，用户体验不友好，xhr2.0中的formData对象支持文件的异步上传。</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> formData = <span class="keyword">new</span> FormData();</span><br><span class="line"><span class="comment">//获取上传的文件，传递到后端</span></span><br><span class="line"><span class="keyword">var</span> file = <span class="built_in">document</span>.getElementById(<span class="string">"file"</span>).files[<span class="number">0</span>];</span><br><span class="line">formData.append(<span class="string">"file"</span>, file);</span><br><span class="line">xhr.send(formData);</span><br></pre></td></tr></table></figure><h2 id="显示文件进度信息"><a href="#显示文件进度信息" class="headerlink" title="显示文件进度信息"></a>显示文件进度信息</h2><blockquote><p>xhr2.0还支持获取上传文件的进度信息，因此我们可以根据进度信息可以实时的显示文件的上传进度。</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span> 需要注册 xhr.upload.onprogress = <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;&#125; 事件，用于监听文件上传的进度.注意：需要在send之前注册。</span><br><span class="line"><span class="number">2.</span> 上传的进度信息会存储事件对象e中</span><br><span class="line"><span class="number">3.</span> e.loaded表示已上传的大小   e.total表示整个文件的大小</span><br></pre></td></tr></table></figure><p>代码参考：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">xhr.upload.onprogress = <span class="function"><span class="keyword">function</span> (<span class="params">e</span>) </span>&#123;</span><br><span class="line">  </span><br><span class="line">  inner.style.width = (e.loaded/e.total*<span class="number">100</span>).toFixed(<span class="number">2</span>)+<span class="string">"%"</span>;</span><br><span class="line">  span.innerHTML = (e.loaded/e.total*<span class="number">100</span>).toFixed(<span class="number">2</span>)+<span class="string">"%"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">xhr.send(formData);</span><br></pre></td></tr></table></figure><p>如果上传文件超过8M，php会报错，需要进行设置，允许php上传大文件。</p><h2 id="跨域资源共享-CORS-兼容性IE10"><a href="#跨域资源共享-CORS-兼容性IE10" class="headerlink" title="跨域资源共享(CORS) ( 兼容性IE10+ )"></a>跨域资源共享(CORS) ( 兼容性IE10+ )</h2><h3 id="cors的使用"><a href="#cors的使用" class="headerlink" title="cors的使用"></a>cors的使用</h3><blockquote><p>新版本的XMLHttpRequest对象，可以向不同域名的服务器发出HTTP请求。这叫做<a href="http://en.wikipedia.org/wiki/Cross-Origin_Resource_Sharing" target="_blank" rel="noopener">“跨域资源共享”</a>（Cross-origin resource sharing，简称CORS）。</p></blockquote><p>跨域资源共享（CORS）的前提</p><ul><li>浏览器支持这个功能( 兼容性IE10+ )</li><li>服务器必须允许这种跨域。</li></ul><p>服务器允许跨域的代码：</p><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//允许所有的域名访问这个接口</span></span><br><span class="line">header(<span class="string">"Access-Control-Allow-Origin:*"</span>);</span><br><span class="line"><span class="comment">//允许www.study.com这个域名访问这个接口</span></span><br><span class="line">header(<span class="string">"Access-Control-Allow-Origin:http://www.study.com"</span>);</span><br></pre></td></tr></table></figure><h3 id="CORS的具体流程（了解）"><a href="#CORS的具体流程（了解）" class="headerlink" title="CORS的具体流程（了解）"></a>CORS的具体流程（了解）</h3><ol><li><p>浏览器发送跨域请求</p></li><li><p>服务器端收到一个跨域请求后，在响应头中添加Access-Control-Allow-Origin Header资源权限配置。发送响应</p></li><li><p>浏览器收到响应后，查看是否设置了<code>header(&#39;Access-Control-Allow-Origin:请求源域名或者*&#39;);</code></p><p>如果当前域已经得到授权，则将结果返回给<a href="http://lib.csdn.net/base/javascript" target="_blank" rel="noopener">JavaScript</a>。否则浏览器忽略此次响应。</p></li></ol><p>结论：</p><ol><li><strong>跨域行为是浏览器行为，响应式回来了的, 只是浏览器安全机制做了限制,  对于跨域响应内容进行了忽略。</strong></li><li><strong>服务器与服务器之间是不存在跨域的问题的</strong></li></ol><h3 id="jsonp与cors的对比"><a href="#jsonp与cors的对比" class="headerlink" title="jsonp与cors的对比"></a>jsonp与cors的对比</h3><ul><li>jsonp兼容性好，老版本浏览器也支持，但是jsonp仅支持get请求，发送的数据量有限。使用麻烦</li><li>cors需要浏览器支持cors功能才行。但是使用简单，<strong>只要服务端设置允许跨域，对于客户端来说，跟普通的get、post请求并没有什么区别。</strong></li><li>跨域的安全性问题：<strong>因为跨域是需要服务端配合控制的</strong> ，也就是说不论jsonp还是cors，如果没有服务端的允许，浏览器是没法做到跨域的。</li></ul><p>【案例：图灵机器人】</p><h3 id="其他的跨域手段"><a href="#其他的跨域手段" class="headerlink" title="其他的跨域手段"></a>其他的跨域手段</h3><p>以下方式基本不用啊，了解即可：</p><p>1、顶级域名相同的可以通过domain.name来解决，即同时设置 domain.name = 顶级域名（如example.com）<br>2、document.domain + iframe<br>3、window.name + iframe<br>4、location.hash + iframe<br>5、window.postMessage()</p><p><a href="http://rickgray.me/2015/09/03/solutions-to-cross-domain-in-browser.html" target="_blank" rel="noopener">其他跨域方式</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;前言&quot;&gt;&lt;a href=&quot;#前言&quot; class=&quot;headerlink&quot; title=&quot;前言&quot;&gt;&lt;/a&gt;前言&lt;/h1&gt;&lt;p&gt;我们使用php动态渲染页面时，有很多比较麻烦的地方。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;在前端写好页面以后，需要后台进行修改，意味这后端程序员也需要
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>循环语句</title>
    <link href="http://yoursite.com/2019/11/30/%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5/"/>
    <id>http://yoursite.com/2019/11/30/%E5%BE%AA%E7%8E%AF%E8%AF%AD%E5%8F%A5/</id>
    <published>2019-11-30T10:46:21.000Z</published>
    <updated>2020-04-14T02:52:17.018Z</updated>
    
    <content type="html"><![CDATA[<h1 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h1><p><strong>为什么要学习流程控制</strong></p><blockquote><p>实际项目中, 不可能都是简单的顺序结构(从上往下执行),  会出现不同的条件, 就要根据条件不同做出相应的处理</p></blockquote><blockquote><p>程序的三种基本结构</p></blockquote><h2 id="顺序结构"><a href="#顺序结构" class="headerlink" title="顺序结构"></a>顺序结构</h2><ul><li><p>从上到下执行的代码就是顺序结构</p></li><li><p>程序默认就是从上到下,一行一行的顺序执行的</p></li><li><pre><code class="js"><span class="built_in">console</span>.log(<span class="string">"哈哈1"</span>);<span class="built_in">console</span>.log(<span class="string">"哈哈2"</span>);<span class="built_in">console</span>.log(<span class="string">"哈哈3"</span>);&lt;!--￼<span class="number">0</span>--&gt;</code></pre></li></ul><ul><li><p>if..else 语句  ==&gt; 可能性有2种</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 语法</span></span><br><span class="line"><span class="keyword">if</span> (条件) &#123;</span><br><span class="line">    <span class="comment">// 当条件为 true 时执行的代码</span></span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 当条件不为 true 时执行的代码</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> age = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">if</span> (age &gt;= <span class="number">18</span>) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'已成年'</span>)</span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'未成年'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><ul><li><p>if..else if ..else 语句   ==&gt; 可能性有2种以上</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> (条件<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="comment">// 当条件1为  true 时执行的代码</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span> (条件<span class="number">2</span>)&#123;</span><br><span class="line">    <span class="comment">// 当条件2 为true 时执行的代码</span></span><br><span class="line">&#125;<span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 当条件1和 条件2 都不为true 时执行的代码</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> age = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(age &lt; <span class="number">18</span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"未成年"</span>);</span><br><span class="line"></span><br><span class="line">  &#125;<span class="keyword">else</span> <span class="keyword">if</span>(age &gt; <span class="number">18</span>&amp;&amp;age&lt;<span class="number">60</span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"劳动力"</span>);</span><br><span class="line"></span><br><span class="line">  &#125;<span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"退休人员"</span>);</span><br><span class="line"></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure></li></ul><hr><p>练习 :</p>  <figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span> 判断一个数是偶数还是奇数</span><br><span class="line"><span class="number">2.</span> 判断年龄大于等于<span class="number">14</span>,并且 是个男孩就可以玩游戏了 =&gt; &amp;&amp;</span><br><span class="line">   判断年龄大于等于 <span class="number">14</span> ,或者是个女孩,,就可以报舞蹈班了 =&gt; ||</span><br><span class="line"><span class="number">3.</span> 素质教育，把百分制分数转换成ABCDE   </span><br><span class="line">  A: <span class="number">90</span><span class="number">-100</span></span><br><span class="line">  B: <span class="number">80</span><span class="number">-89</span></span><br><span class="line">      C: <span class="number">70</span><span class="number">-79</span></span><br><span class="line">      D: <span class="number">60</span><span class="number">-69</span></span><br><span class="line">      E: <span class="number">0</span><span class="number">-59</span></span><br></pre></td></tr></table></figure><h2 id="第2个分支语句-三元运算符"><a href="#第2个分支语句-三元运算符" class="headerlink" title="第2个分支语句 : 三元运算符"></a>第2个分支语句 : 三元运算符</h2><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">条件 ? 值<span class="number">1</span> : 值<span class="number">2</span>    <span class="comment">/*或者*/</span>   条件 ? 表达式<span class="number">1</span> : 表达式<span class="number">2</span>  </span><br><span class="line"><span class="number">1.</span> 三元运算符会得到一个结果，结果根据<span class="string">`条件`</span>来确定。</span><br><span class="line"><span class="number">2.</span> 如果<span class="string">`条件`</span>的值为<span class="literal">true</span>，会返回表达式<span class="number">1</span>的值/值<span class="number">1</span></span><br><span class="line"><span class="number">3.</span> 如果<span class="string">`条件`</span>的值为<span class="literal">false</span>，会返回表达式<span class="number">2</span>的值/值<span class="number">2</span></span><br></pre></td></tr></table></figure><p>案例 :</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//求两个数的最大值</span></span><br><span class="line"><span class="keyword">var</span> n1,n2</span><br><span class="line"><span class="keyword">var</span> max = n1 &gt; n2 ? n1 : n2;</span><br><span class="line"></span><br><span class="line"><span class="comment">//思考1：求两个数的最小值</span></span><br><span class="line"><span class="comment">//思考2：判断成年还是未成年, 并返回字符串</span></span><br><span class="line"><span class="comment">//思考3：求三个数的最小值</span></span><br></pre></td></tr></table></figure><h2 id="第3个分支语句-switch语句"><a href="#第3个分支语句-switch语句" class="headerlink" title="第3个分支语句 :switch语句"></a>第3个分支语句 :switch语句</h2><blockquote><p>if..else适用于范围的判断，switch..case适用于具体的值的判断</p></blockquote><p>语法格式 : </p><blockquote><p>switch case break default </p></blockquote><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">switch</span> (变量) &#123;</span><br><span class="line">  <span class="keyword">case</span> 值<span class="number">1</span>:</span><br><span class="line">    语句<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> 值<span class="number">2</span>:</span><br><span class="line">    语句<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  <span class="keyword">case</span> 值<span class="number">3</span>:</span><br><span class="line">    语句<span class="number">3</span>;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  …</span><br><span class="line">  <span class="keyword">default</span>:</span><br><span class="line">    默认语句;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>注意 : </p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">break</span>可以省略，如果省略，代码会继续执行下一个<span class="keyword">case</span></span><br><span class="line"><span class="keyword">switch</span> 语句在比较值时使用的是全等操作符, 因此不会发生类型转换（例如，字符串<span class="string">'10'</span> 不等于数值 <span class="number">10</span>）</span><br></pre></td></tr></table></figure><p>案例 : </p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">输入一个数字，显示星期几</span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> num = <span class="string">"10"</span>; </span><br><span class="line"><span class="keyword">switch</span> (num) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">10</span>:</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"10"</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">20</span>:</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"20"</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">30</span>:</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"30"</span>);</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">"lalala"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="使用场景"><a href="#使用场景" class="headerlink" title="使用场景"></a>使用场景</h2><ol><li>如果是范围性的判断，使用if..else会更加方便</li><li>如果是对具体值的判断，使用switch..case语句会更加方便，当然用if..else也是可以的。</li><li>如果if..else比较简单，可以使用三元运算符进行替代。</li></ol><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//练习1：输入ABCDE </span></span><br><span class="line"><span class="comment">//如果考了A：  优秀</span></span><br><span class="line"><span class="comment">//如果考了B：  良好</span></span><br><span class="line"><span class="comment">//如果考了C：  中等</span></span><br><span class="line"><span class="comment">//如果考了D：  较差</span></span><br><span class="line"><span class="comment">//如果考了E：  差</span></span><br><span class="line"><span class="comment">//如果是其他值，提示代码有bug</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//练习2： 根据年龄判断自己属于什么身份</span></span><br><span class="line">   <span class="comment">//如果小于18:  非法劳动力</span></span><br><span class="line">   <span class="comment">//如果18-60： 合法劳动力</span></span><br><span class="line">   <span class="comment">//如果大于60 ： 退休人员</span></span><br></pre></td></tr></table></figure><h1 id="循环语句-3个"><a href="#循环语句-3个" class="headerlink" title="循环语句 (3个)"></a>循环语句 (3个)</h1><blockquote><p>在javascript中，循环语句有三种，while、do..while、for循环。</p><p>循环语句的目的 : 解决需要重复执行某些语句的代码</p></blockquote><h2 id="第1个循环语句-while循环"><a href="#第1个循环语句-while循环" class="headerlink" title="第1个循环语句 : while循环"></a>第1个循环语句 : while循环</h2><p><img src="/" class="lazyload" data-src="/.com//D:%5CDesktop%5CmyHexoBlog%5Csource_posts%5Cjs%E8%BF%9B%E9%98%B6%5Cwhile.png"  alt></p><p>基本语法 :</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//当循环条件为true时，执行循环体，</span></span><br><span class="line"><span class="comment">//当循环条件为false时，结束循环。</span></span><br><span class="line"><span class="comment">//一定要给出停止条件，否则会内存溢出导致浏览器崩溃 </span></span><br><span class="line"><span class="keyword">while</span>(循环条件)&#123;</span><br><span class="line">  <span class="comment">//循环体：需要循环执行的语句</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>代码示例:</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1. 打印1-100之间所有的数</span></span><br><span class="line"><span class="comment">//2. 计算1-100之间所有数的和</span></span><br></pre></td></tr></table></figure><p>练习 : </p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1. 计算100内所有偶数的和 循环+判断</span></span><br><span class="line"><span class="comment">//2. 让用户输入密码，只有当密码='123 ' 否则一直弹框   ==&gt; 循环体是什么????</span></span><br></pre></td></tr></table></figure><h2 id="第2个循环语句-do-while循环"><a href="#第2个循环语句-do-while循环" class="headerlink" title="第2个循环语句 : do..while循环"></a>第2个循环语句 : do..while循环</h2><blockquote><p>do..while循环和while循环非常像，二者经常可以相互替代，但是do..while的特点是不管条件成不成立，都会执行一次。</p></blockquote><p><img src="/" class="lazyload" data-src="/.com//D:%5CDesktop%5CmyHexoBlog%5Csource_posts%5Cjs%E8%BF%9B%E9%98%B6%5Cdowhile.png"  alt></p><p>基础语法 : </p> <figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="comment">//循环体;</span></span><br><span class="line">&#125;<span class="keyword">while</span>(条件)</span><br></pre></td></tr></table></figure><p>代码示例 :</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//初始化变量</span></span><br><span class="line"><span class="keyword">var</span> i = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">var</span> sum = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">do</span>&#123;</span><br><span class="line">  sum += i;<span class="comment">//循环体</span></span><br><span class="line">  i++;<span class="comment">//自增</span></span><br><span class="line">&#125;<span class="keyword">while</span>(i &lt;= <span class="number">100</span>);<span class="comment">//循环条件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> i=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">do</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i)</span><br><span class="line">    i++</span><br><span class="line">&#125;<span class="keyword">while</span>(i&gt;<span class="number">100</span>)</span><br></pre></td></tr></table></figure><p>练习:</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 1. 计算1-100所有偶数的和</span></span><br><span class="line"><span class="keyword">do</span>...while</span><br><span class="line">课后练习:</span><br><span class="line"><span class="comment">// 2. 循环输入密码的案例用do..while怎么写？</span></span><br></pre></td></tr></table></figure><p>思考 : </p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">// while循环与do..while循环的区别是啥？</span></span><br></pre></td></tr></table></figure><p>##断点调试   (超级重要)</p><blockquote><p> 断点调试是指自己在程序的某一行设置一个断点，调试时，程序运行到这一行就会停住，然后你可以一步一步往下调试，调试过程中可以看各个变量当前的值，出错的话，调试到出错的代码行即显示错误，停下。</p></blockquote><p>调试步骤：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">浏览器中按F12--&gt;sources--&gt;找到需要调试的文件--&gt;在程序的某一行设置断点</span><br></pre></td></tr></table></figure><p>调试中的相关操作</p><p><img src="/" class="lazyload" data-src="/.com//D:%5CDesktop%5CmyHexoBlog%5Csource_posts%5Cjs%E8%BF%9B%E9%98%B6%5Ctiaoshi.png"  alt></p><p>练习调试 : </p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="number">3</span>以内的数相加</span><br></pre></td></tr></table></figure><h2 id="第3个循环语句-for循环-重点"><a href="#第3个循环语句-for循环-重点" class="headerlink" title="第3个循环语句 : for循环  (重点)"></a>第3个循环语句 : for循环  (重点)</h2><blockquote><p>写while循环的经常会忘记自增，for循环其实是while循环演化过来的，语法更加的简洁明了，使用非常的广泛。</p></blockquote><p><img src="/" class="lazyload" data-src="/.com//D:%5CDesktop%5CmyHexoBlog%5Csource_posts%5Cjs%E8%BF%9B%E9%98%B6%5Cfor.png"  alt></p><p>for循环语法：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1. for循环使用分号分隔</span></span><br><span class="line"><span class="comment">//2. for循环有2个分号，两个分号不能少</span></span><br><span class="line"><span class="keyword">for</span>(初始化语句;判断语句;自增/自减语句)&#123;</span><br><span class="line">  <span class="comment">//循环体</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>执行顺序：1243  —-  243   —–243(直到循环条件变成false)</p><ol><li>初始化语句</li><li>判断语句</li><li>自增或者自减</li><li>循环体</li></ol><p>for循环代码示例：</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line">  <span class="comment">//1. 打印1-5之间所有数</span></span><br><span class="line"><span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">1</span>;i&lt;=<span class="number">5</span>;i++ ) &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//2. 打印1-10之间所有数和</span></span><br></pre></td></tr></table></figure><p>思考1：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1 求1-100之间所有数的和、平均值</span></span><br><span class="line"><span class="comment">//2 求1-100之间所有数的乘积</span></span><br><span class="line"><span class="comment">//3 计算1-100之间能3整除的数的和</span></span><br></pre></td></tr></table></figure><p>思考2：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1 计算1-100之间不能被7整除的数的和</span></span><br><span class="line"><span class="comment">//2 求1-100之间所有偶数的和</span></span><br><span class="line"><span class="comment">//3 同时求1-100之间所有偶数和奇数的和</span></span><br></pre></td></tr></table></figure><p><strong>for一般用在知道具体次数的情况；while适用于不知道具体次数的时候</strong></p><p>思考3（双重for循环）： </p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1  网页打印5*5方形★阵  document.write();</span></span><br><span class="line"><span class="comment">//2  网页打印直角三角形</span></span><br><span class="line"><span class="comment">//3  网页打印9*9乘法表</span></span><br><span class="line"><span class="comment">//1*1=1</span></span><br><span class="line"><span class="comment">//1*2=2 2*2=4</span></span><br><span class="line"><span class="comment">//1*3=3 2*3=6 3*3=9</span></span><br></pre></td></tr></table></figure><h2 id="break和continue"><a href="#break和continue" class="headerlink" title="break和continue"></a>break和continue</h2><blockquote><p>break:    结束/中止for循环</p><p>​          立即跳出当前整个循环，即循环结束，开始执行循环后面的内容（直接跳传出大括号）</p><p>​     一般写在打印之后</p><p>continue:   结束本次循环,进行下一个循环</p><p>​           立即跳出当前循环，继续下一次循环（跳到i++的 地方） (放打印代码前面)</p><p>​    一般写在打印之前</p></blockquote><p>需求 :</p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1. 打印 1-5 , 当打印完第3个的时候,停止打印</span></span><br><span class="line"><span class="comment">//2. 打印 1-5 , 当第3个的时候,不打印 ,,1 2 4 5</span></span><br></pre></td></tr></table></figure><p>思考 : </p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1. 找到1-100之间第一个能被7整除的数</span></span><br><span class="line"><span class="comment">//2. 打印1-10之间所有的数，除了5这个数</span></span><br><span class="line"></span><br><span class="line">思路:</span><br><span class="line"><span class="comment">//1.1 for (1-100)</span></span><br><span class="line"><span class="comment">//1.2 %7 ==0;</span></span><br><span class="line"><span class="comment">//1.3 中止</span></span><br><span class="line"><span class="comment">// 2.1 打印 1-10个数 </span></span><br><span class="line"><span class="comment">// 2.2 打印到5的时候,调出去</span></span><br></pre></td></tr></table></figure><p>思考1 : </p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//输出结果是什么？</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">1</span>; i &lt;=<span class="number">10</span>; i++) &#123;</span><br><span class="line">  <span class="keyword">if</span>(i == <span class="number">5</span>)&#123;</span><br><span class="line">    <span class="keyword">continue</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span>(i == <span class="number">7</span>)&#123;</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">console</span>.log(i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>思考2 : </p><figure class="highlight js"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1. 求1-100之间不能被7整除的整数的和（用continue）</span></span><br><span class="line"><span class="comment">//2. 求200-300之间所有的奇数的和（用continue）</span></span><br><span class="line"><span class="comment">//3. 求200-300之间第一个能被7整数的数（break）</span></span><br><span class="line">总结 : </span><br><span class="line"><span class="number">1.</span><span class="keyword">continue</span> 把所有满足条件的都先打印出来,,找到不满足的提出去</span><br><span class="line"><span class="number">2.</span><span class="keyword">break</span> : 找到对应的拿到,然后中止</span><br></pre></td></tr></table></figure><h2 id="总结"><a href="#总结" class="headerlink" title="总结 :"></a>总结 :</h2><ol><li>循环有很多种，但是以后用得最多的是for循环</li><li>当不明确循环次数的时候，可以使用while循环</li><li>当无论如何都要执行一次代码的时候，可以使用do..while循环。</li><li>循环可以相互替代。</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;流程控制&quot;&gt;&lt;a href=&quot;#流程控制&quot; class=&quot;headerlink&quot; title=&quot;流程控制&quot;&gt;&lt;/a&gt;流程控制&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;为什么要学习流程控制&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;实际项目中, 不可能都是简单
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>jQuery-03</title>
    <link href="http://yoursite.com/2019/11/28/jQuery-03/"/>
    <id>http://yoursite.com/2019/11/28/jQuery-03/</id>
    <published>2019-11-28T10:41:37.000Z</published>
    <updated>2020-04-13T10:42:14.461Z</updated>
    
    <content type="html"><![CDATA[<h1 id="jQuery补充知识点"><a href="#jQuery补充知识点" class="headerlink" title="jQuery补充知识点"></a>jQuery补充知识点</h1><h2 id="隐式迭代"><a href="#隐式迭代" class="headerlink" title="隐式迭代"></a>隐式迭代</h2><h3 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h3><blockquote><p>隐式迭代：jQuery在设置属性时会自动的遍历，因此我们不需要再遍历</p></blockquote><ol><li>jQuery在执行设置性操作时，会给所有的元素都设置上相同的值。</li><li>jQuery在执行获取性操作时，只会返回第一个元素对应的值。</li><li>如果想要给每一个元素都设置不同的值，需要手动进行遍历jQuery对象。</li></ol><h3 id="each方法"><a href="#each方法" class="headerlink" title="each方法"></a>each方法</h3><blockquote><p>遍历jQuery对象集合，为每个匹配的元素执行一个函数</p></blockquote><p>语法：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 参数一表示当前元素在所有匹配元素中的索引号</span></span><br><span class="line"><span class="comment">// 参数二表示当前元素, 在function中this也表示当前元素。</span></span><br><span class="line">$(selector).each(<span class="function"><span class="keyword">function</span>(<span class="params">index,element</span>)</span>&#123;&#125;);</span><br></pre></td></tr></table></figure><p>【案例：不同的透明度.html】</p><h2 id="链式编程"><a href="#链式编程" class="headerlink" title="链式编程"></a>链式编程</h2><blockquote><p>链式编程的原理：设置性操作会返回一个jQuery对象，因此可以继续调用jQuery的方法。</p></blockquote><ol><li>设置操作的时候，可以使用链式编程。</li><li>获取操作的时候，无法使用链式编程。</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">end(); <span class="comment">// 筛选选择器会改变jQuery对象的DOM对象，想要回复到上一次的状态，并且返回匹配元素之前的状态。</span></span><br></pre></td></tr></table></figure><p>【案例：五角星评分案例.html】</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">prevAll();<span class="comment">//获取前面所有的兄弟元素</span></span><br><span class="line">nextAll();<span class="comment">//获取后面所有的兄弟元素</span></span><br><span class="line">siblings();<span class="comment">//获取所有的兄弟元素</span></span><br><span class="line">prev();<span class="comment">//获取前一个兄弟</span></span><br><span class="line">next();<span class="comment">//获取后一个兄弟。</span></span><br></pre></td></tr></table></figure><h2 id="多库共存"><a href="#多库共存" class="headerlink" title="多库共存"></a>多库共存</h2><blockquote><p>jQuery使用<code>$</code>作为标示符，但是如果与其他框架中的$冲突时，jQuery可以释放<code>$</code>符的控制权.</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> c = $.noConflict();<span class="comment">//释放$的控制权,并且把$的能力给了c</span></span><br></pre></td></tr></table></figure><h1 id="jQuery插件"><a href="#jQuery插件" class="headerlink" title="jQuery插件"></a>jQuery插件</h1><blockquote><p>插件：jquery不可能包含所有的功能，我们可以通过插件扩展jquery的功能。</p></blockquote><p>jQuery有着丰富的插件，使用这些插件能给jQuery提供一些额外的功能。</p><h2 id="使用插件"><a href="#使用插件" class="headerlink" title="使用插件"></a>使用插件</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span> 引入jQuery文件</span><br><span class="line"><span class="number">2.</span> 引入插件（如果有用到css的话，需要引入css）</span><br><span class="line"><span class="number">3.</span> 使用插件</span><br></pre></td></tr></table></figure><p>常用插件的使用</p><ul><li>jquery.color.js的使用<ul><li><a href="https://github.com/jquery/jquery-color" target="_blank" rel="noopener">https://github.com/jquery/jquery-color</a></li></ul></li></ul><ul><li>jquery.lazyload.js的使用<ul><li><a href="https://github.com/tuupola/jquery_lazyload" target="_blank" rel="noopener">https://github.com/tuupola/jquery_lazyload</a></li></ul></li><li>jquery.ui插件的使用</li></ul><h2 id="制作jQuery插件"><a href="#制作jQuery插件" class="headerlink" title="制作jQuery插件"></a>制作jQuery插件</h2><blockquote><p>制作jQuery插件的核心思想：给jQuery的原型增加方法即可。</p><p>jQuery.prototype .sayHi=function(){}</p><p>jQuery.fn.sayHi=function(){}</p><p>$.fn.sayHi=function(){}</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$.fn.pluginName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;</span><br></pre></td></tr></table></figure><ul><li>制作基本的jQuery插件  bgc</li></ul><h1 id="jQuery框架封装"><a href="#jQuery框架封装" class="headerlink" title="jQuery框架封装"></a>jQuery框架封装</h1>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;jQuery补充知识点&quot;&gt;&lt;a href=&quot;#jQuery补充知识点&quot; class=&quot;headerlink&quot; title=&quot;jQuery补充知识点&quot;&gt;&lt;/a&gt;jQuery补充知识点&lt;/h1&gt;&lt;h2 id=&quot;隐式迭代&quot;&gt;&lt;a href=&quot;#隐式迭代&quot; class=&quot;
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>jQuery-02</title>
    <link href="http://yoursite.com/2019/11/26/jQuery-02/"/>
    <id>http://yoursite.com/2019/11/26/jQuery-02/</id>
    <published>2019-11-26T10:39:17.000Z</published>
    <updated>2020-04-14T01:06:28.677Z</updated>
    
    <content type="html"><![CDATA[<h1 id="jQuery操作样式"><a href="#jQuery操作样式" class="headerlink" title="jQuery操作样式"></a>jQuery操作样式</h1><h2 id="css操作"><a href="#css操作" class="headerlink" title="css操作"></a>css操作</h2><blockquote><p>功能：设置或者修改样式，操作的是style属性。</p></blockquote><blockquote><p>操作单个样式</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//name：需要设置的样式名称</span></span><br><span class="line"><span class="comment">//value：对应的样式值</span></span><br><span class="line">css(name, value);</span><br><span class="line"><span class="comment">//使用案例</span></span><br><span class="line">$(<span class="string">"#one"</span>).css(<span class="string">"background"</span>,<span class="string">"gray"</span>);<span class="comment">//将背景色修改为灰色</span></span><br></pre></td></tr></table></figure><blockquote><p>设置多个样式</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//参数是一个对象，对象中包含了需要设置的样式名和样式值</span></span><br><span class="line">css(obj);</span><br><span class="line"><span class="comment">//使用案例</span></span><br><span class="line">$(<span class="string">"#one"</span>).css(&#123;</span><br><span class="line">    <span class="string">"background"</span>:<span class="string">"gray"</span>,</span><br><span class="line">    <span class="string">"width"</span>:<span class="string">"400px"</span>,</span><br><span class="line">    <span class="string">"height"</span>:<span class="string">"200px"</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><blockquote><p>获取样式</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//name:需要获取的样式名称</span></span><br><span class="line">css(name);</span><br><span class="line"><span class="comment">//案例</span></span><br><span class="line">$(<span class="string">"div"</span>).css(<span class="string">"background-color"</span>);</span><br></pre></td></tr></table></figure><p>注意：获取样式操作只会返回第一个元素对应的样式值。</p><p>隐式迭代：</p><ol><li>设置操作的时候，如果是多个元素，那么给所有的元素设置相同的值</li><li>获取操作的时候，如果是多个元素，那么只会返回第一个元素的值。</li></ol><h2 id="class操作"><a href="#class操作" class="headerlink" title="class操作"></a>class操作</h2><blockquote><p>添加样式类</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//name：需要添加的样式类名，注意参数不要带点.</span></span><br><span class="line">addClass(name);</span><br><span class="line"><span class="comment">//例子,给所有的div添加one的样式。</span></span><br><span class="line">$(“div”).addClass(“one”);</span><br></pre></td></tr></table></figure><blockquote><p>移除样式类</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//name:需要移除的样式类名</span></span><br><span class="line">removeClass(“name”);</span><br><span class="line"><span class="comment">//例子，移除div中one的样式类名</span></span><br><span class="line">$(“div”).removeClass(“one”);</span><br></pre></td></tr></table></figure><blockquote><p>判断是否有某个样式类</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//name:用于判断的样式类名，返回值为true false</span></span><br><span class="line">hasClass(name)</span><br><span class="line"><span class="comment">//例子，判断每一个div是否有one的样式类</span></span><br><span class="line">$(“div”).hasClass(“one”);</span><br></pre></td></tr></table></figure><blockquote><p>切换样式类</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//name:需要切换的样式类名，如果有，移除该样式，如果没有，添加该样式。</span></span><br><span class="line">toggleClass(name);</span><br><span class="line"><span class="comment">//例子</span></span><br><span class="line">$(“div”).toggleClass(“one”);</span><br></pre></td></tr></table></figure><p>【案例：tab栏切换案例.html】</p><h1 id="jQuery操作属性"><a href="#jQuery操作属性" class="headerlink" title="jQuery操作属性"></a>jQuery操作属性</h1><h2 id="attr操作"><a href="#attr操作" class="headerlink" title="attr操作"></a>attr操作</h2><blockquote><p>设置单个属性</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//第一个参数：需要设置的属性名</span></span><br><span class="line"><span class="comment">//第二个参数：对应的属性值</span></span><br><span class="line">attr(name, value);</span><br><span class="line"><span class="comment">//用法举例</span></span><br><span class="line">$(“img”).attr(“title”,”哎哟，不错哦”);</span><br><span class="line">$(“img”).attr(“alt”,“哎哟，不错哦”);</span><br></pre></td></tr></table></figure><blockquote><p>设置多个属性</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//参数是一个对象，包含了需要设置的属性名和属性值</span></span><br><span class="line">attr(obj)</span><br><span class="line"><span class="comment">//用法举例</span></span><br><span class="line">$(<span class="string">"img"</span>).attr(&#123;</span><br><span class="line">    title:<span class="string">"哎哟，不错哦"</span>,</span><br><span class="line">    alt:<span class="string">"哎哟，不错哦"</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><blockquote><p>获取属性</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//传需要获取的属性名称，返回对应的属性值</span></span><br><span class="line">attr(name)</span><br><span class="line"><span class="comment">//用法举例</span></span><br><span class="line"><span class="keyword">var</span> oTitle = $(<span class="string">"img"</span>).attr(<span class="string">"title"</span>);</span><br><span class="line">alert(oTitle);</span><br></pre></td></tr></table></figure><blockquote><p>移除属性</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//参数：需要移除的属性名，</span></span><br><span class="line">removeAttr(name);</span><br><span class="line"><span class="comment">//用法举例</span></span><br><span class="line">$(<span class="string">"img"</span>).removeAttr(<span class="string">"title"</span>);</span><br></pre></td></tr></table></figure><p>【案例：美女相册.html】</p><h2 id="prop操作"><a href="#prop操作" class="headerlink" title="prop操作"></a>prop操作</h2><blockquote><p>在jQuery1.6之后，对于checked、selected、disabled这类boolean类型的属性来说，不能用attr方法，只能用prop方法。</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//设置属性</span></span><br><span class="line">$(“:checked”).prop(“checked”,<span class="literal">true</span>);</span><br><span class="line"><span class="comment">//获取属性</span></span><br><span class="line">$(“:checked”).prop(“checked”);<span class="comment">//返回true或者false</span></span><br></pre></td></tr></table></figure><p>【案例：表格全选案例.html】</p><h1 id="jQuery动画"><a href="#jQuery动画" class="headerlink" title="jQuery动画"></a>jQuery动画</h1><blockquote><p>jquery提供了三组基本动画，这些动画都是标准的、有规律的效果，jquery还提供了自定义动画的功能。【演示动画例子】</p></blockquote><h2 id="三组基本动画"><a href="#三组基本动画" class="headerlink" title="三组基本动画"></a>三组基本动画</h2><blockquote><p>显示(show)与隐藏(hide)是一组动画：<br>滑入(slideUp)与滑出(slideDown)与切换(slideToggle)，效果与卷帘门类似<br>淡入(fadeIn)与淡出(fadeOut)与切换(fadeToggle)</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">show([speed],easing, [callback]);</span><br><span class="line"><span class="comment">//speed(可选)：动画的执行时间</span></span><br><span class="line"> <span class="comment">//1.如果不传，就没有动画效果。如果是slide和fade系列，会默认为normal</span></span><br><span class="line"> <span class="comment">//2.毫秒值(比如1000),动画在1000毫秒执行完成(推荐)</span></span><br><span class="line">     <span class="comment">//3.固定字符串，slow(200)、normal(400)、fast(600)，如果传其他字符串，则默认为normal。</span></span><br><span class="line"><span class="comment">//easing:动画效果，默认值是swing（慢-快-慢），linear(匀速)</span></span><br><span class="line"><span class="comment">//callback(可选):执行完动画后执行的回调函数</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">【案例：京东轮播图(呼吸灯).html】</span><br></pre></td></tr></table></figure><h2 id="自定义动画"><a href="#自定义动画" class="headerlink" title="自定义动画"></a>自定义动画</h2><blockquote><p>animate: 自定义动画</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$(selector).animate(&#123;params&#125;,[speed],[easing],[callback]);</span><br><span class="line"><span class="comment">// &#123;params&#125;：要执行动画的CSS属性，带数字（必选）</span></span><br><span class="line"><span class="comment">// speed：执行动画时长（可选）</span></span><br><span class="line"><span class="comment">// easing:执行效果，默认为swing（缓动）  可以是linear（匀速）</span></span><br><span class="line"><span class="comment">// callback：动画执行完后立即执行的回调函数（可选）</span></span><br></pre></td></tr></table></figure><h2 id="动画队列与停止动画"><a href="#动画队列与停止动画" class="headerlink" title="动画队列与停止动画"></a>动画队列与停止动画</h2><blockquote><p>在同一个元素上执行多个动画，那么对于这个动画来说，后面的动画会被放到动画队列中，等前面的动画执行完成了才会执行（联想：火车进站）。</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//stop方法：停止动画效果</span></span><br><span class="line">stop(clearQueue, jumpToEnd);</span><br><span class="line"><span class="comment">//第一个参数：是否清除队列</span></span><br><span class="line"><span class="comment">//第二个参数：是否跳转到最终效果</span></span><br></pre></td></tr></table></figure><p>【案例：手风琴特效】<br>【案例：音乐导航】</p><h1 id="jQuery节点操作"><a href="#jQuery节点操作" class="headerlink" title="jQuery节点操作"></a>jQuery节点操作</h1><h2 id="创建节点"><a href="#创建节点" class="headerlink" title="创建节点"></a>创建节点</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//$(htmlStr)</span></span><br><span class="line"><span class="comment">//htmlStr：html格式的字符串</span></span><br><span class="line">$(“&lt;span&gt;这是一个span元素&lt;<span class="regexp">/span&gt;”);</span></span><br></pre></td></tr></table></figure><h2 id="添加节点"><a href="#添加节点" class="headerlink" title="添加节点"></a>添加节点</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//append  appendTo</span></span><br><span class="line"><span class="comment">//prepend prependTo</span></span><br><span class="line"><span class="comment">//before</span></span><br><span class="line"><span class="comment">//after</span></span><br></pre></td></tr></table></figure><p>【案例：城市选择案例.html】</p><h2 id="清空节点与删除节点"><a href="#清空节点与删除节点" class="headerlink" title="清空节点与删除节点"></a>清空节点与删除节点</h2><blockquote><p>empty：清空指定节点的所有元素，自身保留(清理门户)</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$(“div”).empty();<span class="comment">//清空div的所有内容（推荐使用，会清除子元素上绑定的内容，源码）</span></span><br><span class="line">$(“div”).html(“”);<span class="comment">//使用html方法来清空元素，不推荐使用，会造成内存泄漏，绑定的事件不会被清除。</span></span><br></pre></td></tr></table></figure><blockquote><p>remove：相比于empty，自身也删除（自杀）</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$(“div”).remove();</span><br></pre></td></tr></table></figure><h2 id="克隆节点"><a href="#克隆节点" class="headerlink" title="克隆节点"></a>克隆节点</h2><blockquote><p>作用：复制匹配的元素</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 复制$(selector)所匹配到的元素（深度复制）</span></span><br><span class="line"><span class="comment">//cloneNode(true)</span></span><br><span class="line"><span class="comment">// 返回值为复制的新元素，和原来的元素没有任何关系了。即修改新元素，不会影响到原来的元素。</span></span><br><span class="line">$(selector).clone();</span><br></pre></td></tr></table></figure><p>【案例：微博发布】<br>【案例：弹幕效果】</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;jQuery操作样式&quot;&gt;&lt;a href=&quot;#jQuery操作样式&quot; class=&quot;headerlink&quot; title=&quot;jQuery操作样式&quot;&gt;&lt;/a&gt;jQuery操作样式&lt;/h1&gt;&lt;h2 id=&quot;css操作&quot;&gt;&lt;a href=&quot;#css操作&quot; class=&quot;he
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>jQuery-01</title>
    <link href="http://yoursite.com/2019/11/25/jQuery-01/"/>
    <id>http://yoursite.com/2019/11/25/jQuery-01/</id>
    <published>2019-11-25T10:38:15.000Z</published>
    <updated>2020-04-14T03:03:19.005Z</updated>
    
    <content type="html"><![CDATA[<h1 id="jQuery基本介绍"><a href="#jQuery基本介绍" class="headerlink" title="jQuery基本介绍"></a>jQuery基本介绍</h1><h2 id="为什么要学jQuery"><a href="#为什么要学jQuery" class="headerlink" title="为什么要学jQuery"></a>为什么要学jQuery</h2><p>【01-让div显示与设置内容.html】</p><p>使用JS操作DOM的时候，会遇到以下的一些缺点：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1. 获取元素的方法太少且长，麻烦。</span></span><br><span class="line"><span class="comment">//2. 遍历伪数组很麻烦，通常要嵌套一大堆的for循环。</span></span><br><span class="line"><span class="comment">//3. 注册的事件会覆盖。</span></span><br><span class="line"><span class="comment">//4. 有兼容性问题。</span></span><br><span class="line"><span class="comment">//5. 实现动画很麻烦</span></span><br></pre></td></tr></table></figure><h2 id="初体验"><a href="#初体验" class="headerlink" title="初体验"></a>初体验</h2><p>【02-让div显示与设置内容.html】</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    $(<span class="string">"#btn1"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="comment">//隐式迭代：偷偷的遍历，在jQuery中，不需要手动写for循环了，会自动进行遍历。</span></span><br><span class="line">        $(<span class="string">"div"</span>).show(<span class="number">200</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">    $(<span class="string">"#btn2"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        $(<span class="string">"div"</span>).text(<span class="string">"我是内容"</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>使用的优点</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//1. 获取元素的方式非常的简单，而且非常的丰富</span></span><br><span class="line"><span class="comment">//2. jQuery的隐式迭代特性，不再需要书写for循环语句。</span></span><br><span class="line"><span class="comment">//3. 使用jQuery完全不用考虑兼容性问题。</span></span><br><span class="line"><span class="comment">//4. jQuery提供了一系列动画相关的函数，使用非常方便。</span></span><br><span class="line"><span class="comment">//5. 代码简单、粗暴。</span></span><br></pre></td></tr></table></figure><p><strong>没有对比，就没有伤害，有了对比，处处戳中要害。</strong></p><h2 id="什么是jQuery"><a href="#什么是jQuery" class="headerlink" title="什么是jQuery?"></a>什么是jQuery?</h2><blockquote><p>jQuery是一个快速的、轻量的、功能丰富的js库。</p></blockquote><p>jQuery的官网 <a href="http://jquery.com/" target="_blank" rel="noopener">http://jquery.com/</a> </p><p>jQuery就是一个js库，使用jQuery的话，会比使用JavaScript更简单。</p><p>js库：把一些常用到的方法写到一个单独的js文件，使用的时候直接去引用这js文件就可以了。（animate.js、common.js）</p><h2 id="使用步骤"><a href="#使用步骤" class="headerlink" title="使用步骤"></a>使用步骤</h2><p>引包（引入js文件）</p><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"jquery-1.11.1.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>入口函数</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    </span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>功能实现</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">$(<span class="string">"#btnShowDiv"</span>).click(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">$(<span class="string">"div"</span>).show(<span class="number">1000</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="版本介绍"><a href="#版本介绍" class="headerlink" title="版本介绍"></a>版本介绍</h2><blockquote><p>官网下载地址：<a href="http://jquery.com/download/" target="_blank" rel="noopener">http://jquery.com/download/</a></p><p>jQuery版本有很多，分为1.x 2.x 3.x</p></blockquote><p>大版本分类：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span>x版本：能够兼容IE678浏览器（最终版本<span class="number">1.12</span><span class="number">.4</span>）</span><br><span class="line"><span class="number">2.</span>x版本：不兼容IE678浏览器（最终版本<span class="number">2.2</span><span class="number">.4</span>）</span><br><span class="line"></span><br><span class="line"><span class="comment">//jQuery目前正在更新的版本</span></span><br><span class="line"><span class="number">3.</span>x版本：不兼容IE678，更加的精简（在国内不流行，因为国内使用jQuery的主要目的就是兼容IE678）,<span class="number">3.</span>x版本只是在原来的基础上增加了一些新的特性。</span><br></pre></td></tr></table></figure><p>关于压缩版和未压缩版</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">jquery<span class="number">-1.12</span><span class="number">.4</span>.min.js:压缩版本，适用于生产环境，因为文件比较小，去除了注释、换行、空格等东西，但是基本没有颗阅读性。</span><br><span class="line">jquery<span class="number">-1.12</span><span class="number">.4</span>.js:未压缩版本，适用于学习与开发环境，源码清晰，易阅读。</span><br></pre></td></tr></table></figure><h2 id="入口函数"><a href="#入口函数" class="headerlink" title="入口函数"></a>入口函数</h2><p>入口函数的好处：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span> 等待文档加载完成，保证能够获取到元素</span><br><span class="line"><span class="number">2.</span> 形成了一个沙箱，防止全局变量污染。</span><br></pre></td></tr></table></figure><p>两种写法：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//第一种写法</span></span><br><span class="line">$(<span class="built_in">document</span>).ready(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//第二种写法</span></span><br><span class="line">$(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>jQuery入口函数与js入口函数的对比</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span>JavaScript的入口函数要等到页面中所有资源（包括图片、文件）加载完成才开始执行。</span><br><span class="line"><span class="number">2.</span>jQuery的入口函数只会等待文档树加载完成就开始执行，并不会等待图片、文件的加载。</span><br></pre></td></tr></table></figure><h2 id="jQuery对象与DOM对象-重点"><a href="#jQuery对象与DOM对象-重点" class="headerlink" title="jQuery对象与DOM对象(重点)"></a>jQuery对象与DOM对象(重点)</h2><p>基本概念：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span> DOM对象：使用JavaScript中的方法获取页面中的元素返回的对象就是dom对象。</span><br><span class="line"><span class="number">2.</span> jQuery对象：jquery对象就是使用jquery的方法获取页面中的元素返回的对象就是jQuery对象。</span><br><span class="line"><span class="number">3.</span> jQuery对象其实就是DOM对象的包装集（包装了DOM对象的集合（伪数组））</span><br></pre></td></tr></table></figure><p>jQuery对象与DOM对象的区别：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span> DOM对象与jQuery对象的方法不能混用。</span><br><span class="line"><span class="number">2.</span> DOM对象可以和jQuery对象相互转化</span><br></pre></td></tr></table></figure><p>DOM对象转换成jQuery对象：【联想记忆：花钱】</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> $obj = $(domObj);</span><br><span class="line"><span class="comment">// $(document).ready(function()&#123;&#125;);就是典型的DOM对象转jQuery对象</span></span><br></pre></td></tr></table></figure><p>jQuery对象转换成DOM对象：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> $li = $(“li”);</span><br><span class="line"><span class="comment">//第一种方法（推荐使用）</span></span><br><span class="line">$li[<span class="number">0</span>]</span><br><span class="line"><span class="comment">//第二种方法</span></span><br><span class="line">$li.get(<span class="number">0</span>)</span><br></pre></td></tr></table></figure><p>【练习：隔行变色案例.html】</p><p>【练习：开关灯案例】</p><h1 id="选择器"><a href="#选择器" class="headerlink" title="选择器"></a>选择器</h1><h2 id="什么是jQuery选择器"><a href="#什么是jQuery选择器" class="headerlink" title="什么是jQuery选择器"></a>什么是jQuery选择器</h2><p>jQuery选择器是jQuery为我们提供的一组方法，让我们更加方便的获取到页面中的元素。注意：jQuery选择器返回的是jQuery对象。</p><p>jQuery选择器有很多，基本兼容了CSS1到CSS3所有的选择器，并且jQuery还添加了很多更加复杂的选择器。【查看jQuery文档】</p><p>jQuery选择器虽然很多，但是选择器之间可以相互替代，就是说获取一个元素，你会有很多种方法获取到。所以我们平时真正能用到的只是少数的最常用的选择器。</p><h2 id="css选择器"><a href="#css选择器" class="headerlink" title="css选择器"></a>css选择器</h2><blockquote><p>jQuery完全兼容css选择器</p></blockquote><table><thead><tr><th>名称</th><th>用法</th><th align="left">描述</th></tr></thead><tbody><tr><td>ID选择器</td><td>$(“#id”);</td><td align="left">获取指定ID的元素</td></tr><tr><td>类选择器</td><td>$(“.class”);</td><td align="left">获取同一类class的元素</td></tr><tr><td>标签选择器</td><td>$(“div”);</td><td align="left">获取同一类标签的所有元素</td></tr><tr><td>并集选择器</td><td>$(“div,p,li”);</td><td align="left">使用逗号分隔，只要符合条件之一就可。</td></tr><tr><td>交集选择器</td><td>$(“div.redClass”);</td><td align="left">获取class为redClass的div元素</td></tr><tr><td>子代选择器</td><td>$(“ul&gt;li”);</td><td align="left">使用&gt;号，获取儿子层级的元素，注意，并不会获取孙子层级的元素</td></tr><tr><td>后代选择器</td><td>$(“ul li”);</td><td align="left">使用空格，代表后代选择器，获取ul下的所有li元素，包括孙子等</td></tr></tbody></table><blockquote><p>跟CSS的选择器一模一样。</p></blockquote><h2 id="过滤选择器"><a href="#过滤选择器" class="headerlink" title="过滤选择器"></a>过滤选择器</h2><blockquote><p>这类选择器都带冒号:</p></blockquote><table><thead><tr><th>名称</th><th>用法</th><th align="left">描述</th></tr></thead><tbody><tr><td>:eq（index）</td><td>$(“li:eq(2)”).css(“color”, ”red”);</td><td align="left">获取到的li元素中，选择索引号为2的元素，索引号index从0开始。</td></tr><tr><td>:odd</td><td>$(“li:odd”).css(“color”, ”red”);</td><td align="left">获取到的li元素中，选择索引号为奇数的元素</td></tr><tr><td>:even</td><td>$(“li:even”).css(“color”, ”red”);</td><td align="left">获取到的li元素中，选择索引号为偶数的元素</td></tr><tr><td>:first</td><td>$(“li:first”).css(“color”, ”red”);</td><td align="left">获取到的li元素中的第一个</td></tr><tr><td>:last</td><td>$(“li:last”).css(“color”, ”red”);</td><td align="left">获取到的li元素中的最后一个</td></tr></tbody></table><p>【案例：隔行变色】</p><h2 id="筛选选择器-方法"><a href="#筛选选择器-方法" class="headerlink" title="筛选选择器(方法)"></a>筛选选择器(方法)</h2><blockquote><p>筛选选择器的功能与过滤选择器有点类似，但是用法不一样，<code>筛选选择器</code>主要是方法。</p></blockquote><table><thead><tr><th>名称</th><th>用法</th><th align="left">描述</th></tr></thead><tbody><tr><td>children(selector)</td><td>$(“ul”).children(“li”)</td><td align="left">获取当前元素的所有子元素中的li元素</td></tr><tr><td>find(selector)</td><td>$(“ul”).find(“li”);</td><td align="left">获取当前元素中的后代元素中的li元素</td></tr><tr><td>siblings(selector)</td><td>$(“#first”).siblings(“li”);</td><td align="left">查找兄弟节点，不包括自己本身。</td></tr><tr><td>parent()</td><td>$(“#first”).parent();</td><td align="left">查找父亲</td></tr><tr><td>eq(index)</td><td>$(“li”).eq(2);</td><td align="left">相当于<code>$(“li:eq(2)”)</code>,index从0开始</td></tr><tr><td>next()</td><td>$(“li”).next()</td><td align="left">找下一个兄弟</td></tr><tr><td>prev()</td><td>$(“li”).prev()</td><td align="left">找上一次兄弟</td></tr></tbody></table><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">//【案例：下拉菜单】this+children+mouseenter+mouseleave</span></span><br><span class="line"><span class="comment">//【案例：突出展示】siblings+find</span></span><br><span class="line"><span class="comment">//【案例：手风琴】next+parent</span></span><br><span class="line"><span class="comment">//【案例：淘宝精品】index+eq</span></span><br></pre></td></tr></table></figure><h1 id="其他补充"><a href="#其他补充" class="headerlink" title="其他补充"></a>其他补充</h1><h2 id="mouseover与mouseenter"><a href="#mouseover与mouseenter" class="headerlink" title="mouseover与mouseenter"></a>mouseover与mouseenter</h2><blockquote><p>mouseover和mouseoverenter都有鼠标经过的意思，但是在注册鼠标经过事件的时候，推荐使用<code>mouseenter</code></p></blockquote><p><a href="http://www.w3school.com.cn/tiy/t.asp?f=jquery_event_mouseenter_mouseover" target="_blank" rel="noopener">mouseenter 与 mouseover 的不同</a></p><ol><li>mouseover与mouseout是一对事件，当鼠标经过当前元素或者当前元素的子元素的时候，mouseover事件都会触发【事件冒泡】。</li><li>mouseenter与mouseleave是一对事件，只有当鼠标经过当前元素时，事件会触发，鼠标经过子元素，mousenter事件是不会触发的。</li></ol><h2 id="index方法"><a href="#index方法" class="headerlink" title="index方法"></a>index方法</h2><blockquote><p><code>index()</code>方法返回的是当前元素在所有兄弟元素里面的索引。</p></blockquote><figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>我是链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>我是链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>我是链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>我是链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>我是链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>我是链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>我是链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>我是链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"#"</span>&gt;</span>我是链接<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>当碰到这种结构的时候，推荐给li注册事件，这样通过index方法才能获取到正确的索引值。</strong></p><h2 id="区分jQuery与Javascript"><a href="#区分jQuery与Javascript" class="headerlink" title="区分jQuery与Javascript"></a>区分jQuery与Javascript</h2><p>JavaScript是一门编程语言，jQuery仅仅是用JavaScript实现的一个JavaScript库，目的是简化我们的开发。（联想记忆：不能扛着洗衣机去出差）</p><p><img src="/" class="lazyload" data-src="/.com//1.png"  alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;jQuery基本介绍&quot;&gt;&lt;a href=&quot;#jQuery基本介绍&quot; class=&quot;headerlink&quot; title=&quot;jQuery基本介绍&quot;&gt;&lt;/a&gt;jQuery基本介绍&lt;/h1&gt;&lt;h2 id=&quot;为什么要学jQuery&quot;&gt;&lt;a href=&quot;#为什么要学jQuer
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>js进阶02</title>
    <link href="http://yoursite.com/2019/11/19/js%E8%BF%9B%E9%98%B602/"/>
    <id>http://yoursite.com/2019/11/19/js%E8%BF%9B%E9%98%B602/</id>
    <published>2019-11-19T10:44:57.000Z</published>
    <updated>2020-04-14T02:50:29.792Z</updated>
    
    <content type="html"><![CDATA[<h1 id="基础语法"><a href="#基础语法" class="headerlink" title="基础语法"></a>基础语法</h1><h2 id="学习目标"><a href="#学习目标" class="headerlink" title="学习目标"></a>学习目标</h2><ul><li>了解</li></ul><pre><code> 重新认识instanceof- 原型链不可变- for..in的问题</code></pre><ul><li><p>重点</p></li><li><p>重点</p><ul><li><p>上下文调用模式</p></li><li><p>js中的继承</p></li><li><p>闭包</p></li></ul></li></ul><h2 id="1-重新认识instanceof"><a href="#1-重新认识instanceof" class="headerlink" title="1. 重新认识instanceof"></a>1. 重新认识instanceof</h2><p>js基础阶段对instanceof作用的描述 : <strong>判断一个对象是否是某个构造函数的实例</strong></p><p>现在我们学习了原型,也学习了原型链,所以我们现在可以更严谨的描述他的作用:</p><p><strong>判断一个函数的原型对象,是否在实例对象的原型链上</strong></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [];</span><br><span class="line"><span class="built_in">console</span>.log(arr <span class="keyword">instanceof</span> <span class="built_in">Array</span>); <span class="comment">//true</span></span><br><span class="line"><span class="built_in">console</span>.log(arr <span class="keyword">instanceof</span> <span class="built_in">Object</span>);  <span class="comment">//true</span></span><br></pre></td></tr></table></figure><h2 id="2-原型链不可变"><a href="#2-原型链不可变" class="headerlink" title="2. 原型链不可变"></a>2. 原型链不可变</h2><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> Person();</span><br><span class="line"><span class="built_in">console</span>.log(p1 <span class="keyword">instanceof</span> Person); <span class="comment">// ?</span></span><br><span class="line"></span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">    <span class="keyword">constructor</span> : Person,</span><br><span class="line">    a : 1</span><br><span class="line">&#125;</span><br><span class="line">console.log(p1 instanceof Person); // ?</span><br><span class="line">var p2 = new Person();</span><br><span class="line">console.log(p2 instanceof Person); // ?</span><br></pre></td></tr></table></figure><p><img src="/" class="lazyload" data-src="/.com//D:%5CDesktop%5CmyHexoBlog%5Csource_posts%5Cjs%E8%BF%9B%E9%98%B6%5C%E5%8E%9F%E5%9E%8B%E9%93%BE%E4%B8%8D%E5%8F%AF%E5%8F%98.png"  alt></p><p>##3. 上下文调用函数</p><h3 id="3-1-回顾之前我们学习的调用函数的几种方式"><a href="#3-1-回顾之前我们学习的调用函数的几种方式" class="headerlink" title="3.1 回顾之前我们学习的调用函数的几种方式"></a>3.1 回顾之前我们学习的调用函数的几种方式</h3><ul><li><p>普通调用</p><blockquote><p>this – &gt; window</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>);  <span class="comment">// window</span></span><br><span class="line">&#125;</span><br><span class="line">fn();</span><br></pre></td></tr></table></figure></li><li><p>对象调用</p><blockquote><p>this – &gt; obj</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">this</span>) <span class="comment">// obj</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> obj = &#123;</span><br><span class="line">    f : fn</span><br><span class="line">&#125;;</span><br><span class="line">obj.f();</span><br></pre></td></tr></table></figure></li><li><p>构造函数调用</p><blockquote><p>this – &gt; 构造函数的实例</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name; <span class="comment">//this --&gt; 实例</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> Person(<span class="string">'zs'</span>);</span><br></pre></td></tr></table></figure></li><li><p>定时器中的回调函数</p><blockquote><p>this – &gt; window</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">this</span>)<span class="comment">// window</span></span><br><span class="line">&#125;,<span class="number">1000</span>);</span><br></pre></td></tr></table></figure></li><li><p>事件处理函数调用</p><blockquote><p>this –&gt; 事件源</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line">box.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="built_in">console</span>.log(<span class="keyword">this</span>); <span class="comment">// box</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li></ul><p><strong>我们总结了一句话: this的指向是在函数调用时决定的. 谁调用这个函数,this指向谁</strong></p><h3 id="3-2-上下文调用函数的三个方法"><a href="#3-2-上下文调用函数的三个方法" class="headerlink" title="3.2 上下文调用函数的三个方法"></a>3.2 上下文调用函数的三个方法</h3><blockquote><p>为什么要学习上下文调用函数?</p><p>因为这样我们就可以随意的控制函数中this的指向</p></blockquote><h4 id="3-2-1-call方法"><a href="#3-2-1-call方法" class="headerlink" title="3.2.1  call方法"></a>3.2.1  call方法</h4><p><strong>作用:</strong> 调用该函数,并修改函数中this的指向</p><p>*<em>语法: *</em> 函数名. call(对象,[实参]);</p><p><strong>参数详解:</strong></p><p>第一个参数: 要让函数中this指向谁,就写谁</p><p>后面的参数: 被调用函数要传入的实参,以逗号分隔</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">x, y</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>); <span class="comment">// ['a','b','c']</span></span><br><span class="line">    <span class="built_in">console</span>.log(x + y); <span class="comment">//8</span></span><br><span class="line">&#125;</span><br><span class="line">fn.call([<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>], <span class="number">3</span>, <span class="number">5</span>);</span><br></pre></td></tr></table></figure><h4 id="3-2-2-apply-方法"><a href="#3-2-2-apply-方法" class="headerlink" title="3.2.2 apply 方法"></a>3.2.2 apply 方法</h4><p><strong>作用:</strong> 调用该函数,并修改函数中this的指向</p><p>*<em>语法: *</em> 函数名. apply(对象,数组);</p><p><strong>参数详解:</strong></p><p>第一个参数: 要让函数中this指向谁,就写谁</p><p>第二个参数: 要去传入一个数组,里面存放被调用函数需要的实参</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">x, y</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>); <span class="comment">// &#123;a : 1&#125;</span></span><br><span class="line">    <span class="built_in">console</span>.log(x + y); <span class="comment">//8</span></span><br><span class="line">&#125;</span><br><span class="line">fn.apply(&#123;<span class="attr">a</span> : <span class="number">1</span>&#125;, [<span class="number">3</span>, <span class="number">5</span>]);</span><br></pre></td></tr></table></figure><h4 id="3-2-3-bind方法"><a href="#3-2-3-bind方法" class="headerlink" title="3.2.3 bind方法"></a>3.2.3 bind方法</h4><p><strong>作用:</strong> 不调用函数,克隆一个新的函数,并修改新函数中this的指向,将新的函数返回</p><p>*<em>语法: *</em> 函数名. bind(对象[,实参]);</p><p><strong>参数详解:</strong></p><p>第一个参数: 要让函数中this指向谁,就写谁</p><p>后面的参数: 被调用函数要传入的实参,以逗号分隔</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params">x, y</span>)</span>&#123;</span><br><span class="line">    <span class="comment">//调用newFn时打印结果</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>);  <span class="comment">//&#123;b:2&#125;</span></span><br><span class="line">    <span class="built_in">console</span>.log(x + y); <span class="comment">//8</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> newFn = fn.bind(&#123;<span class="attr">b</span>:<span class="number">2</span>&#125;, <span class="number">3</span>, <span class="number">5</span>);</span><br><span class="line">newFn();</span><br></pre></td></tr></table></figure><h4 id="小结"><a href="#小结" class="headerlink" title="小结:"></a>小结:</h4><ul><li>call和apply 会调用函数 ,  bind不会调用函数</li><li>apply要求把实参放到数组中,然后把数组传进来</li></ul><h2 id="4-for-in的问题"><a href="#4-for-in的问题" class="headerlink" title="4. for..in的问题"></a>4. for..in的问题</h2><blockquote><p>for…in 遍历时,会把原型上的属性也遍历出来</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person.prototype.type = <span class="string">'human'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> zs = <span class="keyword">new</span> Person(<span class="string">'zs'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> zs)&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(key); <span class="comment">// name , type  把type也打印出来了</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果我们就想打印对象自己身上的属性,可以使用hasOwnProperty方法来解决</p><p>*<em>hasOwnProperty的作用: *</em> 判断是不是对象自己的属性</p><p>*<em>hasOwnProperty的语法: *</em> 对象.hasOwnProperty(‘属性’) 是则返回true, 否则false</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person.prototype.type = <span class="string">'human'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> zs = <span class="keyword">new</span> Person(<span class="string">'zs'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> zs)&#123;</span><br><span class="line">    <span class="keyword">if</span>(zs.hasOwnProperty(key))&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(key);   <span class="comment">//只有自己的name</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>##5. js中的继承</p><h3 id="5-1-为什么要学习js中的继承"><a href="#5-1-为什么要学习js中的继承" class="headerlink" title="5.1 为什么要学习js中的继承"></a>5.1 为什么要学习js中的继承</h3><p>此时我们希望stu2对象,也拥有stu1对象的class, subject这些属性,但是我们不想再重新写一遍,怎么办?</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> stu1 = &#123;</span><br><span class="line">    class : '三年级',</span><br><span class="line">    subject : <span class="string">'Chinese'</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> stu2 = &#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-2-两个对象之间的继承"><a href="#5-2-两个对象之间的继承" class="headerlink" title="5.2 两个对象之间的继承"></a>5.2 两个对象之间的继承</h3><h4 id="5-2-1-遍历对象"><a href="#5-2-1-遍历对象" class="headerlink" title="5.2.1 遍历对象"></a>5.2.1 遍历对象</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> stu1 = &#123;</span><br><span class="line">    class : '三年级',</span><br><span class="line">    subject : <span class="string">'Chinese'</span>,</span><br><span class="line">    score : <span class="number">98</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> stu2 = &#123;</span><br><span class="line">    score :<span class="number">82</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//通过for..in遍历far</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> far)&#123;</span><br><span class="line">    stu2[key] = stu1[key];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(stu2); <span class="comment">// 此时stu2拥有了class,score和subject .</span></span><br></pre></td></tr></table></figure><p><strong>但是以上代码书写存在一个问题 : 把score的值也继承下来了.我们希望自己有的,就不继承了.所以我们要改一下代码</strong></p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> key <span class="keyword">in</span> far)&#123;</span><br><span class="line">    <span class="comment">//自己没有的才继承</span></span><br><span class="line">    <span class="keyword">if</span>(!stu2.hasOwnProperty(key))&#123;</span><br><span class="line">        stu2[key] = stu1[key];</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>这样处理解决刚才的问题,但是我们发现两个对象上面存在一样的代码.这样比较占用内存</strong></p><h4 id="5-2-2-通过create方法实现继承"><a href="#5-2-2-通过create方法实现继承" class="headerlink" title="5.2.2  通过create方法实现继承"></a>5.2.2  通过create方法实现继承</h4><blockquote><p>通过ceate方法实现继承,可以避免遍历对象方式,占用内存的问题</p></blockquote><p>*<em>create方法语法:  *</em>Object.create(参考对象) 返回一个新的对象</p><p>*<em>create方法的作用: *</em> 返回的新的对象的<code>__proto__</code> 指向参考对象  </p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> stu1 = &#123;</span><br><span class="line">     class : '三年级',</span><br><span class="line">    subject : <span class="string">'Chinese'</span>,</span><br><span class="line">    score : <span class="number">98</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> stu2 = <span class="built_in">Object</span>.create(stu1);</span><br><span class="line">stu2.score = <span class="number">89</span>;</span><br><span class="line"><span class="built_in">console</span>.log(stu2.class); <span class="comment">//'三年级'</span></span><br><span class="line"><span class="built_in">console</span>.log(stu2.subject); <span class="comment">//'Chinese'</span></span><br><span class="line"><span class="built_in">console</span>.log(stu2.score); <span class="comment">//89</span></span><br><span class="line"><span class="built_in">console</span>.log(stu2.__proto__ === stu1); <span class="comment">//true</span></span><br></pre></td></tr></table></figure><h3 id="5-3-构造函数的继承"><a href="#5-3-构造函数的继承" class="headerlink" title="5.3 构造函数的继承"></a>5.3 构造函数的继承</h3><blockquote><p>我们工作中要经常创建多个具有相同属性的对象,所以经常要写构造函数.</p><p>那么构造函数创建的出来的对象该如何实现继承呢?</p></blockquote><h4 id="5-3-1-借用构造函数"><a href="#5-3-1-借用构造函数" class="headerlink" title="5.3.1 借用构造函数"></a>5.3.1 借用构造函数</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.age = age;</span><br><span class="line">    <span class="keyword">this</span>.sayHello = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'hello, '</span> + <span class="string">'我是'</span> + <span class="keyword">this</span>.name );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name, age, score</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.score = score;</span><br><span class="line">    Person.call(<span class="keyword">this</span>, name, age);<span class="comment">//借用构造函数</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> stu = <span class="keyword">new</span> Student(<span class="string">'zs'</span>, <span class="number">18</span>, <span class="number">100</span>);</span><br><span class="line"><span class="built_in">console</span>.log(stu); <span class="comment">//&#123;score : 100, name : zs, age : 18&#125;</span></span><br><span class="line">stu.sayHello(); <span class="comment">//hello, 我是zs</span></span><br></pre></td></tr></table></figure><p><strong>但是我们一般不会把方法写在构造函数的函数体内,我们把方法写在函数的原型上,那么这个时候构造借用函数就无法继承方法了,我们想要继承原型上的方法.可以用原型继承</strong></p><h4 id="5-3-2-原型继承"><a href="#5-3-2-原型继承" class="headerlink" title="5.3.2 原型继承"></a>5.3.2 原型继承</h4><blockquote><p>用来继承方法</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.age = age;</span><br><span class="line">    <span class="keyword">this</span>.sayHello = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'hello, '</span> + <span class="string">'我是'</span> + <span class="keyword">this</span>.name );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name, age, score</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.score = score;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Student.prototype = <span class="keyword">new</span> Person();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> stu = <span class="keyword">new</span> Student(<span class="string">'zs'</span>, <span class="number">18</span>, <span class="number">100</span>);</span><br><span class="line"><span class="built_in">console</span>.log(stu); <span class="comment">//&#123;score : 100&#125;</span></span><br><span class="line">stu.sayHello(); <span class="comment">//hello, 我是undefined</span></span><br></pre></td></tr></table></figure><p><img src="/" class="lazyload" data-src="/.com//D:%5CDesktop%5CmyHexoBlog%5Csource_posts%5Cjs%E8%BF%9B%E9%98%B6%5C%E5%8E%9F%E5%9E%8B%E7%BB%A7%E6%89%BF.png"  alt></p><p><strong>我们发现,方法继承下来了,但是属性却没有继承下来</strong></p><h4 id="5-3-3-组合继承"><a href="#5-3-3-组合继承" class="headerlink" title="5.3.3 组合继承"></a>5.3.3 组合继承</h4><blockquote><p>借用构造函数 + 原型继承</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params">name, age</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name;</span><br><span class="line">    <span class="keyword">this</span>.age = age;</span><br><span class="line">    <span class="keyword">this</span>.sayHello = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'hello, '</span> + <span class="string">'我是'</span> + <span class="keyword">this</span>.name );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params">name, age, score</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.score = score;</span><br><span class="line">    Person.call(<span class="keyword">this</span>, name, age);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Student.prototype = <span class="keyword">new</span> Person();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> stu = <span class="keyword">new</span> Student(<span class="string">'zs'</span>, <span class="number">18</span>, <span class="number">100</span>);</span><br><span class="line"><span class="built_in">console</span>.log(stu); <span class="comment">//&#123;score : 100, name : zs, age : 18&#125;</span></span><br><span class="line">stu.sayHello(); <span class="comment">//hello, 我是zs</span></span><br></pre></td></tr></table></figure><p>##6. 闭包</p><p>*<em>概念: *</em> 函数和函数作用域的结合</p><p>*<em>通俗理解: *</em> 内部函数使用外部函数的变量, 整个外部函数形成了一个闭包</p><p>###6.1闭包的作用:</p><ol><li>私有化数据</li><li>数据保持</li></ol><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">main</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> money = <span class="number">10000</span>;  <span class="comment">//放到局部作用中,防止全局变量污染(私有化数据)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123;</span><br><span class="line">        queryMoney : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> money;</span><br><span class="line">        &#125;,</span><br><span class="line">        payMoney : <span class="function"><span class="keyword">function</span>(<span class="params">num</span>)</span>&#123;</span><br><span class="line">            money -= num;</span><br><span class="line">        &#125;,</span><br><span class="line">        addMoney : <span class="function"><span class="keyword">function</span>(<span class="params">num</span>)</span>&#123;</span><br><span class="line">            money += num;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> moneyManger = main();  <span class="comment">// 通过moneyManger 可以获取到局部的变量money</span></span><br></pre></td></tr></table></figure><p>###6.2闭包的缺点: </p><p>  由于内部的函数使用了外部函数的变量,导致外部这个函数无法被回收掉.如果代码中大量的存在闭包,可能会导致内存泄露 (不要刻意使用闭包);</p><h2 id="7-拓展内容"><a href="#7-拓展内容" class="headerlink" title="7.拓展内容"></a>7.拓展内容</h2><p>###7.1 函数的静态成员和实例成员</p><p>成员: 泛指属性和方法</p><p>静态成员: 函数也是对象, 函数自己的属性</p><p>实例成员: 特指构造函数时,写在构造函数体内,通过this.xxx.给实例添加的属性</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line"><span class="keyword">this</span>.name = name; <span class="comment">//实例成员</span></span><br><span class="line">    <span class="keyword">this</span>.age = age; <span class="comment">// 实例成员</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person.type = <span class="string">'呵呵'</span>; <span class="comment">//静态成员</span></span><br></pre></td></tr></table></figure><h3 id="7-2-Function的原型图"><a href="#7-2-Function的原型图" class="headerlink" title="7.2.Function的原型图"></a>7.2.Function的原型图</h3><p>Functon 自己创造了自己</p><p>Object是Function的实例</p><p><img src="/" class="lazyload" data-src="/.com//D:%5CDesktop%5CmyHexoBlog%5Csource_posts%5Cjs%E8%BF%9B%E9%98%B6%5CFunction%E5%8E%9F%E5%9E%8B%E5%9B%BE01.png"  alt></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;基础语法&quot;&gt;&lt;a href=&quot;#基础语法&quot; class=&quot;headerlink&quot; title=&quot;基础语法&quot;&gt;&lt;/a&gt;基础语法&lt;/h1&gt;&lt;h2 id=&quot;学习目标&quot;&gt;&lt;a href=&quot;#学习目标&quot; class=&quot;headerlink&quot; title=&quot;学习目标&quot;&gt;&lt;/a
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>js进阶01</title>
    <link href="http://yoursite.com/2019/11/18/js%E8%BF%9B%E9%98%B601/"/>
    <id>http://yoursite.com/2019/11/18/js%E8%BF%9B%E9%98%B601/</id>
    <published>2019-11-18T10:43:03.000Z</published>
    <updated>2020-04-14T02:47:30.612Z</updated>
    
    <content type="html"><![CDATA[<h1 id="基础语法"><a href="#基础语法" class="headerlink" title="基础语法"></a>基础语法</h1><h2 id="学习目标"><a href="#学习目标" class="headerlink" title="学习目标"></a>学习目标</h2><ul><li>了解</li></ul><ul><li>回顾js基础</li><li>构造函数创建对象存在的问题</li></ul><ul><li><p>重点</p><ul><li><p>知道函数有原型对象</p></li><li><p>构造函数,原型对象和实例三者的关系</p></li><li><p>原型链</p></li><li><p>会给内置的对象添加自定义的方法</p></li><li><p>会使用更简单的原型使用方式</p></li></ul></li></ul><h2 id="1-回顾"><a href="#1-回顾" class="headerlink" title="1. 回顾"></a>1. 回顾</h2><h3 id="1-1-作用域"><a href="#1-1-作用域" class="headerlink" title="1.1 作用域:"></a>1.1 作用域:</h3><p>####1.1.1 全局作用域</p><p>整个js执行的环境就是一个全局作用域</p><p>####1.1.2 局部作用域</p><p>es5规范中: 只有函数才能构成一个局部作用域</p><p>####1.1.3 作用域链</p><p>将js执行时变量查找的方式,以链式形式表示出来</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> num = <span class="number">0</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> num1;</span><br><span class="line">    num1 = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(num1);</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">fnSon</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> num2 = <span class="number">2</span>;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="number">2</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>将上面的代码用链式的形式展示出来</p> class="lazyload" data-src="/.com//Desktop\myHexoBlog\source\_posts\js进阶\作用域链.png" <img src="/"><h3 id="1-2-词法作用域规则"><a href="#1-2-词法作用域规则" class="headerlink" title="1.2 词法作用域规则"></a>1.2 词法作用域规则</h3><blockquote><p>词法作用域又叫静态作用域. </p></blockquote><ul><li><p>作用域是在代码书写完毕之后就形成了,与代码执行无关</p></li><li><p>内部作用域可以访问外部作用域的变量,但是外部不可以访问内部的</p></li><li><p>函数的形参就相当于在当前函数的作用域中申明了这个变量</p></li><li><p>访问变量时,先在自己的作用域中查找,如果没有则沿着作用域链往上找,直到全局.如果全局也没有就报错</p> class="lazyload" data-src="/.com//Desktop\myHexoBlog\source\_posts\js进阶\报错1.png" <img src="/"></li><li><p>给变量赋值之前,要先找变量.查找变量也是沿着作用域链查找,直到全局,如果全局也没有,则会再全局作用域创建这个变量(隐式全局)</p></li><li><p>代码执行之前先考虑预解析规则,调用函数时,执行函数里的代码之前,函数内也要先执行预解析规则</p></li></ul><p>###真实面试题:</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a;</span><br><span class="line"><span class="keyword">if</span> (<span class="string">"a"</span> <span class="keyword">in</span> <span class="built_in">window</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line">alert(a);  <span class="comment">//</span></span><br><span class="line"><span class="comment">//=============================================</span></span><br><span class="line"><span class="keyword">var</span> foo = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!foo) &#123;</span><br><span class="line">        <span class="keyword">var</span> foo = <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    alert(foo); <span class="comment">//</span></span><br><span class="line">&#125;</span><br><span class="line"> bar();</span><br><span class="line"><span class="comment">//================================================</span></span><br><span class="line"><span class="keyword">var</span> num = <span class="number">123</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f1</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(num); <span class="comment">//  </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f2</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> num = <span class="number">456</span>;</span><br><span class="line">    f1(num);</span><br><span class="line">&#125;</span><br><span class="line">f2();</span><br><span class="line"></span><br><span class="line"><span class="comment">//======================================================</span></span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">   <span class="keyword">var</span> a = <span class="number">1</span>, b = <span class="number">1</span>, c = <span class="number">1</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> fn();</span><br><span class="line"> <span class="built_in">console</span>.log(c); <span class="comment">//</span></span><br><span class="line"> <span class="built_in">console</span>.log(b); <span class="comment">//</span></span><br><span class="line"> <span class="built_in">console</span>.log(a); <span class="comment">//</span></span><br><span class="line">  </span><br><span class="line"> <span class="function"><span class="keyword">function</span> <span class="title">fn1</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">   <span class="keyword">var</span> a = b = c = <span class="number">1</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> fn1();</span><br><span class="line"> <span class="built_in">console</span>.log(c); <span class="comment">//</span></span><br><span class="line"> <span class="built_in">console</span>.log(b); <span class="comment">//</span></span><br><span class="line"> <span class="built_in">console</span>.log(a); <span class="comment">//</span></span><br><span class="line"><span class="comment">//========================================================</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fn</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> a = <span class="number">2</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">fnSon</span>(<span class="params">a</span>)</span>&#123;</span><br><span class="line">        a = <span class="number">3</span>;</span><br><span class="line">        <span class="built_in">console</span>.log(a); <span class="comment">//</span></span><br><span class="line">    &#125;</span><br><span class="line">    fnSon();</span><br><span class="line">    <span class="built_in">console</span>.log(a);  <span class="comment">// </span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(a);  <span class="comment">// </span></span><br><span class="line">fn();</span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">// </span></span><br><span class="line"></span><br><span class="line"><span class="comment">//==========================================================</span></span><br><span class="line"><span class="keyword">var</span> a ;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'呵呵'</span>)</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        a = <span class="number">4</span>;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'哈哈'</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    a();</span><br><span class="line">    <span class="built_in">console</span>.log(a);  <span class="comment">//</span></span><br><span class="line">&#125;</span><br><span class="line">a();</span><br><span class="line"><span class="built_in">console</span>.log(a); <span class="comment">//</span></span><br><span class="line"><span class="comment">//=================================================================</span></span><br><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">a</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    a++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(a) <span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//==================================================================</span></span><br><span class="line"> <span class="keyword">var</span> a = &#123; <span class="attr">x</span> : <span class="number">1</span> &#125;</span><br><span class="line"> <span class="keyword">var</span> b = a;</span><br><span class="line"> a.x = a = &#123; <span class="attr">n</span> : <span class="number">1</span>&#125;;</span><br><span class="line"> <span class="built_in">console</span>.log(a.x); <span class="comment">//</span></span><br><span class="line"> <span class="built_in">console</span>.log(b.x); <span class="comment">//</span></span><br></pre></td></tr></table></figure><p>###1.3. 创建对象的方式</p><p>####1.3.1 简单方式</p><p>我们可以直接通过 <code>new Object()</code> 创建：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> person = <span class="keyword">new</span> <span class="built_in">Object</span>()</span><br><span class="line">person.name = <span class="string">'Jack'</span>;</span><br><span class="line">person.age = <span class="number">18</span>;</span><br><span class="line">person.sayName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);   <span class="comment">//jack</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>每次创建通过 <code>new Object()</code> 比较麻烦，所以可以通过它的简写形式对象字面量来创建：</p><blockquote><p>字面量形式的创建方式,底层也是new Object创建出来的</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> person = &#123;</span><br><span class="line">  name: <span class="string">'Jack'</span>,</span><br><span class="line">  age: <span class="number">18</span>,</span><br><span class="line">  sayName: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>上面的写法比较简单，但是如果我们要创建多个person对象呢？</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> person1 = &#123;</span><br><span class="line">  name: <span class="string">'Jack'</span>,</span><br><span class="line">  age: <span class="number">18</span>,</span><br><span class="line">  sayName: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person2 = &#123;</span><br><span class="line">  name: <span class="string">'Mike'</span>,</span><br><span class="line">  age: <span class="number">16</span>,</span><br><span class="line">  sayName: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> person3 = &#123;</span><br><span class="line">  name: <span class="string">'zs'</span>,</span><br><span class="line">  age: <span class="number">17</span>,</span><br><span class="line">  sayName: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>通过上面的代码我们不难看出，这样写的代码太过冗余。</p><p>####1.3.2 简单方式的改进：工厂函数</p><p>我们可以写一个函数，解决代码重复问题：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">createPerson</span> (<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    name: name,</span><br><span class="line">    age: age,</span><br><span class="line">    sayName: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>然后生成对象：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> p1 = createPerson(<span class="string">'Jack'</span>, <span class="number">18</span>);</span><br><span class="line">p1.sayName(); <span class="comment">//jack</span></span><br><span class="line"><span class="keyword">var</span> p2 = createPerson(<span class="string">'Mike'</span>, <span class="number">18</span>);</span><br><span class="line">p2.sayName(); <span class="comment">// Mike</span></span><br></pre></td></tr></table></figure><p>####1.3.3 更优雅的方式(更推荐使用的一种方式)：构造函数</p><p>一种更优雅的工厂函数就是下面这样，构造函数：</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">  <span class="keyword">this</span>.sayName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> Person(<span class="string">'Jack'</span>, <span class="number">18</span>);</span><br><span class="line">p1.sayName() <span class="comment">// =&gt; Jack</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p2 = <span class="keyword">new</span> Person(<span class="string">'Mike'</span>, <span class="number">23</span>);</span><br><span class="line">p2.sayName() <span class="comment">// =&gt; Mike</span></span><br></pre></td></tr></table></figure><p><strong>构造函数中new关键字做了4件事:</strong></p><ol><li>创建一个新对象</li><li>让 this 就指向了这个新对象</li><li>执行构造函数中的代码</li><li>返回新对象</li></ol><h2 id="2-构造函数的问题"><a href="#2-构造函数的问题" class="headerlink" title="2. 构造函数的问题"></a>2. 构造函数的问题</h2><blockquote><p>使用构造函数带来的最大的好处就是创建对象更方便了，但是其本身也存在一个浪费内存的问题：</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">  <span class="keyword">this</span>.sayHello = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'hello '</span> + <span class="keyword">this</span>.name);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> Person(<span class="string">'Tom'</span>, <span class="number">18</span>);</span><br><span class="line"><span class="keyword">var</span> p2 = <span class="keyword">new</span> Person(<span class="string">'Jack'</span>, <span class="number">16</span>);</span><br></pre></td></tr></table></figure><p>以上代码的图示:</p> class="lazyload" data-src="/.com//Desktop\myHexoBlog\source\_posts\js进阶\构造函数的问题.png" <img src="/"><p>通过上面的图示,我们发现,每一个对象都引用了一个函数,我们创建了多少个对象,对应的就会在内存中创建出对应数量的一样的函数.这样造成了内存的极大浪费</p><p>##3 解决构造函数浪费内存的方法:</p><p>###3.1 把对象的行为定义在构造函数外面</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">  <span class="keyword">this</span>.sayHello = say;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">say</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">'hello '</span> + <span class="keyword">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> Person(<span class="string">'Tom'</span>, <span class="number">18</span>);</span><br><span class="line"><span class="keyword">var</span> p2 = <span class="keyword">new</span> Person(<span class="string">'Jack'</span>, <span class="number">16</span>);</span><br><span class="line">p1.sayHello(); <span class="comment">// hello Tom</span></span><br><span class="line">p2.sayHello(); <span class="comment">// hello Jack</span></span><br></pre></td></tr></table></figure> class="lazyload" data-src="/.com//Desktop\myHexoBlog\source\_posts\js进阶\解决构造函数的问题01.png" <img src="/"><p>*<em>注意: *</em>  这种方式,可以解决构造函数浪费内存的问题,但是,同时又出现了一个新的问题,我们把函数定义在了全局,</p><p>全局的函数,很容易被别人写的代码覆盖.</p><p>###3.2 利用函数的原型对象(更优雅的解决方案)</p><blockquote><p>js给每一个函数,提供了一个对应的原型对象.可以通过函数的prototype属性访问到这个原型对象.</p><p>原型对象有一个constructor的属性会指向自己对应的函数</p><p>而我们通过  <code>new 函数</code>  创建出来的实例对象,默认可以访问到函数对应的原型对象上的属性</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line">Person.prototype.sayName = <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">   <span class="built_in">console</span>.log(<span class="string">'hello '</span> + <span class="keyword">this</span>.name);</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> Person(<span class="string">'Tom'</span>, <span class="number">18</span>);</span><br><span class="line"><span class="keyword">var</span> p2 = <span class="keyword">new</span> Person(<span class="string">'Jack'</span>, <span class="number">16</span>);</span><br><span class="line">p1.sayHello(); <span class="comment">// hello Tom</span></span><br><span class="line">p2.sayHello(); <span class="comment">// hello Jack</span></span><br></pre></td></tr></table></figure> class="lazyload" data-src="/.com//Desktop\myHexoBlog\source\_posts\js进阶\构造函数,实例,原型关系图.png" <img src="/"><p>*<em>注意: *</em>为了我们方便查看,实例和原型的关系.浏览器很贴心的帮我们实现了一个属性 <code>__proto__</code>, 通过这个属性,我们可以在控制台上清楚的看到原型.但是<code>__proto__</code>不是w3c标准的属性,所以不要在生产环境(上线)下使用.</p><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> Person();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(Perosn.prototype === p1.__proto__) <span class="comment">//true</span></span><br></pre></td></tr></table></figure><h3 id="3-3-小结"><a href="#3-3-小结" class="headerlink" title="3.3 小结:"></a>3.3 小结:</h3><ul><li><p>利用原型对象,可以更加优雅的解决构造函数浪费内存的问题</p></li><li><p>一般对象私有的属性直接写在构造函数中,而对象公有的属性写在原型对象上</p></li><li><p>函数对应有一个自己的原型对象 , 通过prototype属性可以访问</p></li><li><p>原型对象有一个constructor属性,可以指回自己的对应的函数</p></li><li><p>通过函数new出来的实例,默认可以访问到原型对象的属性 ,我们可以通过<code>__proto__</code>在控制台看到</p><p>​    </p></li></ul><h2 id="3-原型链"><a href="#3-原型链" class="headerlink" title="3. 原型链"></a>3. 原型链</h2><blockquote><p>原型对象也是对象,那么这个对象的是被谁创建出来的呢?</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> Person();</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(Person.prototype) <span class="comment">// 指向Person的原型对象</span></span><br><span class="line"><span class="built_in">console</span>.log(Person.prototype.__proto__.constructor) <span class="comment">// 我们可以看到Person的原型对象是Object的实例</span></span><br></pre></td></tr></table></figure> class="lazyload" data-src="/.com//Desktop\myHexoBlog\source\_posts\js进阶\原型链.png" <img src="/"><h2 id="4-js中对象属性的查找规则"><a href="#4-js中对象属性的查找规则" class="headerlink" title="4. js中对象属性的查找规则"></a>4. js中对象属性的查找规则</h2><blockquote><p>因为这个查找规则,所以Object函数原型对象上的所有属性都可以被其他对象访问到</p></blockquote><ul><li>访问对象的属性时,先在对象自己身上找,找到就直接返回</li><li>如果对象的身上没有这个属性,就会往原型上面找,如果找到就直接返回</li><li>如果原型上也没有,就往原型的原型上面找(沿着原型链一直往上找),找到就立即返回</li><li>如果最终都没有找到,则返回undefined</li></ul><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Student</span>(<span class="params"></span>)</span>&#123;&#125;</span><br><span class="line"><span class="keyword">var</span> s1 = <span class="keyword">new</span> Student();</span><br><span class="line">s1.toString()  <span class="comment">//[object Object]</span></span><br></pre></td></tr></table></figure><h2 id="5-内置对象的原型"><a href="#5-内置对象的原型" class="headerlink" title="5. 内置对象的原型"></a>5. 内置对象的原型</h2><ul><li><p>Array.prototype</p></li><li><p>String.prototype</p><p>…</p><p>通过观察内置函数的原型,我们发现我们在js基础阶段学习的数组/字符串常用的API,其实都定义在他们对应的原型上的.所以所有的数组对象/字符串,都能使用这些API.</p> class="lazyload" data-src="/.com//Desktop\myHexoBlog\source\_posts\js进阶\Array.prototype.png" <img src="/"> </li></ul><p><strong>小测试: 给数组添加一个我们自己定义的方法</strong></p><p>##6. 更简单的原型使用方式</p><blockquote><p>如果我们有很多公用的属性,那么一个一个的添加在函数的原型上就比较麻烦,我们还可以有一种更简单的方式</p><p>直接新建一个对象赋值给函数的prototype属性</p></blockquote><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Person</span> (<span class="params">name, age</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">this</span>.name = name;</span><br><span class="line">  <span class="keyword">this</span>.age = age;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Person.prototype = &#123;</span><br><span class="line">  <span class="keyword">constructor</span>: Person, // =&gt; 手动定义一个 <span class="keyword">constructor</span> 属性, 指向正确的构造函数</span><br><span class="line">  sayHello: function () &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'我叫'</span> + <span class="keyword">this</span>.name + <span class="string">'，我今年'</span> + <span class="keyword">this</span>.age + <span class="string">'岁了'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  eat : <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'吃饭ing...'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> p1 = <span class="keyword">new</span> Person(<span class="string">'zs'</span>, <span class="number">18</span>);</span><br></pre></td></tr></table></figure> class="lazyload" data-src="/.com//Desktop\myHexoBlog\source\_posts\js进阶\原型的简单使用方式.png" <img src="/"> ]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;基础语法&quot;&gt;&lt;a href=&quot;#基础语法&quot; class=&quot;headerlink&quot; title=&quot;基础语法&quot;&gt;&lt;/a&gt;基础语法&lt;/h1&gt;&lt;h2 id=&quot;学习目标&quot;&gt;&lt;a href=&quot;#学习目标&quot; class=&quot;headerlink&quot; title=&quot;学习目标&quot;&gt;&lt;/a
      
    
    </summary>
    
    
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://yoursite.com/2019/11/14/hello-world/"/>
    <id>http://yoursite.com/2019/11/14/hello-world/</id>
    <published>2019-11-14T04:58:25.000Z</published>
    <updated>2020-04-13T08:02:11.409Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html" target="_blank" rel="noopener">Deployment</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.
      
    
    </summary>
    
    
    
  </entry>
  
</feed>
